\chapter{Sobolev Spaces} \label{sobolev_chap}

This chapter is a brief introduction to Sobolev spaces.  We gives some
of the most important results about these spaces.  In particular, we
give those which will be useful for our study of elliptic partial
differential equations in the next chapter.  As we said, we present only a
few results about Sobolev spaces and often not in their most general
form.  We refer the reader to \cite{Ad} for a thorough coverage of the
subject.

\section{The $\displaystyle W^{k,p}$ spaces} \label{sobolev_def}

\begin{defn} \label{sob_1st_wkp}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$.  For $k\in \NN$ and
$p$ a positive integer or $\infty$, the
{\bfseries Sobolev space}\index{Sobolev Space!$\displaystyle W^{k,p}(\Omega)$}
$\displaystyle W^{k,p}(\Omega)$ is the space defined by
\[
W^{k,p}(\Omega) = \left\{ f \in L^p(\Omega) : \diff^\alpha f \in
  L^p(\Omega) \ , \ |\alpha| \leq k \right\} \ ,
\]
where the derivatives $\displaystyle \diff^\alpha$ are derivatives in
the sense of distributions.
\end{defn}

We can define a norm on $\displaystyle W^{k,p}(\Omega)$ by
\begin{equation} \label{sob_norm_wkp}
\| f \|_{k,p} =
\begin{cases}
\displaystyle \left( \sum_{|\alpha|\leq k} \| \diff^\alpha f \|_p^p \right)^{1/p}&
\quad \text{if} \quad 0 < p < \infty \\
\displaystyle \max_{|\alpha|\leq k} \| \diff^\alpha f \|_\infty &
\quad \text{if} \quad p = \infty
\end{cases}
\end{equation}
for $\displaystyle f \in W^{k,p}(\Omega)$, where $\|\cdot\|_p$ is the
$\displaystyle L^p$-norm on $\displaystyle L^p(\Omega)$.
We will sometime use the notation $\|f\|_{p,\Omega}$ and
$\|f\|_{k,p,\Omega}$ when you
need to clearly identify the domain to be considered for the norm.

Note that
$\displaystyle \|f\|_\infty = \esssup_{\VEC{x} \in \Omega} |f(\VEC{x})|$.
However, to simplify the notation, we will only write
$\displaystyle \|f\|_\infty = \sup_{\VEC{x} \in \Omega} |f(\VEC{x})|$
but the reader must understand that the essential supremum is used
when $f$ is only defined almost everywhere.

\begin{theorem}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$.  For $k\in \NN$ and
$p$ a positive integer or $\infty$, the space
$\displaystyle W^{k,p}(\Omega)$ equipped with
the norm (\ref{sob_norm_wkp}) is a Banach space.  If $p \neq \infty$,
$\displaystyle W^{k,p}(\Omega)$ is also separable.
\end{theorem}

\begin{proof}
Let $\displaystyle \left\{ \alpha_1, \alpha_2, \ldots, \alpha_N \right\}$,
where $\displaystyle N = \sum_{|\alpha|\leq k} 1$, be an ordering of
the multi-indices $\displaystyle \alpha \in \NN^n$ such that
$|\alpha|\leq k$.  We assume that $\alpha_1 = (0, 0, \ldots, 0)$.
Consider the mapping
\begin{align*}
T: W^{k,p}(\Omega) & \rightarrow (L^p(\Omega))^N \\
f &\mapsto \left( \diff^{\alpha_1} f , \diff^{\alpha_2} f, \ldots,
\diff^{\alpha_N} f \right)
\end{align*}
This is an isometry if the norm on $\displaystyle (L^p(\Omega))^N$ is
the norm
\[
\| \VEC{f} \|_{p} =
\begin{cases}
\displaystyle \left( \sum_{j=0}^N \| f_{\alpha_j} \|_p^p \right)^{1/p} &
\quad \text{if} \ 0 < p < \infty \\
\displaystyle \max_{1\leq j \leq N} \| f_{\alpha_j} \|_\infty &
\quad \text{if} \ p = \infty
\end{cases}
\]
for $\displaystyle \VEC{f} \in (L^p(\Omega))^N$.

\stage{i}  We do the case $1<p<\infty$ and leave the cases $p =1$ and
$p=\infty$ to the reader.

We prove that $\displaystyle W^{k,p}(\Omega)$ is complete
by proving that $T$ is a closed mapping. Suppose that
$\displaystyle \left\{f_j \right\}_{j=1}^\infty \subset W^{k,p}(\Omega)$
is such that $\displaystyle \left\{T(f_j) \right\}_{j=1}^\infty$
converges to $\VEC{g}$ in $\displaystyle (L^p(\Omega))^N$.  Then
$\displaystyle \left\{ \diff^{\alpha_i} f_j \right\}_{j=1}^\infty$
converge to $g_{\alpha_i}$ in $\displaystyle L^p(\Omega)$ for
$1\leq i \leq N$.  In particular, for $\alpha_1$, we have that
$\displaystyle \left\{ f_j \right\}_{j=1}^\infty$
converges to $g \equiv g_{\alpha_1}$ in $\displaystyle L^p(\Omega)$.

Since $\displaystyle L^p$ convergence implies convergence in the
sense of distributions, we have that
$\displaystyle g_{\alpha_i} = \diff^{\alpha_i} g$ almost everywhere for all
$0\leq i \leq N$.  To prove this statement, we use the definition of
the derivative in the sense of distributions to write
\[
\int_\Omega \diff^{\alpha_i} f_j(\VEC{x}) \phi(\VEC{x}) \dx{\VEC{x}} =
(-1)^{|\alpha_i|} \int_\Omega f_j(\VEC{x}) \diff^{\alpha_i} \phi(\VEC{x})
\dx{\VEC{x}}
\]
for all $\phi \in \DD(\Omega)$.  As $j\rightarrow \infty$, the
integral on the left converges to
$\displaystyle \int_\Omega g_{\alpha_i}(\VEC{x}) \phi(\VEC{x}) \dx{\VEC{x}}$
for all $\phi\in \DD(\Omega)$ because
\begin{align*}
&\left| \int_\Omega \diff^{\alpha_i} f_j(\VEC{x}) \phi(\VEC{x}) \dx{\VEC{x}}
- \int_\Omega g_{\alpha_i}(\VEC{x}) \phi(\VEC{x}) \dx{\VEC{x}} \right|
\leq \int_\Omega \left| \diff^{\alpha_i} f_j(\VEC{x}) - g_{\alpha_i}(\VEC{x})
\right| \, \left| \phi(\VEC{x}) \right| \dx{\VEC{x}} \\
&\qquad \leq
\left(\int_\Omega \left| \diff^{\alpha_i} f_j(\VEC{x}) - g_{\alpha_i}(\VEC{x})
\right|^p \dx{\VEC{x}} \right|^{1/p}
\left( \int_\Omega \left| \phi(\VEC{x}) \right|^q \dx{\VEC{x}} \right)^{1/q}
\to 0 \quad \text{as} \quad j \to \infty
\end{align*}
by assumption, where $1/p + 1/q = 1$.  Similarly,
the integral on the right converges to
\[
(-1)^{|\alpha_i|} \int_\Omega g(\VEC{x}) \diff^{\alpha_i} \phi(\VEC{x})
\dx{\VEC{x}} = \int_\Omega \diff^{\alpha_i} g(\VEC{x}) \phi(\VEC{x})
\dx{\VEC{x}}
\]
for all $\phi\in \DD(\Omega)$.  Hence,
\[
 \int_\Omega g_{\alpha_i}(\VEC{x}) \phi(\VEC{x}) \dx{\VEC{x}}
= \int_\Omega \diff^{\alpha_i} g(\VEC{x}) \phi(\VEC{x})
\dx{\VEC{x}}
\]
for all $\phi\in \DD(\Omega)$ and all $i$.  Thus,
$\displaystyle g_{\alpha_i} = \diff^{\alpha_i} g$ almost everywhere for all $i$.

\stage{ii} To prove that $\displaystyle W^{k,p}(\Omega)$ is separable for
$0\leq p < \infty$, it is enough to note that
$\displaystyle T : W^{k,p}(\Omega) \rightarrow T\left(W^{k,p}(\Omega)\right)$ is
an isometry and that $\displaystyle T\left(W^{k,p}(\Omega)\right)$ is
a subset of the separable space $\displaystyle (L^p(\Omega))^N$.
\end{proof}

The must important Sobolev spaces (for the study of partial
differential equations) are those with $p=2$.  There is a nice
equivalent way to define the spaces
$\displaystyle W^{k,2}(\RR^n)$ for $0\leq k \leq \infty$.

\begin{theorem} \label{sob_wk2_wk2}
For $k\in \NN$, $\displaystyle f \in W^{k,2}(\RR^n)$ if and only if
$\displaystyle \hat{f} \in L^2(\RR^n,\rho)$, where the measure $\rho$
is defined by
$\displaystyle \dx{\rho(\VEC{x})} = (1+\|\VEC{x}\|_2^2)^k\dx{\VEC{x}}$.
Moreover, the norm $\|\cdot \|_{k,2}$ defined in (\ref{sob_norm_wkp})
is equivalent to the norm
\begin{equation} \label{sob_norm_wkmu}
\|f \|_{k,\rho} = \left( \int_{\RR^n} \left| \hat{f}(\VEC{y})\right|^2
\dx{\rho(\VEC{y})} \right)^{1/2} \quad , \quad f \in W^{k,2}(\RR^n) \ .
\end{equation}
\end{theorem}

\begin{proof}
\stage{i} We first find two positive constants,
$C_1$ and $C_2$, such that
\[
C_1 \left( 1 + \|\VEC{y}\|_2^2\right)^k \leq
\sum_{|\alpha|\leq k} \left|\VEC{y}^{2\alpha}\right| \leq
C_2 \left( 1 + \|\VEC{y}\|_2^2\right)^k
\]
for $\displaystyle \VEC{y} \in \RR^n$.

\stage{i.a} Since
$\displaystyle \left| \VEC{y}^\alpha \right| \leq 1$
for $\|\VEC{y}\|_2 \leq 1$, and
$\displaystyle \left| \VEC{y}^\alpha \right| \leq
\|\VEC{y}\|_2^{|\alpha|} \leq \|\VEC{y}\|_2^{k}$
for $\|\VEC{y}\|_2 \geq 1$ and $|\alpha|\leq k$, we get
\[
\sum_{|\alpha|\leq k} \left|\VEC{y}^{2\alpha}\right| 
= \sum_{|\alpha|\leq k} \left|\VEC{y}^{\alpha}\right|^2 \leq
C_2 \max\left\{ 1, \|\VEC{y}\|_2^{2k} \right\}
\leq C_2 \left( 1 + \|\VEC{y}\|_2^2\right)^k
\]
for $\displaystyle \VEC{y} \in \RR^n$, where
$\displaystyle C_2 = \sum_{|\alpha|\leq k} 1$.

\stage{i.b} Let
\begin{equation} \label{sob_equi_Hk}
C_1' = \min_{\|\VEC{y}\|=1} \sum_{|\alpha|= k} \left|\VEC{y}^{2\alpha}\right| \ .
\end{equation}
Since $\displaystyle \sum_{|\alpha|= k} \left|\VEC{y}^{2\alpha}\right|$ is 
continuous on the compact set $\{\VEC{y} : \|\VEC{y}\|_2=1\}$, the
minimum is reached at a point $\VEC{w} \neq \VEC{0}$ in $\RR^n$.
If $w_j \neq 0$, then $\displaystyle \left| w_j^{2k}\right| >0$ and thus
$\displaystyle C_1' = \sum_{|\alpha|= k} \left|\VEC{w}^{2\alpha}\right| >0$.
Given $\VEC{y} \neq \VEC{0}$, let $\VEC{z} = \|\VEC{y}\|_2^{-1} \VEC{y}$.
Since $\|\VEC{z}\|_2 = 1$, we get from
$\displaystyle \sum_{|\alpha|= k} \left|\VEC{z}^{2\alpha}\right| \geq
C_1' >0$ that
$\displaystyle \sum_{|\alpha|= k} \left|\VEC{y}^{2\alpha}\right| \geq C_1'
\|\VEC{y}\|_2^{2k}$
because $\displaystyle \sum_{|\alpha|= k} \left|\VEC{z}^{2\alpha}\right|$
is an homogeneous function of degree $2k$.  We have that
\begin{align*}
\left(1+\|\VEC{y}\|_2^2\right)^k &\leq
2^k \max\left\{1, \|\VEC{y}\|_2^{2k}\right\}
\leq 2^k \left( 1+ \|\VEC{y}\|_2^{2k}\right)
\leq 2^k \left( 1 + \frac{1}{C_1' } \sum_{|\alpha|= k}
\left|\VEC{y}^{2\alpha}\right| \right) \\
&\leq 2^k C_1'' \left( 1 + \sum_{|\alpha|= k}
\left|\VEC{y}^{2\alpha}\right| \right)
\leq 2^k C_1'' \sum_{|\alpha|\leq k} \left|\VEC{y}^{2\alpha}\right|
\end{align*}
for $\displaystyle \VEC{y} \in \RR^n$, where
$\displaystyle C_1'' = \max \{ 1 , 1/C_1'\}$.
Finally, this is
\[
C_1 \left(1+\|\VEC{y}\|^2\right)^k
\leq \sum_{|\alpha|\leq k} \left|\VEC{y}^{2\alpha}\right|
\]
for $\displaystyle \VEC{y} \in \RR^n$, where
$\displaystyle C_1 = 1/(2^k C_1'')$.

\stage{ii}  We have that
\begin{align*}
\|f\|_{k,\rho} < \infty
&\Leftrightarrow \int_{\RR^n} \left| \hat{f}(\VEC{y})\right|^2
\big( 1 + \|\VEC{y}\|_2^2\big)^k \dx{\VEC{y}} < \infty
\Leftrightarrow \int_{\RR^n} \left| \VEC{y}^\alpha \hat{f}(\VEC{y}) \right|^2
< \infty \ \text{for all} \ |\alpha| \leq k \\
&\Leftrightarrow \VEC{y}^\alpha \hat{f}(\VEC{y}) \in L^2(\RR^n)
 \ \text{for all} \ |\alpha| \leq k  
\Leftrightarrow \diff^\alpha f \in L^2(\RR^2) 
  \ \text{for all} \ |\alpha| \leq k \\
&\Leftrightarrow \|f\|_{k,2} < \infty \ ,
\end{align*}
where the second to last equivalence is due to 
Plancherel theorem, Theorem~\ref{distr_plancherel}.  To be
more precise, we saw in Proposition~\ref{distr_frr_tempD} that 
$\displaystyle (\diff^\alpha u)^\wedge = (i \VEC{y})^\alpha \hat{u}$ in the
sense of distributions for all $\displaystyle u \in \SS'(\RR^n)$ and
multi-index $\alpha$.
Therefore, $\displaystyle (\diff^\alpha u)^\wedge \in L^2(\RR^n)$ if and only if
$\displaystyle (i \VEC{y})^\alpha \hat{u} \in L^2(\RR^n)$.  It follows
from Plancherel theorem that there exists $\displaystyle g \in L^2(\RR^n)$
such that $\displaystyle (\diff^\alpha f)^\wedge = \hat{g}$ in the sense of
distributions if and only if
$\displaystyle (i \VEC{y})^\alpha \hat{f} \in L^2(\RR^n)$.
But $\displaystyle (\diff^\alpha f)^\wedge = \hat{g}$ in the sense of
distributions means that
$\displaystyle (\diff^\alpha f)(\hat{\phi}) = g(\hat{\phi})$
for all $\phi \in \SS(\RR^n)$.  From
Proposition~\ref{distr_frr_tempT}, this means that
$\displaystyle (\diff^\alpha f)(\phi) = g(\phi)$
for all $\phi \in \SS(\RR^n)$.  Therefore,
$\displaystyle \diff^\alpha f = g \in L^2(\RR^n)$ in the sense of
distributions.
Thus, the two norms describe the same space $\displaystyle W^{k,2}(\RR^n)$.

Moreover, since
$\displaystyle (\diff^\alpha f)^\wedge(\VEC{y})
=(i\VEC{y})^\alpha \hat{f}(\VEC{y})$
for $\displaystyle \VEC{y}\in \RR^n$ and
$\displaystyle f \in W^{k,2}(\RR^n)$, we get from Plancherel theorem that
\[
\sum_{|\alpha|\leq k} \| \diff^\alpha f \|_2^2 =
\sum_{|\alpha|\leq k} \| (\diff^\alpha f)^\wedge \|_2^2 =
\sum_{|\alpha|\leq k} \| \VEC{y}^\alpha \hat{f}(\VEC{y}) \|_2^2 =
\int_{\RR^n} \left( \sum_{|\alpha|\leq k}
\left|\VEC{y}^{2\alpha}\right| \right)
\, \left| \hat{f}(\VEC{y}) \right|^2 \dx{\VEC{y}} \ .
\]
Thus, it follows from (i) that $\displaystyle C_1 \|f\|_{k,\rho}^2
\leq \|f\|_{k,2}^2 \leq C_2 \|f\|_{k,\rho}^2$.
\end{proof}

Hence, we can expand the definition of
$\displaystyle W^{k,2}(\RR^n)$ from $k \in\NN$ to $k\in \RR$ as follows.

\begin{defn} \label{sob_2nd_wk2}
For $s\in \RR$, the
{\bfseries Sobolev space}\index{Sobolev Space!$W^{s,2}(\RR^n)$}
$\displaystyle W^{s,2}(\RR^n)$ is the space defined by
\[
W^{s,2}(\RR^n) = \left\{ f \in L^2(\RR^n) : \hat{f} \in
  L^2(\RR^n,\rho) \right\} \ ,
\]
where the measure $\rho$ is defined by
$\displaystyle \dx{\rho(\VEC{x})} = (1+\|\VEC{x}\|^2)^s\dx{\VEC{x}}$.
\end{defn}

If follows from Theorem~\ref{sob_wk2_wk2} that the space
$\displaystyle W^{k,2}(\RR^n)$ for $k \in \NN$ is an Hilbert space
equipped with the scalar product
\begin{equation} \label{sob_sp_wkmu}
\ps{f}{g}_{k,\rho} = \int_{\RR^n} \hat{f}(\VEC{y})\, \overline{\hat{g}(\VEC{y})}
\dx{\rho(\VEC{y})}
\end{equation}
for $\displaystyle f,g \in W^{k,2}(\RR^n)$.

A direct consequence of Definition~\ref{sob_2nd_wk2} is the following
proposition.

\begin{prop} \label{sob_DinDm}
For $s\in \RR$, $\displaystyle f\in W^{s,2}(\RR^n)$ if and only if
$\displaystyle \diff^\alpha f \in W^{s-|\alpha|,2}(\RR^n)$ for all
multi-indices $\alpha$ such that $|\alpha|\leq s$.  Moreover,
$\displaystyle \diff^\alpha$ is a bounded operator
from $\displaystyle W^{s,2}(\RR^n)$ to
$\displaystyle W^{s-|\alpha|,2}(\RR^n)$ for $|\alpha|\leq s$.  To be
more precise
$\displaystyle \|\diff^\alpha f\|_{s-|\alpha|,\rho}
\leq \|f\|_{s,\rho}$ for $\displaystyle f\in W^{s,2}(\RR^n)$.
\end{prop}

\begin{proof}
Note that the result is trivial if $s$ is a non-negative integer
because it is obvious that
$\displaystyle \|\diff^\alpha f\|_{s-|\alpha|,2} \leq
\|\diff^\alpha f\|_{s,2}$ for all $\displaystyle f \in W^{s,2}(\RR^n)$
by definition of the norm $\|\cdot\|_{s,2}$.

For $\displaystyle f \in W^{s,2}(\RR^n)$ and a multi-index $\alpha$
such that $|\alpha| \leq s$, we have that
\begin{align}
\|\diff^\alpha f\|_{s-|\alpha|,\rho}^2 &= \int_{\RR^n}
\left| (\diff^\alpha f)^\wedge(\VEC{y}) \right|^2
(1+\|\VEC{y}\|^2)^{s-|\alpha|} \dx{\VEC{y}}
= \int_{\RR^n}
\left|\hat{f}(\VEC{y}) \right|^2 \, \left| \VEC{y}^\alpha \right|^2
(1+\|\VEC{y}\|^2)^{s-|\alpha|} \dx{\VEC{y}} \nonumber \\
&\leq \int_{\RR^n} \left|\hat{f}(\VEC{y}) \right|^2 \,
\left( 1 + \|\VEC{y}\|^2\right)^s \dx{\VEC{y}} = \|f\|_{s,\rho}^2
< \infty \ . \label{sob_DinDmEQ}
\end{align}

It follows from (\ref{sob_DinDmEQ}) that
$\displaystyle f\in W^{s,2}(\RR^n)$ implies
$\displaystyle \diff^\alpha f \in W^{s-|\alpha|,2}(\RR^n)$
for all multi-indices $\alpha$ such that $|\alpha|\leq s$.

Moreover, (\ref{sob_DinDmEQ}) proves that
$\displaystyle \diff^\alpha$ is a bounded operator
of norm less than $1$ from $\displaystyle W^{s,2}(\RR^n)$ to
$\displaystyle W^{s-|\alpha|,2}(\RR^n)$ for $|\alpha|\leq s$.

Conversely, if $\displaystyle \diff^\alpha f \in W^{s-|\alpha|,2}(\RR^n)$ for
all multi-indices $\alpha$ such that $|\alpha|\leq s$, then
$\displaystyle f\in W^{s,2}(\RR^n)$ if we take $\alpha = (0,0,\ldots,0)$.
\end{proof}

\subsection{Dense Subsets}

\begin{defn}
An open set $\displaystyle \Omega \subset \RR^n$ satisfies
the {\bfseries segment property}\index{Segment Property} if, for each
$\VEC{x} \in \partial \Omega$,
there exists a bounded open neighbourhood
$\displaystyle U_{\VEC{x}} \subset \RR^n$ of $\VEC{x}$ and an
element $\displaystyle \VEC{y} \in \RR^n$ such that
$\VEC{z} + \delta \VEC{y} \in \Omega$ for $0<\delta < 1$ if
$\VEC{z} \in \overline{\Omega} \cap U_{\VEC{x}}$ (Figure~\ref{SEGMPROP}).
\end{defn}

\pdfF{sobolev/segmprop}{Graphical representation of the segment
property}{Graphical representation of the segment property for an
arbitrary set $\Omega$.  The region in grey represents the set
$\displaystyle \bigcup_{0\leq \delta \leq 1} \big(\overline{\Omega}\cap U +
\delta \VEC{y} \big)$.}{SEGMPROP}

If $\displaystyle \Omega \subset \RR^n$ is an open set with a bounded
boundary of class $\displaystyle C^2$, then $\Omega$ has the segment
property.  Open sets with only continuous boundaries may still have
the segment property if the ``corners'' are not too numerous.  A
simple example is a square in $\displaystyle \RR^2$.

We need a few lemmas before being in a position to prove the mains
results of this section.

\begin{lemma} \label{sob_denselem1}
Suppose that $\Omega_1 \subset \Omega_2$ are two open subsets of
$\displaystyle \RR^n$, $k\in \NN$ and $p$ is a positive integer.
Moreover, suppose that $\displaystyle f \in W^{k,p}(\Omega_1)$ has a
compact support in $\Omega_1$.
Let $\underline{f}:\Omega_2 \to \RR$ be the function defined by
\[
\underline{f}(\VEC{x}) =
\begin{cases}
f(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \Omega_1 \\
0 & \quad \text{if} \ \VEC{x} \in \Omega_2 \setminus \Omega_1
\end{cases}
\]
Then $\displaystyle \underline{f} \in W^{k,p}(\Omega_2)$.  In particular,
$\displaystyle \diff^\alpha \underline{f} = \underline{\diff^\alpha f}$
almost everywhere and in the sense of distributions on $\Omega_2$
for $|\alpha|\leq k$.
\end{lemma}

\begin{proof}
Since $K = \supp f$ is a compact subset of the open set $\Omega_1$,
there exists an open set $U$ such that
$K \subset U \subset \overline{U} \subset \Omega_1$.
Choose $\psi \in \DD(\Omega_2)$ such that
$\psi(\VEC{x}) = 1$ for $\VEC{x} \in K$ and $\psi(\VEC{x}) = 0$ for
$\VEC{x} \in \Omega_2 \setminus U$
\footnote{
To obtain such a function $\psi$, let $\displaystyle \{V_j\}_{j=1}^J$
be a finite open cover of $\supp f$ with $V_j \subset \Omega_1$.  Such a
finite open cover exists because $f$ has a compact support in
$\Omega_1$.  Select a partition of unity
$\displaystyle \{\psi_j\}_{j=1}^J$ for $\supp f$
subordinate to $\displaystyle \{V_j\}_{j=1}^J$ and set
$\displaystyle \psi = \sum_{j=1}^J \psi_j$. \label{FOOTNOTE1}}.

Since
\[
\int_{\Omega_2} \left|\underline{\diff^\alpha f}(\VEC{x})\right|^p
\dx{\VEC{x}} = 
\int_{\Omega_1} \left| \diff^\alpha f(\VEC{x}) \right|^p \dx{\VEC{x}} < \infty
\]
for $|\alpha|\leq k$, we get that
$\displaystyle \underline{\diff^\alpha f}$ defines a
distribution in $\displaystyle L^p(\Omega_2)$ for $|\alpha|\leq k$.
Hence,
\begin{align*}
(\diff^\alpha \underline{f})(\phi)
&= (-1)^{|\alpha|} \int_{\Omega_2} \underline{f}(\VEC{x})
\diff^\alpha \phi(\VEC{x})\dx{\VEC{x}}
= (-1)^{|\alpha|} \int_{\Omega_1} f(\VEC{x})
\diff^\alpha (\psi \phi)(\VEC{x})\dx{\VEC{x}} \\
&= \int_{\Omega_1} \diff^\alpha f(\VEC{x}) (\psi \phi)(\VEC{x})\dx{\VEC{x}}
= \int_{\Omega_1} \diff^\alpha f(\VEC{x}) \phi(\VEC{x})\dx{\VEC{x}} \\
&= \int_{\Omega_2} \underline{\diff^\alpha f}(\VEC{x}) \phi(\VEC{x})\dx{\VEC{x}}
= (\underline{\diff^\alpha f}) (\phi)
\end{align*}
for $\phi \in \DD(\Omega_2)$ and $|\alpha|\leq k$.  The second and fourth
equality are a consequence of $\phi \psi = \phi$ on $K$.  The third
equality comes from $\displaystyle f \in W^{k,p}(\Omega_1)$ and
$\psi \phi \in \DD(\Omega_1)$.
Thus $\displaystyle \diff^\alpha \underline{f} = \underline{\diff^\alpha f}$
almost everywhere in $\RR^n$.
\end{proof}

It is also interesting to note that, as a distribution,
$\displaystyle \diff^\alpha \underline{f}\,\big|_{\Omega_1} = \diff^\alpha f$.

\begin{lemma} \label{sob_denselem4}
Suppose that $\Omega$ is an open subset of $\displaystyle \RR^n$,
$k\in \NN$ and $p$ is a positive integer.  Moreover, suppose that
$\displaystyle f \in W^{k,p}(\Omega)$ 
is such that $S = \supp f \cap \partial \Omega \neq \emptyset$ and
$S \subsetneqq \partial \Omega$ \footnotemark.
Let $\displaystyle \underline{f}:\RR^n \to \RR$ be the function defined by
\[
\underline{f}(\VEC{x}) =
\begin{cases}
f(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \Omega \\
0 & \quad \text{if} \ \VEC{x} \in \RR^n \setminus \Omega
\end{cases}
\]
Then $\displaystyle \underline{f} \in W^{k,p}(V)$, where
$\displaystyle V = \RR^n \setminus S$.
In particular,
$\displaystyle \diff^\alpha \underline{f} = \underline{\diff^\alpha f}$
almost everywhere and in the sense of distributions on $V$
for $|\alpha|\leq k$.
\end{lemma}

\footnotetext{The lemma is obvious if
$\supp f \cap \partial \Omega = \partial \Omega$.}

\begin{proof}
Since
\[
\int_V \left|\underline{\diff^\alpha f}(\VEC{x})\right|^p \dx{\VEC{x}} = 
\int_{\Omega} \left| \diff^\alpha f(\VEC{x}) \right|^p \dx{\VEC{x}} < \infty
\]
for $|\alpha|\leq k$, we get that
$\displaystyle \underline{\diff^\alpha f}$ defines a
distribution included in $\displaystyle L^p(V)$ for $|\alpha|\leq k$.

Given $\phi \in \DD(V)$ and $|\alpha|\leq k$, let
$K = \supp f\, \cap\, \supp\, \phi$.  Since $\supp\, \phi \subset V$, so
$\supp\, \phi\, \cap\, S = \emptyset$, and
$\supp f \subset \overline{\Omega}$ with  
$\supp f \cap \partial \Omega = S$, we get that $K \subset \Omega$.
Since $K$ is a closed subset of the compact set $\supp\, \phi$, we have
that $K$ is a compact subset of $\Omega$.  Thus, there exists an open
set $U$ such that $K \subset U \subset \overline{U} \subset \Omega$.
Choose a function $\displaystyle \psi \in \DD(\RR^n)$ such that
$\psi(\VEC{x}) = 1$ for $\VEC{x} \in K$ and
$\psi(\VEC{x}) = 0$ for
$\displaystyle \VEC{x} \in \RR^n \setminus U$ \footnote{See
footnote on page~\pageref{FOOTNOTE1}}.

We have that
\begin{align*}
(\diff^\alpha \underline{f})(\phi)
&= (-1)^{|\alpha|} \int_V \underline{f}(\VEC{x})
\diff^\alpha \phi(\VEC{x})\dx{\VEC{x}}
= (-1)^{|\alpha|} \int_{\Omega} f(\VEC{x})
\diff^\alpha (\psi \phi)(\VEC{x})\dx{\VEC{x}} \\
&= \int_{\Omega} \diff^\alpha f(\VEC{x}) (\psi \phi)(\VEC{x})\dx{\VEC{x}}
= \int_{\Omega} \diff^\alpha f(\VEC{x}) \phi(\VEC{x})\dx{\VEC{x}} \\
&= \int_V \underline{\diff^\alpha f}(\VEC{x}) \phi(\VEC{x})\dx{\VEC{x}}
= (\underline{\diff^\alpha f}) (\phi) \ .
\end{align*}
The second and fourth equality are a
consequence of $\phi \psi = \phi$ in $K$.  The third equality comes
from $\displaystyle f \in W^{k,p}(\Omega)$ and $\psi \phi \in \DD(\Omega)$.
Since $\phi \in \DD(V)$ and $|\alpha|\leq k$ are arbitrary,
we get $\displaystyle \diff^\alpha \underline{f} = \underline{\diff^\alpha f}$
almost everywhere in $V$.
\end{proof}

We need a special version of Proposition~\ref{distr_limit_convol}.

\begin{lemma} \label{sob_denselem2}
Suppose that $\Omega$ is an open subset of $\displaystyle \RR^n$,
$U$ is an open subset such that $\overline{U} \subset \Omega$ is
compact, $k\in \NN$, $p$ is a positive integer, and
$\displaystyle f \in W^{k,p}(\Omega)$.

Given $\displaystyle \psi \in \DD(\RR^n)$ such that
$\psi(\VEC{x}) = 0$ for $\|\VEC{x}\|>1$ and
$\displaystyle \int_{\RR^n} \psi(\VEC{x})\dx{\VEC{x}} = 1$ \footnotemark, let
$\displaystyle \psi_\epsilon(\VEC{x}) = \epsilon^{-n} \psi(\epsilon^{-1}\VEC{x})$
for $\displaystyle \VEC{x} \in \RR^n$ and $\epsilon > 0$.
Let $\displaystyle \underline{f}:\RR^n \to \RR$ be the function defined by
\[
\underline{f}(\VEC{x}) =
\begin{cases}
f(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \Omega \\
0 & \quad \text{if} \ \VEC{x} \in \RR^n \setminus \Omega
\end{cases}
\]
Then, $\displaystyle \underline{f} \ast \psi_{\epsilon} \in C^\infty(\RR^n)$
for all $\epsilon$
and $\displaystyle \left(\underline{f} \ast \psi_{\epsilon}\right)\big|_U \in
W^{k,p}(U)$ for $\epsilon < \dist{\partial \Omega}{U}$.  Moreover,
$\| \left( \underline{f} \ast \psi_{\epsilon} \right)
- f\|_{k,p,U} \rightarrow 0$ as $\epsilon \rightarrow 0^+$.

If $f$ has a compact support, then
$\displaystyle \underline{f} \ast \psi_{\epsilon} \in \DD(\RR^n)$ for
all $\epsilon$.  In particular, $\displaystyle \supp (\underline{f} \ast
\psi_{\epsilon}) \subset \supp f + \overline{B_\epsilon}(\VEC{0})
\subset \Omega$ for $\epsilon < \dist{\partial U}{\supp f}$.
\end{lemma}

\footnotetext{
One such
function is
\[
\psi(\VEC{x}) =
\begin{cases}
\displaystyle ke^{-1/(1-\|\VEC{x}\|^2)} & \quad \text{for} \quad \|\VEC{x}\|<1 \\
0 & \quad  \text{for} \quad \|\VEC{x}\|\geq 1
\end{cases}
\]
where $\displaystyle k^{-1} = \int_{\|\VEC{x}\|<1} e^{-1/(1-\|\VEC{x}\|^2)}
\dx{\VEC{x}}$.}

\begin{proof}
We have that $\underline{f}$ is a distribution on $\displaystyle \RR^n$ because
$\displaystyle \underline{f} \in L^p(\RR^n)$.
It follows from Proposition~\ref{distr_smooth_convol} that 
$\displaystyle \underline{f} \ast \psi_{\epsilon} \in C^\infty(\RR^n)$.

Given $|\alpha|\leq k$, since
$\displaystyle \underline{\diff^\alpha f} \in L^p(\RR^n)$ because
$\displaystyle \supp\, \underline{\diff^\alpha f} \subset
\supp f \subset \Omega$ and
$\displaystyle \diff^\alpha f \in L^p(\Omega)$, we get from
Theorem~\ref{distr_sp_young} that
$\displaystyle \underline{\diff^\alpha f} \ast \psi_\epsilon \in L^p(\RR^n)$.

For $\epsilon < \dist{\partial \Omega}{U}$, $\phi \in \DD(U)$ and
$|\alpha|\leq k$, we have that
\begin{align*}
&\diff^\alpha(\underline{f} \ast \psi_\epsilon)(\phi)
= (-1)^{|\alpha|} \int_{\RR^n}
(\underline{f} \ast \psi_\epsilon)\, \diff^\alpha \phi \dx{\VEC{x}}  \\
&\quad = (-1)^{|\alpha|} \int_{\RR^n}
\left( \int_{\RR^n} \underline{f}(\VEC{y}-\VEC{x})\,
\psi_\epsilon (\VEC{y}) \dx{\VEC{y}} \right) \diff^\alpha \phi(\VEC{x})
\dx{\VEC{x}} \\
&\quad = (-1)^{|\alpha|} \int_{\RR^n} \left( \int_{\RR^n}
\underline{f}(\VEC{y}-\VEC{x})\, \diff^\alpha \phi(\VEC{x}) \dx{\VEC{x}}
\right) \psi_\epsilon (\VEC{y}) \dx{\VEC{y}} \\
&\quad = (-1)^{|\alpha|} \int_{B_\epsilon(\VEC{0})}
\left( \int_{U} f(\VEC{y}-\VEC{x})\,
\diff^\alpha \phi(\VEC{x}) \dx{\VEC{x}}
\right) \psi_\epsilon (\VEC{y}) \dx{\VEC{y}} \\
&\quad = \int_{B_\epsilon(\VEC{0})}
\left( \int_{U} \diff^\alpha f(\VEC{y}-\VEC{x})\, \phi(\VEC{x}) \dx{\VEC{x}}
\right) \psi_\epsilon (\VEC{y}) \dx{\VEC{y}}
= \int_U \left( \int_{B_\epsilon(\VEC{0})} \diff^\alpha f (\VEC{y}-\VEC{x})\,
\psi_\epsilon (\VEC{y}) \dx{\VEC{y}} \right) \phi(\VEC{x}) \dx{\VEC{x}} \\
&\quad = \int_U \left( \int_{\RR^n} \underline{\diff^\alpha f}
(\VEC{y}-\VEC{x})\,
\psi_\epsilon (\VEC{y}) \dx{\VEC{y}} \right) \phi(\VEC{x}) \dx{\VEC{x}}
= \int_{U} \left( \underline{\diff^\alpha f} \ast
\psi_\epsilon \right) \phi \dx{\VEC{x}} \ ,
\end{align*}
where the fourth and seventh equality are a consequence of
$\displaystyle \underline{f}(\VEC{y} - \VEC{x}) = f(\VEC{y}-\VEC{x})$
and\\
$\displaystyle \underline{\diff^\alpha f}(\VEC{y} - \VEC{x})
= \diff^\alpha f(\VEC{y}-\VEC{x})$ respectively 
for $\VEC{x} \in U$ and $\VEC{y} \in B_\epsilon(\VEC{0})$ because
$U + B_\epsilon(\VEC{0}) \subset \Omega$ for our choice of $\epsilon$.
We have use integration by parts for the fifth equality with
$\supp \phi \subset U$.

Since the previous relation is true for all $\phi \in \DD(U)$, we get that
$\displaystyle \diff^\alpha(\underline{f} \ast \psi_\epsilon)
= \underline{\diff^\alpha f} \ast \psi_\epsilon$ almost everywhere in
$U$.  It follows that
$\displaystyle \diff^\alpha(\underline{f} \ast \psi_\epsilon)\big|_U \in L^p(U)$.
Since this is true for all $|\alpha|\leq k$, we get that
$\displaystyle \diff^\alpha(\underline{f} \ast \psi_\epsilon)\big|_U
\in W^{p,k}(U)$

We get from Proposition~\ref{distr_limit_convol} that
\[
\left\| \diff^\alpha(\underline{f} \ast \psi_\epsilon)
- \diff^\alpha f \right\|_{p,U}
= \left\| \underline{\diff^\alpha f} \ast \psi_\epsilon
- \diff^\alpha f \right\|_{p,U}
\leq \left\| \underline{\diff^\alpha f} \ast \psi_\epsilon -
\underline{\diff^\alpha f} \right\|_{p,\RR^n} \to 0 \quad \text{as} \quad
\epsilon \to 0^+ \ .
\]
Since this is true for all $|\alpha| \leq k$, we get that
$\displaystyle \left\| \underline{f} \ast \psi_\epsilon - f \right\|_{p,k,U}$
as $\epsilon \to 0^+$.

If $f$ has a compact support, then
$\displaystyle \underline{f} \ast \psi_\epsilon$ has a compact support
because
$\displaystyle \supp (\underline{f} \ast \psi_\epsilon)
\subset \supp \underline{f} + \supp \psi_\epsilon
\subset \supp f + \overline{B_\epsilon(\VEC{0})}$.
\end{proof}

\begin{lemma} \label{sob_denselem3}
Suppose that $\Omega$ is an open subset of $\displaystyle \RR^n$,
$U$ is a bounded open subset of $\Omega$,
$k\in \NN$, $p$ is a positive integer, and
$\displaystyle f \in W^{k,p}(\Omega)$.
Given $\displaystyle \VEC{y} \in \RR^n$, suppose that there exists
$d>0$ such that $\delta \VEC{y} + U \subset \Omega$ for
$0 \leq \delta < d$, and
define $f_\delta:U \to \RR$ by $f_\delta(\VEC{x}) = f(\VEC{x} + \delta \VEC{y})$
for $\VEC{x} \in U$ and $0 \leq \delta < d$.  Then
$\displaystyle f_\delta \in W^{k,p}(U)$ for $0 \leq \delta < d$ and
$f_\delta \to f_0 = f$ in $\displaystyle W^{k,p}(U)$ as $\delta \to 0^+$.
\end{lemma}

\begin{proof}
\stage{i}
We first note that if $\displaystyle g \in L^p(\Omega)$, then
$\displaystyle g_\delta \in L^p(U)$ for $0 \leq \delta <d$ where
$g_\delta:U \to \RR$ is defined by
$g_\delta(\VEC{x}) = f(\VEC{x} + \delta \VEC{y})$
for $\VEC{x} \in U$.  This follows from
\[
\int_U |g_\delta|^p \dx{\VEC{x}}
= \int_U |g(\VEC{x} + \delta\VEC{y})|^p \dx{\VEC{x}}
\leq \int_{\Omega} |g|^p \dx{\VEC{x}} < +\infty
\]
because $\delta \VEC{y} + U \subset \Omega$.

Given $\phi \in \DD(U)$ and $|\alpha| \leq k$, we can use integration by
parts to get
\begin{align*}
\diff^\alpha f_\delta (\phi)
&= (-1)^{|\alpha|} \int_U f(\VEC{x}+\delta\VEC{y})
\diff^\alpha \phi(\VEC{x}) \dx{\VEC{x}}
= \int_U \diff^\alpha f(\VEC{x}+\delta\VEC{y}) \phi(\VEC{x}) \dx{\VEC{x}} \\
&= \int_U (\diff^\alpha f)_\delta(\VEC{x}) \phi(\VEC{x}) \dx{\VEC{x}}
\end{align*}
because $\VEC{x}+\delta\VEC{y} \in \Omega$ for all $\VEC{x} \in U$
and $\supp \phi \subset U$.  Thus, 
$\displaystyle \diff^\alpha f_\delta = (\diff^\alpha f)_\delta \in L^p(U)$
\footnote{As it is so for a sufficiently differentiable function $f$.}
according to the remark at the beginning of the proof with
$\displaystyle g = \diff^\alpha f$.  Since this is true for all
multi-indices $\alpha$ such that $|\alpha|\leq k$, we get that
$\displaystyle f_\delta \in W^{k,p}(U)$.

\stage{ii}
We fix the multi-index $\alpha$ such that $|\alpha|\leq k$.
Given $\epsilon >0$, since $\DD(\Omega)$ is dense in
$\displaystyle L^p(\Omega)$, there exists $\phi \in \DD(\Omega)$
such that $\displaystyle \|\diff^\alpha f - \phi\|_{p,\Omega} < \epsilon/3$.
We then have that
$\displaystyle \|\diff^\alpha f - \phi\|_{p,U} \leq
\|\diff^\alpha f - \phi\|_{p,\Omega} < \epsilon/3$
and
$\displaystyle \|\diff^\alpha f_\delta - \phi_\delta \|_{p,U}
= \| (\diff^\alpha f)_\delta - \phi_\delta \|_{p,U}
\leq \|\diff^\alpha f - \phi\|_{p,\Omega} < \epsilon/3$
for all $0\leq \delta < d$
because $\VEC{x}+\delta\VEC{y} \in \Omega$ for all $\VEC{x} \in U$
when $0\leq \delta < d$.

Since $\phi$ has a compact support, it is uniformly continuous.
So, there exists $\delta_0$ such that
$\| \phi_\delta - \phi\|_{\infty,U} < \epsilon/(3Q)$
for $0 \leq \delta < \delta_0$ and
$\displaystyle Q^p = \int_U \dx{\VEC{x}}$.  This implies that
$\| \phi_\delta - \phi\|_{p,U} < \epsilon/3$ for $0\leq \delta < \delta_0$.

Hence,
\[
\|\diff^\alpha f_\delta - \diff^\alpha f \|_{p,U} \leq
\|\diff^\alpha f_\delta - \phi_\delta \|_{p,U}
+ \| \phi_\delta - \phi\|_{p,U} 
+ \| \phi - \diff^\alpha f\|_{p,U} < \epsilon
\]
for $0\leq \delta < \delta_0$.  Thus,
$\displaystyle \|\diff^\alpha f_\delta - \diff^\alpha f \|_{p,U} \to 0$ as
$\delta \to 0^+$.  Since this is true for all multi-indices $\alpha$ such
that $|\alpha|\leq k$, we get that
$\displaystyle \|\diff^\alpha f_\delta - \diff^\alpha f \|_{k,p,U} \to 0$ as
$\delta \to 0^+$.
\end{proof}

\begin{theorem} \label{DDRRnDWkp}
Suppose that $k\in \NN$ and $p$ is a positive integer.
If $\displaystyle \Omega \subset \RR^n$ satisfies the segment property, then 
$\displaystyle \DD(\RR^n)\big|_{\Omega} =
\left\{ \phi\big|_{\Omega} : \phi \in \DD(\RR^n) \right\}$
is dense in $\displaystyle W^{k,p}(\Omega)$ with respect to the norm
$\|\cdot\|_{k,p,\Omega}$.
\end{theorem}

\begin{rmk}
Since elements of $\displaystyle W^{k,p}(\RR^n)$ are equivalence class
of functions which are equal almost everywhere, the statement
$\displaystyle \DD(\RR^n) \subset W^{k,p}(\RR^n)$ has a special meaning.
When view as an element of $\displaystyle W^{k,p}(\RR^n)$, 
a function $\displaystyle \phi \in \DD(\RR^n)$ is associated to its
equivalence class in $\displaystyle W^{k,p}(\RR^n)$.  We will regularly make
this type of interpretation from now on.
\end{rmk}

\begin{proof}
\stage{i} We first shown that every member of
$\displaystyle W^{k,p}(\Omega)$ can be approximated by members of
$\displaystyle W^{k,p}(\Omega)$ with bounded support.

Choose $\displaystyle \phi\in \DD(\RR^n)$ such that
$\phi(\VEC{x}) = 1$ for $\|\VEC{x}\|_2 \leq 1$ and
$\phi(\VEC{x}) = 0$ for $\|\VEC{x}\|_2 > 2$, let $M$ be a constant such
that $\displaystyle |\diff^{\alpha}\phi(\VEC{x})| \leq M$ for all
$\displaystyle \VEC{x} \in \RR^n$ and
$|\alpha| \leq k$.

Given $\delta >0$, let $\displaystyle \phi_\delta \in \DD(\RR^n)$ be
the function defined
$\displaystyle \phi_\delta(\VEC{x}) = \phi\left(\delta \VEC{x}\right)$
for $\displaystyle \VEC{x} \in \RR^n$.  For $\delta \leq 1$, we have that
$\displaystyle |\diff^{\alpha} \phi_\delta(\VEC{x})| \leq
\delta^{|\alpha|} M \leq M$ for all
$\displaystyle \VEC{x} \in \RR^n$ and $|\alpha| \leq k$.

Given $\displaystyle f \in W^{k,p}(\Omega)$, let
$f_\delta = \phi_\delta f$ on $\Omega$.  We have that $f_\delta$ has a bounded
support; namely,
$\displaystyle \phi_\delta f \subset \Omega \cap B_{2/\delta}(\VEC{0})$.
Moreover, $\displaystyle \phi_\delta f \in W^{k,p}(\Omega)$ because
\[
\diff^{\alpha} f_\delta = \sum_{\beta\leq \alpha} \binom{\alpha}{\beta}
\diff^{\alpha-\beta} \phi_{\delta} \diff^{\beta} f \ ,
\]
where $\beta \leq \alpha$ means $\beta_j \leq \alpha_j$ for all $j$
and $\displaystyle \binom{\alpha}{\beta} = 
\prod_{j=1}^n \binom{\alpha_j}{\beta_j}$.  We are obviously talking
about derivative in the sense of distributions.
In particular, we have that
\[
\left\| \diff^{\alpha} f_\delta \right\|_p
\leq M \sum_{\beta\leq \alpha} \binom{\alpha}{\beta}
\left\| \diff^{\beta} f \right\|_p < \infty
\]
for $0 < \delta \leq 1$ and $|\alpha| \leq k$.  Moreover, it follows
from the Lebesgue Dominated Convergence Theorem that
\[
\left\| f - f_\delta \right\|_{k,p,\Omega}
\leq 2 \left(
\sum_{|\alpha|\leq k} \int_{\VEC{x} \in \Omega \setminus B_{1/\delta}(\VEC{0})}
\left| \diff^\alpha f(\VEC{x} \right|^p \dx{\VEC{x}} \right)^{1/p} \to 0 
\quad \text{as} \quad \delta \to 0^+
\]
because $\displaystyle \diff^{\alpha}f \in L^p(\Omega)$ for all
$|\alpha| \leq k$.  Hence, we have shown that every member of
$\displaystyle W^{k,p}(\Omega)$ can be approximated by members of
$\displaystyle W^{k,p}(\Omega)$ with bounded support.

\stage{ii} From now on, we assume that $\displaystyle f \in W^{k,p}(\Omega)$
has a bounded support.  Let
$\displaystyle K = \supp f \subset \overline{\Omega}$.
For each bounded open set $U_{\VEC{x}}$ provided in the definition of
segment property, choose an open set
$V_\VEC{x}$ such that $\displaystyle \overline{V_\VEC{x}} \subset U_{\VEC{x}}$.
Let
$\displaystyle Q = K \setminus \bigcup_{\VEC{x} \in \partial \Omega} V_{\VEC{x}}$.
We have that $Q \subset \Omega$ because
$\displaystyle \partial \Omega \subset \bigcup_{\VEC{x}
\in \partial \Omega} V_{\VEC{x}}$.
Hence, $Q$ is a compact subset of $\Omega$ because it is
bounded and closed.  Choose an open set $U$ such that
$Q \subset U \subset \overline{U} \subset \Omega$.
We get an open cover $\displaystyle \left\{U\right\} \cup
\big\{ \bigcup_{\VEC{x} \in \partial \Omega} V_{\VEC{x}} \big\}$ of $K$.
Being closed and bounded, $K$ is compact.  So, there exists a finite
subcover of $K$ that we denote $\displaystyle \left\{ V_i \right\}_{i=1}^I$.
At most one of the $V_i$ may have an empty intersection with $\partial \Omega$;
namely, the open set $U$ introduced before.

Let $\displaystyle \left\{ \phi_i \right\}_{i=1}^I$ be a partition
of unity of $K$ subordinate to $\displaystyle \left\{ V_i \right\}_{i=1}^I$
and let $\displaystyle f_i = \phi_i f$.  We have that
$\displaystyle f_i \in W^{k,p}(\Omega)$ with
$\supp f_i \subset V_i \cap \overline{\Omega}$.
Given $\epsilon >0$, if we can find $\displaystyle \xi_i \in \DD(\RR^n)$
such that $\displaystyle \|f_i - \xi_i\|_{k,p,\Omega} < \epsilon/I$ for all $i$,
then we will have that $\displaystyle \xi = \sum_{i=1}^I \xi_i \in \DD(\RR^n)$
and $\displaystyle \|f - \xi\|_{k,p,\Omega}
\leq \sum_{i=1}^I \|f_i - \xi_i\|_{k,p,\Omega} < \epsilon$.  Because
$\epsilon$ is arbitrary, this will prove that
$\displaystyle \DD(\RR^n)\big|_{\Omega}$ is dense in $W^{k,p}(\Omega)$.

\stage{iii}
Consider $\displaystyle \underline{f}_i : \RR^n \to \RR$ defined by
\[
\underline{f}_i(\VEC{x})
= \begin{cases}
f_i(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \Omega \\
0 & \quad \text{if} \ \VEC{x} \in \RR^n \setminus \Omega
\end{cases}
\]

If $\supp f_i \subset \Omega$, then we have from
Lemma~\ref{sob_denselem1} that
$\displaystyle \underline{f}_i \in W^{k,p}(\RR^n)$
and from Lemma~\ref{sob_denselem2} (with $\Omega$ and $U$ replaced by
$\displaystyle \RR^n$ and $\Omega$ respectively) that
$\displaystyle \underline{f}_i \ast \psi_\epsilon \in \DD(\RR^n)$ and
\[
\left\| \underline{f}_i \ast \psi_\epsilon - f_i \right\|_{k,p,\Omega}
= \left\| \underline{f}_i \ast \psi_\epsilon
- \underline{f}_i \right\|_{k,p,\Omega}
\quad \text{as} \quad \epsilon \to 0^+ \ .
\]
We choose $\xi_i$ to be $\underline{f}_i \ast \psi_\epsilon$
for $\epsilon$ small enough to get
$\displaystyle \left\|\xi_i - f_i\right\|_{k,p,\Omega}
= \left\| \underline{f}_i \ast \psi_\epsilon - f_i \right\|_{k,p,\Omega}
< \epsilon/I$.

We now suppose that $S = \supp f_i \cap \partial \Omega \neq \emptyset$.
It follows from Lemma~\ref{sob_denselem4} that
$\displaystyle \underline{f}_i \in W^{k,p}(V)$, where
$\displaystyle V = \RR^n \setminus S$.

Let $\VEC{y}_i$ be the vector provided in the definition of the segment property
such that\\
$\delta \VEC{y} + (\overline{\Omega} \cap U_i) \subset \Omega$
for $0 < \delta < 1$.  We define
$\displaystyle \underline{f}_{i,\delta} \in W^{k,p}(V-\delta \VEC{y}_i)$ by
$\underline{f}_{i,\delta}(\VEC{x}) = \underline{f}_i(\VEC{x} + \delta \VEC{y}_i)$
for $\VEC{x} \in V - \delta \VEC{y}_i$.

Let $\displaystyle d
= \min \left\{ 1 , \|\VEC{y}_i\|^{-1} \dist{V_i}{\partial U_i} \right\}$.
We then have that $\delta \VEC{y}_i + \overline{\Omega} \subset V$ for
$0 < \delta < d$ because $S \subset V_i \cap \partial \Omega$ and
$\displaystyle (V_i \cap \partial \Omega) - \delta \VEC{y}_i
\subset U_i \setminus \overline{\Omega}$ for $0 < \delta < d$.
Thus
$\displaystyle S - \delta \VEC{y}_i \subset U_i \setminus \overline{\Omega}$ for
$0 < \delta < d$ (Figure~\ref{DENSE}); namely,
$S \cap \left(\delta\VEC{y} + \overline{\Omega}\right) = \emptyset$.

From Lemma~\ref{sob_denselem3} (with $\Omega$ and $U$ replaced by $V$ and
$\Omega$ respectively), we get that
$\displaystyle \underline{f}_{i,\delta} \to \underline{f}_i = f_i$
in $\displaystyle W^{k,p}(\Omega)$ as $\delta \to 0$.
So, there exists $\delta_i$ such that
$\displaystyle \left\|\underline{f}_{i,\delta_i} - f_i \right\|_{k,p,\Omega}
< \epsilon/(2I)$.

Since $\overline{\Omega} \subset V - \delta_i \VEC{y}_i$, it follows
from Lemma~\ref{sob_denselem2} (with $\Omega$ and $U$ replaced by
$V-\delta_i \VEC{y}_i$ and $\Omega$ respectively) that
$\displaystyle \underline{f}_{i,\delta_i} \ast \psi_\epsilon \to
\underline{f}_{i,\delta_i}$ in $\displaystyle W^{k,p}(\Omega)$ 
as $\epsilon \to 0$.  Choose $\xi_i$ to be
$\underline{f}_{i,\delta_i} \ast \psi_\epsilon$
for $\epsilon$ small enough to get
$\displaystyle \left\|\underline{f}_{i,\delta_i} - \xi_i\right\|_{k,p,\Omega}
< \epsilon/(2I)$.
Then
$\displaystyle \|f_i - \xi_i\|_{k,p,\Omega} \leq
\left\|f_i - \underline{f}_{i,\delta_i} \right\|_{k,p,\Omega}
+ \left\|\underline{f}_{i,\delta_i} - \xi_i\right\|_{k,p,\Omega} < \epsilon/I$.
\end{proof}

\pdfF{sobolev/dense}{Illustration of the translation of the region $S$ mentioned
in the proof of Theorem~\ref{DDRRnDWkp}}{Illustration of the
translation of the region $S$ mentioned in the proof of
Theorem~\ref{DDRRnDWkp} for $0 < \delta < d$.}{DENSE}

As the following example shows, $\DD(\Omega)$ is not dense in
$\displaystyle W^{k,2}(\Omega)$ for $k$ a positive integer.

\begin{egg}
Let $k$ be a positive integer, and $p$ be a positive integer or $\infty$. 
If $\displaystyle \Omega \subset \RR^n$ is a bounded open set, then
$\DD(\Omega)$ is not dense in $\displaystyle W^{k,p}(\Omega)$ with
respect to the norm $\|\cdot\|_{k,p,\Omega}$.

To prove this statement, consider the continuous linear functional
\begin{align*}
T: W^{k,p}(\Omega) & \rightarrow \RR \\
v &\mapsto \int_{\Omega} \left( \sum_{|\alpha|\leq k} \diff^\alpha u(\VEC{y})
\diff^\alpha v(\VEC{y})\right) \dx{\VEC{y}}
\end{align*}
where $\displaystyle u \in C^\infty(\overline{\Omega})$ is a
non-trivial function satisfying
\begin{equation} \label{sob_not dense}
\sum_{|\alpha|\leq k} (-1)^\alpha \diff^{2\alpha} u(\VEC{y}) = 0 \  ,
\end{equation}
for $\VEC{y} \in \Omega$.  Such function $u$ can be found by the
method of separation of variables applied to \ref{sob_not dense} on an
open rectangular region containing $\Omega$ for instance.

If follows from integration by parts that
$\displaystyle T(v)=0$ for all $v\in \DD(\Omega)$.
However, $\displaystyle u \in W^{k,p}(\Omega)$ because $\Omega$ is bounded and
$\displaystyle u \in C^\infty(\overline{\Omega})$.  Thus,
$T$ is not the trivial functional because $T(u) >0$.

If $\DD(\Omega)$ was dense in $\displaystyle W^{k,p}(\Omega)$, we
would have that $T=0$ on $\displaystyle W^{k,p}(\Omega)$ because $T=0$ on
$\DD(\Omega)$.  But this is not the case.
\end{egg}

The following lemma is a special case of Lemma~\ref{sob_denselem2}
with $\displaystyle \Omega = U = \RR^n$ if we assume that the distance
between a set and the empty set is $\infty$.  Nevertheless, we state
it because there is an easy proof in this special case.

\begin{lemma} \label{sob_denselem5}
Suppose that $k\in \NN$, $p$ is a positive integer, and
$\displaystyle f \in W^{k,p}(\RR^n)$.
Given $\displaystyle \psi \in \DD(\RR^n)$ such that
$\psi(\VEC{x}) = 0$ for $\|\VEC{x}\|>1$ and
$\displaystyle \int_{\RR^n} \psi(\VEC{x})\dx{\VEC{x}} = 1$, let
$\displaystyle \psi_\epsilon(\VEC{x}) = \epsilon^{-n} \psi(\epsilon^{-1}\VEC{x})$
for $\displaystyle \VEC{x} \in \RR^n$ and $\epsilon > 0$.
Then
$\displaystyle f\ast \psi_{\epsilon} \in W^{k,p}(\RR^n) \cap C^\infty(\RR^n)$
for all
$\epsilon$ and $\displaystyle \| \left( f \ast \psi_{\epsilon} \right)
- f\|_{k,p} \rightarrow 0$ as $\epsilon \rightarrow 0^+$.

If $f$ has a compact support, then
$\displaystyle f \ast \psi_{\epsilon} \in \DD(\RR^n)$ for all $\epsilon$;
more precisely,
$\supp f\ast \psi_\epsilon \subset \supp f + B_\epsilon(\VEC{0})$.
\end{lemma}

\begin{proof}
We have from Young's inequality,
Theorem~\ref{distr_sp_young}, that
$\displaystyle \diff^\alpha f \ast \psi_\epsilon \in L^p(\RR^n)$ for all
$|\alpha|\leq k$ because $\displaystyle f \in W^{k,p}(\RR^n)$ implies that
$\displaystyle \diff^\alpha f \in L^p(\RR^n)$ for all $|\alpha|\leq k$.
Moreover, from Proposition~\ref{distr_comm_der}, we have
$\displaystyle \diff^\alpha(f \ast \psi_\epsilon) =  \diff^\alpha f
\ast \psi_\epsilon$ in the sense of distributions.  Thus
$\displaystyle f \ast \psi_\epsilon \in W^{k,p}(\RR^n)$.

We have from Proposition~\ref{distr_limit_convol} that
\[
\| \diff^\alpha(f \ast \psi_\epsilon) - \diff^\alpha f \|_{p}
= \| \diff^\alpha f \ast \psi_\epsilon - \diff^\alpha f \|_{p}
\rightarrow 0 \quad \text{as}\quad \epsilon \rightarrow 0^+
\]
for $|\alpha|\leq k$.  Thus,
$\displaystyle \| (f \ast \psi_\epsilon) - f \|_{k,p} \rightarrow 0$
as $\epsilon \rightarrow 0^+$.

It follows from Proposition~\ref{distr_smooth_convol} that
$\displaystyle f \ast \phi_{\epsilon} \in C^\infty(\RR^n)$ for all $\epsilon>0$.
If $f$ has a compact support, then $f \ast \phi_{\epsilon}$ has a
compact support because $\phi_\epsilon$ has a compact support.  To be
precise,
$\supp (f \ast \phi_{\epsilon}) \subset \supp f + \supp \phi_{\epsilon}$.
\end{proof}

The next proposition is a special case of Theorem~\ref{DDRRnDWkp} if
$\displaystyle \Omega = \RR^n$ and if we assume that a set with an
empty boundary automatically satisfy the segment property.  The proof
for this special case is a lot simpler than the proof for
Theorem~\ref{DDRRnDWkp}.  So, we give it.

\begin{prop} \label{DDRRnDWkpV2}
For $k\in \NN$ and $0 < p < \infty$, $\displaystyle \DD(\RR^n)$ is dense in
$\displaystyle W^{k,p}(\RR^n)$ with respect to the norm $\|\cdot\|_{k,p}$.
\end{prop}

\begin{proof}
As in the proof of Theorem~\ref{DDRRnDWkp}, we have that every member of
$\displaystyle W^{k,p}(\RR^n)$ can be approximated by members of
$\displaystyle W^{k,p}(\RR^n)$ with bounded support.

We now show that every member of $\displaystyle W^{k,p}(\RR^n)$ with
compact support can be approximated by members of $\displaystyle \DD(\RR^n)$.

Suppose that $\displaystyle f \in W^{k,p}(\RR^n)$ has compact
support.  Choose $\displaystyle \phi \in \DD(\RR^n)$ such that\\
$\displaystyle \int_{\RR^n} \phi(\VEC{x}) \dx{\VEC{x}} = 1$
and set
$\displaystyle \phi_\epsilon(\VEC{x}) = \epsilon^{-n}\phi(\epsilon^{-1} \VEC{x})$
for all $\displaystyle \VEC{x} \in \RR^n$.
It follows from Proposition~\ref{distr_smooth_convol} that
$\displaystyle f \ast \phi_{\epsilon} \in C^\infty(\RR^n)$ for all $\epsilon>0$.
Since both $f$ and $\phi_\epsilon$ have compact support, 
$f \ast \phi_{\epsilon}$ has compact support.  Thus,
$\displaystyle f \ast \phi_{\epsilon} \in \DD(\RR^n)$.  Moreover, from 
Proposition~\ref{distr_limit_convol}, we have that
\[
  \diff^{\alpha} (f \ast \phi_\epsilon)
  = (\diff^\alpha f) \ast \phi_\epsilon \to \diff^\alpha f
\quad \text{as} \quad \epsilon \to 0^+
\]
in $\displaystyle L^p(\RR^n)$ for all $|\alpha| \leq k$.  Thus,
$f \ast \phi_{\epsilon} \to f$ in $\displaystyle W^{k,p}(\RR^n)$ as
$\epsilon \to 0^+$.
\end{proof}

The next theorem is a version of Proposition~\ref{DDRRnDWkpV2} for
$\displaystyle W^{s,2}(\RR^n)$ with $s$ real.  Its proof is remarkably simple.

\begin{theorem} \label{DDRRnDWs2}
For $s\in \RR$, $\displaystyle \DD(\RR^n)$ is dense in
$\displaystyle W^{s,2}(\RR^n)$ with
respect to the norm $\|\cdot\|_{s,\rho}$.
\end{theorem}

\begin{proof}
We consider the operator
\begin{align*}
T^{[s]} : W^{s,2}(\RR^n) & \to L^2(\RR^n) \\
f &\mapsto \F^{-1}\big((1+\|\VEC{y}\|_2^2)^{s/2} \F(f) \big)  
\end{align*}
This is an isometry because
\[
\|T^{[s]}(f)\|_2 = \left\| \F^{-1}\big((1+\|\VEC{y}\|_2^2)^{s/2}
\F(f) \big) \right\|_2
= \left\| (1+\|\VEC{y}\|_2^2)^{s/2} \F(f) \right\|_2
= \| f \|_{s,\rho} \ ,
\]
where the second equality is a consequence of Plancherel theorem,
Theorem~\ref{distr_plancherel}, and the last one is just the
definition of $\|\cdot\|_{s,\rho}$.

It follows from Proposition~\ref{distr_frr_tempT} that the Fourier
transform is a homeomorphism from $\displaystyle \SS(\RR^n)$ onto
itself.  It is also clear that
$\displaystyle \phi \mapsto (1+\|\VEC{y}\|_2^2)^{s/2} \phi$ is a
homeomorphism from $\displaystyle \SS(\RR^n)$ onto itself.  Thus,
$\displaystyle T^{[s]}$ is a homeomorphism from $\displaystyle \SS(\RR^n)$
onto itself.

Since $\displaystyle \SS(\RR^n)$ is dense in $\displaystyle L^2(\RR^n)$
according to the norm
$\displaystyle \|g\|_2 = \left(\int_{\RR^n} |g(\VEC{x})|^2 \dx{\VEC{x}}
\right)^{1/2}$
for $\displaystyle g \in L^2(\RR^n)$, it
follow from the isometry $\displaystyle T^{[s]}$ that
$\displaystyle \SS(\RR^n)$ is dense in $\displaystyle W^{s,2}(\RR^n)$.

Moreover, $\displaystyle \DD(\RR^n)$ is dense in
$\displaystyle \SS(\RR^n)$ according to the norm
$\|\cdot\|_{s,\rho}$.  To prove this, choose $\displaystyle \phi \in \DD(\RR^n)$
such that $|\phi(\VEC{x})| \leq 1$ for all $\displaystyle \VEC{x} \in \RR^n$,
$\phi(\VEC{x}) = 1$ for $\|\VEC{x}\|<1$ and
$\phi(\VEC{x}) = 0$ for $\|\VEC{x}\|>2$.  Let
$\displaystyle \phi_\delta(\VEC{x}) = \phi\left(\delta \VEC{x}\right)$
for all $\displaystyle \VEC{x} \in \RR^n$ and $\delta >0$.  If
$\displaystyle \psi \in \SS(\RR^n)$, then
$\displaystyle \psi_\delta = \psi \phi_\delta \in \DD(\RR^n)$ and
$\psi_\delta - \psi \to 0$ as $\delta \to 0^+$ in $\displaystyle L^2(\RR^n)$
follows from the Lebesgue Dominate Convergence Theorem
since $\psi_{\delta}(\VEC{x}) \to \psi(\VEC{x})$ for all
$\displaystyle \VEC{x} \in \RR^n$ as $\delta \to 0^+$ and
$\|\psi_{\delta}\|_2 \leq \|\psi\|_2 < \infty$ for all $\delta$.
Since
\begin{align*}
  P: \SS(\RR^n) & \to \SS(\RR^n) \\
  \zeta &\mapsto (1+\|\VEC{y}\|_2^2)^{s/2} \F(\zeta) (\VEC{y})
\end{align*}
is continuous, we get that
$P(\psi_\delta - \psi) \to 0$ in $\displaystyle \SS(\RR^n)$ as $\delta \to 0^+$
according to the norm $\|\cdot\|_2$.
This implies that
$\displaystyle \| \psi - \psi_\delta \|_{s,\rho}
= \left\| P(\psi - \psi_\delta) \right\|_2 \to 0$ as $\delta \to 0^+$.
\end{proof}

\begin{prop} \label{sob_T_dd_wkp}
Let $\displaystyle \Omega \subset \RR^n$ be an open set and
$\phi \in \DD(\Omega)$.
For $k\in \NN$ and $p$ a positive integer or $\infty$,
\begin{align*}
T: W^{k,p}(\Omega) &\rightarrow W^{k,p}(\Omega) \\
f &\mapsto \phi \,f 
\end{align*}
is a bounded linear mapping.
\end{prop}

\begin{proof}
The result follows from the Leibniz formula \footnote{The reader can
easily verify that the Leibnitz formula that we already know for the
product of two differentiable functions
is also true for the product $\phi u$ with $\phi \in \DD(\Omega)$ and
$u \in \DD'(\Omega)$.}, and the fact that $\phi\in \DD(\Omega)$ and
all its derivatives are bounded on $\Omega$.
\end{proof}

\begin{lemma} \label{sobVsubsetU}
Let $\Omega_1 \subset \Omega_2$ be two open subsets of
$\displaystyle \RR^n$.  Then,
$\displaystyle W^{k,p}(\Omega_2)\big|_{\Omega_1} \subset W^{k,p}(\Omega_1)$.  More
precisely, if $\displaystyle f \in W^{k,p}(\Omega_2)$, then
$\displaystyle f\big|_{\Omega_1} \in W^{k,p}(\Omega_1)$ and
$\displaystyle \diff^\alpha \left(f\big|_{\Omega_1}\right) =
\left( \diff^\alpha f \right)\big|_{\Omega_1}$ for $|\alpha| \leq k$.
\end{lemma}

\begin{proof}
Given $\displaystyle f \in W^{k,p}(\Omega_2)$, we have that
$\displaystyle (\diff^\alpha f)\big|_{\Omega_1} \in L^p(\Omega_1)$ for
all multi-indices $\alpha$ such that $|\alpha|\leq k$ because
$\displaystyle \int_{\Omega_1} |\diff^\alpha f|^p \dx{\VEC{x}} \leq 
\int_{\Omega_2} |\diff^\alpha f|^p \dx{\VEC{x}} < \infty$
for all $\alpha$ such that $|\alpha|\leq k$.  In
particular, this implies that 
$\displaystyle f\big|_{\Omega_1}$ defines a proper distribution on $\Omega_1$.

Moreover, for $|\alpha| \leq k$, we have that
\begin{align*}
\diff^\alpha \left(f\big|_{\Omega_1}\right)(\phi)
&= (-1)^{|\alpha|} \int_{\Omega_1} f\big|_{\Omega_1}(\VEC{x})
\,\diff^{\alpha}\phi(\VEC{x}) \dx{\VEC{x}}
= (-1)^{|\alpha|} \int_{\Omega_2} f(\VEC{x}) \diff^{\alpha}\phi(\VEC{x})
\dx{\VEC{x}} \\
&= \int_{\Omega_2} \diff^\alpha f(\VEC{x}) \, \phi(\VEC{x}) \dx{\VEC{x}}
= \int_{\Omega_1} \left(\diff^\alpha f(\VEC{x})\right)\big|_{\Omega_1} \,
\phi(\VEC{x}) \dx{\VEC{x}}
\end{align*}
for all $\phi \in \DD(\Omega_1) \subset \DD(\Omega_2)$, where we
assume that a test function $\phi$ on $\Omega_1$ is extended to a test
function $\phi$ on $\Omega_2$ by
$\phi(\VEC{x}) = 0$ for $\VEC{x} \in \Omega_2 \setminus \Omega_1$.  Hence,
$\displaystyle \diff^\alpha \left(f\big|_{\Omega_1}\right) =
\left( \diff^\alpha f \right)\big|_{\Omega_1}$.
\end{proof}

\begin{theorem} \label{sob_Cinfty_dense}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$, $k\in \NN$
and $0<p<\infty$.
Then $\displaystyle C^\infty(\Omega) \cap W^{k,p}(\Omega)$ is dense in
$\displaystyle W^{k,p}(\Omega)$.
\end{theorem}

\begin{proof}
We prove that
$\displaystyle
S = \left\{ f \in C^\infty(\Omega) :  \|f\|_{k,p} < \infty \right\}$
is dense in $\displaystyle W^{k,p}(\Omega)$.  Consider
$\displaystyle f\in W^{k,p}(\Omega)$ and $\delta>0$.

\stage{i} Let $\displaystyle \Omega_{-1} = \Omega_0 = \emptyset$ and
\[
\Omega_j = \left\{ \VEC{x} \in \Omega : \|\VEC{x}\| < j \ \text{and} \ 
\dist{\VEC{x}}{\partial \Omega} > \frac{1}{j} \right\}
\]
for $j>0$.  Moreover, let
$\displaystyle V_j = \Omega_{j+1} \setminus \overline{\Omega_{j-1}}$
for $j>0$.
The collection $\displaystyle \left\{ V_j \right\}_{j=1}^\infty$ is an
open cover of $\Omega$.  Let
$\displaystyle \left\{ \phi_j \right\}_{j=1}^\infty$ be a partition
of unity of $\Omega$ subordinate to
$\displaystyle \left\{ V_j \right\}_{j=1}^\infty$.  We are using here
the Definition~\ref{pot_part_unity_V2} of a partition of unity.

Choose $\displaystyle \psi \in \DD(\RR^n)$ such that
$\psi(\VEC{x}) = 0$ for $\|\VEC{x}\|>1$ and
$\displaystyle \int_{\RR^n} \psi(\VEC{x}) \dx{\VEC{x}} = 1$.
We consider
$\displaystyle \psi_\epsilon(\VEC{x}) = \epsilon^{-n}
\psi(\epsilon^{-1} \VEC{x})$ for $\VEC{x} \in \RR^n$ and $\epsilon>0$.

\stage{ii} Choose $\delta >0$.  Consider
$\displaystyle \underline{f}: \RR^n \to \RR$ defined by
\[
\underline{f}(\VEC{x}) =
\begin{cases}
f(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \Omega \\
0 & \quad \text{if} \ \VEC{x} \in \RR^n \setminus \Omega
\end{cases}
\]
We show that, for some set
$\displaystyle \{\epsilon_j\}_{j=1}^\infty \subset \RR$ to be
specified later,
\begin{equation} \label{sob_HequalsW_phi}
\phi = \sum_{j=1}^\infty (\phi_j\,\underline{f}) \ast \psi_{\epsilon_j}
\end{equation}
is in $\displaystyle C^\infty(\Omega) \cap W^{k,p}(\Omega)$ and satisfies
$\|f-\phi\|_{k,p} \leq \delta$ on $\Omega$.  As usual, we may assume
that $\phi_j$ is defined on $\displaystyle \RR^n$ by $\phi_j(\VEC{x}) = 0$ for
$\displaystyle \VEC{x} \in \RR^n\setminus \Omega$.
It follows from Proposition~\ref{sob_T_dd_wkp} that
$\displaystyle \phi_j \underline{f} \in W^{k,p}(\RR^n)$ and from
Lemma~\ref{sob_denselem5} that
$\displaystyle (\phi_j\,\underline{f}) \ast \psi_{\epsilon_j} \in
W^{k,p}(\RR^n) \cap C^\infty(\RR^n)$.

If $\displaystyle \epsilon_j < \frac{1}{(j+1)(j+2)}$ and 
$\displaystyle U_j = \Omega_{j+2} \setminus \overline{\Omega_{j-2}}$
for $j>0$, then
\[
\supp \left( (\phi_j\,\underline{f}) \ast \psi_{\epsilon_j}\right) \subset 
\supp (\phi_j\,\underline{f}) + \supp \psi_{\epsilon_j}
\subset \left\{ \VEC{x} : \dist{\VEC{x}}{V_j} < \epsilon_j \right\}
\subset U_j
\]
as can be visualized in Figure~\ref{sob_fig1}.  Note that this
also implies that $\supp \phi \subset \overline{\Omega}$.  If
$K \subset \Omega$ is a compact set, then there are only a finite
number of $U_j$ that intersect $K$.  In fact, $U_j \cap K = \emptyset$
for $j > q+1$ such that $K \subset \Omega_q$.  Thus, the
sum in \ref{sob_HequalsW_phi} is finite on $K$.  Therefore, $\phi$ is
$\displaystyle C^\infty$ on the interior of $K$ since each term of the
series is in $\displaystyle C^\infty(\RR^n)$.  Finally, since this is true
for any compact subset of $\Omega$, then
$\displaystyle \phi \in C^\infty(\Omega)$.
Since $\displaystyle \phi \in L^1_{loc}(\Omega)$, we also get that
$\phi \in \DD'(\Omega)$.

We use Lemma~\ref{sob_denselem2} to choose
$\displaystyle \epsilon_j < \frac{1}{(j+1)(j+2)}$ such that
\[
\left\| \left( (\phi_j\,\underline{f}) \ast \psi_{\epsilon_j}\right)
- (\phi_j\,f) \right\|_{k,p,\Omega}  < \frac{\delta}{2^j Q}
\]
for $j>0$, where $\displaystyle Q^p = \sum_{\|\alpha|\leq k} 1$.

Consider $h_{j-1}:\Omega \to \RR$ defined by
\[
h_{j-1}(\VEC{x}) = \begin{cases}
(f-\phi)(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \Omega_{j-1} \\
0 & \quad \text{if} \ \VEC{x} \in \Omega \setminus \Omega_{j-1}
\end{cases}
\]
Since
\[
h_{j-1}\big|_{\Omega_{j-1}} = (f - \phi)\big|_{\Omega_{j-1}}
= f - \sum_{i=1}^j (\phi_i\,\underline{f}) \ast \psi_{\epsilon_i}
= \sum_{i=1}^j \phi_i f -
\sum_{i=1}^j (\phi_i\,\underline{f}) \ast \psi_{\epsilon_i}
\]
on $\Omega_{j-1}$ because $\displaystyle \sum_{i=1}^j \phi_j(\VEC{x}) =1$ for
all $\VEC{x}\in \Omega_{j-1}$, we get
\begin{align}
&\left\|\diff^\alpha h_{j-1}\right\|_{p,\Omega}
= \left\|\diff^\alpha h_{j-1}\right\|_{p,\Omega_{j-1}}
\leq \left\| f - \phi \right\|_{k,p,\Omega_{j-1}}
= \left\| \sum_{i=1}^j \phi_i f -
\sum_{i=1}^j (\phi_i\,\underline{f}) \ast \psi_{\epsilon_i}
\right\|_{k,p,\Omega_{j-1}} \nonumber \\
&\qquad \leq \left\| \sum_{i=1}^j \left( \phi_i f -
(\phi_i\,\underline{f}) \ast \psi_{\epsilon_i} \right) \right\|_{k,p,\Omega}
\leq \sum_{i=1}^j \left\| \left( \phi_i f -
(\phi_i\,\underline{f}) \ast \psi_{\epsilon_i} \right) \right\|_{k,p,\Omega}
\leq \sum_{i=1}^\infty \frac{\delta}{2^i Q} = \frac{\delta}{Q}
\label{HequalsWEq1}
\end{align}
for all multi-indices $\alpha$ such that $|\alpha| \leq k$.
Thus $\displaystyle h_{j-1} \in W^{k,p}(\Omega)$ for all $j$.
Note that
$\displaystyle \sum_{i=1}^j (\phi_i\,\underline{f}) \ast \psi_{\epsilon_i}
\in C^{\infty}(\RR^n)$ and has a compact support in $\Omega_{j-1}$.

Since
$\displaystyle
h^\alpha_{j-1}(\VEC{x}) \to \diff^\alpha (f-\phi)(\VEC{x})$
as $j \to \infty$ for all $\VEC{x} \in \Omega$ and multi-indices $\alpha$ with
$|\alpha| \leq k$, we get from (\ref{HequalsWEq1}) and the Lebesgue
Monotone Convergence Theorem that
$\displaystyle \left\| \diff^\alpha (f - \phi)
\right\|_{p,\Omega} \leq \delta/Q$ for all multi-indices $\alpha$ with
$|\alpha| \leq k$.  Hence,
$\displaystyle \left\| f -\phi \right\|_{k,p,\Omega} \leq \delta$.

\stage{iii} We have that $\phi \in S$ because
$\displaystyle f\in W^{k,p}(\Omega)$
and $\displaystyle \phi-f \in W^{k,p}(\Omega)$ by (ii), thus
$\displaystyle \phi = (\phi-f) + f \in W^{k,p}(\Omega)$.
In particular,
\[
\|\phi \|_{k,p} = \| (\phi-f) + f \|_{k,p} \leq \| (\phi-f)\|_{k,p} +
\|f \|_{k,p} \leq \delta +\| f\|_{k,p} < \infty \ .  \qedhere
\]
\end{proof}

\pdfF{sobolev/sob_fig1}{Open cover for the proof that $H^{k,p}=W^{k,p}$}
{The open cover used in the proof of Theorem~\ref{sob_Cinfty_dense}.}{sob_fig1}

\subsection{Localized Sobolev Spaces}

\begin{defn}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$.
If $k \in \NN$ and $p$ is a positive integer or $\infty$, the
{\bfseries localized Sobolev space}\index{Sobolev Space!Localized}
$\displaystyle W^{k,p}_{loc}(\Omega)$ is the set
of all distributions $u \in \DD'(\Omega)$ with the following property.
For every bounded open set $V$ such that $\overline{V}\subset \Omega$,
there exists $\displaystyle g\in W^{k,p}(\RR^n)$ such that $u=g$ on
$V$ in the sense of distributions \footnotemark.\addtocounter{footnote}{-1}

Similarly, if $\displaystyle s \in \RR$, the {\bfseries localized Sobolev space}
$\displaystyle W^{s,2}_{loc}(\Omega)$ is the set
of all distributions $u \in \DD'(\Omega)$ with the following property.
For every bounded open set $V$ such that $\overline{V}\subset \Omega$,
there exists $\displaystyle g\in W^{s,2}(\RR^n)$ such that $u=g$ on
$V$ in the sense of distributions \footnotemark.
\end{defn}

\footnotetext{$u=g$ on $V$ means that
$\displaystyle u(\phi) = g(\phi) = \int_{\Omega} g \phi \dx{\VEC{x}}$
for all $\phi \in \DD(V)$.  If $\displaystyle u \in L^1_{loc}(\Omega)$, this
implies that $u=g$ almost everywhere on $V$.}

Proposition~\ref{sob_T_dd_wkp} is also true for the Sobolev spaces
$\displaystyle W^{s,2}(\RR^n)$ with $s\in [0,\infty[$.  To prove it, the
following technical lemma is needed first.

\begin{lemma} \label{sob_tri_equ}
For all $\displaystyle \VEC{x}, \VEC{y} \in \RR^n$ and $m \in \RR$, we have
$\displaystyle \left(\frac{1+\|\VEC{y}\|^2}{1+\|\VEC{x}\|^2} \right)^m
\leq 2^{|m|} \left(1+\|\VEC{y}-\VEC{x}\|^2\right)^{|m|}$.
\end{lemma}

\begin{proof}
It is enough to proof the lemma for $m\geq 0$.  If $m<0$, it suffices
to interchange $\VEC{x}$ and $\VEC{y}$.

It follows from
$\displaystyle \left(\|\VEC{y} - \VEC{x}\| - \|\VEC{x}\|\right)^2 \geq 0$
that $\displaystyle 2\|\VEC{x}\|\,\|\VEC{y}-\VEC{x}\|
\leq \|\VEC{y} - \VEC{x}\|^2 + \|\VEC{x}\|^2$.  Hence, from
$\displaystyle \|\VEC{y}\| \leq \|\VEC{y}-\VEC{x}\| +\|\VEC{x}\|$, we
get that
\[
\|\VEC{y}\|^2 \leq \left( \|\VEC{y}-\VEC{x}\| +\|\VEC{x}\| \right)^2
= \|\VEC{y}-\VEC{x}\|^2 +\|\VEC{x}\|^2 +2 \|\VEC{y}-\VEC{x}\|\,\|\VEC{x}\|
\leq 2\left( \|\VEC{y}-\VEC{x}\|^2 +\|\VEC{x}\|^2 \right) \ .
\]
Then,
\[
1+\|\VEC{y}\|^2 \leq 1 + 2\left( \|\VEC{y}-\VEC{x}\|^2 +\|\VEC{x}\|^2 \right)
\leq 2 \left(1+\|\VEC{y}-\VEC{x}\|^2\right)\left(1+\|\VEC{x}\|^2\right) \ .
\]
It follows that
\[
\frac{1+\|\VEC{y}\|^2}{1+\|\VEC{x}\|^2}
\leq 2 \left(1+\|\VEC{y}-\VEC{x}\|^2\right) \ .  \qedhere
\]
\end{proof}

\begin{prop} \label{sob_T_dd_wk2}
For $\phi \in \SS(\RR^n)$ and $s\in [0,\infty[$, the mapping
\begin{align*}
T: W^{s,2}(\RR^n) &\rightarrow W^{s,2}(\RR^n) \\
f &\mapsto \phi \,f 
\end{align*}
is a bounded linear mapping.
\end{prop}

\begin{proof}
To prove that there exists a constant $C$ such that
$\displaystyle \|\phi f \|_{s,\rho} \leq C \|f\|_{s,\rho}$ for
$\displaystyle f \in W^{s,2}(\RR^n)$, we first prove that the mapping 
$\displaystyle T : L^2(\RR^n,\rho) \rightarrow L^2(\RR^n,\rho)$
defined by
\[
T(h)(\VEC{y}) =
(2\pi)^{-n/2} \int_{\RR^n} \left(1+\|\VEC{z}\|^2\right)^{-s}
\hat{\phi}(\VEC{y} - \VEC{z}) h(\VEC{z}) \dx{\rho(\VEC{z})}
\]
for $\displaystyle h \in L^2(\RR^n,\rho)$ is a continuous linear
mapping, where the measure $\rho$ is defined by
$\displaystyle \dx{\rho(\VEC{x})} = (1+\|\VEC{x}\|^2)^s\dx{\VEC{x}}$.
In particular,
$\displaystyle \|h\|_{2,\rho} \equiv \left(
\int_{\RR^n} |h(\VEC{z})|^2 \dx{\rho(\VEC{z})}\right)^{1/2}$ for
$\displaystyle h \in L^2(\RR^n,\rho)$

Let
\[
K(\VEC{y},\VEC{z}) =(2\pi)^{-n/2} \left(1+\|\VEC{z}\|^2\right)^{-s}
\hat{\phi}(\VEC{y} - \VEC{z}) \ .
\]
According to the generalized Young's inequality,
Theorem~\ref{distr_GyoungI}, we only have to prove that
\[
\sup_{\VEC{z}\in\RR^n}
\int_{\RR^n} |K(\VEC{y},\VEC{z})|\dx{\rho(\VEC{y})} < C \quad
\text{and} \quad
\sup_{\VEC{y}\in\RR^n}
\int_{\RR^n} |K(\VEC{y},\VEC{z})|\dx{\rho(\VEC{z})} < C
\]
for some constant $C$ to get
$\displaystyle \|T(h) \|_{2,\rho} \leq C \|h\|_{2,\rho}$ for
$\displaystyle h \in L^2(\RR^n,\rho)$.  From
Lemma~\ref{sob_tri_equ}, we get
\begin{align*}
\int_{\RR^n}|K(\VEC{y},\VEC{z})| \dx{\rho(\VEC{y})}
&= (2\pi)^{-n/2} \int_{\RR^n} \left(1+\|\VEC{z}\|^2\right)^{-s}
\left(1+\|\VEC{y}\|^2\right)^{s}
\left|\hat{\phi}(\VEC{y} - \VEC{z})\right|\dx{\VEC{y}} \\
&\leq 2^s (2\pi)^{-n/2} \int_{\RR^n} \left(1+\|\VEC{y}-\VEC{z}\|^2\right)^{s}
\left|\hat{\phi}(\VEC{y} - \VEC{z})\right|\dx{\VEC{y}} \\
&\leq 2^s (2\pi)^{-n/2} \int_{\RR^n} \left(1+\|\VEC{y}\|^2\right)^{s}
\left|\hat{\phi}(\VEC{y})\right|\dx{\VEC{y}} \equiv C_1 < \infty
\end{align*}
for all $\displaystyle \VEC{z}\in \RR^n$ because
$\displaystyle \hat{\phi} \in \SS(\RR^n)$ by
Proposition~\ref{distr_frr_tempT}.
Moreover,
\[
\int_{\RR^n} |K(\VEC{y}, \VEC{z})| \dx{\rho(\VEC{z})}
= \int_{\RR^n} \left|\hat{\phi}(\VEC{y} - \VEC{z})\right|\dx{\VEC{z}}
= \int_{\RR^n} \left|\hat{\phi}(\VEC{y})\right|\dx{\VEC{y}} \equiv C_2
< \infty
\]
for all $\displaystyle \VEC{y}\in \RR^n$ because
$\displaystyle \hat{\phi} \in \SS(\RR^n)$ by
Proposition~\ref{distr_frr_tempT}.  It suffices to take
$C = \max\{C_1,C_2\}$ to reach the conclusion.

However, We have that 
\begin{align*}
(\phi\,f)^\wedge(\VEC{y}) &= (\hat{\phi}\ast \hat{f})(\VEC{y})
= \int_{\RR^n} \hat{\phi}(\VEC{y} - \VEC{z}) \hat{f}(\VEC{z})
\dx{\mu(\VEC{z})} \\
&= (2\pi)^{-n/2} \int_{\RR^n} \left(1+\|\VEC{z}\|^2\right)^{-s}
\hat{\phi}(\VEC{y} - \VEC{z}) \hat{f}(\VEC{z}) \dx{\rho(\VEC{z})}
= T(\hat{f}) \ ,
\end{align*}
where item (4) of Proposition~\ref{distr_frr_tempT} was used for the
first equality.  Hence
\[
\|\phi f\|_{s,\rho} = \| (\phi\, f)^\wedge\|_{2,\rho}
= \| T(\hat{f}) \|_{2,\rho} \leq C \|\hat{f}\|_{2,\rho}
= \|f \|_{s,\rho}
\]
for all $\displaystyle f \in W^{s,2}(\RR^n)$.
\end{proof}

The reader should be careful when reading the next proposition.  For
instance, if $u \in \DD'(\Omega)$ is represented by a function in
$\displaystyle W^{s,2}(\Omega)$, then we also denote this function as
$u$.

\begin{prop} \label{sob_Hsloc_cond}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$ and $k$ be a
non-negative integer.  Suppose that $u \in \DD'(\Omega)$.  Then
$\displaystyle u \in W^{k,p}_{loc}(\Omega)$ if and only if
$\displaystyle \phi \, u \in W^{k,p}(\RR^n)$
\footnotemark\addtocounter{footnote}{-1}
for all $\phi \in \DD(\Omega)$.
Similarly, if $s \in \RR$, then $\displaystyle u \in W^{s,2}_{loc}(\Omega)$
if and only if $\displaystyle \phi \, u \in W^{s,2}(\RR^n)$
\footnotemark\ for all $\phi \in \DD(\Omega)$.
\end{prop}

\begin{rmk}
As usual, $\phi \in \DD(\Omega)$ can be expanded to
$\displaystyle \phi \in \DD(\RR^n)$ with $\supp \phi \subset \Omega$
by setting $\phi(\VEC{x}) = 0$ for
$\displaystyle \VEC{x} \in \RR^n\setminus \Omega$.
\end{rmk}

\footnotetext{ Recall that $\displaystyle \phi \, u \in \DD'(\RR^n)$
is defined by $(\phi \, u)(\psi) = u(\phi \psi)$ for all
$\displaystyle \psi \in \DD(\RR^n)$
because $\supp (\phi \psi) \subset \supp \phi \subset \Omega$ for all
$\displaystyle \psi \in \DD(\RR^n)$ and so we may assume that
$\psi \psi \in \DD(\Omega)$.
Hence $\displaystyle \phi u \in W^{k,p}(\RR^n)$ (resp.
$\displaystyle \phi u \in W^{s,2}(\RR^n)$) means that there exists
$\displaystyle g \in W^{k,p}(\RR^n)$ (resp.
$\displaystyle g \in W^{s,2}(\RR^n)$) such that
$\phi u = g$ in the sense of distributions on $\displaystyle \RR^n$.}

\begin{proof}
\stage{i}
Suppose that $\displaystyle u \in W^{s,2}_{loc}(\Omega)$ and
$\phi \in \DD(\Omega)$.  Choose an open set $V$ such that
$\displaystyle \supp \phi \subset V \subset \overline{V}\subset \Omega$.
We get from the definition of $\displaystyle W^{s,2}_{loc}(\Omega)$
that there exists $\displaystyle g\in W^{s,2}(\RR^n)$ such that $u=g$ on
$V \supset \supp \phi$ in the sense of distributions.  Hence
$\phi\, u = \phi \, g$ in the sense of distribution on $\RR^n$ because
\[
  (\phi \, u)(\psi) = u(\phi\psi) = g(\phi\psi) = (\phi\,g)(\psi)
\]
for all $\displaystyle \psi \in \DD'(\RR^n)$ since
$\supp(\phi\psi) \subset \supp
\phi \subset V$.  Therefore,
$\displaystyle \phi\, u = \phi \, g \in W^{s,2}(\RR^n)$ by
Proposition~\ref{sob_T_dd_wk2}.

Suppose that $\displaystyle \phi\,u \in W^{s,2}(\RR^n)$ for all
$\displaystyle \phi\in \DD(\Omega)$.  Let $V$ be an open
subset of $\Omega$ such that $\overline{V}\subset \Omega$.  Choose
$\displaystyle \phi \in \DD(\Omega)$ such that $\phi(\VEC{x})=1$ for all
$\VEC{x} \in V$, then $u = \phi \, u$ on $V$ in the sense of
distributions with $\displaystyle \phi \, u \in W^{s,2}(\RR^n)$.

\stage{ii} The proof in the case of $\displaystyle W^{k,p}(\RR^n)$ is
basically identical.
\end{proof}

It follows from Propositions~\ref{sob_T_dd_wk2} and
\ref{sob_Hsloc_cond} that
$\displaystyle W^{s,2}(\RR^n) \subset W^{s,2}_{loc}(\Omega)$
for every open set $\displaystyle \Omega \subset \RR^n$.

\section{The $\displaystyle W^{k,p}_0$ spaces}

\begin{defn}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$.
For $k\in \NN$ and $p$ a positive integer. the
{\bfseries Sobolev space}\index{Sobolev Space!$W^{k,p}_0(\Omega)$}
$\displaystyle W^{k,p}_0(\Omega)$ is the closure in 
$\displaystyle W^{k,p}(\Omega)$ of $\DD(\Omega)$ with respect to the norm
$\|\cdot\|_{k,p}$.

For $s \in \RR$. the
{\bfseries Sobolev space}\index{Sobolev Space!$W^{s,2}_0(\Omega)$}
$\displaystyle W^{s,2}_0(\Omega)$ is the closure in 
$\displaystyle W^{s,2}(\Omega)$ of $\DD(\Omega)$ with respect to the norm
$\|\cdot\|_{s,\rho}$.
\end{defn}

If $\displaystyle \Omega \subset \RR^n$ is a bounded open set, we will
show when studying the trace operators in Section~\ref{sectTraceOp}
that the space $\displaystyle W^{k,p}_0(\Omega)$ generalizes the space
of functions $\displaystyle f \in C^k(\Omega) \cap C^{k-1}(\overline{\Omega})$
such that $\displaystyle \pdydxn{f}{\VEC{\nu}}{j}(\VEC{x}) = 0$ for all
$\VEC{x} \in \partial \Omega$ and $0 \leq j <k$, where
$\VEC{\nu}(\VEC{x})$ is the outward unit normal to $\partial \Omega$
at $\VEC{x} \in \partial \Omega$.  See Theorem~\ref{H0TraceOmega}.

The next proposition generalizes Lemma~\ref{sob_denselem1}.

\begin{prop} \label{sob_expand_WKP}
Consider $k\in \NN$ and $p$ a positive integer.  Let $\Omega$ be an
open subset of $\displaystyle \RR^n$.  Given a function
$f:\Omega \rightarrow \CC$,
we define a function $\displaystyle \underline{f}:\RR^n\rightarrow \CC$ by
\[
\underline{f}(\VEC{x}) =
\begin{cases}
f(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \Omega \\
0 & \quad \text{if} \ \VEC{x} \in \RR^n \setminus \Omega
\end{cases}
\]
If $\displaystyle f \in W^{k,p}_0(\Omega)$, then
$\displaystyle \diff^\alpha \underline{f} = \underline{\diff^\alpha f}$
in the sense of distributions on $\displaystyle \RR^n$ for
$|\alpha|\leq k$.  In particular,
$\displaystyle \underline{f} \in W^{k,p}(\RR^n)$.
\end{prop}

\begin{proof}
By definition, there exists a sequence
$\displaystyle \{\phi_i\}_{i=0}^\infty$ in
$\DD(\Omega)$ converging to $f$ with respect to the norm
$\|\cdot\|_{k,p}$.

\stage{i} We first prove that
\[
\int_\Omega \diff^\alpha \phi_i(\VEC{x}) \psi(\VEC{x}) \dx{\VEC{x}}
\rightarrow \int_\Omega \diff^\alpha f(\VEC{x}) \psi(\VEC{x}) \dx{\VEC{x}}
\quad \text{as}\quad i \rightarrow \infty
\]
for any bounded function $\psi$ with bounded support and $|\alpha|\leq k$.
According to Hlders' inequality,
\begin{align*}
&\left|\int_\Omega \diff^\alpha \phi_i(\VEC{x}) \psi(\VEC{x}) \dx{\VEC{x}}
- \int_\Omega \diff^\alpha f(\VEC{x}) \psi(\VEC{x}) \dx{\VEC{x}}\right|
\leq  \int_\Omega \left| \diff^\alpha \phi_i(\VEC{x}) -
\diff^\alpha f(\VEC{x})\right|\,
\left| \psi(\VEC{x}) \right| \dx{\VEC{x}} \\
&\quad \leq \left( \int_\Omega \left| \diff^\alpha \phi_i(\VEC{x})
- \diff^\alpha f(\VEC{x})\right|^p
\dx{\VEC{x}} \right)^{1/p} \left(
\int_\Omega \left| \psi(\VEC{x}) \right|^q \dx{\VEC{x}} \right)^{1/q} \\
&\quad = C \left( \int_\Omega \left| \diff^\alpha \phi_i(\VEC{x})
- \diff^\alpha f(\VEC{x})\right|^p \dx{\VEC{x}} \right)^{1/p}
\leq C \| \phi_i - f \|_{k,p} \rightarrow 0 \quad \text{as} \quad
i\rightarrow \infty \ ,
\end{align*}
where $\displaystyle \frac{1}{p}+ \frac{1}{q} = 1$ and
$\displaystyle C = \left(
\int_\Omega \left| \psi(\VEC{x}) \right|^q \dx{\VEC{x}} \right)^{1/q}
< \infty$.

\stage{ii} Since
\[
\int_{\RR^n} \left|\underline{f}(\VEC{x})\right|^p \dx{\VEC{x}} = 
\int_{\Omega} \left| f(\VEC{x}) \right|^p \dx{\VEC{x}} < \infty \ ,
\]
the function $\underline{f}$ defines a distribution on $\displaystyle \RR^n$.
Hence, for $|\alpha|\leq k$, we get from (i) that
\begin{align*}
(\diff^\alpha \underline{f})(\phi)
&= (-1)^{|\alpha|} \int_{\RR^n} \underline{f}(\VEC{x})
\diff^\alpha \phi(\VEC{x})\dx{\VEC{x}}
= (-1)^{|\alpha|} \int_{\Omega} f(\VEC{x})
\diff^\alpha \phi(\VEC{x})\dx{\VEC{x}} \\
&= (-1)^{|\alpha|} \lim_{i\rightarrow \infty}
\int_{\Omega} \phi_i(\VEC{x}) \diff^\alpha \phi(\VEC{x})\dx{\VEC{x}}
= \lim_{i\rightarrow \infty}
\int_{\Omega} \diff^\alpha \phi_i(\VEC{x}) \phi(\VEC{x})\dx{\VEC{x}} \\
&= \int_{\Omega} \diff^\alpha f(\VEC{x}) \phi(\VEC{x})\dx{\VEC{x}}
= \int_{\RR^n} \underline{\diff^\alpha f}(\VEC{x}) \phi(\VEC{x})\dx{\VEC{x}}
= (\underline{\diff^\alpha f}) (\phi)
\end{align*}
for $\displaystyle \phi \in \DD(\RR^n)$.
Thus $\displaystyle \diff^\alpha \underline{f} = \underline{\diff^\alpha f}$
almost everywhere in $\displaystyle \RR^n$.

\stage{iii} We have that $\displaystyle \diff^\alpha \underline{f}
= \underline{\diff^\alpha f} \in L^p(\RR^n)$ for $|\alpha| \leq k$ because
\[
\left( \int_{\RR^n} \left|\underline{\diff^\alpha f}(\VEC{x})\right|^p
\dx{\VEC{x}}\right)^{1/p} = 
\left( \int_{\Omega} \left| \diff^\alpha f(\VEC{x}) \right|^p
\dx{\VEC{x}}\right)^{1/p} < \infty
\]
since $\displaystyle f \in W^{k,p}(\Omega)$.  Thus,
$\displaystyle \underline{f} \in W^{k,p}(\RR^n)$.

It is also interesting to note that, as a distribution,
$\displaystyle \diff^\alpha \underline{f}\,\big|_{\Omega} = \diff^\alpha f$.
\end{proof}

\begin{lemma} \label{sob_w0_trad1}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$.
If $\displaystyle f \in W^{k,p}(\Omega)$ has a compact support in
$\Omega$, then there exists a sequence
$\displaystyle \left\{ \psi_i \right\}_{i=1}^\infty \subset \DD(\Omega)$
such that $\psi_i \to f$ in $\displaystyle W^{k,p}(\Omega)$ as
$i \to \infty$; namely, $\displaystyle f\in W^{k,p}_0(\Omega)$.
\end{lemma}

\begin{proof}
Since $K = \supp f$ is a compact subset of the open set $\Omega$,
there exists an open set $U$ such that
$K \subset U \subset \overline{U} \subset \Omega$.  Hence,
$\displaystyle d = \dist{K}{\partial U} > 0$. 

Choose $\displaystyle \phi \in \DD(\RR^n)$ such that
$\phi(\VEC{x}) = 0$ for $\|\VEC{x}\|>1$ and
$\displaystyle \int_{\RR^n} \phi(\VEC{x}) \dx{\VEC{x}} = 1$.
Let $\displaystyle \phi_i(\VEC{x}) = i^n\phi(i \VEC{x})$ for all
$\displaystyle \VEC{x} \in \RR^n$.
It follows from Lemmas~\ref{sob_denselem1} and
\ref{sob_denselem5} that 
$\displaystyle \underline{f} \ast \phi_i \in \DD(\RR^n)$ for all $i>0$
and
$\underline{f} \ast \phi_i \to \underline{f}$ in
$\displaystyle W^{k,p}(\RR^n)$ as $i \to \infty$.

Since $1/i \to 0$ as $i\to \infty$, there exists $J>0$ such that $1/i<d$
for $i > J$.  Let $\psi_i = \underline{f} \ast \phi_{i+J}$ for $i>0$.
We have that
\[
  \supp \psi_i \subset \supp f + \supp\, \phi_{i+J}
  \subset K + \overline{B_{1/(i+j)}(\VEC{0})}
  \subset \overline{U} \subset \Omega
\]
for all $i >0$ and
$\displaystyle \| \psi_i - f \|_{k,p,\Omega}
= \| \psi_i - \underline{f} \|_{k,p,\RR^n} \to 0$
as $i \to \infty$.
\end{proof}

\begin{rmk}
To illustrate the fact that proofs in mathematics are often not unique.
We give another proof of the previous lemma.

We expand $f$ to $\displaystyle \underline{f}:\RR^n\rightarrow \CC$ by
\[
\underline{f}(\VEC{x}) =
\begin{cases}
f(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \Omega \\
0 & \quad \text{if} \ \VEC{x} \in \RR^n \setminus \Omega
\end{cases}
\]
It follows from Proposition~\ref{sob_expand_WKP} that
$\displaystyle \underline{f} \in W^{k,p}(\RR^n)$.  Since
$\displaystyle \DD(\RR^n)$
is dense in $\displaystyle W^{k,p}(\RR^n)$, there exists a sequence
$\displaystyle \{\phi_i\}_{i=0}^\infty$ in 
$\displaystyle \DD(\RR^n)$ converging to $\underline{f}$ with respect
to the norm $\displaystyle \|\cdot\|_{k,p,\RR^n}$.

Choose $\phi \in \DD(\Omega)$ such that
$\phi(\VEC{x}) = 1$ for all $\VEC{x} \in \supp f$ \footnote{
See footnote on page~\pageref{FOOTNOTE1}.}.
It follows from Proposition~\ref{sob_T_dd_wkp} that
$\displaystyle \{\phi \, \phi_i\}_{i=0}^\infty$
converges to $\phi \,\underline{f}$ with respect to the norm
$\|\cdot\|_{k,p,\RR^n}$.  Thus,
$\displaystyle \{\phi \, \phi_i\}_{i=0}^\infty$
is a sequence in $\DD(\Omega)$ converging to
$\displaystyle \phi \,\underline{f}\big|_{\Omega} = f$ with respect to the norm
$\|\cdot\|_{k,p,\Omega}$.  Therefore
$\displaystyle f\in W^{k,p}_0(\Omega)$ by definition.
\end{rmk}

There is a converse to Proposition~\ref{sob_expand_WKP}.

\begin{prop} \label{sob_expand_WKP_Conv}
Consider $k\in \NN$ and $p$ a positive integer.  Let $\Omega$ be an
open subset of $\displaystyle \RR^n$ that satisfies the segment
property.  Given a function $f:\Omega \rightarrow \CC$,
we define a function $\displaystyle \underline{f}:\RR^n\rightarrow \CC$ by
\[
\underline{f}(\VEC{x}) =
\begin{cases}
f(\VEC{x}) & \quad \text{for} \quad \VEC{x} \in \Omega \\
0 & \quad \text{for} \quad \VEC{x} \not\in \Omega \\
\end{cases}
\]
Then, $\displaystyle f \in W^{k,p}_0(\Omega)$ if and only if
$\displaystyle \underline{f} \in W^{k,p}(\RR^n)$.
\end{prop}

\begin{proof}
We have proved in Proposition~\ref{sob_expand_WKP} that
$\displaystyle \underline{f} \in W^{k,p}(\RR^n)$ if
$\displaystyle f \in W^{k,p}_0(\Omega)$.  We now prove the converse.

\stage{i} We first assume that
$\displaystyle K = \supp f \subset \overline{\Omega}$ is compact.
Let
$\displaystyle Q = K \setminus \bigcup_{\VEC{x} \in \partial \Omega} U_{\VEC{x}}$,
where each bounded open set $U_{\VEC{x}}$ comes from the definition of
segment property.  We have that $Q \subset \Omega$ because
$\displaystyle \partial \Omega \subset \bigcup_{\VEC{x}
\in \partial \Omega} U_{\VEC{x}}$.
Hence, $Q$ is a compact subset of $\Omega$ because it is
bounded and closed.  Choose an open set $U$ such that
$Q \subset U \subset \overline{U} \subset \Omega$.
We get an open cover $\displaystyle \left\{U\right\} \cup
\big\{ \bigcup_{\VEC{x} \in \partial \Omega} U_{\VEC{x}} \big\}$ of $K$.
So, there exists a finite subcover of $K$ that we denote
$\displaystyle \left\{ U_i \right\}_{i=1}^I$.
At most one of the $U_i$ may have an empty intersection with $\partial \Omega$;
namely, the open set $U$ introduced before.

Let $\displaystyle \left\{ \phi_i \right\}_{i=1}^I$ be a partition
of unity of $K$ subordinate to $\displaystyle \left\{ U_i \right\}_{i=1}^I$

Suppose that $\displaystyle \underline{f} \in W^{k,p}(\RR^n)$.
Let $h_i \equiv \phi_i f$. Then
$\displaystyle \underline{h}_i = \phi_i \underline{f} \in W^{k,p}(\RR^n)$
according to Proposition~\ref{sob_T_dd_wkp}.
We can write $\underline{f}$ as
$\displaystyle \underline{f} = \sum_{i=0}^I \phi_i \underline{f}
= \sum_{i=1}^I \underline{h}_i$ where either
$\supp \underline{h}_i \subset U_i \subset \Omega$ (if $U_i = U$
mentioned above) or
$\supp \underline{h}_i \subset U_i \cap \overline{\Omega}$.
If we can prove that
$\displaystyle h_i \in W^{k,p}_0(\Omega)$ for all $i$, then we will
have that
$\displaystyle f = \sum_{i=0}^I h_i \in W^{k,p}_0(\Omega)$.

If $\supp h_i \subset \Omega$, we have that
$\displaystyle h_i \in W^{k,p}_0(\Omega)$ according to
Lemma~\ref{sob_w0_trad1}.

if $\supp \underline{h}_i \subset U_i \cap \overline{\Omega}$, we consider
$\displaystyle h_{i,t} \in W^{k,p}(\RR^n)$ for $0 < t < 1$ defined by
$h_{i,t}(\VEC{x}) = \underline{h}_i(\VEC{x} - t \VEC{y}_i)$.  We have that
$\supp h_{i,t} \subset \Omega$ for $0 < t < 1$ because
$\supp h_{i,t} \subset t\VEC{y}_i + U_i \cap \overline{\Omega} \subset \Omega$
for $0< t <1$.  It follows from Lemma~\ref{sob_w0_trad1} that
$\displaystyle h_{i,t} \in W^{k,p}_0(\Omega)$ for all $t$.

Since $h_{i,t} \to h_i$ in $\displaystyle W^{k,p}_0(\Omega)$ as $t \to 0^+$
according to Lemma~\ref{sob_denselem3}, and since 
$\displaystyle W^{k,p}_0(\Omega)$ is closed, we get that
$\displaystyle h_i \in W^{k,p}_0(\Omega)$.

\stage{ii}  If $\supp f$ is not bounded, we construct a sequence of functions
$\displaystyle \left\{ f_i \right\}_{i=1}^\infty \subset W^{k,p}(\Omega)$
as we did in (i) of the proof of Theorem~\ref{DDRRnDWkp}
\footnote{Take $\delta = 1/i$ in (i) of the proof of Theorem~\ref{DDRRnDWkp}.}
such that $\supp f_i$ is bounded and
$f_i \to f$ in $\displaystyle W^{k,p}(\Omega)$ as $i \to \infty$.

From (i), we have that $\displaystyle f_i \in W^{k,p}_0(\Omega)$.  Since
$f_i \to f$ in $\displaystyle W^{k,p}(\Omega)$ as $i \to \infty$, and since 
$\displaystyle W^{k,p}_0(\Omega)$ is closed, we get that
$\displaystyle f \in W^{k,p}_0(\Omega)$.
\end{proof}

\begin{egg}
As the following example shows,
$\displaystyle W^{k,2}_0(\Omega) \subsetneqq W^{k,2}(\Omega)$ when $\Omega$ is a
bounded open subset of $\displaystyle \RR^n$ and $k\geq 1$.

If $\Omega$ is bounded, we obviously have that $f:\Omega \to \RR$
defined by $f(\VEC{x}) = 1$ for all $\VEC{x} \in \Omega$ is in 
$\displaystyle W^{k,2}(\Omega)$.  We now show that
$\displaystyle f \not\in W_0^{k,2}(\Omega)$.  Since
$\displaystyle W_0^{k,2}(\Omega) \subset W_0^{1,1}(\Omega)$ because
$\Omega$ is bounded, it is in fact enough to
show that $\displaystyle f \not\in W_0^{1,1}(\Omega)$.

Suppose that $\displaystyle f \in W_0^{1,1}(\Omega)$.  Then, there
exists a sequence
$\displaystyle \{\phi_i\|_{i=1}^\infty \subset \DD(\Omega)$ such that
$\phi_i \to f$ with respect to the norm $\|\cdot\|_{1,1}$.
Since $\displaystyle \int_{\Omega} |\phi_i| \dx{\VEC{x}} < \infty$ and
$\displaystyle \sum_{j=1}^n \int_{\Omega} \left| \pdydx{\phi_i}{x_j}
\right| \dx{\VEC{x}} < \infty$ because
$\displaystyle \phi_i \in \DD(\Omega)$, there exists a positive constant $C_i$
such that
$\displaystyle \int_{\Omega} |\phi_i| \dx{\VEC{x}} < C_i
\sum_{j=1}^n \int_{\Omega} \left| \pdydx{\phi_i}{x_j}
\right| \dx{\VEC{x}}$.
We may assume that $C_i > 1$.
Hence,
\begin{align*}
\|f - \phi_i\|_{1,1}
&= \int_{\Omega} |f-\phi_i| \dx{\VEC{x}} + \sum_{j=1}^n \int_{\Omega}
\left| \pdydx{\phi_i}{x_j} \right| \dx{\VEC{x}}
\geq \int_{\Omega} |f| \dx{\VEC{x}} - \int_{\Omega} |\phi_i| \dx{\VEC{x}}
+ \sum_{j=1}^n \int_{\Omega}
\left| \pdydx{\phi_i}{x_j} \right| \dx{\VEC{x}} \\
&\geq \int_{\Omega} \dx{\VEC{x}} + \left( 1- C_i\right)
\sum_{j=1}^n \int_{\Omega} \left| \pdydx{\phi_i}{x_j} \right| \dx{\VEC{x}}
\geq \int_{\Omega} \dx{\VEC{x}} + \left(1 - C_i\right)
\|f - \phi_i\|_{1,1}
\end{align*}
for all $i$.  Thus,
\[
\|f - \phi_i\|_{1,1} \geq \frac{1}{C_i} \int_{\Omega} \dx{\VEC{x}}
\geq \int_{\Omega} \dx{\VEC{x}} >  0
\]
for all $i$.  This is a contradiction that
$\phi_i \to f$ with respect to the norm $\|\cdot\|_{1,1}$.

The previous reasoning can be easily modified to prove that
$\displaystyle W^{k,p}_0(\Omega) \subsetneqq W^{k,p}(\Omega)$ when $\Omega$ is a
bounded open subset of $\RR^n$ and $p,k\geq 1$.
\end{egg}

\section{The $\displaystyle H^{k,p}$ spaces} \label{WequalH}

We introduce in this section the spaces $\displaystyle H^{k,p}(\Omega)$ and
$\displaystyle H^{k,p}_0(\Omega)$ for $k \in \NN$ and
$1 \leq p \leq \infty$, and the spaces
$\displaystyle H^{s,2}(\Omega)$ and $\displaystyle H^{s,2}_0(\Omega)$
for $s\in \RR$.  We also prove that, except for $k=\infty$, the spaces
$\displaystyle H^{k,p}(\Omega)$ and $\displaystyle H^{k,p}_0(\Omega)$ are
none other than the the spaces
$\displaystyle W^{k,p}(\Omega)$ and $\displaystyle W^{k,p}_0(\Omega)$
respectively.

\begin{defn} \label{sob_H_spaces}
Assume that $k\in \NN$ and $p$ is a positive integer or $\infty$.
Let $\Omega$ be an open set in $\displaystyle \RR^n$ and
\[
S = \left\{ f \in C^k(\Omega) :  \|f\|_{k,p} < \infty \right\} \ ,
\]
where $\|\cdot\|_{k,p}$ is the norm defined in (\ref{sob_norm_wkp}).

The {\bfseries Sobolev space}\index{Sobolev Space!$H^{k,p}(\Omega)$}
$\displaystyle H^{k,p}(\Omega)$ is the closure of $S$ in
$\displaystyle L^p(\Omega)$ with respect to the norm $\|\cdot\|_{k,p}$.

The {\bfseries Sobolev space}\index{Sobolev Space!$H^{k,p}_0(\Omega)$}
$\displaystyle H^{k,p}_0(\Omega)$ is the closure of $\DD(\Omega)$ in
$\displaystyle L^p(\Omega)$ with respect to the norm $\|\cdot\|_{k,p}$.

Since the case $p=2$ is predominant in the study of partial
differential equations, we define
$\displaystyle H^k(\Omega) \equiv H^{k,2}(\Omega)$ and
$\displaystyle H^k_0(\Omega) \equiv H^{k,2}_0(\Omega)$.
\end{defn}

\begin{rmkList} \label{sob_compl_Hk2}
\begin{enumerate}
\item Let $\Omega$ be a bounded open subset of $\displaystyle \RR^n$.
An equivalent definition of $\displaystyle H^{k,p}(\Omega)$ for $p$ a
positive integer is that $\displaystyle H^{k,p}(\Omega)$ is the closure of
$\displaystyle C^\infty(\overline{\Omega})$ in $\displaystyle L^p(\Omega)$
with respect to the norm $\|\cdot\|_{k,p}$ defined in
(\ref{sob_norm_wkp}).

Let $H$ be the closure of $\displaystyle C^\infty(\overline{\Omega})$ in
$\displaystyle L^p(\Omega)$ with respect to the norm $\|\cdot\|_{k,p}$.
If $\displaystyle f\in C^\infty(\overline{\Omega})$, then
$\displaystyle \diff^\alpha f$ is a
continuous function on the compact set $\overline{\Omega}$ for all
multi-indices $\alpha$.  It follows that
$\displaystyle \|\diff^\alpha f\big|_{\Omega}\|_p \leq
\|\diff^\alpha f\big|_{\overline{\Omega}}\|_p < \infty$ for all
multi-indices $\alpha$.  Thus,
$\displaystyle \left\|f\big|_{\Omega} \right\|_{k,p} < \infty$ for all
$\displaystyle f\in C^\infty(\overline{\Omega})$.  Hence,
$\displaystyle C^\infty(\overline{\Omega}) \subset S$, where $S$ is given in
Definition~\ref{sob_H_spaces}.

However, it follows from Theorem~\ref{DDRRnDWkp} that
$\displaystyle C^\infty(\overline{\Omega})$ is dense in $S$ with
respect to the norm $\|\cdot\|_{k,p}$ \footnote{In fact
$\displaystyle C^\infty(\overline{\Omega})$
is dense in $\displaystyle W^{k,p}(\Omega) \supset S$ with respect to
$\|\cdot\|_{k,p}$.}.

Thus, the closure of $\displaystyle C^\infty(\overline{\Omega})$ in
$\displaystyle L^p(\Omega)$ with respect to $\|\cdot\|_{k,p}$
is the closure of $S$ in $\displaystyle L^p(\Omega)$
with respect to $\|\cdot\|_{k,p}$.

\item As well, an equivalent definition of
$\displaystyle H^{k,p}_0(\Omega)$ is that
$\displaystyle H^{k,p}_0(\Omega)$ is the
closure of $\displaystyle C^k_c(\Omega)$ in $\displaystyle L^p(\Omega)$
with respect to the norm $\|\cdot\|_{k,p}$ defined in
(\ref{sob_norm_wkp}).

Given $\displaystyle f \in C^k_c(\Omega)$, it follows from
Lemma~\ref{sob_w0_trad1} that there exists a sequence
$\displaystyle \left\{ \psi_i \right\}_{i=1}^\infty \subset \DD(\Omega)$
such that $\psi_i \to f$ in $\displaystyle W^{k,p}(\Omega)$ as $i \to \infty$.
Thus, $\displaystyle C^k_c(\Omega) \subset \overline{\DD(\Omega)}$,
where the closure is with respect to the norm $\|\cdot\|_{k,p}$.
It follows that the closure of $\displaystyle C^k_c(\Omega)$ in
$\displaystyle L^p(\Omega)$ with respect to $\|\cdot\|_{k,p}$
is included in $\displaystyle H^{k,p}_0(\Omega)$, the closure of
$\DD(\Omega)$ in $\displaystyle L^p(\Omega)$
with respect to $\|\cdot\|_{k,p}$.

But since $\DD(\Omega) \subset C^k_c(\Omega$, we also have that
$\displaystyle H^{k,p}_0(\Omega)$, the closure of
$\displaystyle \DD(\Omega)$ in $\displaystyle L^p(\Omega)$ with
respect to $\|\cdot\|_{k,p}$, is included in the closure of
$\displaystyle C^k_c(\Omega)$ in
$\displaystyle L^p(\Omega)$ with respect to $\|\cdot\|_{k,p}$ 
Thus, the closure of $\displaystyle C^k_c(\Omega)$ in
$\displaystyle L^p(\Omega)$ with respect to $\|\cdot\|_{k,p}$
is $\displaystyle H^{k,p}_0(\Omega)$.
\end{enumerate}
\end{rmkList}

\begin{prop} \label{sob_WcontainsH}
Let $\Omega$ be an open subset of $\RR^n$.  If
$k\in \NN$ and $p$ is a positive integer or $\infty$, then
$\displaystyle H^{k,p}(\Omega) \subset W^{k,p}(\Omega)$ and
$\displaystyle H^{k,p}_0(\Omega) = W^{k,p}_0(\Omega)$.
\end{prop}

\begin{proof}
That $\displaystyle H^{k,p}_0(\Omega) = W^{k,p}_0(\Omega)$ is simple
to proof because the closure of $\DD(\Omega)$ in $\displaystyle L^p(\Omega)$ or
$\displaystyle W^{k,p}(\Omega)\subset L^p(\Omega)$ with respect to the
norm $\|\cdot\|_{k,p}$ give the same
set since $\displaystyle W^{k,p}(\Omega)$ is closed with respect to this norm.
Recall that $\displaystyle W^{k,p}(\Omega)$ is a Banach space with
respect to the norm 
$\|\cdot\|_{k,p}$, so $\displaystyle W^{k,p}(\Omega)$ is complete and
thus closed with respect to this norm.

To prove that $\displaystyle H^{k,p}(\Omega) \subset W^{k,p}(\Omega)$,
we first note that $S$ in the definition of
$\displaystyle H^{k,p}(\Omega)$ is a subset of
$\displaystyle W^{k,p}(\Omega)$.  Again, Since
$\displaystyle W^{k,p}(\Omega)$ is closed, we have that
$\displaystyle H^{k,p}(\Omega) = \overline{S} \subset W^{k,p}(\Omega)$,
where the closure is with respect to the norm $\|\cdot\|_{k,p}$.
\end{proof}

The first question that comes to mind is whether
$\displaystyle W^{k,p}(\Omega) = H^{k,p}(\Omega)$ whatever the open set
$\Omega \subset \RR^n$.  The answer is positive for
$1\leq p < \infty$.  However, it is not always true for $p=\infty$.

\begin{theorem} \label{sob_HequalsW}
If $\displaystyle \Omega \subset \RR^n$ is an open set, $k\in \NN$ and $p$ is a
positive integer, then $\displaystyle H^{k,p}(\Omega) = W^{k,p}(\Omega)$.
\end{theorem}

\begin{proof}
$\displaystyle H^{k,p}(\Omega) \subset W^{k,p}(\Omega)$ follows from
Proposition~\ref{sob_WcontainsH}.  The converse inclusion comes from
Theorem~\ref{sob_Cinfty_dense} because $S$ in the definition of
$\displaystyle H^{k,p}(\Omega)$ contains
$\displaystyle C^\infty(\Omega) \cap W^{k,p}(\Omega)$.
\end{proof}

\begin{egg}
We have that
$\displaystyle H^{1,\infty}(]-1,1[) \subsetneqq W^{1,\infty}(]-1,1[)$.

The function $f(x) = |x|$ is in $\displaystyle W^{1,\infty}(]-1,1[)$.
In particular,
\[
\diff f(x) =
\begin{cases}
-1 & \quad \text{for} \quad x <0 \\
c & \quad \text{for} \quad x =0 \\
1 & \quad \text{for} \quad x >0 \\
\end{cases}
\]
where $c$ can be any constant of your choice.  However, it is
impossible to find
\[
\phi \in
\left\{ g \in C^1(]-1,1[) :  \|g\|_{1,\infty} < \infty \right\}
\]
such that
\[
\| f- \phi \|_{1,\infty} = \sup_{x\in]-1,1[} |f(x)-\phi(x)|
+ \sup_{x\in]-1,1[} |\diff f(x)-\diff \phi(x)| < 1 \  .
\]
If $\diff \phi(0)=b \in \RR$, then either
$\displaystyle \lim_{x\rightarrow 0^-}|\diff f(x)-\diff \phi(x)|
= |-1-b| \geq 1$ or
$\displaystyle \lim_{x\rightarrow 0^+}|\diff f(x)-\diff \phi(x)| =|1-b| \geq 1$.
Recall also that the uniform limit of continuous functions on
$]-1,1[$ is a continuous function.  Thus, if
$\displaystyle \left\{\phi_j\right\}_{j=0}^\infty$ was to converge in
$\displaystyle W^{1,\infty}(]-1,1[)$ to $f$, then
$\displaystyle \{\diff \phi_j\}_{j=1}^\infty$ would be converging
uniformly to $\diff f$ in $]-1,1[$.  It would follow that the limit
$\diff f$ will be continuous at the origin.  This is not so for $\diff f$.
\end{egg}

\begin{defn}
To obtain a consistent notation (with many textbook on Sobolev spaces), we set
$\displaystyle H^{s,2}(\Omega) = W^{s,2}(\Omega)$ for $s \in \RR$.
Moreover, the {\bfseries Sobolev space}\index{Sobolev Space!$H^{s,2}_0(\Omega)$}
$\displaystyle H^{s,2}_0(\Omega)$ is the completion of
$\DD(\Omega)$ in $\displaystyle H^{s,2}(\Omega)$.
\end{defn}

Because of Theorem~\ref{sob_wk2_wk2}, the definition of 
$\displaystyle H^{k,2}_0(\Omega)$ for $k \in \NN$ above is equivalent
to the definition of $\displaystyle H^{k,2}_0(\Omega)$ given in
Definition~\ref{sob_H_spaces}.

\section{Sobolev Spaces on Manifolds}

We can define Sobolev spaces on subset of $\displaystyle \RR^n$ other
than open sets.

\begin{defn} \label{sob_manifold}
Let $\displaystyle M\subset \RR^n$ be a $\displaystyle C^k$-manifold
of dimension $m$ (without a boundary).  Let
$\displaystyle \BB = \{ (,U_j,\psi_j) \}_{j=1}^\infty$ be an atlas for
$M$ as defined in Section~\ref{pot_int_man}.
Let $\displaystyle \{\phi_i\}_{i=1}^\infty$ be a partition of unity
for $M$ subordinate to $\BB$.  The space
$\displaystyle W^{k,2}(M)$ is defined by 
\[
W^{k,2}(M) = \left\{ f \in L^2(M) : (\phi_i f) \circ \psi_i^{-1} \in
W^{k,2}_{loc}(\psi_i(U_i)) \ , \ 0<i<\infty \right\} \ .
\]
\end{defn}

For this definition to make sense, it has to be independent of the
atlas used for the manifold $M$.  This is a consequence of the
following proposition.

\begin{prop} \label{sob_cv}
Suppose that $\Omega_1$ and $\Omega_2$ are two bounded open subsets of
$\displaystyle \RR^n$, and that $\chi$ is a
$\displaystyle C^k$-diffeomorphism of $\Omega_1$ onto $\Omega_2$ \footnotemark.
\begin{enumerate}
\item Then, $\displaystyle T:W_{loc}^{s,2}(\Omega_1) \to
 W_{loc}^{s,2}(\Omega_2)$ defined by
$\displaystyle T(u) = u \circ \chi^{-1}$ for
$\displaystyle u \in W_{loc}^{s,2}(\Omega_1)$ is an
isomorphism with inverse defined by
$\displaystyle T^{-1}(v) = v \circ \chi$ for all
$\displaystyle v \in W_{loc}^{s,2}(\Omega_2)$.
\item If in addition all the partial derivatives of $\chi$ and
$\displaystyle \chi^{-1}$ of order less or equal to $k$ are bounded, then
$\displaystyle T:W^{k,p}(\Omega_1) \to W^{k,p}(\Omega_2)$ defined by
$\displaystyle T(u) = u \circ \chi^{-1}$ for
$\displaystyle u \in W^{k,p}(\Omega_1)$
is an isomorphism with inverse defined by
$\displaystyle T^{-1}(v) = v \circ \chi$ for all
$\displaystyle v \in W^{k,p}(\Omega_2)$.
This result is also true if 
$\displaystyle W^{k,p}(\Omega_1)$ and $\displaystyle v \in W^{k,p}(\Omega_2)$
are respectively replaced by $\displaystyle v \in W^{k,p}_0(\Omega_1)$
and $\displaystyle v \in W^{k,p}_0(\Omega_2)$.
\end{enumerate}
\end{prop}

\footnotetext{Namely, $\chi:\Omega_1 \to \Omega_2$ is an homeomorphism,
and $\chi:\Omega_1 \to \Omega_2$ and
$\displaystyle \chi^{-1}:\Omega_2 \to \Omega_1$
are of class $C^k$.}

\begin{proof}
A proof of the first item is given in Proposition~25.8 of \cite{Tr}.

A proof of the second item is given in Propositions~24.6 and 24.7 of
\cite{Tr}, and in Theorem~3.41 of \cite{Ad}.
This proof uses the result of Theorem~\ref{sob_Cinfty_dense} and the
classical formula for the change of variables in integrals.
\end{proof}

The concept of Sobolev spaces on manifolds is really important for
some problems in applied mathematics, particularly in physics.
However, we will make very little use of Sobolev spaces on manifolds in this
book.  For more details about Sobolev spaces on Manifold, the reader
should consult Chapter~25 of \cite{Tr}.

\section{Dual Spaces} \label{sobDualSp}

\begin{defn}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$.  The
{\bfseries dual}\index{Sobolev Space!Dual Space} of the space
$\displaystyle H^{s,2}_0(\Omega)$ is the space
$\displaystyle H^{-s,2}(\Omega)$ of all bounded
linear functionals on $\displaystyle H^{s,2}_0(\Omega)$.
\end{defn}

\begin{rmk}
If $\displaystyle \Omega = \RR^n$ or $\Omega$ is a compact manifold
(without boundary), we then have
that $\displaystyle H^{k,2}(\Omega) = H^{k,2}_0(\Omega)$ and
$\displaystyle H^{-k,2}(\Omega)$ is
the dual space of $\displaystyle H^{k,2}(\Omega)$; namely,
$\displaystyle H^{-k,2}(\Omega)$ is the
set of all bounded linear functionals on $\displaystyle H^{k,2}(\Omega)$
\end{rmk}

It may seem from the definition above that we have two definitions
of $\displaystyle H^{s,2}(\RR^n)$ for $s < 0$: the definition above
and Definition~\ref{sob_2nd_wk2}.  We now show that it is not so and,
in this process, show that the dual space of $\displaystyle H^{s,2}(\RR^n)$
for $s\geq 0$ is the space $\displaystyle H^{-s,2}(\RR^n)$.

\begin{prop}
For $\displaystyle s \in \RR$, the dual of
$\displaystyle H^{s,2}(\RR^n)$ is canonically isomorphic 
to $\displaystyle H^{-s,2}(\RR^n)$.
\end{prop}

\begin{proof}
As we did in the proof of Theorem~\ref{DDRRnDWs2}, we consider the operator
\begin{align*}
T^{[s]} : H^{s,2}(\RR^n) & \to L^2(\RR^n) \\
f &\mapsto \F^{-1}\big((1+\|\VEC{y}\|_2^2)^{s/2} \F(f) \big)  
\end{align*}
We saw that it is an isometry.  We also consider the injection
\begin{align*}
i : \DD(\RR^n) & \to H^{s,2}(\RR^n) \\
\phi &\mapsto \phi
\end{align*}
It is easy to see that $i$ is a continuous mapping \footnote{It is a
good exercise to test the reader understanding of the topology on
$\displaystyle \D(\RR^n)$.}.
It is also easy to verify that the adjoint of $i$ is the mapping
\begin{align*}
i^\ast : \big(H^{s,2}(\RR^n)\big)^\ast & \to \DD'(\RR^n) \\
f &\mapsto f
\end{align*}
The transpose of the sequence
\[
\begin{CD}
\DD(\RR^n) @>i>> H^{s,2}(\RR^n) @>T^{[s]}>> L^2(\RR^n)
\end{CD}
\]
is the sequence
\[
\begin{CD}
L^2(\RR^n) @>(T^{[s]})^\ast>> \big(H^{s,2}(\RR^n)\big)^\ast @>i^\ast>>
 \DD'(\RR^n)  \ ,
\end{CD}
\]
because the dual of $\displaystyle L^2(\RR^n)$ is $\displaystyle L^2(\RR^n)$
and $\displaystyle \DD'(\RR^n)$ is the dual of
$\displaystyle \DD(\RR^n)$ by definition; namely,
$\displaystyle \DD'(\RR^n)$ is the space of continuous linear
functionals on $\displaystyle \DD(\RR^n)$.

For $\displaystyle \phi \in \SS(\RR^n) \subset H^{s,2}(\RR^n)$ and
$\psi \in \SS(\RR^n) \subset (L^2(\RR^n))^\ast = L^2(\RR^n)$, we have that
\begin{align*}
\psi\left(T^{[s]}(\phi)\right)
&= \int_{\RR^n}  \left( \int_{\RR^n} e^{i\VEC{z}\cdot \VEC{y}} \left(
(1+\|\VEC{y}\|_2^2)^{s/2} \int_{\RR^n} e^{-i \VEC{y}\cdot\VEC{x}}
\phi(\VEC{x}) \dx{\mu(\VEC{x})} \right) \dx{\mu(\VEC{y})} \right)
\psi(\VEC{z}) \dx{\VEC{z}} \\
&= \int_{\RR^n}  \left( \int_{\RR^n} e^{-i\VEC{x}\cdot \VEC{y}} \left(
(1+\|\VEC{y}\|_2^2)^{s/2} \int_{\RR^n} e^{i \VEC{y}\cdot\VEC{z}}
\psi(\VEC{z}) \dx{\mu(\VEC{z})} \right) \dx{\mu(\VEC{y})} \right)
\phi(\VEC{x}) \dx{\VEC{x}} \\
&= \int_{\RR^n}  \left( \int_{\RR^n} e^{i\VEC{x}\cdot \VEC{y}} \left(
(1+\|\VEC{y}\|_2^2)^{s/2} \int_{\RR^n} e^{-i \VEC{y}\cdot\VEC{z}}
\psi(\VEC{z}) \dx{\mu(\VEC{z})} \right) \dx{\mu(\VEC{y})} \right)
\phi(\VEC{x}) \dx{\VEC{x}} \\
&= (T^{[s]}(\psi))(\phi) \ ,
\end{align*}
where we have used the substitution $\VEC{y} \to -\VEC{y}$ to obtain
the second to last equality.
Since $\displaystyle \SS(\RR^n)$ is dense in $\displaystyle H^{s,2}(\RR^n)$ and
in $\displaystyle L^2(\RR^n)$, we get that 
$\displaystyle (T^{[s]})^\ast = T^{[s]}$.

Since $\displaystyle T^{[s]}$ is an isometry of $\displaystyle H^{s,2}(\RR^n)$
onto $\displaystyle L^2(\RR^n)$, we have that
$\displaystyle (T^{[s]})^\ast$ is an isometry of 
$\displaystyle L^2(\RR^n)$ onto
$\displaystyle \big((H^{s,2}(\RR^n)\big)^\ast$
\footnote{We leave it to the reader to verify that the adjoint of a
surjective isometry is a surjective isometry.}.  So,
$\displaystyle T^{[s]} = (T^{[s]})^\ast$ is an isometry of 
$\displaystyle L^2(\RR^n)$ onto $\displaystyle \big((H^{s,2}(\RR^n)\big)^\ast$.

For $\displaystyle \phi \in \SS(\RR^n)$, we have that
\begin{align*}
\left\| T^{[s]}(\phi)\right\|_{-s,\rho}^2
&= \int_{\RR^n} (1+\|\VEC{z}\|_2^2)^{-s}
\left| \F\left( \F^{-1}\left( (1+\|\VEC{y}\|_2^2)^{s/2} \F(\phi)\right)\right)(\VEC{z})
\right|^2 \dx{\VEC{z}} \\
&= \int_{\RR^n} \left| \F(\phi) (\VEC{z}) \right|^2 \dx{\VEC{z}}
= \left\| \F(\phi) \right\|_2^2 = \|\phi\|_2^2 \ ,
\end{align*}
where we have used Plancherel theorem,
Theorem~\ref{distr_plancherel}, to obtain the last equality.
Hence, $\displaystyle T^{[s]}\left(L^2(\RR^n)\right) \subset H^{-s,2}(\RR^n)
\subset \big(H^{s,2}(\RR^n)\big)^\ast$ since $\displaystyle
\SS(\RR^n)$ is dense in $\displaystyle L^2(\RR^n)$.  It follows that
$\displaystyle T^{[s]}$ is an isometry of 
$\displaystyle L^2(\RR^n)$ onto $\displaystyle H^{-s,2}(\RR^n)$.

To be thorough, we shall probably prove our previous claim that
$\displaystyle H^{-s,2}(\RR^n) \subset \big(H^{s,2}(\RR^n)\big)^\ast$.
This is a consequence of the following observation.
Given $\displaystyle f \in H^{-s,2}(\RR^n)$, we have that
\begin{align*}
|f(g)| &= \left| \int_{\RR^n} f(\VEC{x}) g(\VEC{x}) \dx{\VEC{x}} \right|
= \left| \int_{\RR^n} \hat{f}(\VEC{y}) \hat{g}(\VEC{x}) \dx{\VEC{x}} \right| \\
&= \left| \int_{\RR^n} \big( (1+\|\VEC{y}\|_2^2)^{-s/2}\hat{f}(\VEC{y})\big)
\big( (1+\|\VEC{y}\|_2^2)^{s/2} \hat{g}(\VEC{y}) \big) \dx{\VEC{y}} \right| \\
&\leq \left( \int_{\RR^n} (1+\|\VEC{y}\|_2^2)^{-s}
\left|\hat{f}(\VEC{y})\right|^2 \dx{\VEC{y}} \right)^{1/2}
\left( \int_{\RR^n} (1+\|\VEC{y}\|_2^2)^s\left|\hat{g}(\VEC{y})\right|^2
\dx{\VEC{y}} \right)^{1/2}
= \left\| f\right\|_{-s,\rho} \left\| g \right\|_{s,\rho} 
\end{align*}
for all $\displaystyle g \in H^{s,2}(\RR^n)$, where the second
equality comes from Plancherel theorem,
Theorem~\ref{distr_plancherel}, and the inequality comes from Schwarz
inequality.
\end{proof}

It is possible to describe the elements of the dual space
$\displaystyle H^{-k,2}(\Omega)$.

\begin{theorem}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$.  Every
$\displaystyle F\in H^{-k,2}(\Omega)$ can be expressed as
\begin{equation} \label{sob_dual_form}
\ps{F}{f} = F(f) = \sum_{|\alpha|\leq k} \int_\Omega F_\alpha \,\diff^\alpha f
\end{equation}
for all $\displaystyle f \in H^{k,2}_0(\Omega)$, where the $F_\alpha$
are some functions in $\displaystyle L^2(\Omega)$.
\end{theorem}

\begin{rmk}
Since $\DD(\Omega)$ is dense in $\displaystyle H^{k,2}_0(\Omega)$,
(\ref{sob_dual_form}) is equivalent to
$\displaystyle F = \sum_{|\alpha|\leq k} (-1)^\alpha \diff^\alpha F_\alpha$
in the sense of distribution.
\end{rmk}

\begin{proof}
Let $\displaystyle \left\{ \alpha_1, \alpha_2, \ldots, \alpha_N \right\}$,
where $\displaystyle N = \sum_{|\alpha|\leq k} 1$, be an ordering of
the multi-indices $\displaystyle \alpha \in \NN^n$ such that $|\alpha|\leq k$.
Consider the mapping
\begin{align*}
T: H^{k,2}_0(\Omega) & \rightarrow (L^2(\Omega))^N \\
f &\mapsto \left( \diff^{\alpha_1} f , \diff^{\alpha_2} f, \ldots,
\diff^{\alpha_N} f \right)
\end{align*}
where $\displaystyle (L^2(\Omega))^N$ is an Hilbert space with the
scalar product defined by
$\displaystyle \ps{\VEC{f}}{\VEC{g}}_2 =
\sum_{j=0}^N \int_\Omega f_{\alpha_j} g_{\alpha_j}$
for all $\displaystyle \VEC{f}, \VEC{g} \in (L^2(\Omega))^N$.
$T$ is a linear mapping preserving the norm if the norm on
$\displaystyle (L^2(\Omega))^N$ is the norm induced by the scalar
product; namely,
$\displaystyle \| \VEC{f} \|_2 =
\left( \sum_{j=0}^N \| f_{\alpha_j} \|_2^2 \right)^{1/2}$
for all $\displaystyle \VEC{f} \in (L^2(\Omega))^N$.
Let $\displaystyle R = T(H^{k,2}_0(\Omega))$.  Since $T$ preserves the
norm (so $T$ is a closed mapping), $R$ is a closed subspace of
$\displaystyle (L^2(\Omega))^N$.  Moreover,
$\displaystyle T:H^{k,2}_0(\Omega) \rightarrow R$ is invertible.  Let
$S:R\rightarrow H^{k,2}_0(\Omega)$ be the inverse of $T$.  $S$ is
an isometry and so a bounded linear mapping.

Consider the bounded linear functional
\begin{align*}
P:R &\rightarrow \RR \\
g &\mapsto  F(S(g)) = \ps{F}{S(g)}
\end{align*}
Using Hahn-Banach theorem, we can obtain a bounded linear functional
$\displaystyle Q: (L^2(\Omega))^N \rightarrow \RR$ such that
$\displaystyle Q\big|_R = P$ and $\|Q\| = \|P\|$; the norm of the
operators is induced by the norm $\|\cdot\|_2$ on
$\displaystyle (L^2(\Omega))^N$.

Using Riesz representation theorem, there exist
$\displaystyle F_\alpha \in L^2(\Omega)$ for $|\alpha|\leq k$ such that
\[
\ps{F}{f} = \ps{Q}{T(f)} = Q(T(f))
= \sum_{j=0}^N \int_\Omega F_{\alpha_j} \diff^\alpha f 
\]
for all $\displaystyle f \in H^{k,2}_0(\Omega)$.
\end{proof}

\section{Extension}

Let $\Omega$ be an open subset of $\displaystyle \RR^n$.  The space
$\displaystyle W_0^{k,2}(\Omega)$ can always be extended to
$\displaystyle W^{k,2}(\RR^n)$.  If 
$\displaystyle f\in W_0^{k,2}(\Omega)$, we define $f(\VEC{x}) =0$ for
$\displaystyle \VEC{x} \in \RR^n\setminus \Omega$ to get
 $\displaystyle f \in W^{k,2}(\RR)$.
The element of $\displaystyle W_0^{k,2}(\Omega)$ are the elements of
$\displaystyle W^{k,2}(\RR)$
which are the limit with respect to the norm $\|\cdot\|_{k,2}$ of test
functions with compact support in $\Omega$.

Since it is generally simpler to work with $\displaystyle W^{k,2}(\RR^n)$
than with $\displaystyle W^{k,2}(\Omega)$, where $\Omega$ is a bounded
domain in $\displaystyle \RR^n$, it should be useful to determine under which
conditions $\displaystyle W^{k,2}(\Omega)$ 
may be extended to a subspace of $\displaystyle W^{k,2}(\RR^n)$.

The concept of extension is also important when we have boundary
conditions.  It may be easier to deal with boundary conditions imposed on
functions defined on $\displaystyle \RR^n$ instead of functions
defined on a bounded open set $\Omega$.

\begin{defn} \label{sob_k_ext_prop}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$.  Let $E$ be a linear
operator from the space of measurable functions on $\Omega$ to the
space of measurable function on $\displaystyle \RR^n$.
\begin{enumerate}
\item $E$ is called a
{\bfseries $\mathbf{(k,p)}$-extension operator}%
\index{Sobolev Space!$\mathbf{(k,p)}$-Extension Operator}
on $\Omega$ if the restriction of $E$ to $\displaystyle W^{k,p}(\Omega)$
is a bounded linear mapping
$\displaystyle E:W^{k,p}(\Omega) \rightarrow W^{k,p}(\RR^n)$ such that
$\displaystyle E(f)\big|_{\Omega} = f$ for all
$\displaystyle f\in W^{k,p}(\Omega)$.
If $\Omega$ has an $(k,p)$-extension operator, we say that $\Omega$ 
has the {\bfseries $\mathbf{(k,p)}$-extension property}%
\index{Sobolev Space!$\mathbf{(k,p)}$-Extension Property}.
\item $E$ is called a {\bfseries strong $\mathbf{k}$-extension operator}%
\index{Sobolev Space!Strong $\mathbf{k}$-Extension Operator}
on $\Omega$ if, for all $0\leq m\leq k$ and $0 < p < \infty$, the
restriction of $E$ to $\displaystyle W^{m,p}(\Omega)$ is a
$(m,p)$-extension operator on $\Omega$.
If $\Omega$ has a strong $k$-extension operator, we say that $\Omega$ 
has the {\bfseries strong $\mathbf{k}$-extension property}%
\index{Sobolev Space!Strong $\mathbf{k}$-Extension Property}..
\item $E$ is called a {\bfseries total extension operator}%
\index{Sobolev Space!Total Extension Operator}.on $\Omega$
if it is a strong $k$-extension operator for every $k \geq 0$.
\end{enumerate}
\end{defn}

The next proposition gives a simple example of how the concept of
extension can be used.  It is Theorem~\ref{DDRRnDWkp} for $p=2$.

\begin{theorem} \label{sob_dense_ext_H}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$ with the
$(k,2)$-extension property.  Then
$\displaystyle \DD(\RR^n)\big|_{\Omega}$ is dense in
$\displaystyle W^{k,2}(\Omega)$ with respect to the norm $\|\cdot\|_{k,2}$.
\end{theorem}

\begin{proof}
We have from Theorem~\ref{DDRRnDWs2} that $\DD(\RR^n)$ is dense in
$\displaystyle W^{k,2}(\RR^n) \supset E(W^{k,2}(\Omega))$.

Given $\displaystyle f\in W^{k,2}(\Omega)$, suppose that
$\displaystyle \{\phi_j\}_{j=0}^\infty \subset \DD(\RR^n)$ converges
to $E(f)$ with respect to the norm $\|\cdot\|_{k,2,\RR^n}$.  Then,
$\phi_j\big|_\Omega \rightarrow f$ in
$\displaystyle W^{k,2}(\Omega)$ with respect
to the norm $\|\cdot\|_{k,2,\Omega}$ as $j\rightarrow \infty$
according to Lemma~\ref{sobVsubsetU}.
\end{proof}

A first example of an open subset of $\displaystyle \RR^n$ with a
total extension operator is given by the following theorem.

\begin{theorem} \label{sob_Rp_ext}
There exists a strong $k$-extension operator $E$ on
$\displaystyle \RR^n_+ \equiv \{ \VEC{x} \in \RR^n : x_n>0 \}$.
Given $\displaystyle f \in W^{k,p}(\RR^n_+)$,
\[
\supp E(f) \subset \supp f \cup 
\left( \bigcup_{j=1}^{k+1} \left\{
(x_1,x_2,\ldots,x_{n-1},-(1/j)x_n): \VEC{x} \in \supp f \right\} \right) \ .
\]
Moreover, for all multi-indices $\alpha$ such that $|\alpha|\leq k$,
there exists a strong $(k-|\alpha|)$-extension operator $E_\alpha$ on
$\displaystyle \RR^n_+$ such that
$\displaystyle \diff^\alpha (E(f)) = E_\alpha(\diff^\alpha f)$ for all
$\displaystyle f \in W^{k,p}(\RR^n_+)$.
\end{theorem}

\begin{rmk}
It is also useful to define for later use the sets
$\displaystyle \RR^n_0 = \{ \VEC{x} \in \RR^n : x_n=0 \}$ and
$\displaystyle \RR^n_- = \{ \VEC{x} \in \RR^n : x_n<0 \}$.
\end{rmk}

\begin{proof}
Let $\displaystyle \VEC{a} \in \RR^{k+1}$ be the unique solution of
the linear equation $A \VEC{a} = \VEC{u}$, where $A$ is the
Vandermonde matrix defined by $\displaystyle A_{i,j} = (-j)^{i-1}$ for
$1 \leq i,j \leq k+1$ and $u_j = 1$ for $1 \leq j \leq k+1$.  The
$a_j$ will be used in the definition of the extension operators $E$
and $E_\alpha$ to ensure that $E(\phi)$ and $E_\alpha(\phi)$ are
sufficiently differentiable functions on $\displaystyle \RR^n$.

Let
\[
E(\phi)(\VEC{x})
= \begin{cases}
\phi(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \RR^n_+ \cup \RR^n_0 \\
\displaystyle \sum_{j=1}^{k+1} a_j \phi(\breve{\VEC{x}},-jx_n)
& \quad \text{if} \ \VEC{x} \in \RR^n_-
\end{cases}
\]
and
\[
E_\alpha(\phi)(\VEC{x})
= \begin{cases}
\phi(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \RR^n_+ \cup \RR^n_0 \\
\displaystyle \sum_{j=1}^{k+1} (-j)^{\alpha_n} a_j \phi(\breve{\VEC{x}},-jx_n)
& \quad \text{if} \ \VEC{x} \in \RR^n_-
\end{cases}
\]
for $\displaystyle \phi \in S = \{ \phi\big|_{\RR^n_+ \cup \RR^n_0} :
\phi \in \DD(\RR^n) \}$,
where $\breve{\VEC{x}} = (x_1,x_2,\ldots, x_{n-1})$ for all
$\VEC{x} \in \RR^n$ and $m \leq k$ is arbitrary but fixed.  We prove
that these operators satisfy that statement of the theorem.

We have that $E(\phi)$ is of class $\displaystyle C^m$ on
$\displaystyle \RR^n_+ \cup \RR^n_-$ for all $\phi \in S$.
Moreover,
\[
\diff^\alpha (E(\phi))(\VEC{x}) 
= \sum_{j=1}^{k+1} (-j)^{\alpha_n} a_j (\diff^{\alpha} \phi)
(\breve{\VEC{x}},-jx_n)
= E_\alpha(\diff^\alpha \phi)(\VEC{x}))
\]
for $|\alpha| \leq m$ and $\displaystyle \VEC{x} \in \RR^n_-$ and obviously
\[
\diff^\alpha (E(\phi))(\VEC{x}) = E_\alpha(\diff^\alpha \phi)(\VEC{x}))
= \diff^\alpha \phi (\VEC{x})
\]
for $|\alpha| \leq m$ and $\displaystyle \VEC{x} \in \RR^n_+$.  Moreover,
we have that
\[
\lim_{\substack{\VEC{x}\to (\breve{\VEC{z}},0)\\x_n<0}}
\diff^\alpha (E(\phi))(\VEC{x}) 
= \sum_{j=1}^{k+1} (-j)^{\alpha_n} a_j
\bigg( \lim_{\substack{\VEC{x}\to (\breve{\VEC{z}},0)\\x_n>0}}
(\diff^{\alpha} \phi)(\VEC{x}) \bigg) =
\lim_{\substack{\VEC{x}\to (\breve{\VEC{z}},0)\\x_n>0}}
\diff^\alpha (E(\phi))(\VEC{x})
\]
for $|\alpha| \leq m$
because $\displaystyle \sum_{j=1}^{k+1} (-j)^{\alpha_n}a_j = 1$ for
$0 \leq \alpha_n \leq m \leq k$.  Thus, $E(\phi) \in C^m(\RR^n)$ for
$\phi \in S$.

To prove that $E$ is a bounded linear operator, we note that
\begin{align*}
\| E(\phi) \|_{m,p,\RR^n}
&= \left( \sum_{|\alpha|\leq m} \|\diff^\alpha E(\phi)\|_p^p \right)^{1/p}
= \left( \sum_{|\alpha|\leq m} \int_{\RR^n}
\left|\diff^\alpha (E(\phi))(\VEC{x}) \right|^p \dx{\VEC{x}} \right)^{1/p} \\
&= \left( \sum_{|\alpha|\leq m} \left( \int_{\RR^n_+}
\left|\diff^\alpha \phi(\VEC{x}) \right|^p \dx{\VEC{x}}
+ \int_{\RR^n_-} \left|\sum_{j=1}^{k+1} (-j)^{\alpha_n} a_j
\diff^\alpha \phi(\breve{\VEC{x}},-j x_n)\right|^p \dx{\VEC{x}}
\right) \right)^{1/p} \\
&\leq \bigg( \sum_{|\alpha|\leq m} \bigg( \int_{\RR^n_+}
\left|\diff^\alpha \phi(\VEC{x}) \right|^p \dx{\VEC{x}} \\
&\qquad + \sum_{\substack{0\leq s_1 \leq s_2 \leq \ldots \leq s_p \leq p\\
  s_1+s_2+\ldots+s_p = p\\
  1\leq j_1 < j_2 < \ldots <j_p \leq k+1}} c_{s_1,s_2,\ldots,s_p}
  \int_{\RR^n_+} \prod_{i=1}^p \left| (-j_i)^{\alpha_n} \diff^\alpha
\phi(\breve{\VEC{x}},-j_i x_n)\right|^{s_i} \dx{\VEC{x}}
\bigg) \bigg)^{1/p} \ ,
\end{align*}
where the $c_{s_1,s_2,\ldots,s_p} \geq 0$ are constants.
In the previous relation and those that follow below, we assume that
factors with $j_i=0$ are removed from the products.

Using the generalized Hlder's inequality with
$\displaystyle \sum_{i=1}^p \frac{1}{p/s_i} = 1$, we get
\begin{align*}
&\int_{\RR^n_+} \prod_{i=1}^p \left| (-j_i)^{\alpha_n} \diff^\alpha
\phi(\breve{\VEC{x}},-j_i x_n)\right|^{s_i} \dx{\VEC{x}}
\leq \prod_{i=1}^p \left( \int_{\RR^n_+} \left| (-j_i)^{\alpha_n} \diff^\alpha
\phi(\breve{\VEC{x}},-j_i x_n)\right|^p \dx{\VEC{x}} \right)^{s_i/p} \\
&\qquad = \prod_{i=1}^p \left( \int_{\RR^n_+} j_i^{\alpha_n p-1} \left|
 \diff^\alpha \phi(\VEC{x})\right|^p \dx{\VEC{x}} \right)^{s_i/p}
= \left( \prod_{i=1}^p j_i^{(\alpha_n p-1)s_i/p} \right) 
\int_{\RR^n_+} \left| \diff^\alpha \phi(\VEC{x})\right|^p \dx{\VEC{x}} \ ,
\end{align*}
where we have used the substitution $x_n \to -x_n/j_i$ for each of the
integrals in the product to obtain the first equality.  Therefore,
\begin{align}
\| E(\phi) \|_{m,p,\RR^n}
&\leq \bigg( \sum_{|\alpha|\leq m} \bigg( 1
+ \sum_{\substack{0\leq s_1 \leq s_2 \leq \ldots \leq s_p \leq p\\
  s_1+s_2+\ldots+s_p = p\\
  1\leq j_1 < j_2 < \ldots <j_p \leq k+1}} c_{s_1,s_2,\ldots,s_p}
\left( \prod_{i=1}^p j_i^{(\alpha_n p-1)s_i/p} \right) \bigg) 
\int_{\RR^n_+} \left| \diff^\alpha \phi(\VEC{x}) \right|^p \dx{\VEC{x}}
  \bigg)^{1/p} \nonumber \\
& \leq C \| \phi \|_{m,p,\RR^n_+} \label{sobRpExtEq1}
\end{align}
for all $\phi \in S$, $0\leq m \leq k$ and $0<p<\infty$, where
\[
C = N\, \bigg(
1 + \sum_{\substack{0\leq s_1 \leq s_2 \leq \ldots \leq s_p \leq p\\
s_1+s_2+\ldots+s_p = p\\
1\leq j_1 < j_2 < \ldots <j_p \leq k+1}} c_{s_1,s_2,\ldots,s_p}
\left( \prod_{i=1}^p j_i^{(m p-1)s_i/p} \right) \bigg)^p \ ,
\]
where $\displaystyle N = \sum_{|\alpha|\leq m} 1$.

Since $E$ is defined by extension from the dense set $S$ in
$\displaystyle W^{m,p}(\RR^n_+)$ according to Theorem~\ref{DDRRnDWkp},
we have that (\ref{sobRpExtEq1}) is true for all
$\displaystyle \phi \in W^{m,p}(\RR^n_+)$.  Thus, proving that
$\displaystyle E: W^{m,p}(\RR^n_+) \to W^{m,p}(\RR^n)$ is a $(m,p)$-extension
operator on $\displaystyle \RR^n_+$ for all
$0\leq m \leq k$ and $0<p<\infty$.

To prove that $E_\alpha$ is a strong $(k-|\alpha|)$-extension operator
on $\displaystyle \RR^n_+$, we note that
$\displaystyle \diff^{\beta} (E_\alpha(\phi))
= E_\alpha(\diff^{\beta} \phi) = E_{\alpha+\beta}(\phi)$ for all
$\phi \in S$ and $0\leq |\beta| \leq k - |\alpha|$.  Then, we repeat
the previous arguments with $E$ and $\alpha$ replaced by $E_\alpha$
and $\beta$ respectively, and
$\displaystyle W^{m,p}(\RR^n_+)$ for $0 \leq m \leq k-|\alpha|$.
\end{proof}

There is a version of the previous theorem for total extension operators.

\begin{theorem} \label{sob_Rp_Totalext}
There exists a total extension operator on
$\displaystyle \RR^n_+ = \{ \VEC{x} : x_n>0 \}$.
\end{theorem}

\begin{proof}[Proof (Sketch)]
The proof resembles the proof of the previous theorem.  However, there
are some major technical details.  We only sketch the proof.  Consult
Lemma 5.20 and Theorem 5.21 in \cite{Ad} for all the details of the
proof.

Since
$\displaystyle S = \left\{ \phi\big|_{\RR^n_+} : \phi \in \DD(\RR^n) \right\}$
is dense in $\displaystyle W^{k,p}(\RR^n_+)$ according to
Theorem~\ref{DDRRnDWkp}, it is enough to define the extension operators
on $S$.

Let $\psi:\RR \to [0,1]$ be a function of class $C^\infty$ such that
$\psi(x) = 1$ for $x \leq 1/2$ and $\psi(x) = 0$ for $x \geq 1$.
We consider the operator $E$ defined on $S$ by
\[
E(\phi)(\VEC{x})
= \begin{cases}
\phi(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \RR^n_+ \cup \RR^n_0 \\
\displaystyle \sum_{j=1}^\infty a_j \psi(-2^jx_n)\phi(\breve{\VEC{x}},-2^jx_n)
& \quad \text{if} \ \VEC{x} \in \RR^n_-
\end{cases}
\]
where $\breve{\VEC{x}} = (x_1,x_2,\ldots, x_{n-1})$ for all
$\displaystyle \VEC{x} \in \RR^n$ and
$\displaystyle \{a_j\}_{j=1}^\infty \subset \RR$ is a
sequence satisfying
\begin{equation} \label{sobRpTotalextEq1}
\sum_{j=0}^\infty 2^{ij} a_j = (-1)^i \quad \text{and} \quad
\sum_{j=0}^\infty 2^{ij} |a_j| < \infty
\end{equation}
for $i \in \NN$.

The function $E(\phi)$ is well defined because the series used to
define $E(\phi)(\VEC{x})$ for $\displaystyle \VEC{x} \in \RR^n_-$ is finite
on any compact set $\displaystyle K \subset \RR^n_-$.  
In fact, the summation is on $j$
such that $\displaystyle 2^j \inf_{\VEC{x} \in K} |x_n| \leq 1$.
Moreover, $E(\phi)$ has a compact support and
$\displaystyle E(\phi) \in C(\overline{\RR^n_+}) \cap C^{\infty}(\RR^n_+)$.

The convergence of the last series in (\ref{sobRpTotalextEq1}) is to
ensure that the series used to define $E(\phi)(\VEC{x})$ for
$\displaystyle \VEC{x} \in \RR^n_-$ is 
a absolutely and uniformly convergent as $x_n \to 0^-$.  It is also
used to show that $E$ is a bounded operator from
$\displaystyle W^{k,p}(\RR^n_+)$ to $\displaystyle W^{k,p}(\RR^n)$ for
all $k\geq 0$ and $0 < p < \infty$.  The first series in
(\ref{sobRpTotalextEq1}) is to ensure that
$\displaystyle E(\phi) \in C^\infty(\RR^n)$
for all $\phi \in S$ similarly to what we had in the proof of
Theorem~\ref{sob_Rp_ext}.
\end{proof}

The next theorem gives conditions on open sets
$\displaystyle \Omega \subset \RR^n$
that ensure the existence of a strong $k$-extension operator on $\Omega$.
But first, we need some definitions.

\begin{defn}
A collection $\displaystyle \{ U_j \}_{j=1}^\infty$ of open subsets of
$\displaystyle \RR^n$ is a {\bfseries locally finite open cover}%
\index{Locally Finite Open Cover} of a set
$\displaystyle \Omega \subset \RR^n$ if
$\displaystyle \Omega \subset \bigcup_{j=1}^\infty U_j$ and,
for any compact set $\displaystyle K \subset \RR^n$, the set $K$
intersects at most a finite number of $U_j$.
\end{defn}

\begin{defn} \label{UnifKregDefn}
A open set $\displaystyle \Omega \subset \RR^n$ satisfies the
{\bfseries uniform $\displaystyle \mathbf C^k$-regularity condition}%
\index{Uniform $\mathbf C^k$-Regularity Condition} if there exists
a locally finite open cover
$\displaystyle \{ U_j \}_{j=1}^\infty$ for $\partial \Omega$ and a collection 
$\displaystyle \{ \psi_j \}_{j=1}^\infty$ of $\displaystyle C^k$-diffeomorphisms 
$\displaystyle \psi_i: U_i \to B_{1}(\VEC{0}) \subset \RR^n$ with the following
properties:
\begin{enumerate}
\item There exists a positive integer $J$ such that the intersection
of any $J+1$ sets $U_j$ is empty.
\item There exists $\delta >0$ such that
\[
\left\{ \VEC{x} \in \RR^n :
\dist{\VEC{x}}{\partial \Omega}  < \delta \right\}
\subset \bigcup_{j=0}^\infty \psi_j^{-1}\big(B_{1/2}(\VEC{0})\big) \ .
\]
\item For each $j$, we have
$\displaystyle \psi_j(U_j\cap \Omega) = B_{1}(\VEC{0}) \cap \RR^n_+$.
\item There exists $C>0$ such that
\[
\sup_{\VEC{x}\in U_j} |\diff^\alpha\psi_{j,s}(\VEC{x})| < C
\quad \text{and} \quad
\sup_{\VEC{x}\in B_{1}(\VEC{0})} |\diff^\alpha\psi^{-1}_{j,s}(\VEC{x})| < C
\]
for all multi-indices $\alpha$ with $0\leq|\alpha|\leq k$, all
$j > 0$, and all $s \in \{1,2,\ldots, n\}$.  Recall that
$\psi_{j,s}$ denoted the $s$ component of $\psi_j$ with a similar
meaning for $\displaystyle \psi^{-1}_{j,s}$.
\end{enumerate}
If $\partial \Omega$ is bounded (so compact), we may assume that
the locally finite cover of $\partial \Omega$ is a finite collection
$\displaystyle \{ U_j \}_{j=1}^J$ for some positive integer $J$.
\end{defn}

\begin{theorem} \label{sob_Omega_Ext}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$ with a bounded boundary
\footnotemark and suppose that $\Omega$ satisfies the uniform
$\displaystyle C^k$-regularity condition, then there exists a strong
$k$-extension operator $F$ on $\Omega$.
\end{theorem}

\footnotetext{The open set $\Omega$ does not have to be bounded.
This result may be used for problems on an unbounded domain like we
had for the exterior Neumann or Direchlet problems in a previous
chapter.}

\begin{proof}[Proof (Sketch)]
Let $\displaystyle \{ U_j \}_{j=1}^J$ be the finite cover
of $\partial \Omega$ from the definition of uniform
$\displaystyle C^k$-regularity, and 
$\displaystyle \{ \psi_j \}_{j=1}^J$ be the associated
collection of $\displaystyle C^k$-diffeomorphisms with the properties
listed in the definition of uniform $\displaystyle C^k$-regularity. 

Let $\displaystyle V_j = \psi_j^{-1}(B_{1/2}(\VEC{0}))$
and $\displaystyle W_j = \psi_j^{-1}(B)$ for $1\leq j \leq J$, where
\[
B = \{ \VEC{y} \in B_1(\VEC{0}) :
\|\breve{\VEC{y}}\| < 1/2 \ \text{and}\ |y_n| < \sqrt{3}/2 \} \ .
\]
Since $B_{1/2}(\VEC{0}) \subset B \subset B_1(\VEC{0})$, we have that
$V_j \subset W_j \subset U_j$ for $1\leq j \leq J$ (Figure~\ref{SOBFIG2}).

As stated in the definition of uniform $\displaystyle C^k$-regularity,
there exists $\delta>0$ such that
\[
\left\{ \VEC{x} \in \RR^n :
\dist{\VEC{x}}{\partial \Omega}  < \delta \right\} \subset
\bigcup_{j=1}^J V_j \ .
\]
Let $\displaystyle W_0 = \left\{ \VEC{x} \in \Omega :
\dist{\VEC{x}}{\partial \Omega}  > \delta/2 \right\}$.
We then have that $\displaystyle \{ W_j \}_{j=0}^J$ is an open cover
of $\Omega$.
Let $\displaystyle \{ \phi_j \}_{j=0}^J$ be a partition of unity for
$\Omega$ subordinated to $\displaystyle \{ W_j \}_{j=0}^J$.

Since $\Omega$ satisfies the uniform $\displaystyle C^k$-regularity
condition, we have that $\partial \Omega$ is a boundary of class
$\displaystyle C^k$.  Thus, $\partial \Omega$ satisfies the segment
property.  It then follows from Theorem~\ref{DDRRnDWkp} that
$\displaystyle S = \left\{ \phi\big|_{\Omega} : \phi \in \DD(\RR^n) \right\}$
is dense in $\displaystyle W^{m,p}(\Omega)$ for $m\leq k$ arbitrary
but fixed.  Hence, as we have done
before, it is enough to define the extension operators on $S$.  

Given $\phi \in S$, we have that
$\displaystyle \phi = \sum_{j=0}^J \omega_j$, where
$\displaystyle \omega_j = \phi\, \phi_j \in C^\infty(\RR^n)$ has its
support in $W_j$.

For $j=0$, let
\[
\rho_0(\VEC{x})
= \begin{cases}
\omega_0(\VEC{x}) & \quad \text{if} \ \VEC{x} \in W_0 \\
0 & \quad  \text{if} \ \VEC{x} \in \RR^n\setminus W_0
  \end{cases}
\]
So, $\rho_0$ is an extension of $\omega_0$ to $\displaystyle \RR^n$ and,
according to Lemma~\ref{sob_denselem1},
$\displaystyle \rho_0 \in W^{m,p}(\RR^n)$
since $\supp \omega_0 \subset \Omega$.

For $0< j \leq J$, we consider
$\displaystyle \tilde{\omega}_j = \omega_j \circ \psi_j^{-1}$ on $B$.
Since $\supp\, \tilde{\omega}_j \subset B$, we may again use
Lemma~\ref{sob_denselem1} to extend $\tilde{\omega}_j$ to
$\displaystyle \RR^n$ by setting
$\tilde{\omega}_j(\VEC{x}) = 0$ for
$\displaystyle \VEC{x} \in \RR^n \setminus B$.  We have that
$\displaystyle \tilde{\omega}_j \in W^{m,p}(\RR^n_+)$
according to Lemma~\ref{sobVsubsetU}.
Using the strong $k$-extension operator $E$
provided by Theorem~\ref{sob_Rp_ext}, we have that
$\displaystyle E(\tilde{\omega}_j) \in W^{m,p}(\RR^n)$,
$E(\tilde{\omega}_j)\big|_{\RR^n_+} = \tilde{\omega}_j$ and
$\displaystyle \|E(\tilde{\omega}_j)\|_{m,p,\RR^n} \leq
C_j \|\tilde{\omega}_j\|_{m,p,\RR^n_+}$
for a constant $C_j$ that depends on $m$ and $p$.
Since $\supp \tilde{\omega}_j \subset B$ and
$\supp E(\tilde{\omega}_j) \subset B$, we have that
$\displaystyle \|E(\tilde{\omega}_j)\|_{m,p,B} \leq
C_j \|\tilde{\omega}_j\|_{m,p,B_+}$ where $B_+= \{\VEC{x} \in B : x_n> 0\}$.

Let $\rho_j = E(\tilde{\omega}_j) \circ \psi_j$ on $W_j$.  We have
that $\displaystyle \rho_j \in C_c^m(W_j)$ and
\[
\rho_j(\VEC{x}) = E(\tilde{\omega}_j)(\psi_j(\VEC{x}))
= \tilde{\omega}_j(\psi_j(\VEC{x})) = \omega_j(\VEC{x})
\]
for $\VEC{x} \in W_j \cap \Omega$ because $\psi_j(\VEC{x}) \in B_+$. 
Since $\supp\, \rho_j \subset W_j$, we may again use
Lemma~\ref{sob_denselem1} to extend $\rho_j$ to a
function in $\displaystyle W^{m,p}(\RR^n)$ by setting
$\rho_j(\VEC{x}) = 0$ for $\displaystyle \VEC{x} \in \RR^n \setminus W_j$.

A lengthy computation shows that
\[
  \|\rho_j\|_{m,p,\RR^n} = \|\rho_j\|_{m,p,W_j} 
\leq K \|\omega_j\|_{m,p,W_j\cap \Omega} = K \|\omega_j\|_{m,p,\Omega}
\]
for some constant $K$ that depends only of $m$ and $p$.  To justify
this claim, one has to use item (4) in the definition of uniform
$\displaystyle C^k$-regularity.  We may also assume that $K \geq 1$.  Consult
Theorem 5.22 in \cite{Ad} for the details.

The operator $F$ is defined on $S$ by
$\displaystyle F(\phi) = \sum_{j=0}^J \rho_j$.
We have that $\displaystyle F(\phi) \in W^{m,p}(\RR^n)$ by construction,
\[
  F(\phi)(\VEC{x}) = \sum_{j=0}^J \rho_j(\VEC{x})
  = \sum_{j=0}^J \omega_j(\VEC{x}) = \phi(\VEC{x})
\]
for $\VEC{x} \in \Omega$, and
\begin{equation}\label{sobOmegaExtEq1}
\|F(\phi)\|_{m,p,\RR^n} \leq \sum_{j=0}^J \|\rho_j\|_{m,p,\RR^n}
\leq K \sum_{j=0}^J \|\omega_j\|_{m,p,\Omega}
\leq QK(1+J)  \|\phi\|_{m,p,\Omega} \ ,
\end{equation}
where $Q$ is a constant that depends on
$\displaystyle \sup_{\VEC{x} \in \RR^n}
\left|\diff^\alpha \phi_j(\VEC{x}) \right|$
for $0 \leq j \leq J$ and $|\alpha| \leq m$.

Note that $F$ does not depend on $0 \leq m \leq k$ or $0 < p < \infty$
as it is the case for the strong $k$-extension operator $E$ used
above.

Since $F$ is defined by extension from the dense set $S$ in
$\displaystyle W^{m,p}(\Omega)$, we have that
(\ref{sobOmegaExtEq1}) is true for all
$\displaystyle \phi \in W^{m,p}(\Omega)$.  Thus, proving that
$\displaystyle F: W^{m,p}(\Omega) \to W^{m,p}(\RR^n)$ is a $(m,p)$-extension
operator on $\displaystyle \Omega$ for all
$0\leq m \leq k$ and $0<p<\infty$.
\end{proof}

\pdfF{sobolev/sob_fig2}{Representation of the local structure for the
proof of Theorem~\ref{sob_Omega_Ext}}{Representation of the local
structure provided by the uniform $C^k$-regularity of $\Omega$ in the
proof of Theorem~\ref{sob_Omega_Ext}.}{SOBFIG2}

If $\Omega$ is an open subset of $\displaystyle \RR^n$ with a compact
boundary of class $\displaystyle C^k$ (so $\partial \Omega$ is a
compact oriented manifold of class $\displaystyle C^k$),  then
$\Omega$ satisfies the uniform $\displaystyle C^k$-regularity 
condition.  There exists therefore a strong $k$-extension operator on
$\Omega$.

\section{Imbedding}

Imbeddings will be used in the next chapter to show that solutions of
linear elliptic partial differential equations in Sobolev spaces
are in fact smoother than predicted.

There are a lot of results about imbedding of Sobolev spaces into
others spaces of functions; in particular into spaces of
differentiable functions.  The interested reader should consult
\cite{Ad} for more results on this subject.  We have included some of
the must important results, at least a version of them because there
may be many versions of these results.  Our intention was to include
only the results that we need for our study of partial differential
equations.  However, there are some fundamental results that we could
not ignore because of their significance even if we may not use them
later.

\subsection{In $\RR$}

Before looking at results in higher dimensions, it is interesting to
consider $\displaystyle H^{1,p}(I)$, where $I$ is an open interval
of $\RR$.  We first start by generalizing the
Fundamental Theorem of Calculus to the theory of distributions.

\begin{lemma} \label{sob_ftc}
Suppose that $I = ]a,b[ \subset \RR$ and that
$\displaystyle f \in L^1_{loc}(I)$.  For $x_0 \in I$, let
\[
v(x) = \int_{x_0}^x f(t) \dx{t} \ .
\]
Then $v \in C(\overline{I})$ and
\[
\int_I v(x) \phi'(x) \dx{x} = - \int _I f(x) \phi(x) \dx{x}
\]
for all $\phi \in \DD(I)$; namely, $v' = f$ where $v'$ is the
derivative of $v$ in the sense of distributions.
\end{lemma}

\begin{proof}
That $v$ is continuous on $\overline{I}$ can be easily deduced from
Theorem 8.17 in \cite{Ru}.

For $\phi \in \DD(I)$, we have
\begin{align*}
\int_I v(x) \phi'(x) \dx{x} &= \int_I \left( \int_{x_0}^x g(t)
  \dx{t} \right) \phi'(x) \dx{x} \\
&= -\int_a^{x_0} \left( \int_x^{x_0} g(t) \phi'(x) \dx{t}\right) \dx{x}
+ \int_{x_0}^b \left( \int_{x_0}^x g(t) \phi'(x) \dx{t}\right) \dx{x}
\end{align*}
Using Fubini's Theorem, we get
\begin{align*}
\int_I v(x) \phi'(x) \dx{x} &=
-\int_a^{x_0} \left( \int_a^t g(t) \phi'(x) \dx{x}\right) \dx{t}
+ \int_{x_0}^b \left( \int_t^b g(t) \phi'(x) \dx{x}\right) \dx{t} \\
&= -\int_a^{x_0} g(t) \phi(t) \dx{t}
- \int_{x_0}^b g(t) \phi(t) \dx{t} = - \int_I g(t) \phi(t) \dx{t} \ .  \qedhere
\end{align*}
\end{proof}

\begin{theorem} \label{sob_ader}
Given $\displaystyle u \in H^{1,p}(I)$, where $I = ]a,b[ \subset \RR$,
there exists $w \in C(\overline{I})$ such that $w=u$ almost everywhere on $I$.
Moreover,
\[
w(x) - w(y) = \int_y^x u'(t) \dx{t}
\]
for all $x$ and $y$ in $I$, where $u'$ is the derivative of $u$ in
the sense of distributions.
\end{theorem}

\begin{proof}
Given $x_0 \in I$, let
\[
\tilde{w}(x) = \int_{x_0}^x u'(t) \dx{t}
\]
for $x \in I$.  The function $\tilde{w}$ is well defined because
$\displaystyle u \in H^{1,p}(I)$, so
$\displaystyle u' \in L^p(I) \subset L^p(J)$
where $J$ is the bounded interval with endpoints $x_0$ and
$x$.  Moreover, $\displaystyle L^p(J) \subset L^1(J)$ because $J$ is bounded.

From Lemma~\ref{sob_ftc}, we have that
\[
\int_I \tilde{w}(x) \phi'(x) \dx{x} = - \int_I u'(x) \phi(x) \dx{x}
= \int_I u(x) \phi'(x) \dx{x}
\]
for all $\phi \in \DD(I)$.  Thus,
\[
\int_I \left( \tilde{w}(x) - u(x)\right) \phi'(x) \dx{x} = 0
\]
for all $\phi \in \DD(I)$.  It follows from
Lemma~\ref{distr_der0_eq_const} that there exists a constant $C$ such
that $\tilde{w} - u = C$ almost everywhere on $I$.  The function $w$
is defined by $w = \tilde{w} - C$.

Note that
\[
w(x) - w(y) = \tilde{w}(x) - \tilde{w}(y) =
\int_{x_0}^x u'(t) \dx{t} - \int_{x_0}^y u'(t) \dx{t}
= \int_y^x u'(t) \dx{t} \ .
\]
for all $x$ and $y$ in $I$.
\end{proof}

It follows from the previous theorem that
$\displaystyle H^{1,p}(I) \subset C(\overline{I})$.  We prove more
general and stronger results in the next section.

\subsection{In $\RR^n$}

To illustrate the complexity of the results about imbeddings, we
summarize some of the results listed in \cite{Br}.
\begin{center}
\begin{tabular}{c|c|c|c}
& $\displaystyle \frac{1}{p'} = \frac{1}{p} - \frac{1}{n} > 0$
& $p\leq q < \infty$ or $p = n$ & $ p > n$ \\
\hline  
\rule{0pt}{1.2em} $\RR^n$ & $\displaystyle H^{1,p}(\RR^n)
 \rightarrow L^{q}(\RR^n)$
& $\displaystyle H^{1,p}(\RR^n) \rightarrow L^{q}(\RR^n)$
& $\displaystyle H^{1,p}(\RR^n) \rightarrow L^{\infty}(\RR^n)$ \\
& for $p \leq q \leq p'$ & & \\
& continuous & continuous & continuous \\
\hline
\rule{0pt}{1.2em} $\Omega$ open, and $\partial \Omega$
& $\displaystyle H^{1,p}(\Omega) \rightarrow L^{p'}(\Omega)$
& $\displaystyle H^{1,p}(\Omega) \rightarrow L^{q}(\Omega)$
& $\displaystyle H^{1,p}(\Omega) \rightarrow L^{\infty}(\Omega)$ \\
bounded and of & continuous & continuous & continuous \\
class $C^1$ & & & \\
\hline
\rule{0pt}{1.2em} $\Omega$ open and
& $\displaystyle H^{1,p}(\Omega) \rightarrow L^{q}(\Omega)$
& $\displaystyle H^{1,p}(\Omega) \rightarrow L^{q}(\Omega)$
& $\displaystyle H^{1,p}(\Omega) \rightarrow C(\overline{\Omega})$ \\
bounded, and & for $1 \leq q < p'$ & & \\
$\partial \Omega$ of class $\displaystyle C^1$ & compact & compact & compact \\
\hline
\end{tabular}
\end{center}
There are similar results for $\displaystyle H^{m,p}$ with $m>1$.
This is a small sample of all the possible imbeddings.  In \cite{Ad},
imbeddings are given based on the following criteria: $\Omega$ bounded or
unbounded, $\partial \Omega$ satisfying only the segment property,
$\partial \Omega$ of class $\displaystyle C^k$ for $k\geq 1$, $\Omega$
satisfying the uniform $\displaystyle C^k$-regularity conditions, and
several other criteria.

As mentioned previously, we will only give the results that will be
useful to us later.  This is sufficient to get an idea of what is
involved in proving results about imbeddings.

\begin{theorem}[Sobolev's Lemma] \label{sob_TheSobLemma}
If $s >k +n/2$, then $\displaystyle H^{s,2}(\RR^n) \subset C^k(\RR^n)$ and there
exists a constant $C$ depending on $s$ and $k$ only such that
\begin{equation} \label{sob_sob_lemma_max}
\|f\|_{k,\infty} \leq C \|f\|_{s,\rho}
\end{equation}
for $\displaystyle f \in H^{s,2}(\RR^n)$.
In particular, $\displaystyle H^{s,2}(\RR^n) \subset C_b^k(\RR^n)$.
Moreover, the imbedding $\displaystyle i:H^{s,2}(\RR^n) \to C_b^k(\RR^n)$
is continuous.  \index{Sobolev's Lemma}
\end{theorem}

\begin{proof}
Let $f$ be an element of $\displaystyle \SS(\RR^n) \subset H^{s,2}(\RR^n)$.
Note that $\displaystyle \DD(\RR^n) \subset H^{s,2}(\RR^n)$ could also
have been used.  Assume that $|\alpha|\leq k$.

Since $\displaystyle (\diff^\alpha f)^\wedge(\VEC{y}) =
(i\,\VEC{y})^\alpha \hat{f}(\VEC{y})$, we get from Schwarz
inequality that
\begin{align*}
\| (\diff^\alpha f)^\wedge \|_1 &= 
\int_{\RR^n} \left| (-i\,\VEC{y})^\alpha \hat{f}(\VEC{y}) \right| \dx{\VEC{y}}
\leq \int_{\RR^n} (1+\|\VEC{y}\|^2)^{k/2} \left| \hat{f}(\VEC{y}) \right|
\dx{\VEC{y}} \\
& =\int_{\RR^n} (1+\|\VEC{y}\|^2)^{(k-s)/2}
 (1+\|\VEC{y}\|^2)^{s/2} \left| \hat{f}(\VEC{y}) \right| \dx{\VEC{y}} \\
&\leq \left( \int_{\RR^n} (1+\|\VEC{y}\|^2)^{k-s} \dx{\VEC{y}} \right)^{1/2}
\left(\int_{\RR^n} (1+\|\VEC{y}\|^2)^s \left|\hat{f}(\VEC{y}) \right|^2
\dx{\VEC{y}}\right)^{1/2}
= C_1 \| f \|_{s,\rho} \ ,
\end{align*}
where
\[
C = \left( \int_{\RR^n} (1+\|\VEC{y}\|^2)^{k-s} \dx{\VEC{y}} \right)^{1/2}
< \infty
\]
because $k-s < -n/2$.  Note that the constant $C$ does not depend on
$f$ but only on $s$ and $k$.  Since $\displaystyle \diff^\alpha f$, and
$\displaystyle (\diff^\alpha f)^\wedge$ are in
$\displaystyle L^1(\RR^n)$, we
get from Proposition~\ref{distr_inv_four_transf} that
$\displaystyle ((\diff^\alpha f)^\wedge)^\vee \in C_0(\RR^n)$,
$\displaystyle ((\diff^\alpha f)^\wedge)^\vee = \diff^\alpha f$ almost
everywhere, and
\[
  \|\diff^\alpha f\|_\infty \leq \|(\diff^\alpha f)^\wedge \|_1
  \leq C \| f \|_{s,\rho} \ .
\]
Since this is true for all $|\alpha|\leq k$, we have
that
\begin{equation}\label{sob_sob_inequ}
\max_{|\alpha|\leq k} \|\diff^\alpha f\|_{\infty} \leq C \| f \|_{s,\rho}
\end{equation}
for all $\displaystyle f \in \SS(\RR^n)$.  Since
$\displaystyle \SS(\RR^n)$ is dense in
$\displaystyle H^{s,2}(\RR^n)$, (\ref{sob_sob_inequ}) is true for all
$\displaystyle f \in H^{s,2}(\RR^n)$.  More precisely, if
$\displaystyle \{f_i\}_{i=1}^\infty \subset \SS(\RR^n)$ converges in
$\displaystyle H^{s,2}(\RR^n)$ to $\displaystyle f \in H^{s,2}(\RR^n)$, then
$\displaystyle \{f_i\}_{i=1}^\infty$ is a Cauchy sequence in
$\displaystyle H^{s,2}(\RR^n)$.
From (\ref{sob_sob_inequ}), $\displaystyle \{f_i\}_{i=1}^\infty$ is a Cauchy
sequence in the complete space $\displaystyle C_b^k(\RR^n)$.  Thus, there exists
$\displaystyle g \in C_b^k(\RR^n)$ such that
$\displaystyle \{f_i\}_{i=1}^\infty$ converges in
$\displaystyle C_b^k(\RR^n)$ to $g$.  Moreover, since
$\displaystyle \{f_i\}_{i=1}^\infty $ converges in
$\displaystyle H^{s,2}(\RR^n)$ to $f$, we have
that $\displaystyle \{f_i\}_{i=1}^\infty $ converges pointwise to $f$ almost
everywhere.  Thus $f = g$ almost everywhere.

The continuity of the injection
$\displaystyle i:H^{m,2}(\RR^n) \to C_b^k(\RR^n)$ is a direct
consequence of (\ref{sob_sob_lemma_max}).
\end{proof}

\begin{rmk}
In the previous theorem, we may have proved directly that 
$\displaystyle H^{s,2}(\RR^n) \subset C^k(\RR^n)$.

Let $f$ be any element of $\displaystyle H^{s,2}(\RR^n)$.  Let $V$ be
a bounded open subset of $\displaystyle \RR^n$.  Choose
$\displaystyle \psi \in \DD(\RR^n)$ such that
$\psi = 1$ on $\overline{V}$,  $|\psi|\leq 1$ and define $F = \psi f$.
It follows from Proposition~\ref{sob_T_dd_wk2} that
$\displaystyle F \in H^{s,2}(\RR^n)$.

For $|\alpha|\leq k$, since $\displaystyle \diff^\alpha F \in L^2(\RR^n)$
has a compact support, we also have that
$\displaystyle \diff^\alpha F \in L^1(\RR^n)$.
Since $\displaystyle (\diff^\alpha F)^\wedge(\VEC{y}) =
(i\,\VEC{y})^\alpha \hat{F}(\VEC{y})$, as we did for $f$ in the proof
of the previous theorem, we get from Schwarz inequality that
\begin{align*}
\| (\diff^\alpha F)^\wedge \|_1 &= 
\int_{\RR^n} \left| (-i\,\VEC{y})^\alpha \hat{F}(\VEC{y}) \right| \dx{\VEC{y}}
\leq \int_{\RR^n} (1+\|\VEC{y}\|^2)^{k/2} \left| \hat{F}(\VEC{y}) \right|
\dx{\VEC{y}} \\
& = \int_{\RR^n} (1+\|\VEC{y}\|^2)^{(k-s)/2}
 (1+\|\VEC{y}\|^2)^{s/2} \left| \hat{F}(\VEC{y}) \right| \dx{\VEC{y}} \\
&\leq \left( \int_{\RR^n} (1+\|\VEC{y}\|^2)^{k-s} \dx{\VEC{y}} \right)^{1/2}
 \left(\int_{\RR^n} (1+\|\VEC{y}\|^2)^s \left|\hat{F}(\VEC{y}) \right|^2
\dx{\VEC{y}}\right)^{1/2}
= C_1 \| F \|_{s,\rho}
\end{align*}
for $|\alpha|\leq k$, where
$\displaystyle
C = \left( \int_{\RR^n} (1+\|\VEC{y}\|^2)^{k-s} \dx{\VEC{y}} \right)^{1/2}
< \infty$ because $k-s < -n/2$.

Since
$\displaystyle \diff^\alpha F$ and $\displaystyle (\diff^\alpha F)^\wedge$
are in $\displaystyle L^1(\RR^n)$, we
get from Proposition~\ref{distr_inv_four_transf} that the inverse Fourier
transform of $\displaystyle (\diff^\alpha F)^\wedge$ is in
$\displaystyle C_0(\RR^n)$
and is equal to $\displaystyle \diff^\alpha F$ almost everywhere
for $|\alpha| \leq k$.  From Proposition~\ref{distr_cdistr_cder}, we
get that $\displaystyle F\in C^k(\RR^n)$.  Since this is true for any
bounded open subset $V$ of $\displaystyle \RR^n$ and $f=F$ on $V$, then
$\displaystyle f\in C^k(\RR^n)$.
\end{rmk}

\begin{cor}
If $\displaystyle f\in H^{s,2}(\RR^n)$ for all $s>n/2$, then
$\displaystyle f\in C^\infty(\RR^n)$.
\end{cor}

\begin{cor} \label{sob_TheSobLemma_Cor1}
Every distribution on $\displaystyle \RR^n$ with a compact support belongs to
$\displaystyle H^{s,2}(\RR^n)$ for some $s\in \RR$.
\end{cor}

\begin{proof}
If $u$ is a distribution and $K = \supp u$ is compact, it follows from
Proposition~\ref{distr_cont_cond} that there exist a constant $C_1$ and 
an integer $N$ such that
$\displaystyle \left| u(\phi) \right| \leq C_1 \max_{|\alpha|\leq N}
\left\| \diff^\alpha \phi \right\|_{K,\infty}$ for all $\phi \in \DD_K$.
Thus,
$\displaystyle \left| u(\phi) \right| \leq C_1 \max_{|\alpha|\leq N}
\left\| \diff^\alpha \phi \right\|_{\infty}$
for all $\displaystyle \phi \in \DD(\RR^n)$ because $K = \supp u$.

From Theorem~\ref{sob_TheSobLemma}, Sobolev's Lemma, there exists a
constant $C$ such that\\
$\displaystyle \max_{|\alpha|\leq N}
\left\| \diff^\alpha \phi \right\|_{\infty} \leq C \|\phi\|_{s,2}$
for all $\displaystyle \phi \in \DD(\RR^n)$ if $s > N+ n/2$.  Thus,
$\displaystyle \left| u(\phi) \right| \leq C C_1 \|\phi\|_{s,2}$
for all $\displaystyle \phi \in \DD(\RR^n)$.

Since $\displaystyle \DD(\RR^n)$ is dense in
$\displaystyle H^{s,2}(\RR)$, we may
therefore extend $u$ to a bounded linear functional on
$\displaystyle H^{s,2}(\RR)$.  Thus,
$\displaystyle u \in \left( H^{s,2}(\RR^n) \right)^\ast = H^{-s,2}(\RR^n)$.
\end{proof}

\begin{cor} \label{sob_TheSobLemma_cor1}
Let $\displaystyle \Omega \subset \RR^n$ be an open set with the
$(m,2)$-extension property. If $m>k +n/2$, then
$\displaystyle H^{m,2}(\Omega) \subset C_b^k(\overline{\Omega})$.
Moreover, the imbedding
$\displaystyle i:H^{m,2}(\Omega) \to C_b^k(\overline{\Omega})$
is continuous.
\end{cor}

\begin{proof}
Let $\displaystyle E:H^{m,2}(\Omega) \rightarrow H^{m,2}(\RR^n)$ be a bounded
linear mapping provided by the $(m,2)$-extension property.  Given
$\displaystyle f\in H^{m,2}(\Omega)$, we have from the Sobolev's Lemma that
$\displaystyle E(f) \in H^{m,2}(\RR^n) \subset C^k_b(\RR^n)$ and the
injection $\displaystyle i_0:H^{m,2}(\RR^n) \to C_b^k(\RR^n)$ is
continuous.

Let $\displaystyle R: C_b^k(\RR^n) \to C_b^k\left(\overline{\Omega}\right)$
be the mapping defined by $\displaystyle R(f) = f\big|_{\overline{\Omega}}$.
This is a continuous mapping.
Since $i = R\circ i_0 \circ E$, the composition of continuous mappings,
we have that $i$ is continuous.

Note that $\displaystyle f = i(f)\big|_{\Omega}$, so
$\displaystyle i(f) \in C^k_b(\overline{\Omega})$
is the continuous extension of $f$ from $\Omega$ to $\overline{\Omega}$.
\end{proof}

To prove the next corollary, we need to introduce a new space of
functions.

\begin{defn} \label{defnHolderContFunct}
Given $0 < \mu \leq 1$, the space of {\bfseries Hlder continuous
functions of exponent $\mu$}\index{Hlder Continuous Functions of
Exponent $\mu$} on the open set $\displaystyle \Omega \subset \RR^n$,
denoted $\displaystyle C^{k,\mu}(\overline{\Omega})$, is
the set of all functions $\displaystyle f \in C_{bu}^k(\overline{\Omega})$
such that, for each multi-index $\alpha$ satisfying $|\alpha|\leq k$,
there exists a constant $K$ such that
\[
  \left| \diff^\alpha f(\VEC{x}) - \diff^\alpha f(\VEC{y}) \right|
  \leq K \|\VEC{x} - \VEC{y} \|^{\mu}
\]
for all $\VEC{x}, \VEC{y} \in \Omega$.
\end{defn}

The spaces of Hlder continuous functions have several properties:
\begin{enumerate}
\item $\displaystyle C^{k,\mu}(\overline{\Omega})$ is a Banach space
with respect to the norm
\[
\|f\| = \|f\|_{k,\infty,\Omega} + \max_{0\leq |\alpha|\leq k}
\ \sup_{\substack{\VEC{x},\VEC{y} \in \Omega\\ \VEC{x} \neq \VEC{y}}}
\frac{\big|\diff^\alpha f(\VEC{x}) - \diff^\alpha f(\VEC{y})\big|}
{\|\VEC{x}-\VEC{y}\|^{\mu}} \ .
\]
\item $\displaystyle C^{k,\mu_2}(\overline{\Omega})
\subsetneqq C^{k,\mu_1}(\overline{\Omega})$ for $0 < \mu_1 < \mu_2 < 1$.
\item Given $0 < \mu_1 < \mu_2 < 1$, the imbeddings
$\displaystyle i_1 : C^{k,\mu_1}(\overline{\Omega})
\to C_{bu}^k(\overline{\Omega})$
and
$\displaystyle i_2 : C^{k,\mu_2}(\overline{\Omega})
\to C^{k,\mu_1}(\overline{\Omega})$
are continuous.  If $\Omega$ is bounded, the imbeddings $i_1$ and
$i_2$ are compact operators.
\item If $m-k > \mu + n/2 > n/2 > m-k-1$, then
$\displaystyle H^{m,2}(\Omega) \subset C^{k,\mu}(\overline{\Omega})$
and the imbedding
$\displaystyle i_3: H^{m,2}(\Omega) \to C^{k,\mu}(\overline{\Omega})$
is continuous.  If $n/2 = m-k-1$, then
$\displaystyle H^{m,2}(\Omega) \subset C^{k,\mu}(\overline{\Omega})$
and the imbedding
$\displaystyle i_3: H^{m,2}(\Omega) \to C^{k,\mu}(\overline{\Omega})$
is continuous for all $0<\mu<1$.  These properties are often listed
as parts of the Sobolev Imbedding Theorem.
\end{enumerate}
All these results and many more are proved in \cite{Ad} (i.e.\ Theorems~1.34
and 4.12).  In this reference, the authors refer to a bounded open set
that satisfies the ``strong local Lipschitz condition.''\ This
condition is satisfied
by the bounded open sets $\Omega$ that we consider because we assume
that $\Omega$ has the $(m,2)$-extension property.
There are many approaches to prove the next corollary.  However, using spaces of
Hlder continuous functions seem to be the approach more suitable to
generalization.  This is the reason why we have adopted it.

\begin{cor} \label{sob_cor_sob_lem}
Let $\displaystyle \Omega \subset \RR^n$ be a bounded open set with
the $(m,2)$-extension property. If $m>k +n/2$, then the imbedding
$\displaystyle i:H^{m,2}(\Omega) \to C_{bu}^k(\overline{\Omega})$
is compact.
\end{cor}

\begin{proof}
\stage{i} To proof that $\displaystyle I: H^{m,2}(\Omega) \to
C^k_b(\overline{\Omega})$ is compact when $\Omega$ is bounded, we first
show that it is enough to prove that the imbedding
$\displaystyle i: H^{m-k,2}(\Omega) \to C^0_b(\overline{\Omega})$ is
compact. Suppose that
$\displaystyle i: H^{m-k,2}(\Omega) \to C_{bu}^0(\overline{\Omega})$
is compact and that $\{\alpha_0 , \alpha_1, \ldots, \alpha_N\}$ is an
ordering of the multi-indices $\alpha$ such that $|\alpha| \leq k$.
Let $\displaystyle \left\{ f_i \right\}_{i=1}^\infty$ be a bounded
sequence in $\displaystyle H^{m,2}(\Omega)$.
\begin{itemize}
\item Then,
$\displaystyle \left\{ \diff^{\alpha_0} f_i \right\}_{i=1}^\infty$ be a bounded
sequence in
$\displaystyle H^{m-|\alpha_0|,2}(\Omega) \subset H^{m-k,2}(\Omega)$.
Since we assume that
$\displaystyle i: H^{m-k,2}(\Omega) \to C_{bu}^0(\overline{\Omega})$
is compact, there exists a subsequence
$\displaystyle \left\{ f_{\alpha_0,i} \right\}_{i=1}^\infty$
of $\displaystyle \left\{ f_i \right\}_{i=1}^\infty$
such that
$\displaystyle \left\{ \diff^{\alpha_0} f_{\alpha_0,i} \right\}_{i=1}^\infty$
converges in $\displaystyle C_{bu}^0(\overline{\Omega})$.
\item We now have that
$\displaystyle \left\{ \diff^{\alpha_1} f_{\alpha_0,i}
\right\}_{i=1}^\infty$ is
a bounded sequence in
$\displaystyle H^{m-|\alpha_1|,2}(\Omega) \subset H^{m-k,2}(\Omega)$.
Since we assume that
$\displaystyle i: H^{m-k,2}(\Omega) \to C_{bu}^0(\overline{\Omega})$
is compact, there exists a subsequence
$\displaystyle \left\{ f_{\alpha_1,i} \right\}_{i=1}^\infty$
of $\displaystyle \left\{ f_{\alpha_0,i} \right\}_{i=1}^\infty$
such that
$\displaystyle \left\{ \diff^{\alpha_1} f_{\alpha_0,i} \right\}_{i=1}^\infty$
converges in $\displaystyle C_{bu}^0(\overline{\Omega})$.
\item and so on until we reach $\alpha_N$.
\end{itemize}
The sequence
$\displaystyle \left\{ f_{\alpha_N,i} \right\}_{i=1}^\infty$ is such
that
$\displaystyle \left\{ \diff^\alpha f_{\alpha_N,i} \right\}_{i=1}^\infty$
converges in $C_{bu}^0(\overline{\Omega})$ for all multi-indices $\alpha$
such that $|\alpha|\leq k$.  Thus,
$\displaystyle \left\{ \diff^\alpha f_{\alpha_N,i} \right\}_{i=1}^\infty$
converges in $C_{bu}^k(\overline{\Omega})$.

\stage{ii} Choose $j \geq 0$ such that $m-k -j >n/2 \geq m-k-j-1$ and
$0<\mu<1$ such that $m-k -j > \mu + n/2 > n/2 \leq m-k-j-1$.
We obviously have that the imbedding
$\displaystyle i_1 : H^{m-k,2}(\Omega) \to H^{m-k-j,2}(\Omega)$
is continuous.  We have from the fourth item listed before the
statement of the corollary that the imbedding
$\displaystyle i_2 : H^{m-k-j,2}(\Omega) \to
C^{k+j,\mu}(\overline{\Omega}) \subset C^{0,\mu}(\overline{\Omega})$
is also continuous.  Finally, we have from the third item 
listed before the statement of the corollary that the imbedding
$\displaystyle i_3 : C^{0,\mu}(\overline{\Omega})
\to C_{bu}^0(\overline{\Omega})$ is
compact.  It follows that Proposition~\ref{fu_an_comp_cont} that
$\displaystyle i = i_3 \circ i_2 \circ i_1:
H^{m-k,2}(\Omega) \to C^0_b(\overline{\Omega})$ is
compact.
\end{proof}

\begin{theorem}[Rellich's Theorem] \label{sob_rell_th}
Consider two integers $k_1$ and $k_2$ such that $0\leq k_1\leq k_2$.
Let $\Omega \subset \RR^n$ be a bounded open set with the
$(k_2,2)$-extension property.  Then, the inclusion
$\displaystyle i:H^{k_2,2}(\Omega) \to H^{k_1,2}(\Omega)$ is a
compact mapping.  In fact, every bounded sequence in
$\displaystyle H^{k_2,2}(\Omega)$ has a subsequence which converges in
$\displaystyle H^{k_1,2}(\Omega)$ for all $k_1 < k_2$.
\index{Rellich's Theorem}
\end{theorem}

\begin{proof}
Suppose that $\displaystyle \{f_i\}_{i=1}^\infty$ is a bounded sequence in
$\displaystyle H^{k_2,2}(\Omega)$.

Choose $\displaystyle \psi\in \DD(\RR^n)$ such that $\psi(\VEC{x})=1$ for all
$\VEC{x}\in \Omega$ and $0\leq \psi(\VEC{x}) \leq 1$ for all
$\displaystyle \VEC{x}\in \RR^n$.  If
$\displaystyle E:H^{k_2,2}(\Omega) \rightarrow H^{k_2,2}(\RR^n)$
is the bounded linear operator satisfying
Definition~\ref{sob_k_ext_prop}, then
$\displaystyle F=\psi E:H^{k_2,2}(\Omega) \rightarrow H^{k_2,2}(\RR^n)$
is a bounded linear mapping such that $F(f)\big|_{\Omega} = f$ for all
$\displaystyle f\in H^{k_2,2}(\Omega)$ and
$\supp F(f) \subset K \equiv \supp \psi$ for all
$\displaystyle f\in H^{k_2,2}(\Omega)$.

Consider the sequence $\displaystyle \{g_i \}_{i=1}^\infty$, where
$g_i = F(f_i)$ for all $i$.  We have that
$\displaystyle g_i \in H^{k_2,2}(\RR^n)$,
$\supp g_i \subset K$ for all $i$, $g_i\big|_{\Omega} = f_i$ for all
$i$, and there exists $C \in \RR$ such that
$\displaystyle \|g_i\|_{k_2,\rho} < C$ for
all $i$ because the sequence $\displaystyle \{f_i\}_{i=1}^\infty$ is
bounded and $F$ is a bounded linear mapping.

\stage{i}
Choose $\displaystyle \phi \in \DD(\RR^n)$ such that $\phi(\VEC{x})=1$ for all
$\VEC{x}\in K$.  For all $i$, we have $\hat{g}_i = \hat{g}_i \ast \hat{\phi}$
because $g_i = g_i \, \phi$.  Note that $\hat{g}_i \ast \hat{\phi}$ is
defined by the standard integration formula because
$\displaystyle g_i \in H^{k_2,2}(\RR^n) \subset L^2(\RR^n)$ implies
$\displaystyle \hat{g}_i \in L^2(\RR^n)$, and $\phi \in \SS(\RR^n)$
implies $\displaystyle \hat{\phi} \in \SS(\RR^n) \subset L^2(\RR^n)$
by Proposition~\ref{distr_frr_tempT}.  Moreover, it follows from
item 3 of Proposition~\ref{distr_frr_tempD}
that $\displaystyle \hat{g}_i = \hat{g}_i \ast \hat{\phi} \in C^\infty(\RR^n)$
because
$\displaystyle \hat{\phi} \in \SS(\RR^n)$ and
$\displaystyle \hat{g}_i \in L^2(\RR^n) \subset \SS'(\RR^n)$.

It follows from Lemma~\ref{sob_tri_equ} and Schwarz inequality that
\begin{align*}
\left|\hat{g}_i(\VEC{y})\right| &\leq
\int_{\RR^n} \left| \hat{\phi}(\VEC{y}-\VEC{x})\right|\,
\left| \hat{g}_i(\VEC{x}) \right| \dx{\VEC{x}} \\
&\leq \frac{2^{k_2/2}}{\left(1+\|\VEC{y}\|^2\right)^{k_2/2}}
\int_{\RR^n} \left(1+\|\VEC{y}-\VEC{x}\|^2\right)^{k_2/2}
\left| \hat{\phi}(\VEC{y}-\VEC{x})\right|\,
\left(1+\|\VEC{x}\|^2\right)^{k_2/2} \left| \hat{g}_i(\VEC{x}) \right|
\dx{\VEC{x}} \\
&\leq \frac{2^{k_2/2}}{\left(1+\|\VEC{y}\|^2\right)^{k_2/2}} \|\phi\|_{k_2,\rho}
\, \|g_i\|_{k_2,\rho}
\leq 2^{k_2/2}\|\phi\|_{k_2,\rho}\, \|g_i\|_{k_2,\rho} \leq
2^{k_2/2}\,C\,\|\phi\|_{k_2,\rho} < \infty
\end{align*}
for all $\displaystyle \VEC{y}\in \RR^n$ and all $i$.  Similarly,
since $\displaystyle \diff^{\VEC{e}_j} \hat{g}_i
= \diff^{\VEC{e}_j} \hat{g}_i \ast \hat{\phi}$ for $1 \leq j \leq n$, we get
\begin{align*}
\left|\pdydx{\hat{g}_i}{y_j}(\VEC{y})\right| &=
\left| \int_{\RR^n} \hat{\phi}(\VEC{y}-\VEC{x})\,
\pdydx{\hat{g_i}}{x_j}(\VEC{x}) \dx{\VEC{x}} \right|
= \left| \int_{\RR^n} \pdydx{\hat{\phi}}{x_j}(\VEC{y}-\VEC{x})\,
\hat{g}_i(\VEC{x}) \dx{\VEC{x}} \right| \\
&\leq \int_{\RR^n} \left| \pdydx{\hat{\phi}}{x_j}(\VEC{y}-\VEC{x})\right|\,
\left|\hat{g}_i(\VEC{x})\right| \dx{\VEC{x}} \leq \ldots 
\leq 2^{k_2/2}\,C\,\left\|\pdydx{\phi}{y_j}\right\|_{k_2,\rho} < \infty
\end{align*}
for all $\displaystyle \VEC{y}\in \RR^n$ and all $i$, and $1 \leq j \leq n$.

Hence, the sequence of functions $\displaystyle \{\hat{g}_i\}_{i=1}^\infty$ is
uniformly bounded and equicontinuous on $\displaystyle \RR^n$ because
\[
\| \graD_{\VEC{y}} \hat{g}_i(\VEC{y}) \| \leq
\sqrt{n}\,2^{k_2/2}\,C
\,\max_{1\leq j\leq n} \left\|\pdydx{\phi}{y_j}\right\|_{k_2,\rho}
\]
for $\displaystyle \VEC{y}\in \RR^n$ and $i > 0$,
where $\|\cdot\|$ is the Euclidean norm in $\displaystyle \RR^n$.  The
equicontinuity comes from the Mean Value Theorem.

It follows from Arzel\'a-Ascoli Theorem that there exists a subsequence
$\displaystyle \left\{ \hat{g}_i^{[1]}\right\}_{i=1}^\infty$ of
$\displaystyle \{\hat{g}_i\}_{i=1}^\infty$ that
converges uniformly on the compact set of $\overline{B_1(\VEC{0})}$.  Again,
using Arzel\'a-Ascoli Theorem, there exists a subsequence
$\displaystyle \left\{ \hat{g}_{i}^{[2]}\right\}_{i=1}^\infty$ of
$\displaystyle \left\{ \hat{g}_i^{[1]}\right\}_{i=1}^\infty$ that
converges uniformly on the compact set of $\overline{B_2(\VEC{0})}$.
In general,
having the $\displaystyle \left\{\hat{g}_i^{[N]}\right\}_{i=1}^\infty$
that converges uniformly on the compact set of
$\overline{B_N(\VEC{0})}$ for $N \in \NN$,
we use Arzel\'a-Ascoli Theorem, to obtain a subsequence
$\displaystyle \left\{ \hat{g}_i^{[N+1]}\right\}_{i=1}^\infty$ of
$\displaystyle \left\{\hat{g}_i^{[N]}\right\}_{i=1}^\infty$ that
converges uniformly on the compact set of $\overline{B_{N+1}(\VEC{0})}$.
The sequence $\displaystyle \left\{ \hat{g}_i^{[i]}\right\}_{i=1}^\infty$ is a
subsequence of $\displaystyle \{\hat{g}_i\}_{i=1}^\infty$ that
converges uniformly on all sets $\overline{B_N(\VEC{0})}$ for $N > 0$.

\stage{ii}  To prove that the inclusion
$\displaystyle i:H^{k_2,2}(\Omega) \to H^{k_1,2}(\Omega)$ is a
compact mapping, it suffices to prove that
$\displaystyle \left\{g_i^{[i]}\right\}_{i=1}^\infty$ converges in
$\displaystyle H^{k_1,2}(\RR^n)$ since
$\displaystyle g_i^{[i]}\big|_{\Omega} = f_i^{[i]}$ for all $i$.

For $N>0$, we have
\begin{align*}
&\left\|g_i^{[i]} - g_j^{[j]} \right\|_{k_1,\rho}^2 =
\int_{\|\VEC{y}\|\leq N} \left(1+\|\VEC{y}\|^2\right)^{k_1}
\left| \hat{g}_i^{[i]}(\VEC{y}) - \hat{g}_j^{[j]}(\VEC{y})
\right|^2 \dx{\VEC{y}} \\
&\qquad \qquad +\int_{\|\VEC{y}\|> N} \left(1+\|\VEC{y}\|^2\right)^{k_1-k_2}
\left(1+\|\VEC{y}\|^2\right)^{k_2}
\left| \hat{g}_i^{[i]}(\VEC{y}) - \hat{g}_j^{[j]}(\VEC{y})
\right|^2 \dx{\VEC{y}} \\
&\qquad \leq \sup_{\|\VEC{x}\|\leq N}
\left| \hat{g}_i^{[i]}(\VEC{x}) - \hat{g}_j^{[j]}(\VEC{x}) \right|^2
\, \int_{\|\VEC{y}\|\leq N} \left(1+\|\VEC{y}\|^2\right)^{k_1}
\dx{\VEC{y}} \\
&\qquad \qquad + \left(1+N^2\right)^{k_1-k_2}
\int_{\|\VEC{y}\|> N} \left(1+\|\VEC{y}\|^2\right)^{k_2}
\left| \hat{g}_i^{[i]}(\VEC{y}) - \hat{g}_j^{[j]}(\VEC{y}) \right|^2
\dx{\VEC{y}} \\
&\qquad \leq \sup_{\|\VEC{x}\|\leq N}
\left| \hat{g}_i^{[i]}(\VEC{x}) - \hat{g}_j^{[j]}(\VEC{x}) \right|^2
\, \int_{\|\VEC{y}\|\leq N} \left(1+\|\VEC{y}\|^2\right)^{k_1}
\dx{\VEC{y}}
+ \left(1+N^2\right)^{k_1-k_2} \left\| g_i^{[i]}-g_j^{[j]}\right\|_{k_2,\rho} \\
&\qquad \leq \sup_{\|\VEC{x}\|\leq N}
\left| \hat{g}_i^{[i]}(\VEC{x}) - \hat{g}_j^{[j]}(\VEC{x}) \right|^2
\, \int_{\|\VEC{y}\|\leq N} \left(1+\|\VEC{y}\|^2\right)^{k_1}
\dx{\VEC{y}} +2C \left(1+N^2\right)^{k_1-k_2} \ .
\end{align*}
Given $\epsilon>0$, there exists $N>0$ such that
$\displaystyle 2C \left(1+N^2\right)^{k_1-k_2} < \epsilon/2$ because $k_1-k_2<0$.
For this $N$, since $\displaystyle \left\{ \hat{g}_i^{[i]} \right\}_{i=1}^\infty$
converges uniformly on the compact set $\overline{B_N(\VEC{0})}$,
there exists $J>0$ such that
\[
\sup_{\|\VEC{x}\|\leq N}
\left| \hat{g}_i^{[i]}(\VEC{x}) - \hat{g}_j^{[j]}(\VEC{x}) \right|^2
\, \int_{\|\VEC{y}\|\leq N} \left(1+\|\VEC{y}\|^2\right)^{k_1}
\dx{\VEC{y}} < \frac{\epsilon}{2}
\]
for $j,k > J$.  Thus,
$\displaystyle \left\|g_i^{[i]} - g_j^{[j]}\right\|_{k_1,\rho}^2 < \epsilon$
for $j,k > J$.
This prove that $\displaystyle \left\{g_i^{[i]} \right\}_{i=1}^\infty$
is a Cauchy sequence in
$\displaystyle H^{k_1,2}(\RR^n)$.  Since $\displaystyle H^{k_1,2}(\RR^n)$
is a Banach space, this series converges in
$\displaystyle H^{k_1,2}(\RR^n)$.
\end{proof}

\begin{theorem}[Poincar's Ineguality] \label{sob_pt_carre}
Let $\displaystyle \Omega \subset \RR^n$ be an open subset contained
in the region $\displaystyle R= \{ \VEC{x} \in \RR^n : a < x_n < b \}$.  Let
\begin{equation} \label{sob_pc_norm}
\|f \|_{k,2,\ast} = \left( \sum_{|\alpha|=k}
\| \diff^\alpha f \|_{2,\Omega}^2 \right)^{1/2}
\end{equation}
for $\displaystyle f \in H^{k,2}_0(\Omega)$.
Then, there exists a constant $C$ such that
$\displaystyle \|f\|_{k,2,\Omega} \leq C \| f \|_{k,2,\ast}$ for
all $\displaystyle f \in H^{k,2}_0(\Omega)$.
\index{Poincar's Ineguality}
\end{theorem}

\begin{rmk}
If follows from Poincar's Inequality that, if
$\displaystyle \Omega \subset \RR^n$ is an open subset contained between two
parallel hyperplanes, then $\|\cdot\|_{k,2,\ast}$ is a norm on
$\displaystyle H^{k,2}_0(\Omega)$ equivalent to the norm
$\|\cdot\|_{k,2,\Omega}$.  \label{ell_equivNorms}
\end{rmk}

\begin{proof}
We only need to prove that there exists a constant $C$ such that
\begin{equation} \label{sobPtCarreEq1}
  \| \diff^\alpha f \|_{2,\Omega} \leq C \|f\|_{k,2,\ast}
\end{equation}
for $\displaystyle f \in H^{k,2}_0(\Omega)$ and $|\alpha|<k$.

Recall that the $\displaystyle \diff^\alpha$ are derivatives in the sense of
distributions.  Moreover, it is enough to proof (\ref{sobPtCarreEq1}) for
$f \in \DD(\Omega)$ since $\DD(\Omega)$ is dense in
$\displaystyle H^{1,2}_0(\Omega)$
by definition.  We have that
$\displaystyle \| \diff^\alpha g \|_{2,\Omega} \leq \|g\|_{k,2}$
and $\displaystyle \|g\|_{k,2,\ast} \leq \|g\|_{k,2,\Omega}$ for
$\displaystyle g \in H^{k,2}_0(\Omega)$ and $0\leq |\alpha|<k$.  Hence, if
$\displaystyle \left\{\phi_i\right\}_{i=1}^\infty$ converges to 
$\displaystyle f \in H^{k,2}_0(\Omega)$ according to the norm
$\|\cdot\|_{k,2,\Omega}$, then
$\displaystyle \| \diff^\alpha \phi_i \|_{2,\Omega}
\rightarrow \| \diff^\alpha f \|_{2,\Omega}$
and $\displaystyle \|\phi_i\|_{k,2,\ast} \rightarrow \|f\|_{k,2,\ast}$
as $i\rightarrow \infty$.  So,
$\displaystyle \| \diff^\alpha \phi_i \|_{2,\Omega}
\leq C \|\phi_i\|_{k,2,\ast}$ for
all $i$ implies that
$\displaystyle \| \diff^\alpha f \|_{2,\Omega} \leq C \|f\|_{k,2,\ast}$.

The proof of (\ref{sobPtCarreEq1}) is by induction on $k$.  Consider $k=1$.

We write $\displaystyle \VEC{x}\in \RR^n$ as
$\VEC{x} = (\breve{\VEC{x}}, x_n)$ with
$\displaystyle \breve{\VEC{x}} \in \RR^{n-1}$ and $x_n \in \RR$.  Since
$\displaystyle \phi(\VEC{x})
= \int_a^{x_n} \pdydx{\phi}{x_n}(\breve{\VEC{x}}, t) \dx{t}$
for $\phi \in \DD(\Omega)$, we get from Schwarz inequality that
\begin{align*}
\left|\phi(\VEC{x})\right|^2 &= \left( \int_a^{x_n}
\pdydx{\phi}{x_n} (\VEC{x}',t) \dx{t} \right)^2 
\leq \left(\int_a^{x_n}
\left| \pdydx{\phi}{x_n} (\VEC{x}',t)\right|^2 \dx{t}\right)\,
\left( \int_a^{x_n} \dx{t}\right) \\
&\leq (b-a) \int_a^{x_n} \left| \pdydx{\phi}{x_n} (\VEC{x}',t)\right|^2 \dx{t}
\end{align*}
for $\VEC{x} \in \Omega$ and $\phi \in \DD(\Omega)$.  Hence,
\begin{align*}
\|\phi\|_{2,\Omega}^2 &= \int_\Omega \left|\phi(\VEC{x})\right|^2\dx{\VEC{x}} 
= \int_R \left|\phi(\VEC{x})\right|^2\dx{\VEC{x}}
\leq (b-a) \int_a^b \int_{\RR^{n-1}} \left(
\int_a^{x_n} \left| \pdydx{\phi}{x_n} (\breve{\VEC{x}},t)\right|^2 \dx{t}\right)
\dx{\breve{\VEC{x}}} \dx{x_n} \\
& \leq (b-a) \int_a^b \left( \int_{\RR^{n-1}}
\int_a^b \left| \pdydx{\phi}{x_n} (\breve{\VEC{x}},t)\right|^2 \dx{t}
\dx{\breve{\VEC{x}}} \right) \dx{x_n}
= (b-a)^2 \left\| \pdydx{\phi}{x_n} \right\|_{2,\Omega}^2 \leq (b-a)^2
\| f \|_{1,2,\ast}^2
\end{align*}
for $\phi \in \DD(\Omega)$.  As usual $\phi \in \DD(\Omega)$ is
extended to $R$ by $\phi(\VEC{x}) = 0$ for $\VEC{x} \in R \setminus \Omega$.
This proves (\ref{sobPtCarreEq1}) for $k=1$ with $C=b-a$.

We assume that (\ref{sobPtCarreEq1}) is true for $k=j$ and consider the claim
for $k=j+1$.  Note that
$\displaystyle H^{j+1,2}_0(\Omega) \subset H^{j,2}_0(\Omega)$.
By induction, there exists a constant $C_1$ such that
$\displaystyle \| \diff^\alpha \phi \|_{2,\Omega}
\leq C_1 \|\phi\|_{j,2,\ast}$ for 
all $\phi \in \DD(\Omega)$ and $|\alpha| < j$.  So we only have to prove that
there exists a constant $C_2$ such that
$\displaystyle \| \diff^\alpha \phi \|_{2,\Omega}
\leq C_2 \|\phi\|_{j+1,2,\ast}$ for
$|\alpha|=j$ and $\phi \in \DD(\Omega)$.

The reasoning for $k=1$ applied to $\displaystyle \diff^\alpha \phi$
instead of $\phi$ shows
that $\displaystyle \|\diff^\alpha \phi\|_{2,\Omega} \leq
(b-a) \| \diff^\alpha \phi \|_{1,2,\ast}$
for $|\alpha|=j$ and $\phi \in \DD(\Omega)$.  But
\[
\| \diff^\alpha \phi \|_{1,2,\ast}^2 = 
\sum_{j=1}^n \left\| \diff^{\VEC{e}_j} \diff^\alpha \phi \right\|_{2,\Omega}^2 \leq
\sum_{|\alpha|=j+1} \| \diff^\alpha \phi \|_{2,\Omega}^2 = \|\phi\|_{j+1,2,\ast}^2
\]
for all $\phi \in \DD(\Omega)$.  Thus, with $C_2=b-a$, we have
$\displaystyle \| \diff^\alpha \phi \|_{2,\Omega}
\leq C_2 \|\phi\|_{j+1,2,\ast}$ for
$|\alpha|=j$ and $\phi \in \DD(\Omega)$.
This proves (\ref{sobPtCarreEq1}) for $k=j+1$ with $C=C_1 C_2$, and
complete the proof by induction.
\end{proof}

\section{Trace Operators} \label{sectTraceOp}

The trace theorems allow us to generalize boundary conditions to
functions defined almost everywhere.  We will make an extensive use of
the fractional Sobolev spaces $\displaystyle H^{s,2}(\RR^n)$ to define
the trace operators.

A detailed study of trace operators is done in \cite{LiMa1}.

Before studying the general trace operator, we consider a simple trace
theorem for $\displaystyle u \in H^{1,2}(\Omega)$, where $\Omega$ is a
bounded open subset of $\displaystyle \RR^n$ with a nice boundary.

\begin{prop}
Suppose that $\Omega$ is a bounded open subset of $\displaystyle \RR^n$ and that
$\partial \Omega$ is a manifold of class $\displaystyle C^2$.  There
exists $C>0$ such that
\[
\left\| u \right\|_{2,\partial \Omega}
= \left( \int_{\partial \Omega} \left|u(\VEC{x})\right|^2
\dss{S}{x} \right)^{1/2}
\leq C \| u\|_{1,2,\Omega}
\]
for all $\displaystyle u \in C^1(\overline{\Omega})$.
\end{prop}

\begin{proof}
Let $\VEC{\nu}(\VEC{z})$ be the outward unit normal to
$\partial \Omega$ at $\VEC{z} \in \partial \Omega$ and
$N_\eta$ be a tubular neighbourhood of $\partial \Omega$; in
particular,
$\displaystyle N_\eta = \left\{ \VEC{x} + t\, \VEC{\nu}(\VEC{x}) : \VEC{x} \in
\partial \Omega \ , \ |t|<\eta \right\}$.

Choose $\displaystyle \phi \in \DD(\RR)$ such that $|\phi|\leq 1$,
$\phi(0)=1$ and $\supp \phi \subset ]-\eta,\eta[$.
We extend $\displaystyle \VEC{\nu}:\partial \Omega \rightarrow \RR^n$
to $\displaystyle \RR^n$ as follows.
\[
\VEC{\nu}(\VEC{z}) =
\begin{cases}
\phi(t)\VEC{\nu}(\VEC{x}) & \quad \text{if}
\ \VEC{z} = \VEC{x}+t\VEC{\nu}(\VEC{x}) \ \text{with} \ 
\VEC{x} \in \partial \Omega\ \text{and} \ |t|<\eta \ . \\
0 & \quad \text{if}\ \VEC{z} \not\in N_\eta
\end{cases}
\]
Note that $\displaystyle \VEC{\nu} \in C^1(\RR^n)$ has a compact support inside
$N_\eta$.  Using the divergence theorem, we find that
\begin{align*}
&\left| \int_{\partial \Omega} |u(\VEC{x})|^2 \dss{S}{x} \right|
= \left| \int_{\partial \Omega} \left( |u(\VEC{x})|^2
\VEC{\nu}(\VEC{x})\right)\cdot \VEC{\nu}(\VEC{x}) \dss{S}{x}
\right|
= \left| \int_{\Omega} \diV \left( |u(\VEC{x})|^2
\VEC{\nu}(\VEC{x})\right) \dx{\VEC{x}} \right| \\
&\qquad = \left| \int_{\Omega} \sum_{j=1}^n
\left( u(\VEC{x}) \overline{\pdydx{u}{x_j}}(\VEC{x}) \nu_j(\VEC{x})
+ \overline{u}(\VEC{x}) \pdydx{u}{x_j}(\VEC{x}) \nu_j(\VEC{x})
+ |u(\VEC{x})|^2 \pdydx{\nu_j}{x_j}(\VEC{x}) \right) \dx{\VEC{x}}
\right| \\
&\qquad \leq C_1 \int_{\Omega}
\left( 2 \sum_{j=1}^n
\left|u(\VEC{x}) \overline{\pdydx{u}{x_j}}(\VEC{x})\right|
+ n\,|u(\VEC{x})|^2 \right) \dx{\VEC{x}} \  ,
\end{align*}
where
\[
C_1 = \max \left\{
\max_{\substack{\VEC{x}\in N_\eta\\ 1\leq j\leq n}} 
|\nu_j(\VEC{x})| \ , \ 
\max_{\substack{\VEC{x}\in N_\eta\\ 1\leq j\leq n}} 
\left|\pdydx{\nu_j}{x_j}(\VEC{x})\right| \right\} \  .
\]
Using Schwarz inequality, we get
\begin{align*}
\|u\|_{2,\Omega}^2
&=\left| \int_{\partial \Omega} |u(\VEC{x})|^2 \dss{S}{x} \right|
\leq C_1 \left( 2 \sum_{j=1}^n \int_{\Omega}
\left|u(\VEC{x}) \overline{\pdydx{u}{x_j}}(\VEC{x})\right| \dx{\VEC{x}}
+ \int_{\Omega} n\,\left|u(\VEC{x})\right|^2 \dx{\VEC{x}} \right) \\
&\leq C_1 \left( 2 \sum_{j=1}^n \left( \int_{\Omega}
\left|u(\VEC{x})\right|^2 \dx{\VEC{x}}\right)^{1/2}
\left( \int_{\Omega} \left|\pdydx{u}{x_j}(\VEC{x})\right|^2
\dx{\VEC{x}} \right)^{1/2}
+ \int_{\Omega} n\,\left|u(\VEC{x})\right|^2 \dx{\VEC{x}} \right) \\
&\leq C_1 \left( \sum_{j=1}^n \left( \int_{\Omega}
\left|u(\VEC{x})\right|^2 \dx{\VEC{x}} +
\int_{\Omega} \left|\pdydx{u}{x_j}(\VEC{x})\right|^2
\dx{\VEC{x}} \right)
+ \int_{\Omega} n\,\left|u(\VEC{x})\right|^2 \dx{\VEC{x}} \right) \\
&= 2 C_1 (n+1) \int_{\Omega} \left|u(\VEC{x})\right|^2 \dx{\VEC{x}}
+ C_1 \, \sum_{j=1}^n \int_{\Omega} \left|\pdydx{u}{x_j}(\VEC{x})\right|^2
\dx{\VEC{x}}
\leq C^2 \| u \|_{1,2,\Omega}^2
\end{align*}
with $\displaystyle C^2 = 2(n+1)C_1$.  Note that we have used the inequality
$\displaystyle 2ab \leq a^2+b^2$ to get the third inequality above.
\end{proof}

\begin{cor}[Elementary trace operator]
Suppose that $\Omega$ is a bounded open subset of $\displaystyle \RR^n$ and that
$\partial \Omega$ is a manifold of class $\displaystyle C^2$.  The
restriction map
\begin{align*}
T:C^1(\overline{\Omega}) & \rightarrow C^1(\partial \Omega) \\
u &\mapsto u\big|_{\partial \Omega}
\end{align*}
can be continuously extended to a map
$\displaystyle T:H^{1,2}(\Omega) \rightarrow L^2(\partial \Omega)$.
\end{cor}

\begin{proof}
Since 
\begin{equation} \label{sobolev_easy_trace}
\left\| u \right\|_{2,\partial \Omega}
\leq C \| u\|_{1,2,\Omega}
\end{equation}
for all $\displaystyle u \in C^1(\overline{\Omega})$, 
and $\displaystyle C^1(\overline{\Omega}) \supset C^\infty(\overline{\Omega})$
is dense in $\displaystyle H^{1,2}(\Omega)$ with
respect to the norm $\|\cdot\|_{1,2,\Omega}$, we may
extend the restriction map $T$ to $\displaystyle H^{1,2}(\Omega)$ as follows.

Given $\displaystyle u\in H^{1,2}(\Omega)$, choose
$\displaystyle \left\{ u_j\right\}_{j=0}^\infty
\subset C^1(\overline{\Omega})$ such that
$\|u_j - u\|_{1,2,\Omega} \rightarrow 0$ as $j\rightarrow \infty$.
From (\ref{sobolev_easy_trace}),
$\displaystyle \left\{ u_j\big|_{\partial \Omega} \right\}_{j=0}^\infty$ is a
Cauchy sequence in $\displaystyle L^2(\partial \Omega)$.  Thus there exists
$\displaystyle f \in L^2(\partial \Omega)$ such
that $\displaystyle \left\{ u_j\big|_{\partial \Omega} \right\}_{j=0}^\infty$
converges to $f$ in $\displaystyle L^2(\partial \Omega)$.  We set $T(u) = f$.

The procedure is independent of the chosen sequence 
$\displaystyle \left\{ u_j\right\}_{j=0}^\infty \subset C^1(\overline{\Omega})$.
If
$\displaystyle \left\{ v_j\right\}_{j=0}^\infty \subset C^1(\overline{\Omega})$
is another sequence such that
$\|v_j - u\|_{1,2,\Omega} \rightarrow 0$ as $j\rightarrow \infty$ and
$\displaystyle g \in L^2(\partial \Omega)$ is the limit of
$\displaystyle \left\{ v_j\big|_{\partial \Omega} \right\}_{j=0}^\infty$ in
$\displaystyle L^2(\partial \Omega)$, then (\ref{sobolev_easy_trace}) yields
\[
\left\| u_j - v_j \right\|_{2,\partial \Omega}
\leq C \| u_J - v_j\|_{1,2,\Omega} \rightarrow 0 \quad \text{as} \quad 
j\rightarrow \infty \ .
\]
Hence, $f=g$ almost everywhere.
\end{proof}

The first domain with a boundary that we consider for the general space
$\displaystyle H^k(\Omega)$ is $\displaystyle \Omega = \RR^n_+$.
Its boundary is the hyperplane
$\displaystyle \RR^n_0 \equiv \{ \VEC{x}\in \RR^n : x_n = 0 \} \cong \RR^{n-1}$.

\begin{prop} \label{TraceRnRnp}
There exists a bounded linear mapping
$\displaystyle T:H^k(\RR^n) \rightarrow H^{k-1/2}(\RR^{n-1})$
such that
$\displaystyle T(\phi)(\VEC{z}) = \phi(\VEC{z},0)$
for all $\displaystyle \phi\in\SS(\RR^n)$ and all
$\displaystyle \VEC{z} \in \RR^{n-1}$.
The operator $T$ is called a
{\bfseries trace operator}\index{Sobolev Space!Trace Operator},

Moreover, if $\displaystyle f \in H^k(\RR^n)$ and
$\displaystyle W \subset \RR^n$ is an open set
such that $\supp f \subset W$, then we may assume that
$\displaystyle \supp T(f) \subset W \cap \RR^n_0$.
\end{prop}

\begin{rmk}
Obviously, when we write
$\displaystyle \supp T(f) \subset W \cap \RR^n_0$, 
we view $W \cap \RR^n_0$ has a subset of $\RR^{n-1}$.  To be more
precise, we should have written that
$\displaystyle \supp T(f) \subset \{ \VEC{z} \in \RR^{n-1}:
(\VEC{z},0) \in W \}$.
However, we would have lost the visual
aspect of the statement; namely, that
$\displaystyle \supp T(f)$ is "in" $\displaystyle \partial \RR^n_+ = \RR^n_0$.
We will keep using this abuse of language in the rest of this section.
\end{rmk}

\begin{proof}
In this proof, we sometime write $\displaystyle \VEC{x}\in \RR^n$ as
$\VEC{x} = (\breve{\VEC{x}}, x)$ for
$\displaystyle \breve{\VEC{x}}\in \RR^{n-1}$ and $x\in \RR$.
Moreover,
$\phi_{\breve{\VEC{x}}}(x) = \phi(\breve{\VEC{x}},x) = \phi(\VEC{x})$ for
$\displaystyle \phi \in \SS(\RR^n)$.  We use a similar notation for
$\displaystyle \VEC{y} \in \RR^n$.

Given $\displaystyle \phi \in \SS(\RR^n)$, we have that
\[
(\phi_{\breve{\VEC{x}}})^\wedge(y) = \int_{-\infty}^\infty \phi(\breve{\VEC{x}},x)
e^{-ixy} \dx{\mu(x)}
\]
for $y \in \RR$.  Since
$\displaystyle \phi_{\breve{\VEC{x}}} \in \SS(\RR) \subset L^1(\RR)$ and
$\displaystyle (\phi_{\breve{\VEC{x}}})^\wedge \in \SS(\RR) \in L^1(\RR)$ by
Proposition~\ref{distr_frr_tempT}, it follows from
Proposition~\ref{distr_inv_four_transf} that the inverse Fourier transform
of $\displaystyle (\phi_{\breve{\VEC{x}}})^\wedge$ is
$\phi_{\breve{\VEC{x}}}$.  If we assume that $T(\phi)$ for
$\displaystyle \phi \in \SS(\RR^n)$ satisfies
$T(\phi)(\VEC{z}) = \phi(\VEC{z},0)$ for all
$\displaystyle \VEC{z} \in \RR^{n-1}$, we have that
\[
g(\VEC{z}) \equiv T(\phi)(\VEC{z}) = \phi_{\VEC{z}}(0)
= \F^{-1}\left( (\phi_{\VEC{z}})^\wedge\right)(0)
= \int_{-\infty}^\infty (\phi_{\VEC{z}})^\wedge(y) \dx{\mu(y)}
\]
for $\displaystyle \VEC{z} \in \RR^{n-1}$.
Moreover,
\begin{align*}
\hat{g}(\VEC{w}) &= \int_{\RR^{n-1}} \left( \int_{-\infty}^\infty
(\phi_{\VEC{z}})^\wedge(y) \dx{\mu(y)} \right)
e^{-i\VEC{w}\cdot \VEC{z}} \dx{\mu(\VEC{z})}
= \int_{-\infty}^\infty \left( \int_{\RR^{n-1}} 
(\phi_{\VEC{z}})^\wedge(y) e^{-i\VEC{w}\cdot \VEC{z}}
\dx{\mu(\VEC{z})} \right) \dx{\mu(y)} \\
&= \int_{-\infty}^\infty \left( \int_{\RR^{n-1}} 
\left(\int_{-\infty}^\infty \phi(\VEC{z},x)
e^{-ixy} \dx{\mu(x)}\right) e^{-i \VEC{w}\cdot \VEC{z}}
\dx{\mu(\VEC{z})} \right) \dx{\mu(y)}
= \int_{-\infty}^\infty \hat{\phi}(\VEC{w},y) \dx{\mu(y)}
\end{align*}
for all $\displaystyle \VEC{w}\in \RR^{n-1}$.
Hence, using Schwarz inequality, we get
\begin{align*}
&\|g\|_{k-1/2,\rho}^2 = \int_{\RR^{n-1}} \left| \hat{g}(\VEC{w})
\right|^2 \left( 1 + \|\VEC{w}\|^2\right)^{k-1/2} \dx{\VEC{w}}
= \int_{\RR^{n-1}} \left|
\int_{-\infty}^\infty \hat{\phi}(\VEC{w},y) \dx{\mu(y)}
\right|^2 \left( 1 + \|\VEC{w}\|^2\right)^{k-1/2} \dx{\VEC{w}} \\
&\quad = \int_{\RR^{n-1}} \left|
\int_{-\infty}^\infty \hat{\phi}(\VEC{w},y)
\left( 1 + \|\VEC{w}\|^2 + y^2\right)^{k/2}
\left( 1 + \|\VEC{w}\|^2 + y^2\right)^{-k/2} \dx{\mu(y)}
\right|^2 \left( 1 + \|\VEC{w}\|^2\right)^{k-1/2} \dx{\VEC{w}} \\
&\quad \leq \int_{\RR^{n-1}}
\left[\left( \int_{-\infty}^\infty \left|\hat{\phi}(\VEC{w},y)\right|^2
\left( 1 + \|\VEC{w}\|^2 + y^2\right)^k \dx{\mu(y)} \right)
\left( \int_{-\infty}^\infty \left( 1 + \|\VEC{y}\|^2 + y^2\right)^{-k}
  \dx{\mu(y)} \right) \right. \\
&\qquad \qquad \qquad \left. \left( 1 + \|\VEC{w}\|^2\right)^{k-1/2}\right]
\dx{\VEC{w}}
\end{align*}
However, with the substitution $y = \sqrt{1+\|\VEC{w}\|^2}\, z$, we get
\[
\int_{-\infty}^\infty \left( 1 + \|\VEC{w}\|^2 + y^2\right)^{-k}
\dx{\mu(y)}
= \frac{1}{\left(1+\|\VEC{w}\|^2\right)^{k-1/2}}
\int_{-\infty}^\infty \left( 1 + z^2\right)^{-k}
\dx{\mu(z)} \ .
\]
Therefore,
\begin{align*}
\|g\|_{k-1/2,\rho}^2 &\leq 
\int_{\RR^{n-1}} \left[
\left( \int_{-\infty}^\infty \left|\hat{\phi}(\VEC{w},y)\right|^2
\left( 1 + \|\VEC{w}\|^2+y^2\right)^k \dx{\mu(y)} \right) \right. \\
& \qquad \left.
\left( \frac{1}{\left(1+\|\VEC{w}\|^2\right)^{k-1/2}}
\int_{-\infty}^\infty \left( 1 + z^2\right)^{-k} \dx{\mu(z)}
\right) \left( 1 + \|\VEC{w}\|^2\right)^{k-1/2} \right] \dx{\VEC{w}} \\
&= \int_{-\infty}^\infty \left( 1 + z^2\right)^{-k} \dx{\mu(z)}
\int_{\RR^{n-1}} \int_{-\infty}^\infty \left|\hat{\phi}(\VEC{w},y)\right|^2
\left( 1 + \|\VEC{w}\|^2+y^2\right)^k \dx{\mu(y)} \dx{\VEC{w}}
= C \| \phi\|_{k,\rho}^2
\end{align*}
with $\displaystyle C = (2\pi)^{-1/2}
\int_{-\infty}^\infty \left( 1 + z^2\right)^{-k} \dx{\mu(z)} < \infty$.

We have shown that $\|T(\phi)\|_{k-1/2,\rho} \leq \sqrt{C}\, \|\phi\|_{k,\rho}$
for all $\displaystyle \phi \in \SS(\RR^n)$.  Since
$\displaystyle \SS(\RR^n)$ is dense in 
$\displaystyle H^{k,2}(\RR^n)$, we can extend $T$ to
$\displaystyle H^{k,2}(\RR^n)$ and still
have $\displaystyle \|T(f)\|_{k-1/2,\rho} \leq \sqrt{C}\, \|f\|_{k,\rho}$ for all
$\displaystyle f \in H^{k,2}(\RR^n)$.

For the last statement of the theorem, choose
$\displaystyle \phi \in \DD(\RR^n)$
such that $\phi(\VEC{x}) = 1$ for $\VEC{x} \in \supp f$ and
$\phi(\VEC{x}) = 0$ for $\displaystyle \VEC{x} \in \RR^n \setminus W$.
Then $f = \phi f$ and $T(f) = T(\phi) T(f)$
\footnote{We have by construction that
$T(\phi \phi_i) = T(\phi) T(\phi_i)$ for
$\displaystyle \phi \in \DD(\RR^n)$ and
$\displaystyle \phi_i \in \SS(\RR^n)$.  If $\phi_i \to f$ in
$\displaystyle H^k(\RR^n)$ as $i \to \infty$,
then $\phi \phi_i \to \phi f$ in $\displaystyle H^k(\RR^n)$
according to Proposition~\ref{sob_T_dd_wk2}, and
$\displaystyle T(\phi f) = \lim_{i\to \infty} T(\phi \phi_i) =
\lim_{i\to \infty} T(\phi) T(\phi_i) = T(\phi) T(f)$.}.
Since $T(\phi)(\VEC{z}) = \phi(\VEC{z},0)$, we
have that $T(f)(\VEC{z}) = 0$ for
$\displaystyle \VEC{z} \not\in \{\VEC{z} \in \RR^{n-1} : (\VEC{z},0) \in W\}$.
\end{proof}

\begin{theorem} \label{TraceT0}
Let $T$ be the trace operator defined in the previous proposition and
$\displaystyle E: H^k(\RR^n_+) \to H^k(\RR^n)$ be a strong
$k$-extension operator.  Such an operator exists according to
Theorem~\ref{sob_Rp_ext}.
Then, $\displaystyle T_0 = T \circ E:H^k(\RR^n_+)
\rightarrow H^{k-1/2}(\RR^{n-1})$ is continuous and onto.
Moreover, if $\displaystyle f = \phi\big|_{\RR^n_+}$ for some
$\displaystyle \phi \in \SS(\RR^n)$, then
$T_0(f)(\VEC{z}) = f(\VEC{z},0)$ for $\displaystyle \VEC{z} \in \RR^{n-1}$.
The operator $T_0$ is also called a
{\bfseries trace operator}\index{Sobolev Space!Trace Operator},
\end{theorem}

\begin{proof}
Since $T$ and $E$ are continuous, we obviously have that the
composition $T_0 = T \circ E$ is continuous.

To prove that $T_0$ is onto, we prove that there exists a right
inverse to $T_0$; namely a continuous mapping
$\displaystyle S_0:H^{k-1/2}(\RR^{n-1}) \to H^k(\RR^n_+)$.
Since $\displaystyle \SS(\RR^{n-1})$ is dense in
$\displaystyle H^{k-1/2}(\RR^{n-1})$,
we only have to defined the mapping $S_0$ on $\SS(\RR^{n-1})$.

We consider the mapping $\displaystyle S:\SS(\RR^{n-1}) \to \SS(\RR^n)$
defined by
\[
S(\phi)(\VEC{x}) = \F^{-1}\left(
\frac{(1+\|\breve{\VEC{y}}\|^2)^{k-1/2}}{C (1+ \|\VEC{y}\|^2)^k}
\F(\phi)(\breve{\VEC{y}}) \right)(\VEC{x})
\]
for $\displaystyle \phi \in \SS(\RR^{n-1})$ and
$\displaystyle \VEC{x} \in \RR^n$, where
$\displaystyle C = (2\pi)^{-1/2} \int_{\RR} (1+x^2)^{-k}\dx{x}$ and
$\displaystyle \VEC{y} = (\breve{\VEC{y}},y_n) \in \RR^n$.  Since the Fourier
transform is a bijection from the space of rapidly decreasing function
to itself, we have that all the functions involved in the definition
of $S$ are rapidly decreasing functions.

We prove that $S$ is a continuous mapping from
$\displaystyle H^{k-1/2}(\RR^{n-1})$ to $\displaystyle H^k(\RR^n)$.
We have that
\begin{align*}
\|S(\phi)\|_{k,\rho}^2
&= \int_{\RR^n} \left| \F(S(\phi))(\VEC{y}) \right|^2
\left( 1 + \|\VEC{y}\|^2\right)^k \dx{\VEC{y}} \\
&= \int_{\RR^n} \left|
\frac{(1+\|\breve{\VEC{y}}\|^2)^{k-1/2}}{C (1+ \|\VEC{y}\|^2)^k}
\F(\phi)(\breve{\VEC{y}}) \right|^2
\left( 1 + \|\VEC{y}\|^2\right)^k \dx{\VEC{y}} \\
&= \int_{\RR^{n-1}} \frac{1}{C^2} \left( \int_{\RR}
\frac{1}{(1+ \|\VEC{y}\|^2)^k} \dx{y_n} \right)
(1+\|\breve{\VEC{y}}\|^2)^{2k-1} \left| \F(\phi)(\breve{\VEC{y}}) \right|^2
\dx{\breve{\VEC{y}}} \\
&= \frac{(2\pi)^{1/2}}{C} \int_{\RR^{n-1}}
(1+\|\breve{\VEC{y}}\|^2)^{k-1/2} \left| \F(\phi)(\breve{\VEC{y}}) \right|^2
\dx{\breve{\VEC{y}}} = \frac{(2\pi)^{1/2}}{C} \|\phi\|_{k-1/2.\rho}^2
\end{align*}
because
\begin{align}
\int_{\RR} \frac{1}{(1 + \|\VEC{y}\|^2)^k} \dx{y_n}
&= \int_{\RR} \frac{1}{(1 + \|\breve{\VEC{y}}\|^2 + y_n^2)^k} \dx{y_n}
= \frac{1}{(1 + \|\breve{\VEC{y}}\|^2)^{k-1/2}}
\int_{\RR} \frac{1}{(1 + u^2)^k} \dx{u} \nonumber \\
&= \frac{C (2\pi)^{1/2}}{(1 + \|\breve{\VEC{y}}\|^2)^{k-1/2}}
\label{TraceT0Eq1}
\end{align}
after the substitution
$\displaystyle y_n = \left(1 + \|\breve{\VEC{y}}\|^2\right)^{1/2} u$.

We have shown that
$\displaystyle \|S(\phi)\|_{k,\rho}
= (2\pi)^{1/4} C^{-1/2} \|\phi\|_{k-1/2,\rho}$
for all $\displaystyle \phi \in \SS(\RR^{n-1})$.
Since $\displaystyle \SS(\RR^{n-1})$ is dense in
$\displaystyle H^{k-1/2}(\RR^{n-1})$.  We can
extend $S$ to $\displaystyle H^{k-1/2}(\RR^{n-1})$ and still
have
$\displaystyle \|S(f)\|_{k,\rho} = (2\pi)^{1/4} C^{-1/2} \|f\|_{k-1/2,\rho}$
for all $\displaystyle f \in H^{k-1/2}(\RR^{n-1})$.

The operator $S_0$ is defined by $S_0 = i \circ S$ where
$\displaystyle i: H^{k}(\RR^n) \to H^{k}(\RR^n_+)$ is the
continuous mapping defined by $\displaystyle i(f) = f\big|_{\RR^n_+}$ for all
$\displaystyle f \in H^{k}(\RR^n)$.  We obviously have that
$\displaystyle \|i(f)\|_{k,2,\RR^n_+} = \left\|f\right\|_{k,2,\RR^n_+}
\leq \|f \|_{k,2,\RR^n}$.  Because of the equivalence between the
norms $\|\cdot\|_{k,2,\RR^n}$ and $\|\cdot\|_{k,\rho}$, there exists a
constant $Q$ such that
$\displaystyle \|S_0(f)\|_{k,2,\RR^n_+} \leq Q \|f\|_{k-1/2,\rho}$ for all
$\displaystyle f \in H^{k-1/2}(\RR^{n-1})$.

The only piece missing to complete the proof of the theorem is to show
that $S_0$ is really the right inverse of $T_0$.  Using
(\ref{TraceT0Eq1}), we get that
\begin{align*}
S(\phi)(\VEC{z},0)
&= \F^{-1}\left(
\frac{(1+\|\breve{\VEC{y}}\|^2)^{k-1/2}}{C(1+ \|\VEC{y}\|^2)^k}
\F(\phi)(\breve{\VEC{y}}) \right)(\VEC{z},0) \\
&= \frac{1}{(2\pi)^{n/2}}\,\int_{\RR^{n-1}} \int_{\RR} 
\frac{(1+\|\breve{\VEC{y}}\|^2)^{k-1/2}}{C(1+ \|\VEC{y}\|^2)^k}
\F(\phi)(\breve{\VEC{y}})\, e^{i \breve{\VEC{y}}\cdot \VEC{z}}
\dx{y_n} \dx{\breve{\VEC{y}}} \\
&= \frac{1}{(2\pi)^{n/2}}\,\int_{\RR^{n-1}} \left(
\int_{\RR} \frac{1}{(1+ \|\VEC{y}\|^2)^k} \dx{y_n} \right)
\frac{(1+\|\breve{\VEC{y}}\|^2)^{k-1/2}}{C}
\F(\phi)(\breve{\VEC{y}})\, e^{i \breve{\VEC{y}}\cdot \VEC{z}}
\dx{\breve{\VEC{y}}} \\
&= \frac{1}{(2\pi)^{(n-1)/2}}\,\int_{\RR^{n-1}}
\F(\phi)(\breve{\VEC{y}})\, e^{i \breve{\VEC{y}}\cdot \VEC{z}}
\dx{\breve{\VEC{y}}} = \F^{-1}\left(\F(\phi)\right)(\VEC{z})
= \phi(\VEC{z})  
\end{align*}
for all $\displaystyle \VEC{z} \in \RR^{n-1}$.  Therefore,
$T_0(S_0(\phi))(\VEC{z}) = T(S(\phi))(\VEC{z}) = S(\phi)(\VEC{z},0)
= \phi(\VEC{z})$ for all $\displaystyle \VEC{z} \in \RR^{n-1}$ and all
$\displaystyle \phi \in \SS(\RR^{n-1})$.  Hence,
$T_0(S_0(\phi)) = \phi$ for all $\displaystyle \phi \in \SS(\RR^{n-1})$.
We get that $T_0(S_0(f)) = f$ for all
$f \in \displaystyle H^{k-1/2}(\RR^{n-1})$
because $\displaystyle \SS(\RR^{n-1})$ is dense in
$\displaystyle H^{k-1/2}(\RR^{n-1})$.
\end{proof}

Since $\displaystyle \pdydxn{}{x_n}{j}$ is a bounded operator from
$\displaystyle H^k(\RR^n)$ to $\displaystyle H^{k-j}(\RR^n)$ for
$j\leq k$, we may define
$\displaystyle T_j : H^k(\RR^n_+) \to H^{k-j -1/2}(\RR^{n+1})$ 
as $\displaystyle T_j = T \circ \pdydxn{}{x_n}{j} \circ E$, where $T$
and $E$ were defined in Theorem~\ref{TraceT0}.  We get the following theorem.

\begin{theorem} \label{TraceTj}
Let $T$ be the trace operator defined in the previous proposition and
$\displaystyle E: H^k(\RR^n_+) \to H^k(\RR^n)$ be a strong
$k$-extension operator.  If $k > 1/2 +j$ with $j$ a non-negative
integer, then
$\displaystyle T_j = T \circ \pdydxn{}{x_n}{j} \circ E:H^k(\RR^n_+)
\rightarrow H^{k-j-1/2}(\RR^{n-1})$
is continuous and onto.
Moreover, if $\displaystyle f = \phi\big|_{\RR^n_+}$ for
$\displaystyle \phi \in \SS(\RR^n)$, then
$\displaystyle T_j(f)(\VEC{z}) = \pdydxn{f}{x_n}{j}(\VEC{z},0)$ for
$\displaystyle \VEC{z} \in \RR^{n-1}$.
The operator $T_j$ is also called a
{\bfseries trace operator}\index{Sobolev Space!Trace Operator},
\end{theorem}

\begin{proof}
Since $T$, $\displaystyle \pdydxn{}{x_n}{j}$ and $E$ are continuous,
we obviously have that their composition
$\displaystyle T_j = T \circ \pdydxn{}{x_n}{j} \circ E$ is continuous.

To prove that $T_j$ is onto, we do as we did for $T_0$ in the proof
of Theorem~\ref{TraceT0}; namely, we build a right inverse
$\displaystyle S_j : H^{k-j-1/2}(\RR^{n-1}) \to H^k(\RR^n_+)$ for $T_j$.
Since $\displaystyle \SS(\RR^{n-1})$ is dense in
$\displaystyle H^{k-j-1/2}(\RR^{n-1})$,
we only have to define $S_j$ on $\displaystyle \SS(\RR^{n-1})$.

We first consider the mapping $\displaystyle S:\SS(\RR^{n-1}) \to \SS(\RR^n)$
defined by
\[
S(\phi)(\VEC{x}) = x_n^j \F^{-1}\left(
\frac{(1+\|\breve{\VEC{y}}\|^2)^{k-j-1/2}}{C (1+ \|\VEC{y}\|^2)^{k-j}}
\F(\phi)(\breve{\VEC{y}}) \right)(\VEC{x})
\]
for $\displaystyle \phi \in \SS(\RR^{n-1})$ and
$\displaystyle \VEC{x} \in \RR^n$, where
$\displaystyle C = (2\pi)^{-1/2} j! \int_{\RR} (1+x^2)^{-k+j}\dx{x}$ and
$\VEC{y} = (\breve{\VEC{y}},y_n) \in \RR^n$.

To prove that $S$ is a continuous mapping from
$\displaystyle H^{k-j-1/2}(\RR^{n-1})$ to $\displaystyle H^k(\RR^n)$, we
note that
\begin{align*}
&\|S(\phi)\|_{k,\rho}^2
= \int_{\RR^n} \left| \F(S(\phi))(\VEC{y}) \right|^2 \left( 1 + \|\VEC{y}\|^2\right)^k
\dx{\VEC{y}} \\
&\quad = \int_{\RR^n} \left|\pdfdxn{\left(
\frac{(1+\|\breve{\VEC{y}}\|^2)^{k-j-1/2}}{C (1+ \|\VEC{y}\|^2)^{k-j}}
\F(\phi)(\breve{\VEC{y}}) \right)}{y_n}{j} \right|^2
\left( 1 + \|\VEC{y}\|^2\right)^k \dx{\VEC{y}} \\
&\quad = \int_{\RR^{n-1}} \frac{1}{C^2} \left( \int_{\RR}
\left| \pdfdxn{\left( \frac{1}{(1+ \|\VEC{y}\|^2)^{k-j}}
  \right)}{y_n}{j} \right|^2 (1 + \|\VEC{y}\|^2)^k  \dx{y_n} \right)
(1+\|\breve{\VEC{y}}\|^2)^{2k-2j-1} \left| \F(\phi)(\breve{\VEC{y}}) \right|^2
  \dx{\breve{\VEC{y}}} \\
&\quad = \int_{\RR^{n-1}} \frac{1}{C^2} \left( \frac{1}{(1+\|\breve{y}\|_2)^{k-j-1/2}}
\int_{\RR} \left| \sum_{0 \leq s \leq \intpt{j/2}}
C_{j,s} \frac{u^{j-2s}}{(1+u^2)^{k-s}} \right|^2 (1 + u^2)^k \dx{u} \right) \\
&\hspace{20em} (1+\|\breve{\VEC{y}}\|^2)^{2k-2j-1} 
  \left|\F(\phi)(\breve{\VEC{y}}) \right|^2 \dx{\breve{\VEC{y}}} \\
&\quad = Q_0^2  \int_{\RR^{n-1}}
(1+\|\breve{\VEC{y}}\|^2)^{k-j-1/2} \left| \F(\phi)(\breve{\VEC{y}}) \right|^2
  \dx{\breve{\VEC{y}}} = Q_0^2 \|\phi\|_{k-j-1/2.\rho}^2 \ ,
\end{align*}
where
\[
Q_0^2 =  = \frac{1}{C^2} \int_{\RR} \left| \sum_{0 \leq s \leq j/2}
C_{j,s} \frac{u^{j-2s}}{(1+u^2)^{k-s}} \right|^2 (1 + u^2)^k \dx{u}
\]
and the $C_{j,s}$ are constants depending on $k$ and $j$.
The substitution
$\displaystyle y_n = \left(1 + \|\breve{\VEC{y}}\|^2\right)^{1/2} u$
was used to obtain the fourth equality in the expression above.  We
also note that $\displaystyle \pdydx{}{y_n} =
\left(1 + \|\breve{\VEC{y}}\|^2\right)^{-1/2} \pdydx{}{u}$.

We have shown that $\|S(\phi)\|_{k,\rho} = Q_0 \|\phi\|_{k-1/2,\rho}$
for all $\displaystyle \phi \in \SS(\RR^{n-1})$ and some constant $Q_0$.
Since $\displaystyle \SS(\RR^{n-1})$ is dense in
$\displaystyle H^{k-j-1/2}(\RR^{n-1})$.  We can
extend $S$ to $\displaystyle H^{k-j-1/2}(\RR^{n-1})$ and still
have $\displaystyle \|S(f)\|_{k,\rho} = Q_0 \|f\|_{k-j-1/2,\rho}$ for all
$\displaystyle f \in H^{k-j-1/2}(\RR^{n-1})$.

The operator $S_j$ is defined by $S_j = i \circ S$ where
$\displaystyle i: H^{k}(\RR^n) \to H^{k}(\RR^n_+)$ is the
continuous mapping defined by $\displaystyle i(f) = f\big|_{\RR^n_+}$ for all
$\displaystyle f \in H^{k}(\RR^n)$.  Because of the equivalence between the
norms $\|\cdot\|_{k,2,\RR^n}$ and $\|\cdot\|_{k,\rho}$, there exists a
constant $Q_1$ such that
$\displaystyle \|S_j(f)\|_{k,2,\RR^n_+} \leq Q_1 \|f\|_{k-j-1/2,\rho}$ for all
$\displaystyle f \in H^{k-j-1/2}(\RR^{n-1})$.

To complete the proof of the theorem, we now show
that $S_j$ is the right inverse of $T_j$.
Using the substitution
$\displaystyle y_n = \left(1 + \|\breve{\VEC{y}}\|^2\right)^{1/2} u$, we
obtain
\begin{align*}
\int_{\RR} \frac{1}{(1 + \|\VEC{y}\|^2)^{k-j}} \dx{y_n}
&= \int_{\RR} \frac{1}{(1 + \|\breve{\VEC{y}}\|^2 + y_n^2)^{k-j}} \dx{y_n}
= \frac{1}{(1 + \|\breve{\VEC{y}}\|^2)^{k-j-1/2}}
\int_{\RR} \frac{1}{(1 + u^2)^{k-j}} \dx{u} \\
&= \frac{C (2\pi)^{1/2}}{(1 + \|\breve{\VEC{y}}\|^2)^{k-j-1/2} j!} \ .
\end{align*}
Hence,
\begin{align*}
\pdfdxn{S(\phi)}{x_n}{j}(\VEC{z},0)
&= j! \F^{-1}\left(
\frac{(1+\|\breve{\VEC{y}}\|^2)^{k-j-1/2}}{C(1+ \|\VEC{y}\|^2)^{k-j}}
\F(\phi)(\breve{\VEC{y}}) \right)(\VEC{z},0) \\
&= \frac{j!}{(2\pi)^{n/2}}\,\int_{\RR^{n-1}} \int_{\RR} 
\frac{(1+\|\breve{\VEC{y}}\|^2)^{k-j-1/2}}{C(1+ \|\VEC{y}\|^2)^{k-j}}
\F(\phi)(\breve{\VEC{y}})\, e^{i\breve{\VEC{y}}\cdot \VEC{z}}
\dx{y_n} \dx{\breve{\VEC{y}}} \\
&= \frac{j!}{(2\pi)^{n/2}}\,\int_{\RR^{n-1}} \left(
\int_{\RR} \frac{1}{(1+ \|\VEC{y}\|^2)^{k-j}} \dx{y_n} \right)
\frac{(1+\|\breve{\VEC{y}}\|^2)^{k-j-1/2}}{C}
\F(\phi)(\breve{\VEC{y}})\, e^{i\breve{\VEC{y}}\cdot \VEC{z}}
\dx{\breve{\VEC{y}}} \\
&= \frac{1}{(2\pi)^{(n-1)/2}}\,\int_{\RR^{n-1}}
\F(\phi)(\breve{\VEC{y}})\, e^{i\breve{\VEC{y}}\cdot \VEC{z}}
\dx{\breve{\VEC{y}}} = \F^{-1}\left(\F(\phi)\right)(\VEC{z})
= \phi(\VEC{z})
\end{align*}
for all $\displaystyle \VEC{z} \in \RR^{n-1}$, we get that
\[
  T_j(S_j(\phi))(\VEC{z}) = T \left( \pdfdxn{S(\phi)}{x_n}{j} \right)
  = \pdfdxn{S(\phi)}{x_n}{j}(\VEC{z},0) = \phi(\VEC{z})
\]
for all $\displaystyle \VEC{z} \in \RR^{n-1}$ and all
$\displaystyle \phi \in \SS(\RR^{n-1})$.

Hence, $T_j(S_j(\phi)) = \phi$ for all
$\displaystyle \phi \in \SS(\RR^{n-1})$.  We get
that $T_j(S_j(f)) = f$ for all $f \in \displaystyle H^{k-j-1/2}(\RR^{n-1})$
because $\displaystyle \SS(\RR^{n-1})$ is dense in
$\displaystyle H^{k-j-1/2}(\RR^{n-1})$.
\end{proof}

\begin{prop} \label{sobTrace0K}
Given $\displaystyle f \in H^k(\RR^n_+)$ and
$\displaystyle T_j:H^k\left(\RR^n_+\right) \to
H^{k-j-1/2}\left(\RR^{n-1}\right)$
defined in Theorem~\ref{TraceT0} for $j=0$ and Theorem~\ref{TraceTj}
for $j>0$.  If $\displaystyle \supp f \subset \RR^n_+$ is compact,
then $T_j(f) = 0$.  
\end{prop}

\begin{proof}
Since $\supp f \subset \RR^n_+$ is compact, we have that
$\displaystyle f \in H^k_0(\RR^n_+)$ according to Lemma~\ref{sob_w0_trad1}.
So, there exists a sequence
$\displaystyle \left\{ \xi_i \right\}_{i=1}^\infty \subset \DD(\RR^n_+)$
that converges to $f$ in $\displaystyle H^k_0(\RR^n_+)$.

Since
$\displaystyle T_j(\xi_i)(\VEC{z}) = \pdydxn{\xi_i}{x_n}{j}(\VEC{z},0) = 0$
for $\VEC{z} \in \RR^{n-1}$, we get from the continuity of $T_j$ on
$\displaystyle H^k(\RR^n_+)$ that
$\displaystyle T_j(f) = \lim_{i\to \infty} T_j(\xi_i) = 0$.
\end{proof}

\begin{prop} \label{sobTjDomain}
Given $\displaystyle f \in H^k(\RR^n_+)$ and
$\displaystyle T_j:H^k\left(\RR^n_+\right) \to H^{k-j-1/2}\left(\RR^{n-1}\right)$
defined in Theorem~\ref{TraceT0} for $j=0$ and Theorem~\ref{TraceTj}
for $j>0$.  If $\displaystyle V \subset \RR^n$ is an open set such that
$V \supset K = \{ (\VEC{z},0) : \VEC{z} \in \supp T_j(f)$, then there
exists $\displaystyle \tilde{f} \in H^k(\RR^n_+)$ such that
$\supp \tilde{f} \subset V$ and $T_j(\tilde{f}) = T_j(f)$.
\end{prop}

\begin{proof}
Choose an open set $W$ such that $K \subset W \subset \overline{W} \subset V$
and $\phi \in \DD(V)$ such that $\phi(\VEC{x}) = 1$ for $\VEC{x} \in W$.

Since $\displaystyle \DD(\RR^n)\big|_{\RR^n_+}$ is dense in
$\displaystyle H^k(\RR^n_+)$, there exists a sequence
$\displaystyle \left\{\xi_i\right\}_{i=1}^\infty \subset \DD(\RR^n)$
such that $\xi_i \to f$ in $\displaystyle H^k(\RR^n_+)$.
Since $\|g\|_{j,2,\RR^n_+} \leq \|g\|_{k,2,\RR^n_+}$ for $g \in H^k(\RR^n_+)$
and $0 \leq j \leq k$, we also have that $\xi_i \to f$ in
$\displaystyle H^j(\RR^n_+)$ as $i \to \infty$ for $j<k$.

Since $\displaystyle \phi \in \DD(\RR^n)$, we have from
Lemma~\ref{sob_T_dd_wkp} that 
$\phi \xi_i \to \phi f$ in $\displaystyle H^j(\RR^n_+)$ as $i \to \infty$
for $0 \leq j \leq k$.  Moreover,
\begin{align*}
T_j( \phi \xi_i)(\VEC{z}) &= \pdfdxn{(\phi \xi_i)}{x_n}{j}(\VEC{z},0)
= \sum_{m=0}^j \binom{j}{m} \pdydxn{\phi}{x_n}{j-m}(\VEC{z},0)\,
\pdydxn{\xi_i}{x_n}{m}(\VEC{z},0) \\
&= \sum_{m=0}^j \binom{j}{m} \pdydxn{\phi}{x_n}{j-m}(\VEC{z},0)\,
T_m(\xi_i)(\VEC{z})
\end{align*}
for all $\displaystyle \VEC{z} \in \RR^{n-1}$.
Since $\xi_i \to f$ in $\displaystyle H^m(\RR^n_+)$ as $i \to \infty$ for
$0 \leq m \leq j$, we get that
$\displaystyle T_m(\xi_i) = \pdydxn{\xi_i}{x_n}{m} \to T_m(f)$
in $\displaystyle H^{k-m-1/2}(\RR^{n-1})$
as $i \to \infty$ for $0 \leq m \leq j$.  It follows from
Lemma~\ref{sob_T_dd_wk2} that
$\displaystyle \pdydxn{\phi}{x_n}{j-m}\, T_m(\xi_i) 
\to \pdydxn{\phi}{x_n}{j-m}\, T_m(f)$ in
$\displaystyle H^{k-j-1/2}(\RR^{n-1})$ as $i \to \infty$ for
$0 \leq m \leq j$.

Hence,
\[
T_j(\phi f) = \lim_{i\to \infty} T_j( \phi \xi_i) = \pdydxn{(\phi \xi_i)}{x_n}{j}
= \sum_{m=0}^j \binom{j}{m} \pdydxn{\phi}{x_n}{j-m}\, T_m(f) \ .
\]
Since $\displaystyle \pdydxn{\phi}{x_n}{j-m}(\VEC{z},0) = 0$
for $\VEC{z} \in W \supset K$ and $0 \leq m<j$, and
$\displaystyle \phi(\VEC{z},0) = 1$ for $\VEC{z} \in W \supset K$, we
get that $\displaystyle T_j(\phi f) = T_j(f)$.  We can take
$\tilde{f} = \phi f$.
\end{proof}

Problems involving partial differential equations of degree greater
than one do not (generally) come with only one condition on the
boundary.  For instance, the problem may have the conditions
$\displaystyle T_m(f) = g_m \in H^{k-m-1/2}(\RR^{n-1})$ for
$0 \leq m \leq j$ if we assume that $k > 1/2 +j$.

Because $T_m$ is onto, we know that there exists
$\displaystyle f_m \in H^k(\RR^n_+)$ such that $\displaystyle T_m(f_m) = g_m$
for each $m$.  But, we want something stronger.  We want $f_m$ to be
the same for all $m$.  How can we find $\displaystyle f \in H^k(\RR^n_+)$ such
that $\displaystyle T_m(f) = g_m$ for $0 \leq m \leq j$?  To develop a
method to find $f$, we need to look at the operator $S$ defined in the
context of the proof of Theorem~\ref{TraceTj}.  We can easily see that
$\displaystyle \pdfdxn{S(f)}{x_n}{m}(\VEC{z},0) = 0$ for $0 \leq m < j$
and $\displaystyle f \in H^{k-j-1/2}(\RR^{n-1})$ because it is true
for $\phi \in \SS(\RR^{n-1})$.
Thus, $T_{m_1}(S_{m_2}(f)) = 0$ for $m_1 < m_2$.  To find $f$, we
proceed as follows. If $f_0 = S_0(g_0)$ and
$f_m = S_m\big(g_m - T_m(f_{m-1})\big) + f_{m-1}$ for $0 < m \leq j$,
then $f = f_j$.  It is easy to verify that $T_m(f) = g_m$ for
$0 \leq m \leq j$.

We now generalize the previous results about trace to bounded open
subsets $\Omega$ of $\displaystyle \RR^n$ with a smooth boundary.

\begin{theorem} \label{TraceTjOmega}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$ with a bounded boundary
$\partial \Omega$.  Assume that $\Omega$ satisfies the uniform
$\displaystyle C^k$-regularity condition.  If $k > 1/2 +j$ with
$j \in \NN$, then there exists a continuous and surjective linear operator
$\displaystyle \TT_j:H^k(\Omega) \to H^{k-j-1/2}(\partial \Omega)$ such
that $\displaystyle \TT_j(f)(\VEC{z}) = \pdydxn{f}{\nu}{j}(\VEC{z})$ for
$\VEC{z} \in \partial \Omega$ and
$\displaystyle T(f) = \phi\big|_{\partial \Omega}$ for
$\displaystyle \phi \in \DD(\RR^n)$.
Again, the operator $T_j$ is also called a
{\bfseries trace operator}\index{Sobolev Space!Trace Operator},
\end{theorem}

\begin{rmk}
As usual, $\nu(\VEC{x})$ is the outward unit normal to $\partial \Omega$ at
$\VEC{x} \in \partial \Omega$.
\end{rmk}

\begin{proof}
Since $\partial \Omega$ is a compact manifold, we may assume that
the uniform $\displaystyle C^k$-regularity condition given in
Definition~\ref{UnifKregDefn} is given for a finite atlas
$\displaystyle \{ (U_i,\psi_i) \}_{i=1}^I$ for $\partial \Omega$.

We have from item (3) in Definition~\ref{UnifKregDefn} that
$\displaystyle \psi_i(U_i \cap \partial \Omega)
= B_0 \equiv B_1(\VEC{0}) \cap \RR^n_0$ for all $i$.

As stated in the definition of uniform $C^k$-regularity, there exists
$\delta>0$ such that\\
$\displaystyle \left\{ \VEC{x} \in \RR^n :
\dist{\VEC{x}}{\partial \Omega}  < \delta \right\} \subset
\bigcup_{i=1}^I U_i$.
Let $\displaystyle U_0 = \left\{ \VEC{x} \in \Omega :
\dist{\VEC{x}}{\partial \Omega}  > \delta/2 \right\}$.
We then have that $\displaystyle \{ U_i \}_{i=0}^I$ is an open cover of
$\Omega$.
Let $\displaystyle \{ \phi_i \}_{i=0}^I$ be a partition of unity for
$\Omega$ subordinated to $\displaystyle \{ U_i \}_{i=0}^I$.

\subI{Definition of $\TT_j$}
Given $\displaystyle f \in H^k(\Omega)$, we have that
$\displaystyle f = \sum_{i=0}^I f_i$ where
$\displaystyle f_i \equiv \phi_i f \in H^k(\Omega)$ and
$\supp f_i \subset U_i \cap \overline{\Omega}$.

Since $\supp f_0 \subset U_0 \subset \Omega$, we have that
$\displaystyle \TT_j(f_0) = 0 \in H^{k-j-1/2}(\partial \Omega)$
\footnote{To be precise and consistent with our presentation, we may
assume that there is a homeomorphism $\psi_0$ from $U_0$ onto an open
set $\displaystyle W \subset \RR^n_+$ such that $\psi_0$ and
$\psi_0^{-1}$ are of class $\displaystyle C^k$.  Then
$\displaystyle h_0 \equiv f_0 \circ \psi_0^{-1} \in H^k(W)$
can be extended to $\displaystyle H^k(\RR_+^n)$ by
$h_0(\VEC{y}) = 0$ for $\VEC{y} \in \RR_+^n \setminus W$
because $\displaystyle \supp h_0 \subset W$.
It then follows from Proposition~\ref{sobTrace0K} that $q_0 = T_j(h_0) = 0$.
We are now justified to set $\TT_j(f_0) = 0$.}.
We will assume that $0<i\leq I$ from now on.

We have that $\supp f_i \cap \partial U_i = \emptyset$ but we may have that
$\supp f_i \cap \partial \Omega \neq \emptyset$ (Figure~\ref{TraceFig1}).
Since $U_i \cap \Omega \subset \Omega$, we have from
Lemma~\ref{sobVsubsetU} that $\displaystyle f_i \in H^k(U_i \cap \Omega)$.

Let $\displaystyle B_+ = B_1(\VEC{0}) \cap \RR^n_+$.
We have from Proposition~\ref{sob_cv} that
$\displaystyle h_i \equiv f_i \circ \psi_i^{-1} \in H^k(B_+)$ and
$\displaystyle \supp h_i \subset B_+ \cup B_0$.  Therefore, we may
extend $h_i$ to get $\displaystyle h_i \in H^k(\RR^n_+)$ by defining
$h_i(\VEC{y}) = 0$ for $\displaystyle \VEC{y} \in \RR^n_+ \setminus B_+$.
This can be justified by slightly modifying the proof of
Lemma~\ref{sob_denselem1}.

Let $\displaystyle q_i = T_j(h_i) \in H^{k-j-1/2}(\RR^{n-1})$,
where $\displaystyle T_j:H^k(\RR^n_+) \to H^{k-j-1/2}(\RR^{n-1})$ is
the trace operator given in Theorem~\ref{TraceT0} for $j=0$ or
Theorem~\ref{TraceTj} for $j>0$.  We have that
$\displaystyle q_i\big|_{B_1(\VEC{0})} \in H^{k-j-1/2}(B_1(\VEC{0}))$.
It follows from the definitions $E$ in Theorem~\ref{sob_Rp_ext}
that $\displaystyle \supp E(h_i) \subset B_1(\VEC{0}) \subset \RR^n$,
and from the definition of $T$ in Proposition~\ref{TraceRnRnp} (both
$E$ and $T$ were used to define $T_j$)
that $\supp q_i \subset B_1(\VEC{0}) \subset \RR^{n-1}$,

We get that
$\displaystyle g_i \equiv q_i \circ \psi_i \in
H^{k-j-1/2}(U_i \cap \partial \Omega)$.
Since $\supp g_i \subset U_i \cap \partial \Omega$, we
may extend $g_i$ to get
$\displaystyle g_i \in H^{k-j-1/2}(\partial \Omega)$ by setting
$g_i(\VEC{x}) = 0$ for $\VEC{x} \in \partial \Omega \setminus U_i$.

A trace operator $\TT_j$ acting on $f$ is defined by
$\displaystyle \TT_j(f) = \sum_{i=0}^I g_i$.
Recall that $g_0 = \TT_j(f_0) = 0$.

\subI{Surjectivity of $\TT_j$}
Given $\displaystyle g \in H^{k-j-1/2}(\partial \Omega)$, we have that
$\displaystyle g = \sum_{i=0}^I (\phi_i g)$ where
$\displaystyle \phi_i g \in H^{k-j-1/2}(\partial \Omega)$ and
$\supp (\phi_i g) \subset U_i \cap \partial \Omega \subset \partial \Omega$.
Hence,
$\displaystyle \phi_i g \in H^{k-j-1/2}(U_i \cap \partial \Omega)$.

It follows from Proposition~\ref{sob_cv} that
$\displaystyle h_i \equiv (\phi_i g) \circ \psi_i^{-1} \in H^{k-j-1/2}(B_0)$.
Since $\displaystyle \supp h_i \subset B_0$, we may extend
$h_i$ to get $h_i \in \displaystyle H^{k-j-1/2}(\RR^n_0)$ by defining
$\displaystyle h_i(\VEC{y}) = 0$ for
$\displaystyle \VEC{y} \in \RR^n_0 \setminus B_0$.

Since $\displaystyle T_j: H^k(\RR^n_+) \to H^{k-j-1/2}(\RR^{n-1})$ is onto, there
exists $\displaystyle q_i \in H^k(\RR^n_+)$ such that 
$\displaystyle T_j (q_i) = h_i$.  According to
Proposition~\ref{sobTjDomain}, we may assume that
$\displaystyle \supp q_i \subset B_1(\VEC{0}) \subset \RR^n$.

Let $f_i = q_i \circ \psi_i$ on $U_i\cap \Omega$.  We have that
$\supp f_i \subset U_i$ and $\displaystyle f_i \in H^k(U_i\cap \Omega)$.
Note that we may have
$\supp f_i \cap \partial \Omega \neq \emptyset$ but that is fine.
If we set $f_i(\VEC{x}) = 0$ for
$\VEC{x} \in \Omega \setminus U_i$, we have that
$\displaystyle f_i \in H^k(\Omega)$.

If $\displaystyle f = \sum_{i=0}^I f_i$, then
$\displaystyle \TT_j(f) = \sum_{i=0}^I \TT(f_i) = \sum_{i=0}^I \phi_i g = g$ as
required.

\subI{$\TT_j$ for $\displaystyle \mathbf{\phi \in \DD(\RR^n)}$}
For this part of the proof, we assume that the $\psi_i$ and
$\displaystyle \psi_j^{-1}$ are of class $\displaystyle C^\infty$.  We
basically go through the step to define $\TT_j(\phi)$ and show what happen when
$\displaystyle \phi \in \DD(\RR^n)$.

We have that $\displaystyle \phi = \sum_{i=0}^I (\phi_i \phi)$ where
$\displaystyle \phi_i \phi \in \DD\left(U_i \cap \overline{\Omega}\right)$;
in particular, $\supp (\phi_i \phi) \cap \partial U_i = \emptyset$.
We may have that
$\supp (\phi_i \phi) \cap \partial \Omega \neq \emptyset$.

We have that
$\displaystyle h_i \equiv (\phi_i \phi) \circ \psi_i^{-1}
\in \DD\left(\overline{B_+}\right)$; in particular,
$\displaystyle \supp h_i \cap \partial B_1(\VEC{0}) = \emptyset$.  We
extend $h_i$ to get
$\displaystyle h_i \in \DD\left(\overline{\RR^n_+}\right)$ by defining
$h_i(\VEC{y}) = 0$ for
$\displaystyle \VEC{y} \in \overline{\RR^n_+} \setminus B_1(\VEC{0})$.

We have that $\displaystyle T_j(h_i)
= \pdfdxn{((\phi_i \phi) \circ \psi_i^{-1})}{y_n}{j}$ on
$\displaystyle \RR^n_0 \cong \RR^{n-1}$.  Hence
\[
\TT_j(\phi)(\VEC{z})
= \sum_{i=0}^I \TT_j(\phi_i \phi)(\VEC{z})
= \sum_{i=0}^I \pdfdxn{((\phi_i \phi) \circ \psi_i^{-1})}{y_n}{j}
(\psi_i(\VEC{z}))
= - \sum_{i=0}^I \pdfdxn{\phi_i \phi}{\nu}{j} (\VEC{z})
= -\pdfdxn{\phi}{\nu}{j} (\VEC{z})
\]
for $\VEC{z} \in \partial \Omega$.

We get the wrong sign because $\displaystyle \pdydx{}{y_n}$ refers to
the normal to $\displaystyle \RR^n_0$ pointing inside the region
$\displaystyle \RR^n_+$ while
$\displaystyle \pdydx{}{\nu}$ refers to the normal to $\partial \Omega$
pointing outside $\Omega$.  To get the right sign, it suffices to
change the orientation of the $\psi_i$ in the atlas for $\partial \Omega$.
This is left to the reader.  We have ignored this fact until
now to provide a cleaner presentation which is consistent with the
notation used so far.

To prove the previous result when $\psi_i$ is only of class
$\displaystyle C^k$, one needs to prove that
$\displaystyle T_j(f)(\VEC{z}) = \pdfdxn{f}{x_n}{j}(\VEC{z},0)$
for $\displaystyle f \in C_c^k(\RR^n_+)$.  This can easily be proved
because $\displaystyle \DD(\RR^n_+)$ is dense in
$\displaystyle C_c^k(\RR^n_+)$ according to the norm on
$\displaystyle \|\cdot\|_{k,2,\RR^n_+}$.
\end{proof}

\pdfF{sobolev/traceFig1}{Graphical representation of a local
chart}{Graphical representation of a local chart used in the proof 
of Theorem~\ref{TraceTjOmega}.}{TraceFig1}

We can use a trace operator to define $\displaystyle H^{k,2}_0(\Omega)$ where
$\partial \Omega$ is a bounded $\displaystyle C^k$-manifold in
$\displaystyle \RR^n$.  Before doing that, we need the following result.

\begin{prop} \label{H0Trace}
\[
H^{k}_0(\RR^n_+) = \left\{ f \in H^{k}(\RR^n_+) : T_j(f) = 0
\ \text{for} \ 0 \leq j < k \right\} \ ,
\]
where the operator $T_j$ is defined in Theorem~\ref{TraceT0} for $j=0$
and Theorem~\ref{TraceTj} for $j>0$.
\end{prop}

\begin{proof}
\subI{$\mathbf{\subset}$}
Given $\displaystyle f \in H^k_0(\RR^n_+)$, choose a sequence
$\displaystyle \left\{\xi_i\right\}_{i=1}^\infty \subset \DD(\RR^n_+)$
that converges to $f$ in $\displaystyle H^k(\RR^n_+)$.
Since $\|f\|_{j,2,\RR^n_+} \leq \|f\|_{k,2,\RR^n_+}$ for $0\leq j < k$,
we also have that $\displaystyle \left\{\xi_i\right\}_{i=1}^\infty$
converges to $f$ in $\displaystyle H^j(\RR^n_+)$ for $0\leq j < k$.
We have that $\displaystyle \TT_j(\xi_i)(\VEC{z}) =
\pdydxn{\xi_i}{x_n}{j}(\VEC{z},0) = 0$ for
$\displaystyle \VEC{z} \in \RR^{n-1}$, $0 \leq j < k$
and all $i$ because $\displaystyle \supp \xi_i \subset \RR^n_+$.
Hence, we get by continuity of $\TT_j$ on $\displaystyle H^j(\RR^n_+)$
that $\displaystyle \TT_j(f) = \lim_{i\to \infty} \TT_j(\xi_i) = 0$
for $0 \leq j < k$.

\subI{$\mathbf{\supset}$}
Consider $\displaystyle f \in H^{k}(\RR^n_+)$ such that
$T_j(f) = 0$ for $0 \leq j < k$.
According to Proposition~\ref{sob_expand_WKP_Conv}, we 
will have that $\displaystyle f \in H^{k}_0(\RR^n_+)$ if we show that
\[
\underline{f}(\VEC{x}) =
\begin{cases}
f(\VEC{x}) & \quad \text{for} \quad \VEC{x} \in \RR^n_+ \\
0 & \quad \text{for} \quad \VEC{x} \in \RR^n \setminus \RR^n_+ \\
\end{cases}
\]
is in $\displaystyle H^{k}(\RR^n)$.  We have that $\underline{f}$
defines a distribution on $\displaystyle \RR^n$ because
\[
\int_{\RR^n} \left|\underline{f}\right|^2 \dx{\VEC{x}}
= \int_{\RR^n_+} \left|f\right|^2 \dx{\VEC{x}} < \infty
\]
since $\displaystyle f \in H^k(\RR^n_+)$.

Since $\displaystyle \DD\left(\RR^n\right)\big|_{\RR^n_+}$ is dense in
$\displaystyle H^k(\RR^n_+)$, there exists a sequence
$\displaystyle \left\{\xi_i\right\}_{i=1}^\infty \subset
\DD\left(\RR^n\right)$ such that
$\displaystyle \tilde{\xi}_i \equiv \xi_i\big|_{\overline{\RR^n_+}} \to f$ in
$\displaystyle H^k(\RR^n_+)$ as $i \to \infty$.

Suppose that $\displaystyle \alpha \in \NN^n$ is a multi-index such
that $|\alpha| \leq k$ and $0 \leq \alpha_n = m \leq k$.  Let
$\alpha' = (\alpha_1, \ldots, \alpha_{n-1},0)$.  We get from
integration by parts that
\begin{align}
&\diff^\alpha \underline{\tilde{\xi}}_i(\phi)
= (-1)^{|\alpha|} \int_{\RR^n}
\underline{\tilde{\xi}}_i\, \diff^\alpha \phi \dx{\VEC{x}}
= (-1)^{|\alpha|} \int_{\RR^n_+} \tilde{\xi}_i \diff^\alpha \phi \dx{\VEC{x}}
\nonumber \\
&\quad = \sum_{j=0}^{m-1} (-1)^{m+j} \int_{\RR^{n-1}}
\left( \pdfdxn{\diff^{\alpha'} \tilde{\xi}_i}{x_n}{j}(\VEC{z},0) \right)
\pdydxn{\phi}{x_n}{m-j-1}(\VEC{z},0) 
\dx{\VEC{z}} + \int_{\RR^n_+} \left(\diff^\alpha \tilde{\xi}_i\right)\,
\phi \dx{\VEC{x}}   \label{H0TraceEq1}
\end{align}
for all $\displaystyle \phi \in \DD(\RR^n)$.  If $m=0$, the sum in the previous
expression is not present.

We have for $0 \leq j <m$ that
\[
\pdfdxn{\diff^{\alpha'} \tilde{\xi}_i}{x_n}{j}(\VEC{z},0)
= \diff^{\alpha'} \pdfdxn{\tilde{\xi}_i}{x_n}{j}(\VEC{z},0)
= \diff^{\alpha'}  T_j\left( \tilde{\xi}_i \right) \to 
\diff^{\alpha'}  T_j(f) = 0
\]
in $\displaystyle H^{k-|\alpha'|-j -1/2}(\RR^{n-1})$ as $i \to \infty$
because
$\displaystyle T_j\left( \tilde{\xi}_i \right) \to  T_j(f)$ in
$\displaystyle H^{k-j -1/2}(\RR^{n-1})$ and
$\displaystyle \diff^{\alpha'}$ is a bounded operator from
$\displaystyle H^{k-j -1/2}(\RR^{n-1})$ to
$\displaystyle H^{k-|\alpha'|-j -1/2}(\RR^{n-1})$ according to 
Theorem~\ref{sob_DinDm}.

Since $\displaystyle H^{k-j -1/2}(\RR^{n-1}) \subset H^0(\RR^{n-1})$
because $\|g\|_{0,\rho} \leq \|g\|_{k-j -1/2,\rho}$ for all
$\displaystyle g \in H^{k-j -1/2}(\RR^{n-1})$, we have that
$\displaystyle \pdfdxn{\diff^{\alpha'} \tilde{\xi}_i}{x_n}{j}(\VEC{z},0) \to 0$
in $\displaystyle H^0(\RR^{n-1})$ as $i \to \infty$ for $0 \leq j <m$.
From Plancherel theorem, we get
$\displaystyle \pdfdxn{\diff^{\alpha'} \tilde{\xi}_i}{x_n}{j}(\VEC{z},0) \to 0$
in $\displaystyle L^2(\RR^{n-1})$ as $i \to \infty$ for $0 \leq j <m$.
It then follows from Schwarz inequality that
\begin{align*}
&\left| \int_{\RR^{n-1}}
\left( \pdfdxn{\diff^{\alpha'} \tilde{\xi}_i}{x_n}{j}(\VEC{z},0) \right)
\pdydxn{\phi}{x_n}{m-j-1}(\VEC{z},0) 
\dx{\VEC{z}} \right| \\
& \qquad \leq
\left( \int_{R^{n-1}} \left(
\pdfdxn{\diff^{\alpha'} \tilde{\xi}_i}{x_n}{j}(\VEC{z},0) \right)^2
\dx{\VEC{z}} \right)^{1/2}
\left( \int_{R^{n-1}} \left( \pdydxn{\phi}{x_n}{m-j-1}(\VEC{z},0) \right)^2
\dx{\VEC{z}} \right)^{1/2} \to 0
\end{align*}
as $i \to \infty$ for $0 \leq j <m$.
Since $\displaystyle \xi_i\big|_{\overline{\RR^n_+}} \to f$ in
$\displaystyle H^k(\RR^n_+)$ as $i \to \infty$, it also follows from Schwarz
inequality that
$\displaystyle \int_{\RR^n_+} \left(\diff^\alpha
\tilde{\xi}_i\right)\, \phi \dx{\VEC{x}}
\to \int_{\RR^n_+} \left(\diff^\alpha f\right) \, \phi \dx{\VEC{x}}$
as $i \to \infty$.

If $i \to \infty$ in (\ref{H0TraceEq1}), we then
get that
\[
\diff^\alpha \underline{f} (\phi)
= (-1)^{|\alpha|} \int_{\RR^n}
\underline{f}\, \diff^\alpha \phi \dx{\VEC{x}}
= \int_{\RR^n_+} \left(\diff^\alpha f \right)\, \phi \dx{\VEC{x}}
= \int_{\RR^n} \underline{\diff^\alpha f}\, \phi \dx{\VEC{x}}
\]
for all $\displaystyle \phi \in \DD(\RR^n)$ \footnote{Note that
$\underline{\tilde{\xi}}_i \to \underline{f}$ as distributions on
$\displaystyle \RR^n$, not necessarily in $\displaystyle H^k(\RR^n)$.}.
Thus, we have for all $|\alpha| \leq k$
that $\displaystyle \diff^\alpha \underline{f} = \underline{\diff^\alpha f}$
and $\displaystyle \diff^\alpha \underline{f} \in L^2(\RR^n)$ because
\[
\int_{\RR^n} \left|\underline{\diff^\alpha f}\right|^2 \dx{\VEC{x}}
= \int_{\RR^n_+} \left|\diff^\alpha f\right|^2 \dx{\VEC{x}} < \infty
\]
since $\displaystyle f \in H^k(\RR^n_+)$.
Therefore, $\displaystyle \underline{f} \in H^k(\RR^n)$.
\end{proof}

\begin{theorem} \label{H0TraceOmega}
Let $\displaystyle \Omega \subset \RR^n$ be an open set that satisfies
the uniform $\displaystyle C^k$-regularity condition.  Then
\[
H^{k}_0(\Omega) = \left\{ f \in H^{k}(\Omega) : \TT_j(f) = 0
\ \text{for} \ 0 \leq j < k \right\} \ .
\]
\end{theorem}

\begin{proof}[Proof (Sketch)]
\subI{$\mathbf{\subset}$}  This part is basically identical to the
part $\mathbf{\subset}$ in the proof of Proposition~\ref{H0Trace}

Given $\displaystyle f \in H^k_0(\Omega)$, choose a sequence
$\displaystyle \left\{\xi_i\right\}_{i=1}^\infty \subset \DD(\Omega)$
that converges to $f$ in $\displaystyle H^k(\Omega)$.
Since $\|f\|_{j,2,\Omega} \leq \|f\|_{k,2,\Omega}$ for $0\leq j < k$,
we also have that $\displaystyle \left\{\xi_i\right\}_{i=1}^\infty$
converges to $f$ in $\displaystyle H^j(\Omega)$ 
for $0\leq j < k$.  We known that $\TT_j(\xi_i) = 0$ for $0 \leq j < k$
and all $i$.  Hence, we get by continuity of $\TT_j$ on
$\displaystyle H^j(\Omega)$ that $\TT_j(f) = 0$ for $0 \leq j < k$.

\subI{$\mathbf{\supset}$}
Suppose that $\displaystyle f \in H^k(\Omega)$ and
$\TT_j(f) = 0$ for $0 \leq j < k$.

As in the proof of Theorem~\ref{TraceTjOmega}, we may assume that
$\displaystyle \{ (U_i,\psi_i) \}_{i=1}^I$ is a finite atlas for
$\partial \Omega$ with $\psi_i(U_i) = B_1(\VEC{0})$,
$\displaystyle \psi_i(U_i \cap \Omega) = B_+ = B_1(\VEC{0}) \cap \RR^n_+$
and
$\displaystyle \psi_i(U_i \cap \partial \Omega) = B_0 = B_1(\VEC{0})
\cap \RR^n_0$ for all $i$.  We also consider the open set
$\displaystyle U_0 = \left\{ \VEC{x} \in \Omega :
\dist{\VEC{x}}{\partial \Omega}  > \delta/2 \right\}$
associated to the constant $\delta$ provided by the definition
of uniform $\displaystyle C^k$-regularity.
Let $\displaystyle \{ \phi_i \}_{i=0}^I$ be a partition of unity for
$\Omega$ subordinated to the open cover $\displaystyle \{ U_i \}_{i=0}^I$
of $\Omega$.

We have that $\displaystyle f = \sum_{i=0}^I f_i$ where
$\displaystyle f_i \equiv \phi_i f \in H^k(\Omega)$.  If we prove that
$\displaystyle f_i \in H^k_0(\Omega)$ for all $i$, then we will
have that $\displaystyle f \in H^k_0(\Omega)$.
Since $\supp f_0 \subset U_0 \subset \overline{U_0} \subset \Omega$, we
have that $\displaystyle f_0 \in H^k_0(\Omega)$ according to
Lemma~\ref{sob_w0_trad1}.  So, we only have to prove
that $\displaystyle f_i \in H^k_0(\Omega)$ for $0 < i \leq I$.

It can be shown that $T_j(f) = 0$ for
$\displaystyle f \in H^k(\RR_+^n)$ and $0 \leq j <k$
implies that $\displaystyle T_j(\phi f) = 0$ for
$\displaystyle \phi \in \DD(\RR^n)$ and $0 \leq j <k$.   This can be
generalized to show that $\TT_j(f) = 0$ for
$\displaystyle f \in H^k(\Omega)$ and $0 \leq j <k$
implies that $\displaystyle \TT_j(\phi_i f) = \TT_j(f_i) = 0$ for
$0 \leq j <k$ \footnote{This sketchy step of the proof is the reason behind
the mention ``Sketch''.  The details require playing with the
definition of manifold which we are trying to minimize in this book.}.
Basically, what we are saying is that the trace operator is
determined locally.

If we refer to the definition of $\TT_j$ given in the proof of
Theorem~\ref{TraceTjOmega}, we get that
$\displaystyle T_j(h_i) = 0$ for $0 \leq j <k$, where
$\displaystyle h_i \in H^k(\RR^n_+)$ is defined by
$h_i \equiv f_i \circ \psi_i^{-1}$ on
$\displaystyle B_+ = B_1(\VEC{0}) \cap \RR^n_+$
and $0$ on $\displaystyle \RR^n_+ \setminus B_1(\VEC{0})$.  We also have that
$\supp h_i \subset B_+ \cup B_0$.

It follows from Proposition~\ref{H0Trace} that
$\displaystyle h_i \in H^k_0(\RR^n_+)$.
Therefore, there exists a sequence
$\displaystyle \left\{\xi_m\right\}_{m=1}^\infty \subset \DD(\RR^n_+)$
converging to $h_i$ in $\displaystyle H^k(\RR^n_+)$.  Since
$\supp h_i \subset B_1(\VEC{0})$, we may assume that
$\supp\, \xi_m \subset B_+$.  If it is not
so, choose $\displaystyle \phi \in \DD(\RR^n)$ such that
$\phi(\VEC{x}) = 1$ for $\VEC{x} \in \supp h_i$ and $\phi(\VEC{x}) = 0$ for
$\displaystyle \VEC{x} \in \RR^n \setminus B_1(\VEC{0})$.
Then,
$\displaystyle \supp\, \phi \xi_m \subset B_1(\VEC{0}) \cap \RR^n_+ = B_+$.
It follows from Proposition~\ref{sob_T_dd_wkp} that
$\phi \xi_m \to \phi h_i = h_i$ in $\displaystyle H^k(\RR^n_+)$.
Hence, $\displaystyle \tilde{\xi}_m \equiv (\phi \xi_m) \circ
\psi_i \in C_c^k(\Omega \cap U_i)$
and $\tilde{\xi}_m \to h_i \circ \psi_i = f_i$
in $\displaystyle H^k(\Omega \cap U_i)$.
Hence, $\displaystyle f_i \in H^k_0(U_i \cap \Omega)$
according to the second item of Remark~\ref{sob_compl_Hk2}
and thus $\displaystyle f_i \in H^k_0(\Omega)$ because $f_i = \phi_i f = 0$ on
$\Omega \setminus U_i$.
\end{proof}

\subsection{Appendix}

Theorem~\ref{H0TraceOmega} applied to smooth functions can be proved
without the use of trace operators.  First, we need a lemma.

\begin{lemma} \label{sob_comp_DF}
Suppose $\displaystyle f \in W^{k,p}(\Omega)$ with $k\in \NN$ and let
$U$ be an open subset of $\RR$ such that
$\displaystyle \overline{ f(\Omega)} \subset U$.  If
$\psi \in C^k(U)$ is such that the derivatives $\displaystyle \psi^{(j)}$ for
$0\leq j \leq k$ are bounded on $\displaystyle \overline{ f(\Omega)}$,
then $\displaystyle \psi \circ f \in W^{k,p}(\Omega)$.
\end{lemma}

\begin{proof}[Proof (Sketch).]
The proof that $\displaystyle \psi \circ f \in W^{k,p}$ requires the
chain rule for the derivatives of composed functions and the formula
for the change of variables in integrals.
\end{proof}

\begin{prop} \label{sob_w0_trad2}
Let $\Omega$ be a bounded open subset of
$\displaystyle \RR^n$ that satisfies the uniform
$\displaystyle C^k$-regularity condition.  If
$\displaystyle f \in C^{k-1}\left(\overline{\Omega}\right) \cap H^k(\Omega)$,
then
$\displaystyle f \in H^k_0(\Omega)$ if and only if
$\displaystyle \diff^\alpha f =0$ on $\partial \Omega$ for $|\alpha|<k$
\end{prop}

\begin{proof}
The proof is basically a simpler version of the proof
of Theorem~\ref{H0TraceOmega} because
$\displaystyle \TT_j(f)(\VEC{z}) = \pdydxn{f}{\nu}{j}(\VEC{z})$ for
$\VEC{z} \in \partial \Omega$ and $0 \leq j < k$ when
$\displaystyle f \in C^{k-1}\left(\overline{\Omega}\right)$.

There is however an interesting and different proof due to \cite{Br}
in the case $k=1$ that we present below.

Since $\partial \Omega$ is bounded, it is a compact manifold.
Therefore, we may assume that the uniform $C^1$-regularity condition
given in Definition~\ref{UnifKregDefn} is
given for a finite cover
$\displaystyle \{ U_i \}_{i=1}^I$ for $\partial \Omega$.
As stated in the definition of uniform $\displaystyle C^k$-regularity,
there exists $\delta>0$ such that
$\displaystyle \left\{ \VEC{x} \in \RR^n :
\dist{\VEC{x}}{\partial \Omega}  < \delta \right\} \subset
\bigcup_{i=1}^I U_i$.
Let $\displaystyle U_0 = \left\{ \VEC{x} \in \Omega :
\dist{\VEC{x}}{\partial \Omega}  > \delta/2 \right\}$.
We then have that $\displaystyle \{ U_i \}_{i=0}^I$ is an open cover of
$\Omega$.
Let $\displaystyle \{ \phi_i \}_{i=0}^I$ be a partition of unity for
$\Omega$ subordinated to $\displaystyle \{ U_i \}_{i=0}^I$.

Given $\displaystyle f \in C(\overline{\Omega})$, we can write 
$\displaystyle f = \sum_{j=0}^N f_j$ on $\overline{\Omega}$,
where $f_j \equiv \phi_j f :\overline{\Omega} \rightarrow \RR$ is such that
$\supp f_j \subset U_i \cap \overline{\Omega}$.
We obviously have that $\displaystyle f_j \in C\left(\overline{\Omega}\right)$
and it follows that $\displaystyle f_j \in H^1(\Omega)$.

\stage{$\mathbf{\Leftarrow}$}
Choose $\displaystyle \psi \in \DD(\RR)$ such that
$|\psi(x)|\leq 1$ for all $x$, $\psi(x) = 1$ for $|x|\geq 2$ and
$\psi(x) = 0$ for $|x|\leq 1$.  Let
$\xi(x) = \psi(x)\,x$ for $x \in \RR$.

For any positive integer $m$, the function
$g_m:\overline{\Omega}\rightarrow \RR$ defined
by $\displaystyle g_m(\VEC{x}) = \frac{1}{m}\xi(mf_j(\VEC{x}))$ for
$\VEC{x}\in \overline{\Omega}$ is therefore in $\displaystyle H^1(\Omega)$
according to Lemma~\ref{sob_comp_DF}.  Moreover,
\[
\supp g_m = \left\{ \VEC{x} \in \overline{\Omega} : |f_j(\VEC{x})| \geq \frac{1}{m}
\right\} \subset \Omega
\]
because $f_j$ is continuous on $\overline{\Omega}$ and $f_j = 0$ on
$\partial \Omega$.  From Lemma~\ref{sob_w0_trad1},
$\displaystyle g_m \in H^1_0(\Omega)$ for all positive integer $m$.

We now show that $g_m \rightarrow f_j$ in $\displaystyle H^1_0(\Omega)$.
Since $\displaystyle H^1_0(\Omega)$ is closed, this will prove that
$\displaystyle f_j \in h^1_0(\Omega)$.

Let $\alpha$ be a multi-index such that $|\alpha|\leq 1$.  We first prove
that $\displaystyle \diff^\alpha g_m(\VEC{x}) \rightarrow
\diff^\alpha f_j(\VEC{x})$ as $m\rightarrow \infty$ for almost all
$\VEC{x}\in \Omega$.
Since $\displaystyle \diff^\alpha g_m(\VEC{x})=0$ for all $m$ and
$\VEC{x} \in \Omega \setminus \supp f_j$ because
$\displaystyle \diff^\alpha f_j(\VEC{x})=0$ for all
$\VEC{x} \in \Omega \setminus \supp f_j$,
we trivially have that
$\displaystyle \diff^\alpha g_m(\VEC{x}) \rightarrow \diff^\alpha f_j(\VEC{x})$
as $m\rightarrow \infty$ for all $\VEC{x} \in \Omega \setminus \supp f_j$.
Given $\VEC{x} \in \Omega$ such that $f_j(\VEC{x}) \neq 0$.
Choose $\displaystyle C> 2$ and let $M$ be a positive integer such that
$\displaystyle M \left|f_j(\VEC{x})\right|\geq C$.  By continuity of the
norm, there exists a neighbourhood $U\subset \Omega$ of $\VEC{x}$ such that 
$\displaystyle M \left|f_j(\VEC{y})\right|\geq 2$ for $\VEC{y} \in U$.
Hence, $g_m(\VEC{y}) = f_j(\VEC{y})$ for $m\geq M$ and $\VEC{y} \in U$.
We deduce that
$\displaystyle \diff^\alpha g_m(\VEC{x}) = \diff^\alpha f(\VEC{x})$
for $m\geq M$. 
Thus $\displaystyle \diff^\alpha g_m(\VEC{x}) \rightarrow
\diff^\alpha f_j(\VEC{x})$ as
$m\rightarrow \infty$.  Since this is true for all $\VEC{x} \in \Omega$ such
that $f_j(\VEC{x}) \neq 0$, we have that
$\displaystyle \diff^\alpha g_m \rightarrow \diff^\alpha f_j$ pointwise
on $\Omega$ almost everywhere as $m\rightarrow \infty$.  The only
issue may be for $\VEC{x} \in \Omega \cap \partial (\supp f_j)$ where
$f(\VEC{x}) = 0$ but this is a set of measure zero since $f$ is
continuous on $\overline{\Omega}$.

We now prove that $\displaystyle |\diff^\alpha g_m|^2$ is bounded by
the integrable function $\displaystyle K |\diff^\alpha f_j|^2$ for all
$m$, where $K$ is a constant.  For all $m \geq 1$ and
$\VEC{x} \in \Omega$, we have
\[
\left| g_m(\VEC{x}) \right|^2 =
\left| \frac{1}{m} \xi(mf_j(\VEC{x})) \right|^2
\leq \left| f_j(\VEC{x}) \right|^2
\]
because $|\xi(x)|\leq |x|$ for all $x \in \RR$.  For $|\alpha|=1$,
$m \geq 1$ and $\VEC{x}\in \Omega$, we have that
\[
\left| \diff^\alpha g_m(\VEC{x}) \right|^2 =
\left| \xi'(mf_j(\VEC{x})) \diff^\alpha f_j(\VEC{x}) \right|^2
\leq K \left| \diff^\alpha f_j(\VEC{x}) \right|^2 \ ,
\]
where
\[
\sqrt{K} = \max \left\{ 1,
\sup_{1\leq |x|\leq 2} \left\{ |\xi'(x)| \right\} \right\} \ .
\]
Recall that $\xi(x) =0$ for $|x|<1$ and $\xi(x) = x$ for $x>2$.

Since the sequence
$\displaystyle \left\{ (\diff^\alpha g_m)^2 \right\}_{m=1}^\infty$ converges
pointwise almost everywhere to $\displaystyle (\diff^\alpha f_j)^2$
and is bounded by the integrable function
$\displaystyle K (\diff^\alpha f_j)^2$ on $\Omega$, we get from
the Lebesgue Dominated Convergence Theorem that
$\displaystyle \left\{ \diff^\alpha g_m \right\}_{m=1}^\infty$ converges
to $\displaystyle \diff^\alpha f_j$ in $\displaystyle L^2(\Omega)$.
Since $\alpha$ such that $|\alpha|\leq 1$ is arbitrary, we have
$\|g_m - f_j\|_{1,2,\Omega} \rightarrow 0$ as $m\rightarrow \infty$.

\stage{$\mathbf{\Rightarrow}$}
Using the expansion
$\displaystyle f = \sum_{j=0}^N f_j$ given at the beginning of the proof, it
is enough to prove that $\displaystyle f_j \big|_{\partial \Omega} = 0$.
We have that 
$\displaystyle f_j \in W^{1,2}_0(\Omega)$ because $f_j = f \phi_j$ with
$\displaystyle f \in W^{1,2}_0(\Omega)$ and
$\displaystyle \phi_j \in \DD(\RR^n)$.  In fact, for the previous
statement, the readers should convince themselves that if
$\displaystyle \{ \eta_i \}_{i=1}^\infty \subset \DD(\Omega)$
satisfies $\displaystyle \lim_{i\rightarrow \infty} \|\eta_i -f \|_{1,2} = 0$
then
$\displaystyle \{ \phi_j \eta_i \}_{i=1}^\infty \subset \DD(\Omega)$
and
$\displaystyle \lim_{i\rightarrow \infty} \|\phi_j \eta_i -f_j \|_{1,2} = 0$.
Thus $\displaystyle f_j \in W^{1,2}_0(\Omega)$.

Recall that we have from Definition~\ref{UnifKregDefn} that
the $\displaystyle C^1$-diffeomorphism
$\psi_j : U_j \to B_1(\VEC{0}) \subset \RR^n$
satisfies $\psi_j(U_j\cap \Omega) = B_+
= \left\{ \VEC{x}\in B_1(\VEC{0}) : x_n>0 \right\}$,
$\psi_j(U_j \setminus \overline{\Omega}) = B_-
= \left\{ \VEC{x}\in B_1(\VEC{0}) : x_n<0 \right\}$
and $\psi_j(U_j\cap \partial \Omega) = B_0
= \left\{ \VEC{x}\in B_1(\VEC{0}) : x_n=0 \right\}$.
We may also assume that Lemma~\ref{sob_cv} is satisfied by $\psi_j$.

Let $B = B_+ \cup B_0$ and
\[
\tilde{f}_j(\VEC{x}) =
\begin{cases}
f_j(\psi_j^{-1}(\VEC{x})) & \quad \text{if} \quad \VEC{x} \in B \\
0 & \quad \text{if} \ \VEC{x} \in \overline{\RR^n_+} \setminus B
\end{cases}
\]
We have that $\displaystyle \tilde{f}_j \in C\left(\overline{\RR^n_+}\right)$
because $\displaystyle f_j \in C\left(U_j\cap \overline{\Omega}\right)$ and
$\supp f_j \subset U_j\cap \overline{\Omega}$ (Figure~\ref{TraceFig1}).

The problem is reduced to proving that
$\displaystyle \tilde{f}_j \big|_{\RR^n_0} = 0$.
Let $\displaystyle \{ \eta_i \}_{i=1}^\infty \subset \DD(\Omega)$
be a sequence such that
$\displaystyle \lim_{i\rightarrow \infty} \|\eta_i -f_j \|_{1,2,\Omega} = 0$.
Since $\displaystyle \supp f_j \subset U_j \cap \overline{\Omega}$, we
may assume that $\supp \eta_i \subset U_j \cap \Omega$ for all $i$.
Let
\[
\tilde{\eta}_i(\VEC{x}) =
\begin{cases}
\eta_i(\psi_j^{-1}(\VEC{x})) & \quad \text{if} \quad \VEC{x} \in B \\
0 & \quad \text{if} \ \VEC{x} \in \overline{\RR^n_+} \setminus B
\end{cases}
\]
We get a sequence
$\displaystyle \{ \tilde{\eta}_i \}_{i=1}^\infty \subset
C^1_c\left(\overline{\RR^n}\right)$
such that $\supp \tilde{\eta}_i \subset B$ and
$\displaystyle \lim_{i\rightarrow \infty}
\|\tilde{\eta}_i -\tilde{f}_j \|_{1,2,\overline{\RR^n_+}} = 0$.

Consider $\displaystyle \VEC{x} = (\breve{\VEC{x}}, x_n) \in \RR^n_+$ where, as
usual, $\displaystyle \breve{\VEC{x}} \in \RR^{n-1}$.  We have
\[
\left| \tilde{\eta}_i(\breve{\VEC{x}}, x_n) \right|
= \left| \int_0^{x_n} \pdydx{\tilde{\eta}_i}{x_n}(\breve{\VEC{x}},s)
\dx{s} \right|
\leq \int_0^{x_n} \left| \pdydx{\tilde{\eta}_i}{x_n}(\breve{\VEC{x}},s)
\right| \dx{s} \ .
\]
Hence, for $0< \epsilon<1$, we get
\begin{align}
& \frac{1}{\epsilon} \int_{\RR^{n-1}} \int_0^\epsilon
\left| \tilde{\eta}_i(\breve{\VEC{x}}, x_n) \right| \dx{x_n}
\dx{\breve{\VEC{x}}}
\leq \frac{1}{\epsilon} \int_{\RR^{n-1}} \int_0^\epsilon \left(
\int_0^{x_n} \left| \pdydx{\tilde{\eta}_i}{x_n}(\breve{\VEC{x}},s)
\right| \dx{s} \right) \dx{x_n} \dx{\breve{\VEC{x}}} \nonumber \\
&\quad \leq \frac{1}{\epsilon} \int_{\RR^{n-1}} \int_0^\epsilon \left(
\int_0^\epsilon \left| \pdydx{\tilde{\eta}_i}{x_n}(\breve{\VEC{x}},s)
\right| \dx{s}
\right) \dx{x_n} \dx{\breve{\VEC{x}}} = \int_{\RR^{n-1}} \int_0^\epsilon
\left| \pdydx{\tilde{\eta}_i}{x_n}(\breve{\VEC{x}},s) \right| \dx{s}
\dx{\breve{\VEC{x}}} \ .
\label{sob_Wz_Cz}
\end{align}
Since $\tilde{\eta}_i \rightarrow \tilde{f}_j$ as $i\rightarrow \infty$ with
respect to the norm $\displaystyle \|\cdot\|_{1,2,\overline{\RR^n_+}}$,
and $\supp \tilde{f}_j$ and 
$\supp \tilde{\eta}_i$ are subsets of the bounded set $B$ for all $i$,
we get from Schwarz inequality that
\[
\int_{\overline{\RR^n_+}} \left| \tilde{\eta}_i - \tilde{f}_j\right| \dx{\VEC{x}} 
= \int_B \left| \tilde{\eta}_i - \tilde{f}_j\right| \dx{\VEC{x}}
\leq \left(\int_B 1^2 \dx{\VEC{x}}\right)^{1/2}
\left( \int_B \left( \tilde{\eta}_i - \tilde{f}_j\right)^2 \dx{\VEC{x}} 
\right)^{1/2} \rightarrow 0 \quad \text{as} \quad i\rightarrow \infty \ .
\]
and
\begin{align*}
\int_{\overline{\RR^n_+}} \left| \pdydx{\tilde{\eta}_i}{x_m} -
\diff^{\VEC{e}_m}\tilde{f}_j\right| \dx{\VEC{x}} &=
\int_B \left| \pdydx{\tilde{\eta}_i}{x_m} - \diff^{\VEC{e}_m}\tilde{f}_j\right|
\dx{\VEC{x}} \\
&\leq \left(\int_B 1^2 \dx{\VEC{x}}\right)^{1/2}
\left( \int_B \left( \pdydx{\tilde{\eta}_i}{x_m} -
\diff^{\VEC{e}_m}\tilde{f}_j \right)^2 \dx{\VEC{x}} 
\right)^{1/2} \rightarrow 0 \quad \text{as} \quad i\rightarrow \infty
\end{align*}
for $1 \leq m \leq n$, and $\displaystyle \diff^{\VEC{e}_m}$ is as
usual a derivative in the sense of distributions.  If we let
$i \rightarrow \infty$ in (\ref{sob_Wz_Cz}), it then follows that
\begin{equation} \label{sob_Wz_Cz_one}
\frac{1}{\epsilon} \int_{\RR^{n-1}} \int_0^\epsilon
\left| \tilde{f}_j(\VEC{x}', x_n) \right| \dx{x_n} \dx{\VEC{x}'}
\leq \int_{\RR^{n-1}} \int_0^\epsilon
\left| \diff^{\VEC{e}_m}\tilde{f}_j(\VEC{x}',s) \right| \dx{s} \dx{\VEC{x}'}
\end{equation}
If we let $\epsilon \rightarrow 0$ in (\ref{sob_Wz_Cz_one}),
we obtain 
\begin{equation} \label{sob_Wz_Cz_two}
\int_{\RR^{n-1}} \left| \tilde{f}_j(\VEC{x}', 0) \right| \dx{\VEC{x}'}
\leq 0
\end{equation}
because $\displaystyle \tilde{f}_j \in C(\overline{\RR^n_+})$ and
$\displaystyle \diff^{e_m}\tilde{f}_j \in L^1(\RR^n_+)$ since
$\supp \tilde{f}_j$ is a subset of the bounded set $B$.  Basic
calculus is used to compute the limit on the left hand side of 
(\ref{sob_Wz_Cz_one}) and the Lebesgue Dominate Convergence Theorem
is used to compute the limit on the right hand side.

Since $\tilde{f}_j \in C(\overline{\RR^n_+})$, we get from
(\ref{sob_Wz_Cz_two}) that $\displaystyle \tilde{f}_j\big|_{\RR^n_0} = 0$.
\end{proof}

\section{Nonexistence of Solutions}

We conclude this chapter with a generalization of Theorem~\ref{Lewy}
proved by L. Hrmander in \cite{Horm}.

\begin{defn}
A linear differential operator $L$ with $\displaystyle C^\infty$ coefficients in
$\displaystyle \Omega \subset \RR^n$ is
{\bfseries locally solvable}\index{Linear
Partial Differential Operator!Locally Solvable} at 
$\VEC{x_0} \in \Omega$ if there exists an open neighbourhood
$U \subset \Omega$ of $\VEC{x}_0$ such that, given any
$f\in \DD(U)$, there exists a solution $u \in \DD'(U)$ in the sense of
distribution for $Lu = f$.
\end{defn}

\begin{theorem}[Hrmander] % If the label is defined here before the
% first sentence of the definition, TeX does not register it.  Why?
Let $L$ be a linear differential operator with      \label{Hormander}
$\displaystyle C^\infty$ coefficients
in $\displaystyle \Omega \subset \RR^n$ and let
$Q(\VEC{x}, \VEC{\xi})$ for $\VEC{x} \in \Omega$ and
$\displaystyle \VEC{\xi} \in \RR^n$ be the principal symbol associated to $L$.
Let
\[
P(\VEC{x},\VEC{\xi}) = \sum_{j=1}^n \left(
\pdydx{Q}{\xi_j}(\VEC{x},\VEC{\xi})
\pdydx{\overline{Q}}{x_j}(\VEC{x},\VEC{\xi})
- \pdydx{Q}{x_j}(\VEC{x},\VEC{\xi})
\pdydx{\overline{Q}}{\xi_j}(\VEC{x},\VEC{\xi}) \right) \ .
\]
\begin{itemize}
\item Given $\VEC{x}_0 \in \Omega$, if there exists
$\displaystyle \VEC{\xi} \in \RR^n$ such that
$Q(\VEC{x}_0,\VEC{\xi})=0$ and $P(\VEC{x}_0,\VEC{\xi})\neq 0$, then
$L$ is not locally solvable at $\VEC{x}_0$.
\item If for every $\VEC{x} \in \Omega$ we can find
$\displaystyle \VEC{\xi} \in \RR^n$
such that $Q(\VEC{x},\VEC{\xi})=0$ and $P(\VEC{x},\VEC{\xi})\neq 0$,
then there exists $\displaystyle f \in C^\infty(\Omega)$ such that
$Lu = f$ has no 
local solution $u \in \DD'(U)$ whatever the open set $U \subset \Omega$.
\end{itemize}
\end{theorem}

\section{Exercises}

Suggested exercises:

\begin{itemize}
\item In \cite{Br}: number 8.1 to 8.22 in Chapter 8.
\item In \cite{FoPDE}: number 1 in Section 6A; numbers 1 and 2 in
Section 6B; numbers 1 and 2 in Section 6E.
\item In \cite{McO}: numbers 2 to 4, 6 and 7 in Section 6.4;
numbers 2, 7(a) and 9 in Section 6.5. 
\end{itemize}

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "notes"
%%% End: 
