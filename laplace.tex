\chapter{Laplace Equation} \label{ChapLaplace}

Let $\Omega$ be an open subset of $\displaystyle \RR^n$.  The
{\bfseries Laplace equation}\index{Laplace Equation}
is the partial differential equation
\begin{equation} \label{LaplPotEqu}
\Delta u = 0 \quad , \quad \VEC{x} \in \Omega \ .
\end{equation}
The problem is to find $u$ that satisfies the Laplace equation and some
boundary conditions.  The boundary of $\Omega$ is denoted by
$\partial \Omega$.  The most frequent boundary conditions are listed
below.

\subI{Dirichlet Boundary Conditions} Given
$f:\partial \Omega \rightarrow \RR$, we require that
$u(\VEC{x}) = f(\VEC{x})$ for $\VEC{x} \in \partial \Omega$.  We write
$\displaystyle u\big|_{\partial \Omega} = f$.

\subI{Neumann Boundary Conditions} Given
$g:\partial \Omega \rightarrow \RR$, we require that
$\displaystyle \pdydx{u}{\nu}(\VEC{x}) = g(\VEC{x})$
for $\VEC{x} \in \partial \Omega$, where $\nu(\VEC{x})$ is the
outward unit normal to the surface $\partial \Omega$ at $\VEC{x}$.  We write
$\displaystyle \pdydx{u}{\nu} \bigg|_{\partial \Omega} = g$.

\subI{Mixed Boundary Conditions} A mix of the previous two conditions.
We assign $u$ on some parts of $\partial \Omega$ and
$\displaystyle \pdydx{u}{\nu}$ on the other parts of $\partial \Omega$.

\subI{Robin Boundary Conditions} Given
$u_0:\partial \Omega \rightarrow \RR$, we require that
\[
\pdydx{u}{\nu}(\VEC{x}) + \alpha \left( u(\VEC{x})
- u_0(\VEC{x}) \right) = 0 \quad , \quad \VEC{x} \in \partial \Omega \ ,
\]
where $\alpha$ is a constant.  We write
$\displaystyle \left( \pdydx{u}{\nu} +
\alpha (u - u_0)\right)\bigg|_{\partial \Omega} = 0$.

For the steady-state heat problem.  Robin Boundary Conditions is used
to express the fact that heat flow across $\partial \Omega$ is
proportional to the difference between the temperature $u$ inside
$\Omega$ and the temperature $u_0$ outside $\Omega$.  This is the
{\bfseries Newton's Law} of heating
(or cooling)\index{Newton's Law of Heating}.

Equation (\ref{LaplPotEqu}) is also called
{\bfseries potential Equation}\index{Potential Equation} and the
solutions of this equation are called
{\bfseries potential functions}\index{Potential Functions} or
{\bfseries harmonic functions}\index{Harmonic Functions}.  We will
give in Definition~\ref{defnHarmFunct} a more convenient definition of
harmonic function.

The non-homogeneous equation
\[
\Delta u = f(\VEC{x}) \quad , \quad \VEC{x} \in \Omega \ ,
\]
is called the {\bfseries Poisson equation}\index{Poisson Equation}.
The types of boundary
conditions mentioned above are also imposed on the Poisson equation.
We will also study this equation in this and the next chapter.

\section{Harmonic Functions} \label{SectLaplaceHarmFunct}

The following proposition is a consequence of the Divergence Theorem.

\begin{prop}[Green's Identities]
Let $\Omega$ be an open subset of $\displaystyle \RR^n$ with a smooth
boundary (at least a boundary of class $\displaystyle C^2$).  If $u$
and $v$ are two functions of class
$\displaystyle C^2(\Omega) \cap C^1(\overline{\Omega})$, then
\begin{align}
\int_{\partial \Omega} v\,\pdydx{u}{\nu} \dx{S}
&= \int_\Omega \left( v \Delta u + \nabla u \cdot \nabla v \right)
\dx{\VEC{x}} \label{laplace_green1}
\intertext{and}
\int_{\partial \Omega} \left( v\,\pdydx{u}{\nu} 
- u\,\pdydx{v}{\nu} \right) \dx{S}
&= \int_\Omega \left( v \Delta u -  u \Delta v \right)
\dx{\VEC{x}} \ , \label{laplace_green2}
\end{align}
where $\nu(\VEC{x})$ is the outward unit normal to the surface
$\partial \Omega$ at $\VEC{x} \in \partial \Omega$.
\index{Green's Identities}
\end{prop}

\begin{rmk}
Recall that a function $f:\Omega \rightarrow \RR$ is of class
$\displaystyle C^k(\overline{\Omega})$ if $\displaystyle D^{\VEC{\alpha}} f$
can be continuously extended to $\overline{\Omega}$ for all
multi-index $\VEC{\alpha}$ such that $|\VEC{\alpha}|\leq k$.
\end{rmk}

\begin{proof}
The Divergence Theorem\index{Divergence Theorem} states that
\[
\int_{\partial \Omega} F \cdot \nu\ \dx{S} =
\int_\Omega \diV F \dx{\VEC{x}}
\]
for $\displaystyle F:\Omega \rightarrow \RR^n$ of class
$\displaystyle C^1(\Omega) \cap C(\overline{\Omega})$ and
$\nu$ a unite normal to $\partial \Omega$ pointing outside of
$\Omega$.

Moreover, $\displaystyle \pdydx{f}{\nu} = \nabla f \cdot \nu$
for $\displaystyle f \in C^1(\Omega)$.  Thus
(\ref{laplace_green1}) follows from the Divergence Theorem applied to
$F = v \nabla u$.  To get (\ref{laplace_green2}), interchange $u$ and
$v$ in (\ref{laplace_green1}) and subtract the resulting equation
from (\ref{laplace_green1}).
\end{proof}

Recall that, for $\displaystyle \VEC{x} \in \RR^n$ and $r > 0$, the
open ball of radius $r$ centred at $\VEC{x}$ is the set
$\displaystyle B_r(\VEC{x}) = \left\{ \VEC{y}\in \RR^n : 
\|\VEC{y}-\VEC{x}\|<r \right\}$.  The closure of this ball is thus
$\displaystyle \overline{B_r(\VEC{x})} = \left\{ \VEC{y}\in \RR^n : 
\|\VEC{y}-\VEC{x}\|\leq r \right\}$.

\begin{defn} % If the label is defined here before the first sentence
  % of the definition, TeX does not register it.  Why?
A continuous function $u:\Omega \to \RR$ on an open set   \label{defnHarmFunct}
$\displaystyle \Omega \subset \RR^n$ is
{\bfseries harmonic}\index{Harmonic Functions} if
\[
u(\VEC{x}) = M_u(\VEC{x},r) \equiv \frac{1}{\omega_n}
\int_{\|\VEC{x}\|=1} u(\VEC{x} + r\VEC{y}) \dss{S}{y}
= \frac{1}{r^{n-1}\omega_n} \int_{\|\VEC{y}-\VEC{x}\|=r} u(\VEC{y}) \dss{S}{y}
\]
for every $\VEC{x} \in \Omega$ and $r>0$ such that
at $\overline{B_r(\VEC{x})} \subset \Omega$,
where $\displaystyle \omega_n = 2\pi^{n/2}\big/ \Gamma(n/2)$ is the area of the
surface of the ball of radius $1$ in $\displaystyle \RR^n$.
\end{defn}

\begin{theorem}[Mean Value Theorem] \label{laplace_MVT}
Suppose that $\Omega$ is an open subset of $\displaystyle \RR^n$ and that
$\displaystyle u \in C^2(\Omega)$ satisfies $\Delta u = 0$
on $\Omega$.  If $\VEC{x} \in \Omega$ and $r>0$ are such
that $\displaystyle \overline{B_r(\VEC{x})} \subset \Omega$, then
$u(\VEC{x}) = M_u(\VEC{x},r)$.  In particular, this prove that $u$ is
harmonic on $\Omega$. \index{Mean Value Theorem}
\end{theorem}

\begin{proof}
It follows from the Green's identity (\ref{laplace_green1}) on
$\displaystyle \overline{B_s(\VEC{x})}$ with $v \equiv 1$ that
\begin{equation} \label{MVTequ1}
\int_{\partial B_s(\VEC{x})} \pdydx{u}{\nu} \dx{S}
= \int_{B_s(\VEC{x})} \Delta u \dx{\VEC{x}} = 0
\end{equation}
for all $0 \leq s \leq r$.  Since $u$ and
$\graD u$ are continuous on the compact set
$\overline{B_r(\VEC{x})}$ and so uniformly continuous on the compact
set $\overline{B_r(\VEC{x})}$, we may write
\begin{align*}
\pdfdx{ \int_{\partial B_1(\VEC{0})} u(\VEC{x} + s\VEC{y}) \dss{S}{y} }{s}
&= \int_{\partial B_1(\VEC{0})} \pdfdx{u(\VEC{x} + s\VEC{y})}{s} \dss{S}{y}
= \int_{\partial B_1(\VEC{0})} \graD u(\VEC{x} + s\VEC{y}) \cdot
\VEC{y} \dss{S}{y} \\
& = s^{1-n}\int_{\partial B_s(\VEC{x})} \graD u(\VEC{y}) \cdot
(s^{-1}(\VEC{y}-\VEC{x})) \dss{S}{y}
= s^{1-n} \int_{\partial B_s(\VEC{x})}
\pdydx{u}{\nu} \dx{S} = 0
\end{align*}
for all $0<s<r$, where we note that the unit normal vector to
$\partial B_s(\VEC{x})$ at $\VEC{y} \in \partial B_s(\VEC{x})$ is
$\displaystyle \nu(\VEC{y}) = s^{-1}(\VEC{y}-\VEC{x})$.
Therefore,
$\displaystyle s \mapsto
\int_{\partial B_1(\VEC{0})} u(\VEC{x} + s\VEC{y}) \dss{S}{y}$
is a constant function for $0 \leq s \leq r$.  Thus,
\[
\int_{\partial B_1(\VEC{0})} u(\VEC{x} + r\VEC{y}) \dss{S}{y}
= \int_{\partial B_1(\VEC{0})} u(\VEC{x}) \dss{S}{y}
= \omega_n u(\VEC{x}) \ . \qedhere
\]
\end{proof}

Theorem~\ref{laplace_MVT} has a converse.

\begin{theorem} \label{laplace_MVT_conv}
Let $\Omega$ be an open subset of $\RR^n$ and $u:\Omega \rightarrow \RR$
be an harmonic function, then $u \in C^\infty(\Omega)$ and
$\Delta u = 0$ on $\Omega$.
\end{theorem}

\begin{proof}
\stage{i} We first prove that $u$ is of class $C^\infty(\Omega)$.

Choose $\psi \in \DD(]-1,1[)$ such that
\begin{equation} \label{laplace_int1}
\int_{\RR^n} \phi(\VEC{x}) \dx{\VEC{x}} = 1 \ ,
\end{equation}
where $\phi(\VEC{x}) = \psi(\|\VEC{x}\|^2)$ for
$\displaystyle \VEC{x} \in \RR^n$.
We note that $\supp \phi \subset B_1(\VEC{0})$.

Given $\epsilon \in ]0,1[$, let
$\displaystyle
\phi_\epsilon(\VEC{x}) = \epsilon^{-n} \phi\left(\epsilon^{-1}\,\VEC{x}\right)$
for all $\displaystyle \VEC{x} \in \RR^n$ and
$\displaystyle \Omega_\epsilon
= \left\{ \VEC{x} : \overline{B_\epsilon(\VEC{x})} \subset \Omega \right\}$.
For $\VEC{x} \in \Omega_\epsilon$, the support of the function
$\VEC{y} \mapsto \phi_\epsilon(\VEC{x}-\VEC{y})$ is a subset of
$B_\epsilon(\VEC{x}) \subset \Omega$ and
$\displaystyle
\int_{\RR^n} u(\VEC{y}) \phi_\epsilon(\VEC{x}-\VEC{y}) \dx{\VEC{y}}$
is well defined.  The integral outside of $\Omega$ is irrelevant
because $\phi_\epsilon(\VEC{x}-\VEC{y}) = 0$ for
$\VEC{y} \not\in \Omega$ by construction.  One can set $u(\VEC{y})=0$
for $\VEC{y} \not\in \Omega$ to get an integral defined on all
$\displaystyle \RR^n$.

For $\VEC{x} \in \Omega_\epsilon$, we have
\begin{align*}
&\int_{\RR^n} u(\VEC{y}) \phi_\epsilon(\VEC{x}-\VEC{y}) \dx{\VEC{y}} =
\int_{\RR^n} u(\VEC{x}-\VEC{y}) \phi_\epsilon(\VEC{y}) \dx{\VEC{y}}
=\int_{B_\epsilon(\VEC{0})} u(\VEC{x}-\VEC{y})
\epsilon^{-n} \phi(\epsilon^{-1} \VEC{y}) \dx{\VEC{y}} \\
&\qquad =\int_{B_1(\VEC{0})} u(\VEC{x}-\epsilon \VEC{y})
\phi(\VEC{y}) \dx{\VEC{y}}
=\int_0^1 \left(
\int_{\|\VEC{y}\|=1} u(\VEC{x}-\epsilon r \VEC{y}) \dss{S}{y} \right)
\psi(r^2) r^{n-1} \dx{r} \ ,
\end{align*}
where we have use the fact that $\phi(r\VEC{y}) = \psi(r^2)$ for
$\|\VEC{y}\| = 1$.  However, by hypothesis,
\[
\int_{\|\VEC{y}\|=1} u(\VEC{x}-\epsilon r\, \VEC{y}) \dss{S}{y}
= \omega_n \, u(\VEC{x})
\]
because $\epsilon r \leq \epsilon$.  Thus,
\begin{align*}
&\int_{\RR^n} u(\VEC{y}) \phi_\epsilon(\VEC{x}-\VEC{y}) \dx{\VEC{y}}
= \omega_n \, u(\VEC{x}) \int_0^1 \psi(r^2) r^{n-1} \dx{r}
= u(\VEC{x}) \int_0^1 \left( \int_{\|\VEC{y}\|=1} \dss{S}{y}\right)
\psi(r^2) r^{n-1} \dx{r} \\
&\qquad = u(\VEC{x}) \int_0^1 \int_{\|\VEC{y}\|=1} \phi(r\VEC{y}) r^{n-1}
\dx{S(\VEC{y})} \dx{r}
= u(\VEC{x}) \int_{B_1(\VEC{0})} \phi(\VEC{y}) \dx{\VEC{y}} = u(\VEC{x}) \ ,
\end{align*}
where the last equality comes from (\ref{laplace_int1}) with
$\supp \phi \subset B_1(\VEC{0})$.

We have that
\begin{align*}
\Omega_\epsilon & \rightarrow \RR \\
\VEC{x} & \mapsto
\int_{\RR^n} u(\VEC{y}) \phi_\epsilon(\VEC{x}-\VEC{y}) \dx{\VEC{y}}
\end{align*}
is of class $\displaystyle C^\infty$ on $\Omega_\epsilon$ because
$\displaystyle \phi_\epsilon \in C_c^\infty(\RR^n)$ and, for any
$\VEC{x}_0 \in \Omega_\epsilon$ and $\delta>0$ such that
$\overline{B_\delta(\VEC{x}_0)} \subset \Omega_\epsilon$, the function
\begin{align*}
h_{\VEC{\alpha}}: \Omega_\epsilon \times \Omega &\rightarrow \RR \\
(\VEC{x},\VEC{y}) &\mapsto u(\VEC{y})D^{\VEC{\alpha}}_{\VEC{x}}
\phi_\epsilon(\VEC{x}-\VEC{y})
\end{align*}
is uniformly continuous on
$\overline{B_\delta(\VEC{x}_0)} \times \Omega$ for all
multi-index $\VEC{\alpha}$.  This follows from the
fact that $h_{\VEC{\alpha}}:\Omega_\epsilon \times \Omega$ is
continuous, so it is uniformly continuous on the compact set
$\displaystyle \overline{B_\delta(\VEC{x}_0)} \times
\overline{B_{\delta+\epsilon}(\VEC{x}_0)}$, $h_{\VEC{\alpha}}$.  Since
$h_{\VEC{\alpha}}(\VEC{x},\VEC{y}) = 0$ for
$\VEC{x} \in \overline{B_{\delta}(\VEC{x}_0)}$ and
$\VEC{y} \not\in \overline{B_{\delta+\epsilon}(\VEC{x}_0)}$,
$h_{\VEC{\alpha}}$ is uniformly continuous on
$\overline{B_\delta(\VEC{x}_0)} \times \Omega$.

\stage{ii} Since
\[
\int_{\|\VEC{y}\|=1} u(\VEC{x}+r\VEC{y}) \dss{S}{y} = \omega_n u(\VEC{x})
\]
for all $r$ such that $\overline{B_r(\VEC{x})} \subset \Omega$ by hypothesis,
then the function defined by\\
$\displaystyle r \mapsto \int_{\|\VEC{y}\|=1} u(\VEC{x}+r\VEC{y}) \dss{S}{y}$
is constant on its domain.  Hence, using the substitution
$\VEC{y} = r^{-1} (\VEC{z}-\VEC{x})$, we get
\begin{align*}
0 &= \pdfdx{ \int_{\|\VEC{y}\|=1} u(\VEC{x}+r\VEC{y}) \dss{S}{y} }{r}
= \int_{\|\VEC{y}\|=1} \nabla u(\VEC{x}+r\VEC{y}) \cdot \VEC{y}
 \dss{S}{y} \\
&= \int_{\partial B_r(\VEC{x})} \graD u(\VEC{z}) \cdot \left(
  r^{-1} (\VEC{z} - \VEC{x}) \right) \, r^{1-n} \dss{S}{z}
= r^{1-n} \int_{\partial B_r(\VEC{x})} \pdydx{u}{\nu} \dx{S} \ ,
\end{align*}
where we note that the outward unit normal vector to $\partial B_r(\VEC{x})$
at $\VEC{z} \in \partial B_r(\VEC{x})$ is
$\displaystyle \nu(\VEC{z}) = r^{-1}(\VEC{z}-\VEC{x})$.

It follows from (\ref{laplace_green1}) with $\Omega = B_r(\VEC{x})$
and $v=1$ on $\Omega$ that
\[
0 = = r^{1-n} \int_{\partial B_r(\VEC{x})} \pdydx{u}{\nu} \dx{S}
= r^{1-n} \int_{B_r(\VEC{x})} \Delta u \dx{\VEC{y}} \ .
\]
Since this is true for all $\VEC{x} \in \Omega$ and
all $r$ such that $\overline{B_r(\VEC{x})} \subset \Omega$, and since
$\Delta u$ is continuous in $\Omega$ by the first part of the proof, then
$\Delta u = 0$ on $\Omega$.
\end{proof}

\begin{cor} \label{UnifConvHarm}
Let $\displaystyle \left\{ u_j \right\}_{j=1}^\infty$ be a sequence of
harmonic functions on an open set $\Omega \subset \RR^n$.  If the sequence
$\displaystyle \left\{ u_j \right\}_{j=1}^\infty$ converges uniformly
on compact subsets of $\Omega$ to a function $u$, then $u$ is harmonic
in $\Omega$.
\end{cor}

\begin{proof}
Since the $u_j$ are harmonic in $\Omega$, we have by
definition that
\[
u_j(\VEC{x}) = \frac{1}{\omega_n} \int_{\|\VEC{y}\|=1}
u_j(\VEC{x}+r\VEC{y}) \dss{S}{y}
\]
for $j>0$, $\VEC{x}\in \Omega$ and $r$ small enough such that
$\overline{B_r(\VEC{x})} \subset \Omega$.  The left side converges to
$u(\VEC{x})$ as $j\rightarrow \infty$ by hypothesis and the right side
converges to $\displaystyle \frac{1}{\omega_n} \int_{\|\VEC{y}\|=1}
u(\VEC{x}+r\VEC{y}) \dss{S}{y}$ because 
$u_j(\VEC{x}+r\VEC{y}) \rightarrow u(\VEC{x}+r\VEC{y})$ uniformly
on the compact set $\{ \VEC{y} : \|\VEC{y}\|=1\}$.

Being the uniform limit on compact sets of the continuous functions
$u_j$, $u\in C(\Omega)$.

Thus $u$ is a continuous function on $\Omega$ such that
\[
u(\VEC{x}) = \frac{1}{\omega_n} \int_{\|\VEC{y}\|=1}
u(\VEC{x}+r\VEC{y}) \dss{S}{y}
\]
for any $\VEC{x} \in \Omega$ and $r$ such that
$\overline{B_r(\VEC{x})} \subset \Omega$.  This means that $u$ is
harmonic on $\Omega$ by definition.
\end{proof}

It is also interesting to note that Liouville's Theorem for complex
entire (and so harmonic) functions generalizes to harmonic
functions on $\displaystyle \RR^n$ in general.

\begin{theorem}[Liouville's Theorem]
If $\displaystyle u:\RR^n \rightarrow \RR$ is a bounded harmonic
function, then $u$ is constant on $\displaystyle \RR^n$.
\index{Liouville's Theorem}
\end{theorem}

\begin{proof}
Given $\displaystyle \VEC{x} \in \RR^n$ and $R>\|\VEC{x}\|$, we
multiply both sides of
\[
u(\VEC{x}) = \frac{1}{\omega_n} \int_{\|\VEC{y}\|=1}
u(\VEC{x} + \rho R \VEC{y}) \dx{S_{\VEC{y}}}
\]
by $\displaystyle \rho^{n-1}$ and integrate with respect to $\rho$
between $0$ and $1$ to get
\begin{align}
&u(\VEC{x})\int_0^1 \rho^{n-1} \dx{\rho} =
\frac{1}{\omega_n} \int_{\|\VEC{y}\|=1} \int_0^1
u(\VEC{x} + \rho R \VEC{y}) \rho^{n-1} \dx{\rho} \dx{S_{\VEC{y}}}
\nonumber \\
&\qquad = \frac{1}{R^n \omega_n} \int_{\|\VEC{y}\|=1} \int_0^R
u(\VEC{x} + r \VEC{y}) r^{n-1} \dx{r} \dx{S_{\VEC{y}}}
= \frac{1}{R^n \omega_n} \int_{B_R(\VEC{x})} u(\VEC{y}) \dx{\VEC{y}}
\ , \label{LouisEq1}
\end{align}
where we have used the change of variable $r=\rho R$ to get the second
equality.
Since
$\displaystyle \int_0^1 \rho^{n-1} = \frac{1}{n}$, we get from
(\ref{LouisEq1}) that
\[
u(\VEC{x}) = \frac{n}{R^n \omega_n} \int_{B_R(\VEC{x})} u(\VEC{y})
\dx{\VEC{y}} \ .
\]
Thus,
\[
\left| u(\VEC{x}) - u(\VEC{0}) \right|
= \frac{n}{R^n \omega_n} \left| 
\int_{B_R(\VEC{x})} u(\VEC{y}) \dx{\VEC{y}}
- \int_{B_R(\VEC{0})} u(\VEC{y}) \dx{\VEC{y}} \right|
= \frac{n}{R^n \omega_n} \left| 
\int_D u(\VEC{y}) \dx{\VEC{y}} \right| \ ,
\]
where $D = \big(B_R(\VEC{x}) \setminus B_R(\VEC{0})\big) \cup 
\big(B_R(\VEC{0}) \setminus B_R(\VEC{x})\big)$ is the symmetric difference
of the sets $B_R(\VEC{x})$ and $B_R(\VEC{0})$ (Figure~\ref{laplace_FIG5}).
Since
$D \subset D_R = \{ \VEC{y} \in \RR^n :
R-\|\VEC{x}\| \leq \|y\| \leq R+\|\VEC{x}\|\}$,
we get
\begin{align*}
&\left| u(\VEC{x}) - u(\VEC{0}) \right|
\leq \frac{n}{R^n \omega_n} \|u\|_{\infty} \int_D \dx{\VEC{y}}
\leq \frac{n}{R^n \omega_n} \|u\|_{\infty} \int_{D_R} \dx{\VEC{y}} \\
&\qquad = \frac{n}{R^n \omega_n} \|u\|_{\infty} \int_{\|y\|=1}
\int_{R-\|\VEC{x}\|}^{R+\|\VEC{x}\|} r^{n-1} \dx{r} \dx{S_{\VEC{y}}}
= \|u\|_{\infty} \frac{ (R+\|\VEC{x}\|)^n - (R-\|\VEC{x}\|)^n}{R^n}
\to 0 
\end{align*}
as $R \to \infty$.  Thus $u(\VEC{x}) = u(\VEC{0})$.
\end{proof}

\pdfF{laplace/laplace_fig5}{Figure for the proof of Liouville's Theorem} 
{The region $D$ described in the proof of Liouville's Theorem is
in pale blue.}{laplace_FIG5}

\section{Maximum Principle} \label{SectLaplaceMaxPrinc}

\begin{defn}
A continuous function $u:\Omega \to \RR$ on an open set
$\displaystyle \Omega \subset \RR^n$ is
{\bfseries subharmonic}\index{Subharmonic Functions}
if, for every $\VEC{x} \in \Omega$, there exists $R>0$ (that may depend
on $\VEC{x})$ such that $B_R(\VEC{x}) \subset \Omega$ and
\[
u(\VEC{x}) \leq M_u(\VEC{x},r) \equiv \frac{1}{\omega_n}
\int_{\|\VEC{x}\|=1} u(\VEC{x} + r\VEC{y}) \dss{S}{y}
= \frac{1}{r^{n-1}\omega_n} \int_{\|\VEC{y}-\VEC{x}\|=1} u(\VEC{y}) \dss{S}{y}
\]
for all $0<r<R$.
\end{defn}

Any harmonic functions on an open set $\Omega$ is obviously
subharmonic on $\Omega$.

By slightly modifying the proof of Theorem~\ref{laplace_MVT}, we
obtain the following result.

\begin{prop}
A function $u:\Omega \to \RR$ of class $\displaystyle C^2$ on an open set
$\displaystyle \Omega \subset \RR^n$ is subharmonic if and only if
$\Delta u \geq 0$ on $\Omega$.
\end{prop}

\begin{proof}
\stage{$\mathbf{\Leftarrow}$}  This is basically the proof given for
Theorem~\ref{laplace_MVT}.  The only difference is that
(\ref{MVTequ1}) shows that $\displaystyle \int_{\partial B_s(\VEC{x})}
\pdydx{u}{\nu} \dss{S}{y} \geq 0$.
It then follows that
$\displaystyle s \mapsto
\int_{\partial B_1(\VEC{0})} u(\VEC{x} + s\VEC{y}) \dss{S}{y}$
is a non decreasing function for $0 \leq s \leq r$.  Thus,
$u(\VEC{x}) = M_u(\VEC{x},0) \leq M_u(\VEC{x},s)$ for $0 < s \leq r$.

\stage{$\mathbf{\Rightarrow}$}
Suppose that $\Delta u(\VEC{z}) < 0$ for some $\VEC{z} \in \Omega$.
Since $\Delta u$ is continuous, there exists $r>0$ such that
$\displaystyle \overline{B_r(\VEC{z})} \subset \Omega$ and
$\Delta u(\VEC{x}) < 0 $ for all
$\displaystyle \VEC{x} \in \overline{B_r(\VEC{z})}$.

Since $u$ and $\graD u$ are uniformly continuous on the compact set
$\displaystyle \overline{B_r(\VEC{z})}$, we may write
\[
\pdfdx{ \int_{\partial B_1(\VEC{0})} u(\VEC{z} + s\VEC{y}) \dss{S}{y} }{s}
= \int_{\partial B_1(\VEC{0})} \pdfdx{ u(\VEC{z} + s\VEC{y})}{s} \dss{S}{y}
= s^{1-n} \int_{\partial B_s(\VEC{x})} \pdydx{u}{\nu} \dx{S}
\]
for $0 < s < r$.
It then follows from Green's identity (\ref{laplace_green1}) on
$B_x(\VEC{x})$ with $v \equiv 1$ that
\[
\pdfdx{ \int_{\partial B_1(\VEC{0})} u(\VEC{z} + s\VEC{y}) \dss{S}{y} }{s}
= s^{1-n} \int_{\partial B_s(\VEC{x})} \pdydx{u}{\nu} \dx{S}
= s^{1-n} \int_{B_s{\VEC(x)}} \Delta u \dx{\VEC{y}} < 0
\]
for $0 < s < r$.  Hence, $s \mapsto M_u(\VEC{z},s)$ is a decreasing
function on $[0,r]$.  This implies that
$M_u(\VEC{z},s) < M_u(\VEC{z},0) = u(\VEC{z})$
for $0<s<r$.  This is a contradiction that $u$ is subharmonic on $\Omega$.
\end{proof}

\begin{theorem}[Maximum Principle] \label{laplace_HMP}
Let $\Omega$ be a connected open subset of $\displaystyle \RR^n$ and
$u:\overline{\Omega}\rightarrow \RR$ be continuous function which is
subharmonic on $\Omega$.  Moreover, let 
$\displaystyle A = \sup_{\VEC{x}\in \Omega}\, u(\VEC{x})$.
If $A<\infty$, then either $u(\VEC{x}) < A$ for all $\VEC{x} \in \Omega$ or
$u(\VEC{x}) = A$ for all $\VEC{x} \in \Omega$.
\end{theorem}

\begin{rmk}
Recall that a set $\displaystyle \Omega \subset \RR^n$ is
{\bfseries connected}\index{Connected Set} if it cannot be
expressed as the disjoint union of two non-empty open sets with
respect to the induced topology on $\Omega$.
\end{rmk}

\begin{proof}
The set
$\displaystyle u^{-1}(\{A\})
= \left\{ \VEC{x}\in \Omega : u(\VEC{x}) = A \right\}$
is closed in $\Omega$ because $u$ is continuous (the inverse image of a
closed set by a continuous functions is a closed set).

We now show that $\displaystyle u^{-1}(\{A\})$ is also open in the
induce topology on $\Omega$.  If
$\displaystyle \VEC{x} \in u^{-1}(\{A\})$, it follows that
\[
A = u(\VEC{x}) \leq \frac{1}{r^{n-1}\omega_n} \int_{\|\VEC{y}-\VEC{x}\|=r}
u(\VEC{y}) \dss{S}{y}
\]
for $r$ such that $\overline{B_r(\VEC{x})}\subset \Omega$ because
$u$ is subharmonic on $\Omega$.  There exists such a $r$ since $\Omega$ is
open.  Since $A$ is the maximum of $u$ in $\Omega$ and $u$ is continuous in
$\Omega$, this implies that $u(\VEC{y}) = A$ for all
$\VEC{y} \in B_r(\VEC{x})$.  Hence, $B_r(\VEC{x})$ is an open
neighbourhood of $\VEC{x}$ inside $\displaystyle u^{-1}(\{A\})$.
This shows that $\displaystyle u^{-1}(\{A\})$ is open since
$\displaystyle \VEC{x} \in u^{-1}(\{A\})$ is arbitrary

Since $\Omega$ is connected, either
$\displaystyle u^{-1}(\{A\}) = \emptyset$ or
$\displaystyle u^{-1}(\{A\}) = \Omega$ otherwise
$\displaystyle \Omega = u^{-1}(\{A\}) \cup
(\Omega \setminus u^{-1}(\{A\}))$ is the disjoint
union of two non-empty open sets in $\Omega$.
\end{proof}

\begin{cor} \label{laplace_cHMP}
Let $\Omega$ be a bounded open subset of $\RR^n$.  If
$u:\overline{\Omega} \rightarrow \RR$ is continuous and $u$ is
harmonic in $\Omega$, then $u$ reaches its maximal (and minimal) value
on $\partial \Omega$.
\end{cor}

\begin{proof}
Since $u$ is continuous on the compact set $\overline{\Omega}$, there
exists $\VEC{x}\in \overline{\Omega}$ such that
$\displaystyle u(\VEC{x}) = \sup_{\VEC{y}\in \overline{\Omega}}\, u(\VEC{y})$.
If $\VEC{x} \in \Omega$, it follows from Theorem~\ref{laplace_HMP}
that $u(\VEC{y}) = u(\VEC{x})$ for all $\VEC{y} \in \tilde{\Omega}$, a
connected component of $\Omega$.  Thus $u(\VEC{y}) = u(\VEC{x})$ for
$\VEC{y} \in \partial \tilde{\Omega} \subset \partial \Omega$.

To prove the conclusion of the corollary for the minimal value, apply
the previous reasoning to $-u$.
\end{proof}

\begin{theorem}[Uniqueness Theorem] \label{laplace_uniqu_th}
Let $\Omega$ be an open subset of $\RR^n$ with compact closure.  If
$u_1 : \overline{\Omega} \rightarrow \RR$ and
$u_2 : \overline{\Omega} \rightarrow \RR$ are two continuous functions
which are harmonic on $\Omega$ and satisfy $u_1 = u_2$ on $\partial \Omega$, 
then $u_1 = u_2$ in $\Omega$.
\end{theorem}

\begin{proof}
Since $u_1-u_2$ is continuous functions on
$\overline{\Omega}$ and harmonic in $\Omega$, we get from
Corollary~\ref{laplace_cHMP} that
\begin{align*}
0 &= \inf_{\VEC{x}\in \partial \Omega} \left(u_1(\VEC{x}) - u_2(\VEC{x})\right)
= \inf_{\VEC{x}\in \overline{\Omega}} \left(u_1(\VEC{x}) - u_2(\VEC{x})\right)
\leq \sup_{\VEC{x}\in \overline{\Omega}} \left(u_1(\VEC{x}) -
u_2(\VEC{x})\right) \\
& \qquad
= \sup_{\VEC{x}\in \partial \Omega} \left(u_1(\VEC{x}) - u_2(\VEC{x})\right)
= 0 \ .
\end{align*}
Thus $\displaystyle u_1(\VEC{x}) - u_2(\VEC{x}) = 0$ for all
$\VEC{x} \in \Omega$.
\end{proof}

\section{Fundamental Solutions}

\begin{theorem} \label{laplace_fund_sol}
Let
\[
N(\VEC{x}) =
\begin{cases}
\displaystyle \frac{1}{(2-n)\omega_n} \|\VEC{x}\|^{2-n} & \quad 
\text{if} \ n>2 \\[0.9em]
\displaystyle \frac{1}{\omega_2} \ln\left(\|\VEC{x}\|\right) & \quad 
\text{if} \ n=2
\end{cases}
\]
for $\VEC{x} \neq \VEC{0}$.  The function $N$ is a fundamental
solution of the Laplace operator $L(\VEC{x},\diff) = \Delta$.
\end{theorem}

\begin{proof}
\stage{i}
Though $N$ is not defined at the origin, $N$ is absolutely integrable
on any ball $B_r(\VEC{0})$ with $0<r<\infty$.

For $n>2$,
\begin{align*}
\int_{B_r(\VEC{0})} |N(\VEC{x})| \dx{\VEC{x}}
&= \frac{1}{(n-2)\omega_n}
\int_{\|\VEC{y}\|_2 =1} \left( \int_0^r s^{2-n} \, s^{n-1} \dx{s} \right)
\dss{S}{y}
= \frac{1}{(n-2)} \int_0^r s \dx{s} \\
&= \frac{s^2}{2(n-2)}\bigg|_0^r = \frac{r^2}{2(n-2)} < \infty \ .
\end{align*}

For $n=2$ and $r>1$,
\begin{align*}
&\int_{B_r(\VEC{0})} |N(\VEC{x})| \dx{\VEC{x}}
= \frac{1}{\omega_2}
\int_{\|\VEC{y}\|_2 =1} \left( \int_0^r |\ln(s)| \, s \dx{s} \right) \dss{S}{y}
= \int_0^r s |\ln(s)| \dx{s} \\
&\qquad = -\lim_{\epsilon \to 0^+} \int_\epsilon^1 s\ln(s) \dx{s}  
+ \int_1^r s\ln(s) \dx{s}  
= -\lim_{\epsilon \to 0} \left( \frac{s^2}{2}\ln(s) - \frac{s^2}{4}
\right)\bigg|_\epsilon^1
+ \left( \frac{s^2}{2}\ln(s) - \frac{s^2}{4} \right)\bigg|_1^r \\
&\qquad = \frac{r^2}{2}\ln(r) - \frac{r^2}{2} + \frac{1}{2} < \infty \ .
\end{align*}
The case $0<r<1$ is left to the reader.
Hence, $N$ is in $\displaystyle L^1_{loc}(\RR^n)$ and thus in
$\displaystyle \DD'(\RR^n)$.

\stage{ii}
For $\epsilon >0$, let
\[
N_\epsilon(\VEC{x}) =
\begin{cases}
\displaystyle \frac{1}{(2-n)\omega_n}
\left( \|\VEC{x}\|^2 + \epsilon^2\right)^{(2-n)/2} & \quad 
\text{if} \quad n>2 \\[1em]
\displaystyle \frac{1}{2\omega_2}
\ln\left(\|\VEC{x}\|^2 + \epsilon^2 \right) & \quad 
\text{if} \quad n=2
\end{cases}
\]
Note that $N_\epsilon$ is of class $C^{\infty}$ on $\RR^n$.

We first prove that $N_\epsilon \rightarrow N$ in $L^1(K)$ as
$\epsilon \rightarrow 0$ for any compact set $K \subset \RR^n$.
It is obvious that
$\displaystyle \lim_{\epsilon \rightarrow 0} N_\epsilon(\VEC{x}) = N(\VEC{x})$
for $\VEC{x} \neq \VEC{0}$.  Moreover, for $\epsilon \leq 1$,
\[
\left| N_\epsilon(\VEC{x}) \right| <
\begin{cases}
\displaystyle \left| N(\VEC{x})\right| & \quad \text{if} \quad n>2 \\[1em]
\displaystyle \frac{1}{\omega_2} \left( \left|\ln(\|\VEC{x}\|)\right|+1 \right) 
& \quad \text{if} \quad n=2
\end{cases}
\]
for all $\VEC{x} \neq \VEC{0}$ \footnote{If
$\|\VEC{x}\|^2+\epsilon^2 \leq 1$, then
$(1/2) |\ln(\|\VEC{x}\|^2 + \epsilon^2)|  
\leq (1/2) |\ln(\|\VEC{x}\|^2)| = |\ln(\|\VEC{x}\|)|$.
If $\|\VEC{x}\|+\epsilon > 1$ and $\epsilon\leq 1$, then
\begin{align*}
(1/2)|\ln(\|\VEC{x}\|^2+\epsilon^2)|
&= (1/2)\ln(\|\VEC{x}\|^2+\epsilon^2)
\leq (1/2)\ln(\|\VEC{x}\|^2+1) \\
&\leq
\begin{cases}
(1/2) \ln(2) \leq 1 & \quad \text{if} \ \|\VEC{x}\|\leq 1 \\
(1/2)(\ln(\|\VEC{x}\|^2) + 1) = \ln(\|\VEC{x}\|) + 1/2
& \quad \text{if} \ \|\VEC{x}\| > 1
\end{cases}
\end{align*}
It is easier to look at the graph of $|\ln(x)|$ to convince yourself
of these inequalities.}.  In both cases, the dominating
function is integrable on $K$ (even if $\VEC{0} \in  K$).
It follows from the Lebesgue Dominate Convergence Theorem that
\[
\int_K \left| N_\epsilon(\VEC{x}) - N(\VEC{x}) \right| \dx{\VEC{x}}
\rightarrow 0
\]
as $\epsilon \rightarrow 0$.

We now prove that $N_\epsilon \rightarrow N$ in $\DD'(\RR^n)$ as
$\epsilon \rightarrow 0$.  If $\phi \in \DD(\RR^n)$, let $K = \supp \phi$.
$K$ is a compact set by definition of $\DD(\RR^n)$.  Hence
\begin{align*}
\left| \ps{N_\epsilon}{\phi} - \ps{N}{\phi} \right|
&= \left| \ps{N_\epsilon - N}{\phi} \right|
= \left| \int_K \left(N_\epsilon(\VEC{x}) - N(\VEC{x})\right)
\phi(\VEC{x}) \dx{\VEC{x}} \right| \\
&\leq  \sup_{\VEC{x}\in K} \left|\phi(\VEC{x})\right| \,
\int_K \left|N_\epsilon(\VEC{x}) - N(\VEC{x})\right| \dx{\VEC{x}}
\rightarrow 0
\end{align*}
as $\epsilon \rightarrow 0$ because $N_\epsilon \rightarrow N$ in $L^1(K)$ as
$\epsilon \rightarrow 0$ and $\displaystyle
\sup_{\VEC{x}\in K} \left|\phi(\VEC{x})\right|$ is bounded.

\stage{iii} We have
\[
\Delta N_\epsilon(\VEC{x}) = \pdydxn{N_\epsilon}{r}{2}(r) +
\frac{n-1}{r} \pdydx{N_\epsilon}{r}(r)
= \frac{n\epsilon^2}{\omega_n} \left(r^2+\epsilon^2 \right)^{-(n+2)/2}
= \frac{n\epsilon^2}{\omega_n}
\left(\|\VEC{x}\|^2+\epsilon^2 \right)^{-(n+2)/2}
\]
for $r = \|\VEC{x}\|$. Thus
$\displaystyle
\Delta N_\epsilon(\VEC{x}) = \epsilon^{-n} \psi(\epsilon^{-1} \VEC{x})$,
where
\[
\psi(\VEC{x}) = \Delta N_1(\VEC{x}) = \frac{n}{\omega_n}
\left(\|\VEC{x}\|^2 + 1 \right)^{-(n+2)/2}
\]
for $\VEC{x} \in \RR^n$.

Since $N_\epsilon(\VEC{x}) = N_\epsilon(-\VEC{x})$ for all
$\VEC{x}$, we get
\[
\ps{\Delta N_\epsilon}{\phi} =
\int_{\RR^n} \Delta N_\epsilon(\VEC{x}) \phi(\VEC{x}) \dx{\VEC{x}}
= \int_{\RR^n} \Delta N_\epsilon(-\VEC{x}) \phi(\VEC{x}) \dx{\VEC{x}} \\
= (\phi \ast \Delta N_\epsilon)(\VEC{0})
\]
for $\displaystyle \phi \in \DD(\RR^n)$.

We have that $\displaystyle \psi \in L^1(\RR^n)$.  In fact,
$\psi(\VEC{x}) \geq 0$ for all $\VEC{x}$ and
\begin{align*}
a &= \int_{\RR^n} \psi(\VEC{x}) \dx{\VEC{x}}
= \frac{n}{\omega_n} \int_{\|\VEC{y}\|=1} \int_0^\infty
(r^2+1)^{-(2+n)/2} r^{n-1} \dx{r} \dss{S}{y} \\
&= n \int_0^\infty (r^2+1)^{-(2+n)/2} r^{n-1} \dx{r}
= n \int_0^\infty \left(\frac{r^2}{r^2+1}\right)^{(n-2)/2}
\frac{r}{(r^2+1)^2} \dx{r} \\
&= \frac{n}{2} \int_0^1 s^{(n-2)/2} \dx{s} = s^{n/2}\Big|_0^1 = 1 \ ,
\end{align*}
where we have used the substitution $\displaystyle s = \frac{r^2}{r^2+1}$
and $\displaystyle \dx{s} = \frac{2r}{(r^2+1)^2} \, \dx{r}$.

We may therefore use Proposition~\ref{distr_limit_convol} with
$\displaystyle a = \int_{\RR^n} \psi(\VEC{x}) \dx{\VEC{x}} = 1$
to conclude that
\begin{equation} \label{laplace_pot1}
\ps{\Delta N_\epsilon}{\phi} = (\phi \ast \Delta N_\epsilon)(\VEC{0})
\rightarrow \phi(\VEC{0})
\end{equation}
as $\epsilon \rightarrow 0$ for any $\displaystyle \phi \in \DD(\RR^n)$.

\stage{iv}
Finally, from (ii) and (\ref{laplace_pot1}), we have
\[
\ps{\Delta N}{\phi} =
\lim_{e\rightarrow 0} \ps{\Delta N_\epsilon}{\phi} 
= \phi(\VEC{0}) = \delta(\phi)
\]
for all $\phi\in \DD(\RR^n)$.
\end{proof}

\begin{cor} \label{lapl_anal_cond}
If $u\in \DD'(\RR^n)$ satisfies $\Delta u = f \in C^\infty(\RR^n)$,
then $u \in C^\infty(\RR^n)$.  In particular, we recover the
result that harmonic functions on $\RR^n$ are of class $C^\infty(\RR^n)$.
\end{cor}

\begin{proof}
It follows from Theorem~\ref{laplace_fund_sol} that
the first sentence of the equivalence list of Theorem~\ref{distr_hypoTH} is
satisfied.
\end{proof}

The distribution solution of $\Delta u = f \in \EE'(\RR^n)$ is given
by $u = N \ast f$.  The same conclusion may sometime be drawn when
$f \not\in \EE'(\RR^n)$.

\begin{theorem} \label{laplace_not_EEp}
If $f \in L^1(\RR^n)$ for $n>2$ or
$\displaystyle \int_{\RR^n} \big|f(\VEC{y}) \ln(\|\VEC{y}\|)\big|
\dx{\VEC{y}}<\infty$ for $n=2$, then $u= N\ast f$ is a locally
integrable function satisfying $\Delta u = f$ in the sense of
distributions.
\end{theorem}

\begin{proof}
We provide only the proof for $n>0$.  Let
\[
\chi_r(\VEC{x}) = \begin{cases}
1 & \quad \text{if} \quad \|\VEC{x}\| < r \\
0 & \quad \text{otherwise}
\end{cases}
\]
We have that $\displaystyle \chi_r N \in L^1(\RR^n)$ because
\begin{align*}
\int_{\RR^n} \left| \chi_r(\VEC{y}) N(\VEC{y}) \right| \dx{\VEC{y}}
&= \frac{1}{(n-2)\omega_n} \int_{\|\VEC{y}\|<r} \|\VEC{y}\|^{2-n} \dx{\VEC{y}}
= \frac{1}{(n-2)\omega_n}
\int_{\|\VEC{y}\|=1} \int_0^r \rho \dx{\rho} \dx{S_{\VEC{y}}} \\
&= \frac{r^2}{2(n-2)} < \infty \ .
\end{align*}
Moreover, $\displaystyle (1-\chi_r)N \in L^{\infty}(\RR^n)$ because
$\VEC{x} \mapsto N(\VEC{x})$ is a decreasing function as
$\|\VEC{x}\|\to \infty$ with support in $\{\VEC{x} : \|\VEC{x} \| > r\}$.
Thus, it follows from Young's Inequality, Theorem~\ref{distr_sp_young},
that $\displaystyle ( \chi_r N ) \ast f \in L^1(\RR^n)$ and
$\displaystyle ( (1-\chi_r)N ) \ast f \in L^{\infty}(\RR^n)$.

We first show that $\chi_r f \to f$ and $N \ast (\chi_r f) \to N \ast f$ in
$\displaystyle \DD'(\RR^n)$ as $r \to \infty$.

It follows from Lebesgue Dominated Convergence Theorem that
$\chi_r f$ converges to $f$ in $\displaystyle L^1(\RR^n)$ as $r \to \infty$
because $\displaystyle |\chi_r f| \leq |f| \in L^1(\RR^n)$ and
$\displaystyle \lim_{r\to \infty}\chi_r(\VEC{x})f(\VEC{x}) = f(\VEC{x})$
for all $\VEC{x}$.
Therefore, $\ps{\chi_r f}{\phi} \to \ps{f}{\phi}$ as $r\to \infty$
for all test function $\displaystyle \phi \in \DD(\RR^n)$; namely,
$\chi_r f \to f$ in $\displaystyle \DD'(\RR^n)$ as $r\to \infty$. 

Since
\[
\| (\chi_1 N) \ast (\chi_r f - f) \|_1 \leq \|\chi_r f - f\|_1
\, \|\chi_1 N\|_1 \to 0
\]
as $r \to \infty$ and
\[
\| ((1-\chi_1) N) \ast (\chi_r f - f) \|_{\infty} \leq \|\chi_r f - f\|_1
\, \|(1-\chi_1) N\|_\infty \to 0
\]
as $r \to \infty$, we have for all $\displaystyle \phi \in \DD(\RR^n)$ that
\begin{align*}
&\left| \ps{N\ast (\chi_r f)}{\phi} - \ps{N\ast f}{\phi}\right|
= \left| \ps{N\ast (\chi_r f -f)}{\phi}\right| \\
&\quad = \left| \ps{(\chi_1 N) \ast (\chi_r f -f)}{\phi}
+\ps{((1-\chi_1) N) \ast (\chi_r f -f)}{\phi}\right| \\
&\quad \leq \int_{\RR^n} |(\chi_1 N) \ast (\chi_r f -f) |\,
  |\phi|\dx{\VEC{x}}
+ \int_{\RR^n} |((1-\chi_1)N) \ast (\chi_r f -f) |\, |\phi| \dx{\VEC{x}} \\
&\quad \leq \|\phi\|_{\infty} \|(\chi_1 N)\ast (\chi_r f -f) \|_1
+ \|((1-\chi_1)N) \ast (\chi_r f -f)\|_{\infty}\int_{\RR^n} |\phi| \dx{\VEC{x}}
\to 0
\end{align*}
as $r \to \infty$.  Thus, $N \ast (\chi_r f) \to N \ast f$
in $\displaystyle \DD'(\RR^n)$ as $r \to \infty$.

Finally, we have
\[
\Delta (N\ast f) = \lim_{r\to \infty} \Delta (N \ast (\chi_r f))
= \lim_{r\to \infty} \chi_r f = f
\]
in the sens of distributions.  The first equality comes from the fact
that $\Delta$ is continuous on $\displaystyle \DD'(\RR^n)$ and
$N\ast (\chi_r f) \to N \ast f$ in $\displaystyle \DD'(\RR^n)$ as
$r \to \infty$.  The second equality comes from the fact that
$\displaystyle \chi_r f \in \EE'(\RR^n)$ for all $r$.
So $N \ast (\chi_r f)$ is a
solution in the sense of distribution of $\Delta u = \chi_r f$.
The last equality is just $\chi_r f \to f$ in
$\displaystyle \DD'(\RR^n)$ as $r\to \infty$ that we have proved previously.
\end{proof}

\section{Dirichlet and Neumann Problems}

Let
\begin{equation} \label{laplace_NXY}
N(\VEC{x},\VEC{y}) = N(\VEC{x}-\VEC{y})
\end{equation}
for $\VEC{x}\neq \VEC{y}$ in $\displaystyle \RR^n$ and
\[
  N_\epsilon(\VEC{x},\VEC{y}) = N_\epsilon(\VEC{x}-\VEC{y})
\]
for $\VEC{x},\VEC{y}$ in $\displaystyle \RR^n$.

\begin{theorem} \label{laplace_uhexp}
Let $\displaystyle \Omega \subset \RR^n$ be an open bounded set.  If
$\displaystyle u\in C^1(\overline{\Omega})$ is harmonic in $\Omega$, then
\begin{equation} \label{laplace_pot3}
u(\VEC{x}) = \int_{\partial \Omega} \left( u(\VEC{y})
\pdydx{N}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y}) -
N(\VEC{x},\VEC{y})\,\pdydx{u}{\nu_{\VEC{y}}}(\VEC{y})\right)
\dss{S}{y} \quad , \quad \VEC{x} \in \Omega \ ,
\end{equation}
where $\displaystyle \pdydx{N}{\nu_{\VEC{y}}}$ denotes the
directional derivative of $\VEC{y} \mapsto N(\VEC{x},\VEC{y})$ in the
direction of the outward unit normal $\nu(\VEC{y})$ to
$\partial \Omega$ at $\VEC{y}$
\end{theorem}

\begin{proof}
Consider $\VEC{x} \in \Omega$.
Since $\Delta u = 0$ on $\Omega$, we get from Green's identity
(\ref{laplace_green2}) that
\begin{equation} \label{laplace_pot2}
\int_{\Omega} u(\VEC{y}) \Delta_{\VEC{y}}
N_{\epsilon}(\VEC{x},\VEC{y}) \dx{\VEC{y}}
= \int_{\partial \Omega} \left( u(\VEC{y})
\pdydx{N_{\epsilon}}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y}) -
N_{\epsilon}(\VEC{x},\VEC{y}) \,
\pdydx{u}{\nu_{\VEC{y}}}(\VEC{y})\right) \dss{S}{y} \ .
\end{equation}

\stage{i}
If we set $u(\VEC{y}) = 0$ for
$\displaystyle \VEC{y} \in \RR^n \setminus \overline{\Omega}$,
the left hand side of (\ref{laplace_pot2}) becomes
$(u \ast \Delta N_\epsilon)(\VEC{x})$ since
$\displaystyle \Delta_{\VEC{y}} N_{\epsilon}(\VEC{x},\VEC{y})
= \Delta_{\VEC{y}} N_{\epsilon}(\VEC{x} - \VEC{y}) =
(\Delta N_\epsilon)(\VEC{x}-\VEC{y})$ for
$\VEC{y} \in \RR^n$.

Since $\displaystyle u \in L^\infty(\RR^n)$, $u$ is uniformly
continuous on $\overline{\Omega}$, 
$\displaystyle \Delta N_\epsilon(\VEC{y}) =
\epsilon^{-n}\Delta N_1(\epsilon^{-1}\VEC{y})$ and\\
$\displaystyle \int_{\RR^n} \Delta N_1(\VEC{y}) \dx{\VEC{y}} = 1$
(proved in (iii) of the proof of
Theorem~\ref{laplace_fund_sol}), we can use
Proposition~\ref{distr_limit_convol} to conclude that
$u \ast \Delta N_\epsilon \rightarrow u$ uniformly on any compact
subset of $\Omega$ as $\epsilon \rightarrow 0$.  In particular,
$(u \ast \Delta N_\epsilon)(\VEC{x}) \rightarrow u(\VEC{x})$ as
$\epsilon \rightarrow 0$.

\stage{ii}
Since $\VEC{x} \not\in \partial \Omega$ and $\partial \Omega$ is a
compact subset of $\displaystyle \RR^n$, we have that
\[
\left| u(\VEC{y})
\pdydx{N_{\epsilon}}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y}) \right|
\leq \left| u(\VEC{y}) \pdydx{N}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y}) \right|
\]
for all $\VEC{y} \in \partial \Omega$ with
$\displaystyle \VEC{y}\mapsto u(\VEC{y})
\pdydx{N}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y})$ in
$\displaystyle L^1(\partial \Omega)$.
Moreover,
\[
\lim_{\epsilon \rightarrow 0}
u(\VEC{y}) \pdydx{N_{\epsilon}}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y})
= u(\VEC{y}) \pdydx{N}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y})
\]
for all $\VEC{y} \in \partial \Omega$.  We have similar results for 
$\displaystyle N_{\epsilon}(\VEC{x},\VEC{y})
\, \pdydx{u}{\nu_{\VEC{y}}}(\VEC{y})$; namely,
\[
\left| N_{\epsilon}(\VEC{x},\VEC{y})
\pdydx{u}{\nu_{\VEC{y}}}(\VEC{y}) \right|
\leq h(\VEC{x},\VEC{y})
\equiv
\begin{cases}
\displaystyle N(\VEC{x},\VEC{y})
\, \pdydx{u}{\nu_{\VEC{y}}}(\VEC{y}) & \quad \text{if} \ n > 2 \\[0.8em]
\displaystyle
\frac{1}{\omega_2} \left( \left|\ln\left(\|\VEC{x}- \VEC{y}\|\right)\right|
+1 \right) \, \pdydx{u}{\nu_{\VEC{y}}}(\VEC{y}) & \quad
\text{if} \ n = 2
\end{cases}
\]
for all $\VEC{y} \in \partial \Omega$ if $\epsilon \leq 1$ with
$\displaystyle \VEC{y}\mapsto h(\VEC{x},\VEC{y})$ in
$\displaystyle L^1(\partial \Omega)$.
Moreover,
\[
\lim_{\epsilon \rightarrow 0}
N_{\epsilon}(\VEC{x},\VEC{y})
\pdydx{u}{\nu_{\VEC{y}}}(\VEC{y})
= N(\VEC{x},\VEC{y})
\pdydx{u}{\nu_{\VEC{y}}}(\VEC{y})
\]
for all $\VEC{y} \in \partial \Omega$.

It follows from the Lebesgue dominate convergence theorem that the
right hand side of (\ref{laplace_pot2}) converges to
\[
\int_{\partial \Omega} \left( u(\VEC{y})
\pdydx{N}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y}) - N(\VEC{x},\VEC{y}) \,
\pdydx{u}{\nu_{\VEC{y}}}(\VEC{y})\right) \dss{S}{y} \ .
\]
\end{proof}

\begin{rmk}
Replacing $\displaystyle u\big|_{\partial \Omega}$ by $f$ and
$\displaystyle \pdydx{u}{\nu}\bigg|_{\partial \Omega}$ by $g$
in (\ref{laplace_pot3}) does not generally give a solution of
$\Delta u = 0$ in $\Omega$ with the boundary conditions
$\displaystyle u\big|_{\partial \Omega} = f$ and
$\displaystyle \pdydx{u}{\nu}\bigg|_{\partial \Omega} = g$.
There may not be a solution of $\Delta u = 0$ in $\Omega$ with such
boundary conditions.  This is a consequence of the uniqueness theorem,
Theorem~\ref{laplace_uniqu_th}, which states that the solution is
completely determined by the values of $u$ on $\partial \Omega$.
\end{rmk}

\begin{cor}
Let $\Omega$ be an open bounded subset of $\displaystyle \RR^n$.  If
$u\in \DD'(\Omega)$ satisfies $\Delta u = f$, where $f$ is real
analytic on $\Omega$, then $u$ is real analytic on $\Omega$.
\end{cor}

\begin{proof}
We give only a sketch of the proof.  A complete proof can be found in
\cite{FoPDE,Tr}.

From Corollary~\ref{lapl_anal_cond}, we have
$\displaystyle u \in C^{\infty}(\Omega)$.
Given $\VEC{x}_0\in \Omega$, we prove that $u$ is analytic in a
neighbourhood of $\VEC{x}_0$.

According to Cauchy-Kowalevski Theorem~\ref{cauchyKovalTh}, there
exists a analytic solution $v$ to $\Delta v = f$ in a neighbourhood
$B_r(\VEC{x}_0) \subset \Omega$ of $\VEC{x}_0$.

Let $w = u-v$.  We have that $\Delta w =0$ in $B = B_{r/2}(\VEC{x}_0)$
and $\displaystyle w \in C^{\infty}(\overline{B})$.  Hence, from
Theorem~\ref{laplace_uhexp}, we have
\begin{equation} \label{laplaceAnalExt}
w(\VEC{x}) = \int_{\partial B} \left( w(\VEC{y})
\pdydx{N}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y}) -
N(\VEC{x},\VEC{y})\,\pdydx{w}{\nu_{\VEC{y}}}(\VEC{y})\right)
\dss{S}{y}
\end{equation}
for $\VEC{x} \in B$.

Given $\VEC{y} \in \partial B$, the functions
$\VEC{x} \mapsto N(\VEC{x},\VEC{y})$ and
\[
\VEC{x} \mapsto \pdydx{N}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y})
= \frac{-1}{\omega_n \|\VEC{x}-\VEC{y}\|_2^n\,\|\VEC{y}-\VEC{x_0}\|_2} \, 
(\VEC{x} - \VEC{y}) \cdot (\VEC{y}-\VEC{x}_0) 
\]
are real analytic functions on $B_{r/2}(\VEC{x}_0)$.  We may extended these
functions to complex analytic (and so holomorphic) functions for
\[
\VEC{x} \in W \equiv \left\{ \VEC{x} \in \CC^n :
\|\RE(\VEC{x}) - \VEC{x}_0\| < \frac{r}{4}
\ \text{and} \ \|\IM(\VEC{x})\| < \frac{r}{4} \right\}
\]
More precisely, the real series expansion for 
$\VEC{x} \mapsto N(\VEC{x},\VEC{y})$ and
$\displaystyle \VEC{x} \mapsto
\pdydx{N}{\nu_{\VEC{y}}}(\VEC{x},\VEC{y})$ can be used to
defined the complex extension since
\[
\| \VEC{x} -\VEC{x}_0 \|_2
= \|\RE(\VEC{x}) - \VEC{x}_0\|_2 + \|\IM(\VEC{x})\|_2 < \frac{r}{2}
\]
for $\VEC{x} \in W$.
We can use the fact that the integrant in (\ref{laplaceAnalExt}) is
holomorphic for $\VEC{x} \in W$ to extent $w$ to an holomorphic
function on $W$.  Thus $w$ is real analytic on
$\displaystyle B_{r/4}(\VEC{x}_0) = \RR^n \cap W$.  It
follows that $u = v+w$ is real analytic on $B_{r/4}(\VEC{x}_0)$.
\end{proof}

Let $\displaystyle \Omega \subset \RR^n$ be an open subset with a
smooth boundary.
Our goal is to find a solution (in the space of distributions) for the
{\bfseries Dirichlet Problem}\index{Poisson Equation!Dirichlet Problem}
\begin{equation} \label{laplace_diri_probl}
\Delta u = f \quad \text{in} \quad \Omega \qquad \text{with}
\qquad u\big|_{\partial \Omega} = g \ ,
\end{equation}
and a solution for the
{\bfseries Neumann Problem}\index{Poisson Equation!Neumann Problem}
\begin{equation} \label{laplace_neum_probl}
\Delta u = f \quad \text{in} \quad \Omega \qquad \text{with} \qquad
\pdydx{u}{\nu}\bigg|_{\partial \Omega} = g \ .
\end{equation}

There are a few issues to raise before attempting to solve the Dirichlet
and Neumann problems above.
\begin{enumerate}
\item We assume for now that the function $g$ used for the boundary
conditions is at least continuous on $\partial \Omega$.  We will
relax the hypothesis later, when working in Sobolev spaces.
\item For the Neumann problem, the solution is not unique.  If $u$ is
a solution, then $u+c$ is also a solution for any constant $c$.
\item Moreover, for the Neumann problem, $f$ and $g$ cannot be
arbitrary.  If $\tilde{\Omega}$ is a connected component of $\Omega$, then it
follows from Green's identity (\ref{laplace_green1}) with $v=1$ on
$\tilde{\Omega}$ that
\[
\int_{\tilde{\Omega}} f(\VEC{x}) \dx{\VEC{x}}
= \int_{\tilde{\Omega}} \Delta u(\VEC{x}) \dx{\VEC{x}}
= \int_{\partial \tilde{\Omega}} \pdydx{u}{\nu}(\VEC{x}) \dss{S}{x}
= \int_{\partial \tilde{\Omega}} g(\VEC{x}) \dss{S}{x} \ .
\]
\item For the Dirichlet, we may assume without loss of generality that
$f=0$ in $\Omega$ or $g=0$ on $\partial \Omega$.
If $v$ satisfies
\begin{equation} \label{laplace_pot5}
\Delta v = f \quad \text{in} \quad \Omega \qquad \text{with}
\qquad v\big|_{\partial \Omega} = 0 \ ,
\end{equation}
and $w$ satisfies
\begin{equation} \label{laplace_pot6}
\Delta w = 0 \quad \text{in} \quad \Omega \qquad \text{with}
\qquad w\big|_{\partial \Omega} = g \ ,
\end{equation}
then $u=v+w$ satisfies (\ref{laplace_diri_probl}).  Moreover, if we
can solve problems of the form (\ref{laplace_pot5}) then we can solve
problems of the form (\ref{laplace_pot6}) and vice-versa.

Suppose that we can solve problems of the form (\ref{laplace_pot5}).
Choose $\displaystyle \tilde{g} \in C^2(\Omega) \cap C(\overline{\Omega})$
such that $\tilde{g} = g$ on $\partial \Omega$.  Let $v$ be the solution of
\[
\Delta v = \Delta \tilde{g} \quad \text{in} \quad \Omega \qquad \text{with}
\qquad v\big|_{\partial \Omega} = 0 \ .
\]
Then $w=\tilde{g}-v$ satisfies (\ref{laplace_pot6}).

Suppose that we can solve problems of the form (\ref{laplace_pot6}).
Let
\[
\tilde{f} =
\begin{cases}
f & \quad \text{in} \quad \Omega \\
0 & \quad \text{in} \quad \RR^n\setminus \Omega
\end{cases}
\]
and $\tilde{v} = N\ast \tilde{f}$.  Then
$\displaystyle
\Delta \tilde{v} = \Delta N \ast \tilde{f} = \delta \ast \tilde{f} =
\tilde{f}$.  Let $w$ be the solution of
\[
\Delta w = 0 \quad \text{in} \quad \Omega \qquad \text{with}
\qquad w\big|_{\partial \Omega} = \tilde{v}\big|_{\partial \Omega} \ .
\]
Then $v=\tilde{v}-w$ satisfies (\ref{laplace_pot5}).

\item For the Neumann, we may assume without loss of generality that
$f=0$ in $\Omega$ or $g=0$ on $\partial \Omega$.
If $v$ satisfies
\begin{equation} \label{laplace_pot7}
\Delta v = f \quad \text{in} \quad \Omega \qquad \text{with}
\qquad \pdydx{v}{\nu}\bigg|_{\partial \Omega} = 0 \ ,
\end{equation}
and $w$ satisfies
\begin{equation} \label{laplace_pot8}
\Delta w = 0 \quad \text{in} \quad \Omega \qquad \text{with}
\qquad \pdydx{w}{\nu}\bigg|_{\partial \Omega} = g \ ,
\end{equation}
then $u=v+w$ satisfies (\ref{laplace_neum_probl}).  Moreover, if we
can solve problems of the form (\ref{laplace_pot7}) then we can solve
problems of the form (\ref{laplace_pot8}) and vice-versa.

Suppose that we can solve problems of the form (\ref{laplace_pot7}).
Choose
$\displaystyle \tilde{g} \in C^2(\Omega) \cap C^1(\overline{\Omega})$ such that
$\displaystyle \pdydx{\tilde{g}}{\nu} = g$ on $\partial \Omega$.
Let $v$ be the solution of
\[
\Delta v = \Delta \tilde{g} \quad \text{in} \quad \Omega \qquad \text{with}
\qquad \pdydx{v}{\nu}\bigg|_{\partial \Omega} = 0 \ .
\]
Then $w=\tilde{g}-v$ satisfies (\ref{laplace_pot8}).

Suppose that we can solve problems of the form (\ref{laplace_pot8}).
Let
\[
\tilde{f} =
\begin{cases}
f & \quad \text{in} \quad \Omega \\
0 & \quad \text{in} \quad \RR^n\setminus \Omega
\end{cases}
\]
and $\tilde{v} = N\ast \tilde{f}$.  Then
$\displaystyle \Delta \tilde{v} = \tilde{f}$ as we have seen before.
Let $w$ be the solution of
\[
\Delta w = 0 \quad \text{in} \quad \Omega \qquad \text{with}
\qquad \pdydx{w}{\nu}\bigg|_{\partial \Omega} =
\pdydx{\tilde{v}}{\nu}\bigg|_{\partial \Omega} \ .
\]
Then $v=\tilde{v}-w$ satisfies (\ref{laplace_pot7}).
\end{enumerate}

\section{Green's Functions}

\begin{defn} \label{DefnGreenFunct}
Let $\Omega$ be an open subset of $\RR^n$ with a boundary of class
$\displaystyle C^2$.  Suppose that there exists a function
$U: \Omega \times \overline{\Omega} \to \RR$ such that
\begin{enumerate}
\item the function $\VEC{y} \mapsto U(\VEC{x},\VEC{y})$
is harmonic in $\Omega$ and continuous on $\overline{\Omega}$ for all
$\VEC{x} \in \Omega$, and
\item $U(\VEC{x},\VEC{y}) = N(\VEC{x},\VEC{y})$ for $\VEC{x}\in \Omega$ and
$\VEC{y} \in \partial \Omega$,
\end{enumerate}
where $N$ is the fundamental solution defined in (\ref{laplace_NXY}).
Then, the function $G$ defined by
$G(\VEC{x},\VEC{y}) = N(\VEC{x},\VEC{y}) - U(\VEC{x},\VEC{y})$
for $(\VEC{x},\VEC{y}) \in \Omega \times \overline{\Omega}
\setminus \{ (\VEC{x},\VEC{x}) : \VEC{x} \in \Omega \}$
is the {\bfseries Green's function}\index{Green's Function} for $\Omega$.
\end{defn}

In the definition above, the Green's function is obviously not
specified on the diagonal $\{ (\VEC{x},\VEC{x}) : \VEC{x} \in \Omega\}$.

\begin{egg}
The first example of Green's function that students generally
encounter is for ordinary differential equations over an interval.
This is the one-dimensional Green's function that we have not
mentioned but it must be mentioned for completeness.

We have that $N(x) = |x|/2$ for $x \in \RR$.  It is the
fundamental solution of $\displaystyle \dydxn{u}{x}{2}$ because
\begin{align*}
\dydxn{N}{x}{2}(\phi) &= N\left(\dydxn{\phi}{x}{2}\right)
= \int_{-\infty}^\infty N(x)\dydxn{\phi}{x}{2} \dx{x}
= -\int_{-\infty}^0 \frac{x}{2}\,\dydxn{\phi}{x}{2} \dx{x}
+ \int_0^\infty \frac{x}{2}\,\dydxn{\phi}{x}{2} \dx{x} \\
&= \int_{-\infty}^0 \frac{1}{2}\,\dydx{\phi}{x} \dx{x}
- \int_0^\infty \frac{1}{2}\,\dydx{\phi}{x} \dx{x}
= \frac{1}{2} \phi(x)\bigg|_{-\infty}^0 - \frac{1}{2} \phi(x)\bigg|_0^\infty
= \phi(0) = \delta(\phi)
\end{align*}
for all $\phi \in \DD(\RR)$.

Let $\Omega = ]0,L[$.  We seek $U:\Omega \times \overline{\Omega} \to \RR$
such that $U_x:\overline{\Omega} \to \RR$ defined by
$U(y) \equiv U(x,y)$ for all $y \in \overline{\Omega}$ satisfies
$\displaystyle \dydxn{U_x}{y}{2} = 0$ on $\Omega$, $U_x$ is continuous
on $\overline{\Omega}$, $U_x(0) = N(x,0) = N(x) = x/2$ and
$U_x(L) = N(x,L) = N(x-L) = (L-x)/2$.

Since $\displaystyle \dydxn{U_x}{y}{2} = 0$, we get $U_x(y) = Ay + B$
for some constants $A$ and $B$ that may depend on $x$.  From
$U_x(0) = x/2$, we get $B= x/2$.  From 
$U_x(L) = (L-x)/2$, we get $AL + B = (L-x)/2$.  Hence,
$U(x,y) = U_x(y) = (1/2 -x/L)y + x/2$ for
$(x,y) \in \Omega \times \overline{\Omega}$

The Green's function is
\begin{align*}
G(x,y) &= N(x,y) - U(x,y)
= \frac{|x-y|}{2} - \left(\frac{1}{2} -\frac{x}{L}\right)y -
\frac{x}{2} \\
&= \begin{cases}
\displaystyle
\frac{x-y}{2} - \left(\frac{1}{2} -\frac{x}{L}\right)y - \frac{x}{2}
= \frac{y(x-L)}{L} & \quad \text{if} \ x > y \\
\displaystyle
\frac{y-x}{2} - \left(\frac{1}{2} -\frac{x}{L}\right)y - \frac{x}{2}
= \frac{x(y-L)}{L} & \quad \text{if} \ x < y
\end{cases}
\end{align*}
\end{egg}

The Green's function is unique because, for each $\VEC{x} \in \Omega$,
the function $u_{\VEC{x}}:\overline{\Omega}\rightarrow \RR$ defined by
$u_{\VEC{x}}(\VEC{y}) = U(\VEC{x},\VEC{y})$ is the unique
solution of the Dirichlet problem
\begin{equation} \label{laplace_RefGFDP}
\Delta u = 0 \quad \text{in} \quad \Omega \quad
\text{with} \quad u(\VEC{y}) = N(\VEC{x},\VEC{y}) \quad
\text{for} \quad \VEC{y}\in \partial \Omega \ .
\end{equation}

\begin{theorem} \label{laplace_GreenExist}
Let $\Omega$ be any bounded open subset of $\displaystyle \RR^n$ with
a boundary of class $\displaystyle C^2$.  The Green's function $G$ for
$\Omega$ exists \footnotemark.  Moreover,
$\VEC{y} \mapsto G(\VEC{x},\VEC{y})$ is of class
$\displaystyle C^\infty$ on $\overline{\Omega} \setminus \{\VEC{x}\}$.
\end{theorem}

\footnotetext{We should probably say that the function $U$ in
Definition~\ref{DefnGreenFunct} exists and that we may therefore
define $G = N - U$.  However, we will stick to the tradition of
formulating the statement in terms of $G$ instead of $U$.}

\begin{proof}
The proof of this theorem is based on Theorem~\ref{PerronExistTh} that
we will present later.
  
Let $N$ be the fundamental solution given in (\ref{laplace_NXY}).
For each $\VEC{x} \in \Omega$, let $u_{\VEC{x}}$ be the
solution of the Dirichlet problem $\Delta u = 0$ on $\Omega$ with
$u_{\VEC{x}}(\VEC{y}) = N(\VEC{x},\VEC{y})$ for $\VEC{y} \in \partial \Omega$
given by Theorem~\ref{PerronExistTh}.  We also have that
$\displaystyle u_{\VEC{x}} \in C(\overline{\Omega})$
according to Theorem~\ref{PerronExistTh}.

Let $U(\VEC{x},\VEC{y}) = u_{\VEC{x}}(\VEC{y})$ for
$(\VEC{x},\VEC{y}) \in \Omega \times \overline{\Omega}$.  Then
$U$ satisfies the conditions of Definition~\ref{DefnGreenFunct} and so
$G(\VEC{x},\VEC{y}) = N(\VEC{x},\VEC{y}) - U(\VEC{x},\VEC{y})$
for $(\VEC{x},\VEC{y}) \in \Omega \times \overline{\Omega}
\setminus \{ (\VEC{x},\VEC{x}) : \VEC{x} \in \Omega \}$
is the Green's function in the statement of the theorem.

Since $\VEC{y} \mapsto N(\VEC{x},\VEC{y})$ is harmonic on
$\Omega \setminus \{\VEC{x}\}$ and
$\VEC{y} \mapsto U(\VEC{x},\VEC{y})$ is harmonic on $\Omega$, we have
that $\VEC{y} \mapsto G(\VEC{x},\VEC{y})$ is harmonic on 
$\Omega \setminus \{\VEC{x}\}$.  It follows from
Theorem~\ref{laplace_MVT_conv} that $\VEC{y} \mapsto G(\VEC{x},\VEC{y})$
is of class $\displaystyle C^\infty$ on $\Omega \setminus \{\VEC{x}\}$.

Another proof of this theorem is given in Section~\ref{ell_GreenF}.
It will then be proved that $\VEC{y} \mapsto G(\VEC{x},\VEC{y})$ is of class
$\displaystyle C^\infty$ on $\overline{\Omega} \setminus \{\VEC{x}\}$.
\end{proof}

\begin{prop} \label{GxyGyx}
If $G$ is the Green's function for a bounded open set
$\displaystyle \Omega \subset \RR^n$
with a boundary of class $\displaystyle C^2$, then
$G(\VEC{x},\VEC{y}) = G(\VEC{y},\VEC{x})$
for all $\VEC{x},\VEC{y}$ in $\Omega$ with $\VEC{x}\neq \VEC{y}$.
\end{prop}

\begin{proof}
Given $\VEC{z} \in \Omega$, let
$G_{\VEC{x}}:\Omega \setminus \{\VEC{z}\} \to \RR$
be the function defined by $G_{\VEC{z}}(\VEC{w}) = G(\VEC{z},\VEC{w})$
for all $\VEC{w} \in \Omega \setminus \{\VEC{z}\}$.

Given $\VEC{x}$ and $\VEC{y}$, two distinct points in $\Omega$,
choose $\epsilon >0$ small enough such that
$\overline{B_{\epsilon}(\VEC{x})} \subset \Omega$,
$\overline{B_{\epsilon}(\VEC{y})} \subset \Omega$ and
$\overline{B_{\epsilon}(\VEC{x})} \cap
\overline{B_{\epsilon}(\VEC{y})} = \emptyset$.
Let $\Omega_\epsilon = \Omega \setminus
\left(\overline{B_{\epsilon}(\VEC{x})} \cup
\overline{B_{\epsilon}(\VEC{y})} \right)$.

We have from Theorem~\ref{laplace_GreenExist} that
$\displaystyle G_{\VEC{x}} \in
C^\infty(\overline{\Omega}\setminus B_{\epsilon}(\VEC{x}))$ and
$\displaystyle G_{\VEC{y}} \in
C^\infty(\overline{\Omega}\setminus B_{\epsilon}(\VEC{y}))$.
Thus $G_{\VEC{x}}$ and $G_{\VEC{y}}$ are in
$\displaystyle C^\infty(\overline{\Omega_{\epsilon}})$.  We may therefore use
Green's second identity (\ref{laplace_green2}) on $\Omega_{\epsilon}$.
Thus
\begin{equation} \label{laplace_GequG}
\begin{split}
&\int_{\Omega_{\epsilon}} \left( G_{\VEC{x}} \Delta G_{\VEC{y}} - G_{\VEC{y}}
\Delta G_{\VEC{x}} \right) \dx{\VEC{z}}
= \int_{\partial \Omega_{\epsilon}} \left( G_{\VEC{x}}\,\pdydx{G_{\VEC{y}}}{\nu} 
- G_{\VEC{y}}\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dss{S}{z} \\
& \qquad = \int_{\partial \Omega} \left( G_{\VEC{x}}\,\pdydx{G_{\VEC{y}}}{\nu} 
- G_{\VEC{y}}\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dss{S}{z}
- \int_{\partial B_{\epsilon}(\VEC{x})}
\left( G_{\VEC{x}}\,\pdydx{G_{\VEC{y}}}{\nu} 
- G_{\VEC{y}}\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dss{S}{z} \\
& \qquad - \int_{\partial B_{\epsilon}(\VEC{y})}
\left( G_{\VEC{x}}\,\pdydx{G_{\VEC{y}}}{\nu} 
- G_{\VEC{y}}\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dss{S}{z} \ .
\end{split}
\end{equation}

By definition of the Green's functions,
$\VEC{z} \mapsto U(\VEC{x},\VEC{z})
= N(\VEC{x},\VEC{z}) - G_{\VEC{x}}(\VEC{z})$
is harmonic on $\Omega$.
Since, $\VEC{z} \mapsto N(\VEC{x},\VEC{z})$ is harmonic on
$\Omega \setminus B_{\epsilon}(\VEC{x})$, we have that
$G_{\VEC{x}}$ is harmonic on $\Omega \setminus B_{\epsilon}(\VEC{x})$.
Similarly, $G_{\VEC{y}}$ is harmonic on
$\Omega \setminus B_{\epsilon}(\VEC{y})$.

Since $G_{\VEC{x}}$ and $G_{\VEC{y}}$ are harmonic in
$\Omega_{\epsilon}$, the left hand 
side in (\ref{laplace_GequG}) is null.  Moreover,
$G_{\VEC{x}} = 0$ and $G_{\VEC{y}}=0$ on $\partial \Omega$ by
definition of the Green's functions.  Thus, the first integral on the
right hand side of (\ref{laplace_GequG}) is also null.  We get
\begin{equation} \label{laplace_GequG_two}
\int_{\partial B_{\epsilon}(\VEC{x})}
\left( G_{\VEC{x}}\,\pdydx{G_{\VEC{y}}}{\nu} 
- G_{\VEC{y}}\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dss{S}{z}
+ \int_{\partial B_{\epsilon}(\VEC{y})}
\left( G_{\VEC{x}}\,\pdydx{G_{\VEC{y}}}{\nu} 
- G_{\VEC{y}}\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dss{S}{z} = 0
\end{equation}
for all $\epsilon >0$.

We consider the first integral in
(\ref{laplace_GequG_two}).
\begin{equation} \label{laplace_GequG_three}
\begin{split} 
&\int_{\partial B_{\epsilon}(\VEC{x})}
\left( G_{\VEC{x}}\,\pdydx{G_{\VEC{y}}}{\nu} 
- G_{\VEC{y}}\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dss{S}{z} \\
&\qquad = \int_{\|\VEC{z}\|=1}
\left( G_{\VEC{x}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{G_{\VEC{y}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
- G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{G_{\VEC{x}}}{\nu}(\VEC{x}+\epsilon \VEC{z}) \right)
\epsilon^{n-1}\dss{S}{z} \ .
\end{split}
\end{equation}

\stage{i} Let $u_{\VEC{x}}(\VEC{y}) = U(\VEC{x},\VEC{y})$ for
$(\VEC{x},\VEC{y}) \in \Omega \times \overline{\Omega}$, where $U$ is
given in the Definition of the Green's function.

Since $u_{\VEC{x}}$ is continuous on $\overline{\Omega}$ by definition
of Green's functions, and $G_{\VEC{y}}$ is continuously differentiable
on $\Omega \setminus B_{\epsilon}(\VEC{y})$, then $u_{\VEC{x}}$ and
$\displaystyle \pdydx{G_{\VEC{y}}}{\nu}$ are bounded on a
bounded open neighbourhood $V \subset \Omega$ of $\VEC{x}$.  Suppose that
$|u_{\VEC{x}}| < M_1$ and
$\displaystyle \left| \pdydx{G_{\VEC{y}}}{\nu}\right| < M_2$
on $V$.

Suppose that $\epsilon$ is small enough to have
$B_\epsilon(\VEC{x}) \subset V$.
For the first term in (\ref{laplace_GequG_three}),
we get for $n>2$ that
\begin{align*}
&\left| \int_{\|\VEC{z}\|=1}
G_{\VEC{x}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{G_{\VEC{y}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\, \epsilon^{n-1} \dss{S}{z} \right| \\
&\quad = \left| \int_{\|\VEC{z}\|=1}
\left( N(-\epsilon\VEC{z}) - u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z}) \right)
\,\pdydx{G_{\VEC{y}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\,\epsilon^{n-1} \dss{S}{z} \right| \\
&\quad = \left| \int_{\|\VEC{z}\|=1}
\left( \frac{1}{(2-n)\omega_n} \epsilon^{2-n} -
u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z})  \right)
\,\pdydx{G_{\VEC{y}}}{\nu}(\VEC{x} + \epsilon \VEC{z})
\, \epsilon^{n-1} \dss{S}{z} \right| \\
&\quad \leq \int_{\|\VEC{z}\|=1}
\left( \frac{1}{(n-2)\omega_n} \epsilon^{2-n} +
\left| u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z}) \right| \right)
\left| \pdydx{G_{\VEC{y}}}{\nu}(\VEC{x} + \epsilon \VEC{z})
\right|\, \epsilon^{n-1} \dss{S}{z} \leq \left(\frac{\epsilon}{n-2} +
\epsilon^{n-1} \omega_n M_1\right) M_2 \ . 
\end{align*}
Similarly, we get fro $n=2$ that
\begin{align*}
&\left| \int_{\|\VEC{z}\|=1}
G_{\VEC{x}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{G_{\VEC{y}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\, \epsilon \dss{S}{z} \right|
= \left| \int_{\|\VEC{z}\|=1}
\left( N(-\epsilon\VEC{z}) - u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z}) \right)
\,\pdydx{G_{\VEC{y}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\, \epsilon \dss{S}{z} \right| \\
&\quad = \left| \int_{\|\VEC{z}\|=1}
\left( \frac{1}{\omega_2} \ln(\epsilon) -
u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z}) \right)
\,\pdydx{G_{\VEC{y}}}{\nu}(\VEC{x} + \epsilon \VEC{z})
\, \epsilon \dss{S}{z} \right| \\
&\quad \leq \int_{\|\VEC{z}\|=1}
\left( \frac{1}{\omega_2} |\ln(\epsilon)|  +
\left| u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z}) \right| \right)
\left| \pdydx{G_{\VEC{y}}}{\nu}(\VEC{x} + \epsilon \VEC{z})
\right|\, \epsilon \dss{S}{z}
\leq \left( \epsilon |\ln(\epsilon)| + \epsilon \omega_2 M_1 \right) M_2 \ . 
\end{align*}
We therefore have that
$\displaystyle \int_{\|\VEC{z}\|=1}
G_{\VEC{x}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{G_{\VEC{y}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\, \epsilon \dss{S}{z} \to 0$ 
as $\epsilon \to 0$.

\stage{ii}
We now consider the second term of the integral in
(\ref{laplace_GequG_three}).
\begin{align*}
& \int_{\|\VEC{z}\|=1}
G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{G_{\VEC{x}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\epsilon^{n-1}\dss{S}{z} \\
& \qquad = \int_{\|\VEC{z}\|=1}
G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z})
\left( \pdydx{N}{\nu}(-\epsilon \VEC{z})
- \pdydx{u_{\VEC{x}}}{\nu}(\VEC{x}+\epsilon \VEC{z}) \right)
\epsilon^{n-1}\dss{S}{z} \ .
\end{align*}

Since $u_{\VEC{x}}$ is continuously differentiable on $\Omega$ by
definition of the Green's functions, and $G_{\VEC{y}}$ is continuous
on $\Omega \setminus B_{\epsilon}(\VEC{y})$, then $G_{\VEC{y}}$ and
$\displaystyle \pdydx{u_{\VEC{x}}}{\nu}(\VEC{z})$ are bounded on a
bounded open neighbourhood $V \subset \Omega$ of $\VEC{x}$.  Suppose that
$|G_{\VEC{y}}| < M_3$ and
$\displaystyle \left| \pdydx{u_{\VEC{x}}}{\nu}\right| < M_4$
on $V$.  For $\epsilon$ small enough to have
$B_\epsilon(\VEC{x}) \subset V$, we get that
\begin{align*}
\left| \int_{\|\VEC{z}\|=1}
G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{u_{\VEC{x}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\, \epsilon^{n-1} \dss{S}{z} \right|
& \leq \int_{\|\VEC{z}\|=1}
\left| G_{\VEC{y}}(\VEC{x} + \epsilon \VEC{z}) \right|
\, \left|\pdydx{u_{\VEC{x}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\right| \, \epsilon^{n-1} \dss{S}{z} \\
& \leq M_3 M_4\, \omega_n\, \epsilon^{n-1}  \to 0
\end{align*}
as $\epsilon \to 0$.

Moreover, for $n>2$, we have
\begin{align*}
&\int_{\|\VEC{z}\|=1}
G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{N}{\nu}(-\epsilon \VEC{z}) \, \epsilon^{n-1}\dss{S}{z}
= \int_{\|\VEC{z}\|=1} G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z})
\,\dfdx{ \left(\frac{1}{(2-n)\omega_n} \epsilon^{2-n}\right) }{\epsilon}
\, \epsilon^{n-1}\dss{S}{z} \\
&\qquad = \frac{1}{\omega_n} \int_{\|\VEC{z}\|=1}
G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z}) \dss{S}{z}
\to 
\frac{1}{\omega_n} \int_{\|\VEC{z}\|=1} G_{\VEC{y}}(\VEC{x}) \dss{S}{z}
= G_{\VEC{y}}(\VEC{x})
\end{align*}
as $\epsilon \to 0$ and, for $n=2$, we have
\begin{align*}
&\int_{\|\VEC{z}\|=1}
G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{N}{\nu}(-\epsilon \VEC{z}) \, \epsilon \dss{S}{z}
= \int_{\|\VEC{z}\|=1} G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z})
\,\dfdx{ \left(\frac{1}{\omega_2} \ln(\epsilon) \right) }{\epsilon}
\, \epsilon \dss{S}{z} \\
& \qquad = \frac{1}{\omega_2} \int_{\|\VEC{z}\|=1}
G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z}) \dss{S}{z}
\to
\frac{1}{\omega_2} \int_{\|\VEC{z}\|=1} G_{\VEC{y}}(\VEC{x}) \dss{S}{z}
= G_{\VEC{y}}(\VEC{x})
\end{align*}
as $\epsilon \to 0$.
Note that $\VEC{z} \to G_{\VEC{y}}(\VEC{x}+\epsilon \VEC{z})$
converges uniformly to $\VEC{z} \to G_{\VEC{y}}(\VEC{x})$ on
$\{ \VEC{z} : \|\VEC{z}\| = 1\}$ as $\epsilon \to 0$ because
$G_{\VEC{y}}$ is continuous on $\overline{V}$ and so uniformly continuous
on $\overline{V}$.

Note that is $f(\VEC{x}) = g(\|\VEC{x}\|)$ and $\nu(\VEC{x})$ is
the outward unit normal to $\partial B_\epsilon(\VEC{0})$ at the point
$\VEC{x} \in \partial B_\epsilon(\VEC{x})$, then
\[
\pdydx{f}{\nu}(\VEC{x}) = \lim_{s\to 0}
\frac{f\big(\VEC{x} + s(\VEC{x}/\|\VEC{x}\|)\big) - f(\VEC{x})}{s}
= \lim_{s\to 0} \frac{g(\epsilon + s) - g(\epsilon)}{s}
= \dydx{g}{\epsilon}(\epsilon) \ .
\]
Therefore, for $\VEC{x} \in \partial B_\epsilon(\VEC{0})$, we have
that
\[
\pdydx{N}{\nu}(\VEC{x})
= \begin{cases}
\displaystyle
\dfdx{ \left(\frac{1}{(2-n)\omega_n} \epsilon^{2-n}\right) }{\epsilon}
& \quad \text{if} \ n>2 \\
\displaystyle
\dfdx{ \left(\frac{1}{\omega_2} \ln(\epsilon) \right) }{\epsilon}
&\quad \text{if} \ n = 2
\end{cases}
\]

\stage{iii}
(i) and (ii) imply that 
\begin{equation} \label{laplace_GequG_two_A}
\int_{\partial B_{\epsilon}(\VEC{x})}
\left( G_{\VEC{x}}\,\pdydx{G_{\VEC{y}}}{\nu} 
- G_{\VEC{y}}\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dss{S}{z}
\to -G_{\VEC{y}}(\VEC{x})
\end{equation}
as $\epsilon \to 0$.

\stage{iv}
As we have done in (i) and (ii), we can prove that
\begin{equation} \label{laplace_GequG_two_B}
\int_{\partial B_{\epsilon}(\VEC{y})}
\left( G_{\VEC{x}}\,\pdydx{G_{\VEC{y}}}{\nu} 
- G_{\VEC{y}}\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dss{S}{z}
\to G_{\VEC{x}}(\VEC{y})
\end{equation}
as $\epsilon \to 0$.

\stage{v}
It follows from (\ref{laplace_GequG_two_A}) and
(\ref{laplace_GequG_two_B}) that the limit of
(\ref{laplace_GequG_two}) as $\epsilon \to 0$ is
$-G_{\VEC{y}}(\VEC{x}) + G_{\VEC{x}}(\VEC{y}) = 0$.
\end{proof}

Let $U$ be the function given in Definition~\ref{DefnGreenFunct} and
assume that $\VEC{y} \in \Omega$.  A consequence of the previous
proposition is that $\VEC{x} \mapsto U(\VEC{x},\VEC{y})$ is harmonic
in $\Omega$ and can be extended continuously to $\overline{\Omega}$ by
$U(\VEC{x},\VEC{y}) = N(\VEC{x},\VEC{y})$ for
$\VEC{x} \in \partial \Omega$.

\begin{theorem} \label{laplace_dirichlet1}
Let $\Omega$ be a bounded open subset of $\displaystyle \RR^n$ with a
boundary of class $\displaystyle C^2$ and let
$f:\Omega \rightarrow \RR$ be a function in
$\displaystyle L^1(\Omega)$.  The solution of the Dirichlet problem
$\Delta u = f$ in $\Omega$ with $u=0$ on $\partial \Omega$ is given by
\[
u(\VEC{x}) = \int_{\Omega} G(\VEC{x},\VEC{y})f(\VEC{y}) \dx{\VEC{y}}
\quad , \quad \VEC{x} \in \overline{\Omega} \ ,
\]
where $G$ is the Green's function for $\Omega$.
\end{theorem}

\begin{proof}
If we set $f(\VEC{x}) = 0$ for
$\displaystyle \VEC{x} \in \RR^n \setminus \Omega$,
we can write
\[
u(\VEC{x}) = \int_{\Omega} f(\VEC{y}) N(\VEC{x},\VEC{y}) \dx{\VEC{y}}
- \int_{\Omega} f(\VEC{y}) U(\VEC{x},\VEC{y}) \dx{\VEC{y}}
= (N\ast f)(\VEC{x}) - \int_{\Omega} f(\VEC{y}) U(\VEC{x},\VEC{y})
\dx{\VEC{y}} \ ,
\]
where $U$ is the function given in Definition~\ref{DefnGreenFunct}.

Since $f \in \EE'(\Omega)$,
\[
(\Delta(N\ast f))(\phi) = ((\Delta N) \ast f)(\phi) =
(\delta \ast f)(\phi) = f(\phi)
\]
for all $\phi \in \DD(\Omega)$.

We first show that $h : \Omega \to \RR$ defined by
$\displaystyle
h(\VEC{x}) = \int_{\Omega} f(\VEC{y}) U(\VEC{x},\VEC{y}) \dx{\VEC{y}}$
is locally integrable on $\Omega$ and so belongs to $\DD'(\Omega)$.
Let $K$ be a compact subset of $\Omega$ and set
$\displaystyle
d_m = \min \left\{ \|\VEC{z} - \VEC{y}\| : \VEC{z} \in K \ \text{and}
\ \VEC{y} \in \partial \Omega \right\}$ and
$\displaystyle
d_M = \max \left\{ \|\VEC{z} - \VEC{y}\| : \VEC{z} \in K \ \text{and}
  \ \VEC{y} \in \partial \Omega \right\}$.  Since $K$ and
$\partial \Omega$ are compact, we have that $0 < d_m \leq d_M < \infty$.
Since $\VEC{y} \mapsto U(\VEC{x},\VEC{y})$ is harmonic on $\Omega$ and
continuous on $\overline{\Omega}$, we have that
\begin{align*}
\max_{\VEC{y} \in \Omega} | U(\VEC{x},\VEC{y}) |
\leq \max_{\VEC{y} \in \partial \Omega} | U(\VEC{x},\VEC{y}) |
&= \max_{\VEC{y} \in \partial \Omega} | N(\VEC{x},\VEC{y}) |
= \begin{cases}
\displaystyle \max_{\VEC{y} \in \partial \Omega}
\frac{1}{(2-n)\omega_n}
\|\VEC{x}-\VEC{y}\}^{2-n} & \quad \text{if}\ n > 2 \\[0.8em]
\displaystyle \max_{\VEC{y} \in \partial \Omega}
\frac{1}{\omega_2} \left|\ln\left(\|\VEC{x}-\VEC{y}\|\right) \right|
& \quad \text{if}\ n = 2
\end{cases} \\
&\leq C \equiv
\begin{cases}
\displaystyle \frac{1}{(2-n)\omega_n d_m^{n-2}} & \quad \text{if}\ n > 2
\\[0.8em]
\displaystyle \frac{1}{\omega_2} \max\{ |\ln(d_m)|, |\ln(d_M)| \} &
\quad \text{if}\ n = 2  
\end{cases}
\end{align*}
for all $\VEC{x} \in K$.  Hence,
\begin{align*}
\int_K |h(\VEC{x})| \dx{\VEC{x}}
&\leq \int_K \int_{\Omega} |f(\VEC{y})|\, |U(\VEC{x},\VEC{y})|
\dx{\VEC{y}} \dx{\VEC{x}}
\leq C \int_K \int_{\Omega} |f(\VEC{y})| \dx{\VEC{y}} \dx{\VEC{x}} \\
&= C \underbrace{\int_K \dx{\VEC{x}}}_{\substack{<\infty \ \text{because}\\
K \ \text{is compact}}} \ 
\underbrace{\int_{\Omega} |f(\VEC{y})|
\dx{\VEC{y}}}_{\substack{<\infty\ \text{because}\\f \in L^1(\Omega)}}
< \infty \ .
\end{align*}
We find that
\begin{align*}
\Delta h(\phi) &= h(\Delta \phi)
= \int_{\Omega} h(\VEC{x}) \Delta \phi(\VEC{x}) \dx{\VEC{x}}
= \int_{\Omega} \left( \int_{\Omega} f(\VEC{y})\, U(\VEC{x},\VEC{y})
\dx{\VEC{y}} \right) \Delta \phi(\VEC{x}) \dx{\VEC{x}} \\
&= \int_{\Omega} f(\VEC{y})\, \left( \int_{\Omega} U(\VEC{x},\VEC{y})
\, \Delta \phi(\VEC{x}) \dx{\VEC{x}} \right) \dx{\VEC{y}}
= \int_{\Omega} f(\VEC{y}) \, \left( \int_{\Omega} 
\Delta_{\VEC{x}}U(\VEC{x},\VEC{y})
\, \phi(\VEC{x}) \dx{\VEC{x}} \right) \dx{\VEC{y}}
= 0
\end{align*}
for all $\phi \in \DD(\Omega)$ because
$\VEC{x} \mapsto U(\VEC{x},\VEC{y})$ is harmonic on $\Omega$.

We have found that
\[
 \Delta u(\phi) = \Delta(N \ast f)(\phi) + \Delta h (\phi)
 = f(\phi)
\]
for all $\phi \in \DD(\Omega)$.  Hence, $\Delta u = f$ almost
everywhere on $\Omega$ and in the sense of distributions.

Finally, since
$G(\VEC{x},\VEC{y})=0$ for $\VEC{x}\in \partial \Omega$ and
$\VEC{y}\in \Omega$, we have
$\displaystyle u(\VEC{x})
= \int_{\Omega} G(\VEC{x},\VEC{y})f(\VEC{y}) \dx{\VEC{y}} = 0$
for $\VEC{x} \in \partial \Omega$.
\end{proof}

\begin{rmk}
In a sense, it follows from the previous theorem that the Green's
function for $\Omega$ plays a role similar to the fundamental solution
for the operator $\Delta$ on $\displaystyle \RR^n$.
\label{GreenFunctAltDefn}

Choose $\VEC{x}\in \Omega$.  By definition of the Green's function on
$\Omega$, the function
$\displaystyle \tilde{u}_{\VEC{x}}: \RR^n \rightarrow \RR$ defined by
\[
\tilde{u}_{\VEC{x}}(\VEC{y}) =
\begin{cases}
U(\VEC{x},\VEC{y}) & \quad \text{if} \quad
\VEC{y} \in \overline{\Omega} \\
0 & \quad \text{otherwise}
\end{cases}
\]
is harmonic in $\Omega$.  Consider the function
$\displaystyle \tilde{G}_{\VEC{x}}: \RR^n \rightarrow \RR$ defined by
\[
\tilde{G}_{\VEC{x}}(\VEC{y}) =
\begin{cases}
G_{\VEC{x}}(\VEC{y}) = G(\VEC{x},\VEC{y}) & \quad \text{if} \
\VEC{y} \in \overline{\Omega} \setminus \{\VEC{x}| \\
0 & \quad \text{otherwise}
\end{cases}
\]
and let $N_{\VEC{x}}(\VEC{y}) = N(\VEC{x},\VEC{y})$
for $\displaystyle \VEC{y} \in \RR^n\setminus \{\VEC{x}\}$.
Then $\tilde{G}_{\VEC{x}} = N_{\VEC{x}} - \tilde{u}_{\VEC{x}}$
defines a distributions on $\displaystyle \RR^n$ and
\[
\ps{\Delta \tilde{G}_{\VEC{x}}}{\phi} = \ps{\Delta N_{\VEC{x}}}{\phi}
- \ps{\Delta \tilde{u}_{\VEC{x}}}{\phi} =
\delta_{\VEC{x}}(\phi) - 0 = \phi(\VEC{x})
\]
for all $\phi \in \DD(\overline{\Omega})$.  Thus,
$\Delta G_{\VEC{x}} = \delta_{\VEC{x}}$ on $\Omega$.  This property is
often used as the definition of a Green function for $\Omega$.
\end{rmk}

\begin{theorem} \label{laplace_dirichlet2}
Let $\Omega$ be a bounded open subset of $\displaystyle \RR^n$ with a
boundary of class $\displaystyle C^2$, and let
$g:\partial \Omega \rightarrow \RR$ be a
continuous function.  The solution of the Dirichlet problem
$\Delta u = 0$ in $\Omega$ with $u=g$ on $\partial \Omega$ is given by
\[
u(\VEC{x}) = \int_{\partial \Omega} g(\VEC{y})\,
\pdydx{G_{\VEC{x}}}{\nu}(\VEC{y})\dss{S}{y}
\quad , \quad \VEC{x} \in \Omega \  ,
\]
where $G_{\VEC{x}}(\VEC{y}) = G(\VEC{x},\VEC{y})$ for
$\VEC{y} \in \overline{\Omega} \setminus \{\VEC{x}\}$ and $G$ is the
Green's function for $\Omega$.  In particular, $u$ can be continuously
extended to $\overline{\Omega}$ by $u(\VEC{x}) = g(\VEC{x})$ for
$\VEC{x} \in \partial \Omega$.
\end{theorem}

\begin{proof}
The proof is given in Section~\ref{ell_GreenF}.
\end{proof}

We proceed as in the proof of Proposition~\ref{GxyGyx} to justify the
formula for $u$ in the previous theorem.

Suppose that $\displaystyle u \in C^1(\overline{\Omega}) \cap C^2(\Omega)$ is a
solution of $\Delta u = 0$ in $\Omega$ with $u = g$ on $\partial \Omega$.
Fix $\VEC{x} \in \Omega$ and choose $\epsilon >0$ small enough such that
$\overline{B_{\epsilon}(\VEC{x})} \subset \Omega$.
Let $\Omega_\epsilon = \Omega \setminus \overline{B_{\epsilon}(\VEC{x})}$.

We have from Theorem~\ref{laplace_GreenExist} that
$\displaystyle G_{\VEC{x}} \in C^\infty(\overline{\Omega_{\epsilon}})$.
We may therefore use Green's second identity (\ref{laplace_green2}) on
$\Omega_{\epsilon}$ to get
\[
\begin{split}
&\int_{\Omega_{\epsilon}} \left( G_{\VEC{x}} \Delta u
- u\, \Delta G_{\VEC{x}} \right) \dx{\VEC{z}}
= \int_{\partial \Omega_{\epsilon}} \left( G_{\VEC{x}}\,\pdydx{u}{\nu} 
- u\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dx{S} \\
& \qquad = \int_{\partial \Omega} \left( G_{\VEC{x}}\,\pdydx{u}{\nu} 
- u\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dx{S}
- \int_{\partial B_{\epsilon}(\VEC{x})}
\left( G_{\VEC{x}}\,\pdydx{u}{\nu} 
- u\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dx{S}
\end{split}
\]
Since $u$ and $G_{\VEC{x}}$ are harmonic in $\Omega$,
$G_{\VEC{x}}(\VEC{y}) = 0$ for all $\VEC{y} \in \partial \Omega$ and
$u(\VEC{y}) = g(\VEC{y})$ for all $\VEC{y} \in \partial \Omega$, we
get
\begin{equation} \label{lapDireq1}
  0 = - \int_{\partial \Omega} g\,\pdydx{G_{\VEC{x}}}{\nu} \dx{S}
- \int_{\partial B_{\epsilon}(\VEC{x})}
\left( G_{\VEC{x}}\,\pdydx{u}{\nu} 
- u\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dx{S}
\end{equation}
for all $\epsilon >0$.

We first consider the integral
$\displaystyle \int_{\partial B_{\epsilon}(\VEC{x})}
G_{\VEC{x}}\,\pdydx{u}{\nu} \dx{S}$.

Let $u_{\VEC{x}}(\VEC{y}) = U(\VEC{x},\VEC{y})$ for
$(\VEC{x},\VEC{y}) \in \Omega \times \overline{\Omega}$, where $U$ is
given in the Definition of the Green's function.
Since $u_{\VEC{x}}$ is continuous on $\overline{\Omega}$ by definition
of Green's functions, and $u$ is continuously differentiable on
$\Omega$, then $u_{\VEC{x}}$ and $\displaystyle \pdydx{u}{\nu}$
are bounded on a bounded open neighbourhood $V \subset \Omega$ of
$\VEC{x}$.  Suppose that $|u_{\VEC{x}}| < M_1$ and
$\displaystyle \left| \pdydx{u}{\nu} \right| < M_2$ on $V$.
If $\epsilon$ is small enough to have $B_\epsilon(\VEC{x}) \subset V$,
we get for $n>2$ that
\begin{align*}
&\left|\int_{\partial B_{\epsilon}(\VEC{x})}
G_{\VEC{x}}\,\pdydx{u}{\nu} \dx{S}\right|
= \left| \int_{\|\VEC{z}\|=1}
G_{\VEC{x}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{u}{\nu}(\VEC{x}+\epsilon \VEC{z})
\, \epsilon^{n-1} \dss{S}{z} \right| \\
&\quad = \left| \int_{\|\VEC{z}\|=1}
\left( N(-\epsilon\VEC{z}) - u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z}) \right)
\,\pdydx{u}{\nu}(\VEC{x}+\epsilon \VEC{z})
\,\epsilon^{n-1} \dss{S}{z} \right| \\
&\quad = \left| \int_{\|\VEC{z}\|=1}
\left( \frac{1}{(2-n)\omega_n} \epsilon^{2-n} -
u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z})  \right)
\,\pdydx{u}{\nu}(\VEC{x} + \epsilon \VEC{z})
\, \epsilon^{n-1} \dss{S}{z} \right| \\
&\quad \leq \int_{\|\VEC{z}\|=1}
\left( \frac{1}{(n-2)\omega_n} \epsilon^{2-n} +
\left| u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z}) \right| \right)
\left| \pdydx{u}{\nu}(\VEC{x} + \epsilon \VEC{z})
\right|\, \epsilon^{n-1} \dss{S}{z} \leq \left(\frac{\epsilon}{n-2} +
\epsilon^{n-1} \omega_n M_1\right) M_2 \ . 
\end{align*}
Similarly, we get for $n=2$ that
\begin{align*}
&\left|\int_{\partial B_{\epsilon}(\VEC{x})}
G_{\VEC{x}}\,\pdydx{u}{\nu} \dx{S}\right|
=\left| \int_{\|\VEC{z}\|=1}
G_{\VEC{x}}(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{u}{\nu}(\VEC{x}+\epsilon \VEC{z})
\, \epsilon \dss{S}{z} \right| \\
&\quad = \left| \int_{\|\VEC{z}\|=1}
\left( N(-\epsilon\VEC{z}) - u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z}) \right)
\,\pdydx{u}{\nu}(\VEC{x}+\epsilon \VEC{z})
\, \epsilon \dss{S}{z} \right| \\
&\quad = \left| \int_{\|\VEC{z}\|=1}
\left( \frac{1}{\omega_2} \ln(\epsilon) -
u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z}) \right)
\,\pdydx{u}{\nu}(\VEC{x} + \epsilon \VEC{z})
\, \epsilon \dss{S}{z} \right| \\
&\quad \leq \int_{\|\VEC{z}\|=1}
\left( \frac{1}{\omega_2} |\ln(\epsilon)|  +
\left| u_{\VEC{x}}(\VEC{x} + \epsilon \VEC{z}) \right| \right)
\left| \pdydx{u}{\nu}(\VEC{x} + \epsilon \VEC{z})
\right|\, \epsilon \dss{S}{z}
\leq \left( \epsilon |\ln(\epsilon)| + \epsilon \omega_2 M_1 \right) M_2 \ . 
\end{align*}
We therefore have that
\[
\int_{\partial B_{\epsilon}(\VEC{x})}
G_{\VEC{x}}\,\pdydx{u}{\nu} \dx{S} \to 0
\]
as $\epsilon \to 0$.

We now consider the integral
\begin{align*}
\int_{\partial B_\epsilon(\VEC{x})}
u\,\pdydx{G_{\VEC{x}}}{\nu} \dx{S}
&=  \int_{\|\VEC{z}\|=1} u(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{G_{\VEC{x}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\epsilon^{n-1}\dss{S}{z} \\
&= \int_{\|\VEC{z}\|=1} u(\VEC{x}+\epsilon \VEC{z})
\left( \,\pdydx{N}{\nu}(-\epsilon \VEC{z})
- \pdydx{u_{\VEC{x}}}{\nu}(\VEC{x}+\epsilon \VEC{z}) \right)
\epsilon^{n-1}\dss{S}{z} \ .
\end{align*}

Since $u_{\VEC{x}}$ is continuously differentiable on $\Omega$ by
definition of the Green's functions, and $u$ is continuous
on $\Omega$, then $u$ and
$\displaystyle \pdydx{u_{\VEC{x}}}{\nu}$ are bounded on a
bounded open neighbourhood $V \subset \Omega$ of $\VEC{x}$.  Suppose that
$|G_{\VEC{y}}| < M_3$ and
$\displaystyle \left| \pdydx{u_{\VEC{x}}}{\nu}\right|< M_4$
on $V$.  We get for $\epsilon$
small enough to have $B_\epsilon(\VEC{x}) \subset V$ that
\begin{align*}
\left| \int_{\|\VEC{z}\|=1} u(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{u_{\VEC{x}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\, \epsilon^{n-1} \dss{S}{z} \right|
& \leq \int_{\|\VEC{z}\|=1}
\left| G_{\VEC{y}}(\VEC{x} + \epsilon \VEC{z}) \right|
\, \left|\pdydx{u_{\VEC{x}}}{\nu}(\VEC{x}+\epsilon \VEC{z})
\right| \, \epsilon^{n-1} \dss{S}{z} \\
& \leq M_3 M_4\, \omega_n\, \epsilon^{n-1}  \to 0
\end{align*}
as $\epsilon \to 0$.  Moreover, we get for $n>2$ that
\begin{align*}
&\int_{\|\VEC{z}\|=1}
u(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{N}{\nu}(-\epsilon \VEC{z})\, \epsilon^{n-1}\dss{S}{z}
= \int_{\|\VEC{z}\|=1} u(\VEC{x}+\epsilon \VEC{z})
\,\dfdx{ \left(\frac{1}{(2-n)\omega_n} \epsilon^{2-n}\right) }{\epsilon}
\, \epsilon^{n-1}\dss{S}{z} \\
&\qquad = \frac{1}{\omega_n} \int_{\|\VEC{z}\|=1}
u(\VEC{x}+\epsilon \VEC{z}) \dss{S}{z}
\to 
\frac{1}{\omega_n} \int_{\|\VEC{z}\|=1} u(\VEC{x}) \dss{S}{z}
= u(\VEC{x})
\end{align*}
as $\epsilon \to 0$ and, we get for $n=2$ that
\begin{align*}
&\int_{\|\VEC{z}\|=1}
u(\VEC{x}+\epsilon \VEC{z})
\,\pdydx{N}{\nu}(-\epsilon \VEC{z})\, \epsilon \dss{S}{z}
= \int_{\|\VEC{z}\|=1} u(\VEC{x}+\epsilon \VEC{z})
\,\dfdx{ \left(\frac{1}{\omega_2} \ln(\epsilon) \right) }{\epsilon}
\, \epsilon \dss{S}{z} \\
& \qquad = \frac{1}{\omega_2} \int_{\|\VEC{z}\|=1}
u(\VEC{x}+\epsilon \VEC{z}) \dss{S}{z}
\to
\frac{1}{\omega_2} \int_{\|\VEC{z}\|=1} u(\VEC{x}) \dss{S}{z}
= u(\VEC{x})
\end{align*}
as $\epsilon \to 0$. Note that $\VEC{z} \to u(\VEC{x}+\epsilon \VEC{z})$
converges uniformly to $\VEC{z} \to u(\VEC{x})$ on
$\{ \VEC{z} : \|\VEC{z}\| = 1\}$ as $\epsilon \to 0$ because
$u$ is continuous on $\overline{V}$ and so uniformly continuous
on $\overline{V}$.

It follows from (\ref{lapDireq1}) that
$\displaystyle u(\VEC{x}) = \int_{\partial \Omega}
g\,\pdydx{G_{\VEC{x}}}{\nu} \dx{S}$.

\begin{rmk}
There is also a formal justification of the previous theorem.

As we have seen in Remark~\ref{GreenFunctAltDefn},
$\displaystyle \ps{\Delta \tilde{G}_{\VEC{x}}}{\phi} = \phi(\VEC{x})$
for all $\phi \in \DD(\overline{\Omega})$.
Since $\DD(\overline{\Omega})$ is uniformly dense in
$C(\overline{\Omega})$, we get
\begin{equation} \label{lapDireq2}
u(\VEC{x}) = \int_\Omega u(\VEC{y})\,\Delta G_{\VEC{x}}(\VEC{y})
\dx{\VEC{y}}
\end{equation}
for $\VEC{x} \in \Omega$ and $u \in C(\overline{\Omega})$
because $\tilde{G}_{\VEC{x}} = G_{\VEC{x}}$
on $\Omega \setminus \{\VEC{x}\}$.
Suppose that $u \in C^1(\overline{\Omega}) \cap C^2(\Omega)$ is the
solution of $\Delta u = 0$ in $\Omega$ and $u=g$ on $\partial \Omega$.
It is here that we are very formal and assume that
the Green's identity (\ref{laplace_green2}) can be used with
$G_{\VEC{x}}$ on $\Omega$ though we do not have that
$G_{\VEC{x}} \in C^1(\overline{\Omega}) \cap C^2(\Omega)$.
We get
\[
\int_{\partial \Omega} \left( G_{\VEC{x}}\,\pdydx{u}{\nu} 
- u\,\pdydx{G_{\VEC{x}}}{\nu} \right) \dx{S}
= \int_\Omega \left( G_{\VEC{x}} \Delta u -
u \Delta G_{\VEC{x}} \right)\dx{\VEC{y}} \ .
\]
Since $\Delta u = 0$ in $\Omega$, $u = g$ on $\partial \Omega$ and
$G_{\VEC{x}}(\VEC{y}) = G(\VEC{x},\VEC{y}) = 0$ for
$\VEC{y} \in \partial \Omega$ and $\VEC{x} \in \Omega$,
we get from (\ref{lapDireq2}) that
\[
\int_{\partial \Omega} u\, \pdydx{G_{\VEC{x}}}{\nu} \dx{S}
= \int_\Omega u\, \Delta G_{\VEC{x}} \dx{\VEC{y}} = u(\VEC{x})  \ .
\]
\end{rmk}

\begin{defn}
For $\VEC{x} \in \Omega$, consider
$\displaystyle G_{\VEC{x}}(\VEC{y}) = G(\VEC{x},\VEC{y})$ for
$\VEC{y} \in \overline{\Omega} \setminus \{\VEC{x}\}$.  The function
$\displaystyle \VEC{y} \mapsto \pdydx{G_{\VEC{x}}}{\nu}(\VEC{y})$
for $\VEC{y}\in \partial \Omega$ is called the
{\bfseries Poisson Kernel}\index{Poisson Kernel} for $\Omega$.
\end{defn}

\subsection{Dirichlet Problem on the Half Space}

In this section, we consider
\[
\RR^n_+ = \left\{ \VEC{x} \in \RR^n : x_n >0 \right\} \ .
\]
We will also use the following notation.  If
$\VEC{x} = (x_1, x_2, \ldots, x_n)$, then
$\tilde{\VEC{x}} = (x_1, x_2, \ldots, x_{n-1}, -x_n)$.

The {\bfseries Green's function}\index{Green's Function} on
$\displaystyle \RR^n_+$ is defined by
$G(\VEC{x},\VEC{y}) = N(\VEC{x},\VEC{y}) - U(\VEC{x},\VEC{y})$
for $\displaystyle \VEC{x} \in \RR_+^n$ and
$\displaystyle \VEC{y} \in \overline{\RR^n_+}$ with
$\VEC{x} \neq \VEC{y}$, where
$U(\VEC{x},\VEC{y}) = N(\tilde{\VEC{x}}, \VEC{y})$
for $\displaystyle \VEC{x} \in \RR_+^n$ and
$\displaystyle \VEC{y} \in \overline{\RR^n_+}$.

\stage{i} The function
$\VEC{y} \mapsto U(\VEC{x},\VEC{y}) =
N(\tilde{\VEC{x}},\VEC{y})$ is harmonic in $\displaystyle \RR^n_+$ and
continuous on $\displaystyle \overline{\RR^n_+}$ because
$\displaystyle \tilde{\VEC{x}} \not\in \overline{\RR^n_+}$.
In fact, it is harmonic in $\displaystyle \RR^n \setminus \{\tilde{\VEC{x}}\}$.

\stage{ii} We have
$U(\VEC{x},\VEC{y}) = N(\tilde{\VEC{x}},\VEC{y}) = N(\VEC{x},\VEC{y})$ for
$\displaystyle \VEC{y} \in \partial \RR^n_+$ because
$\|\VEC{x}-\VEC{y}\| = \|\tilde{\VEC{x}}-\VEC{y}\|$ when $y_n=0$ since
$\tilde{\VEC{x}}$ is the reflection of $\VEC{x}$ through the
plane $y_n=0$ (Figure~\ref{laplace_FIG1}).

\pdfF{laplace/laplace_fig1}{The Green's function for the half space}
{Domain of the Green's function for the half space.}{laplace_FIG1}

Let $\tilde{G}_{\VEC{x}}(\VEC{y}) =
N(\VEC{x},\VEC{y}) - N(\tilde{\VEC{x}},\VEC{y})$
for $\displaystyle \VEC{y} \in \RR^n$ and $\VEC{y}\neq \VEC{x},\tilde{\VEC{x}}$.
The function $\tilde{G}_{\VEC{x}}$ defines a distribution on
$\displaystyle \RR^n$ such that
\[
\Delta \tilde{G}_{\VEC{x}} = \delta_{\VEC{x}} - \delta_{\tilde{\VEC{x}}}
\]
on $\displaystyle \DD(\RR^n)$ according to
Theorem~\ref{laplace_fund_sol}.  Hence,
\[
\Delta \tilde{G}_{\VEC{x}}(\phi) = \delta_{\VEC{x}}(\phi) -
\delta_{\tilde{\VEC{x}}}(\phi)
= \phi(\VEC{x}) - \phi(\tilde{\VEC{x}}) = \phi(\VEC{x})
\]
for $\displaystyle \phi \in \DD(\RR^n_+)$ assuming that a function
$\displaystyle \phi \in \DD(\RR^n_+)$ is expanded to $\displaystyle \RR^n$
by $\phi(\VEC{y})=0$ for
$\displaystyle \VEC{y} \in \RR^n \setminus \RR^n_+$.  Since
$\tilde{G}_{\VEC{x}}(\VEC{y}) = G_{\VEC{x}}(\VEC{y}) = G(\VEC{x},\VEC{y})$
for all $\displaystyle \VEC{y} \in \overline{\RR^n_+}$ and
$\displaystyle \VEC{x}\in \RR_+^n$, we get
$\Delta G_{\VEC{x}} = \delta_{\VEC{x}}$ in the sense of distribution
on $\displaystyle \RR^n_+$ for $\displaystyle \VEC{x}\in \RR_+^n$.
As mentioned in Remark~\ref{GreenFunctAltDefn}, this is expected from
the Green's function for $\displaystyle \RR^n_+$.

Since our domain $\displaystyle \RR^n_+$ is not bounded, we may not apply
Theorem~\ref{laplace_dirichlet1} and
Theorem~\ref{laplace_dirichlet2}.  The reader may verify that
\[
u(\VEC{x}) = \int_{\RR^n_+} G(\VEC{x},\VEC{y})f(\VEC{y}) \dx{\VEC{y}}
\]
is the solution of $\Delta u = f$ in $\displaystyle \RR^n_+$ with $u = 0$ on
$\displaystyle \partial \RR^n_+$ if
$\displaystyle f \in L^1(\RR^n_+)$ has compact support.  We
will not consider this problem but instead we will focus on the
Dirichlet Problem $\Delta u = 0$ in $\displaystyle \RR^n_+$ with $u=g$ on
$\displaystyle \partial \RR^n_+$ if
$\displaystyle g \in C(\partial \RR^n_+)$.  More precisely, we
will prove a version of Theorem~\ref{laplace_dirichlet2} for
$\displaystyle \RR^n_+$; namely,
Theorem~\ref{laplace_half_plane_proof} below.

Since
\[
N(\VEC{x}) =
\begin{cases}
\displaystyle \frac{1}{(2-n)\omega_n} \|\VEC{x}\|^{2-n} & \quad 
\text{if} \ n>2 \\[0.8em]
\displaystyle \frac{1}{\omega_2} \ln\left(\|\VEC{x}\|\right) & \quad 
\text{if} \ n=2
\end{cases}
\]
for $\VEC{x} \neq \VEC{0}$, The Green's function is
\begin{align*}
G(\VEC{x},\VEC{y}) &= N(\VEC{x},\VEC{y}) - N(\tilde{\VEC{x}},\VEC{y}) \\
&=
\begin{cases}
\displaystyle \frac{1}{(2-n)\omega_n} \|\VEC{x}-\VEC{y}\|^{2-n} -
\frac{1}{(2-n)\omega_n} \|\tilde{\VEC{x}}-\VEC{y}\|^{2-n} & \quad 
\text{if} \ n>2 \\[0.8em]
\displaystyle \frac{1}{\omega_2} \ln\left(\|\VEC{x}-\VEC{y}\|\right) -
\frac{1}{\omega_2} \ln\left(\|\tilde{\VEC{x}}-\VEC{y}\|\right) & \quad 
\text{if} \ n=2
\end{cases}
\end{align*}
for $\displaystyle \VEC{x} \in \RR^n_+$ and
$\displaystyle \VEC{y}\in \overline{\RR^n_+}$ with
$\VEC{x} \neq \VEC{y}$.  The
{\bfseries Poisson kernel}\index{Poisson Kernel} is
\[
\pdydx{G_{\VEC{x}}}{\nu}(\VEC{y}) = -\pdydx{G}{y_n}(\VEC{x},\VEC{y}) =
\frac{x_n-y_n}{\omega_n} \|\VEC{x}-\VEC{y}\|^{-n}
+\frac{x_n+y_n}{\omega_n} \|\tilde{\VEC{x}}-\VEC{y}\|^{-n}
= \frac{2x_n}{\omega_n} \|\tilde{\VEC{x}}-\VEC{y}\|^{-n}
\]
for $\displaystyle \VEC{x} \in \RR^n_+$ and
$\displaystyle \VEC{y} \in \partial \RR^n_+$.  Recall
that $\|\VEC{x}-\VEC{y}\| = \|\tilde{\VEC{x}}-\VEC{y}\|$ for
$\displaystyle \VEC{y} \in \partial \RR^n_+$.

For the remainder of this section, we use the following convention.
Every $\displaystyle \VEC{x}\in \RR^n_+$ is written 
$\VEC{x} = (\breve{\VEC{x}}, x_n)$ for
$\displaystyle \breve{\VEC{x}} \in \RR^{n-1}$ and $x_n>0$,

Let
\[
P_{x_n}(\breve{\VEC{x}}) \equiv \frac{2x_n}{\omega_n}\,
\left( \|\breve{\VEC{x}}\|^2 + x_n^2 \right)^{-n/2} \quad , \quad
\breve{\VEC{x}}\in \RR^{n-1} \ .
\]
Then
\[
u(\VEC{x}) = \int_{\partial \RR^n_+} g(\VEC{y})
\pdydx{G_{\VEC{x}}}{\nu}(\VEC{y})\dss{S}{y}
= \int_{\RR^{n-1}} g(\breve{\VEC{y}},0)
P_{x_n}(\breve{\VEC{x}}-\breve{\VEC{y}})
\dx{\breve{\VEC{y}}} = (g \ast P_{x_n})(\breve{\VEC{x}}) \ ,
\]
where the convolution is on $\displaystyle \RR^{n-1}$.

\begin{lemma} \label{laplace_lemma_diric}
$\displaystyle
\int_{\RR^{n-1}} P_1(\breve{\VEC{y}}) \dx{\breve{\VEC{y}}} = 1$ and
$\displaystyle P_{x_n}(\breve{\VEC{x}}) = x_n^{-(n-1)}
P_1\left( x_n^{-1}\breve{\VEC{x}}\right)$.
\end{lemma}

\begin{proof}
We have that
\begin{align*}
&\int_{\RR^{n-1}} P_1(\breve{\VEC{y}}) \dx{\breve{\VEC{y}}}
= \int_{\|\breve{\VEC{y}}\|=1} \int_0^\infty 
\frac{2}{\omega_n}\,\left( r^2 + 1 \right)^{-n/2}\, r^{n-2}
\dx{r}\dsss{S}{\breve{\VEC{y}}}
= \frac{2\omega_{n-1}}{\omega_n}\, \int_0^\infty 
\left( r^2 + 1 \right)^{-n/2}\, r^{n-2} \dx{r} \\
&\qquad = \frac{\omega_{n-1}}{\omega_n} \int_0^1 s^{(n-3)/2} (1-s)^{-1/2} \dx{s} 
= \frac{\Gamma(n/2)}{\Gamma(1/2)\,\Gamma((n-1)/2)}
\int_0^1 s^{(n-3)/2} (1-s)^{-1/2} \dx{s} = 1 \ ,
\end{align*}
where we have used the substitution
$\displaystyle s = \frac{r^2}{1+r^2}$ and
$\displaystyle \dx{s} = \frac{2r}{(1+r^2)^2}\, \dx{r}$, and the
formulae $\displaystyle \omega_n = 2\pi^{n/2}/\Gamma(n/2)$ and
$\Gamma(1/2) = \sqrt{\pi}$.
The last integral is one of the identities satisfied by the Beta
function (see \cite{FoAC}).
\end{proof}

\begin{theorem} \label{laplace_half_plane_proof}
Suppose that $\displaystyle g \in L^p(\partial \RR^n_+)$ \footnotemark,
for some integer $p\geq 1$.  Then
$u(\VEC{x}) = (g \ast P_{x_n})(\breve{\VEC{x}})$ for
$\VEC{x} \in \RR^n_+$ is well defined and harmonic in $\RR^n_+$.
Moreover, $u_{x_n}(\breve{\VEC{x}}) \equiv u(\breve{\VEC{x}}, x_n)$ for
$\breve{\VEC{x}} \in \RR^{n-1}$ satisfies $u_{x_n} \rightarrow g$ in
$\displaystyle L^p(\RR^{n-1})$ as $x_n \rightarrow 0$.

If $\displaystyle g\in C(\partial \RR^n_+)$ is bounded, then $u$ can be
continuously extended to
$\displaystyle R = \{\VEC{x}\in \RR^n : x_n \geq 0\}$ by
$u(\VEC{x}) = g(\VEC{x})$ for $\displaystyle \VEC{x} \in \partial \RR^n_+$.
\end{theorem}

\footnotetext{In other words,
$\displaystyle g \in L^p(\RR^{n-1})$ since
$\displaystyle \partial \RR^n_+ \cong \RR^{n-1}$.}

\begin{proof}
\stage{i} We first show that $u$ is well defined.  We have that
$\displaystyle P_{x_n} \in L^q(\RR^{n-1})$ for all integer $q \geq 1$.
This is a consequence of the following two facts.
$P_{x_n}$ is bounded at the origin; namely,
$\displaystyle \left| P_{x_n}(\breve{\VEC{x}})\right| \leq 
\frac{2}{\omega_{n} x_n^{n-1}}$ for all
$\displaystyle \breve{\VEC{x}} \in \RR^{n-1}$.
$P_{x_n}$ is $\displaystyle L^q$-integrable away of the origin because
$\displaystyle \left| P_{x_n}(\breve{\VEC{x}})\right| \leq
\frac{2 x_n}{\omega_{n} \|\breve{\VEC{x}}\|^n}$
for all $\displaystyle \breve{\VEC{x}} \in \RR^{n-1}\setminus B_1(\VEC{0})$.
Hence, for all $\displaystyle \VEC{x}\in \RR^n$,
\begin{align*}
\RR^{n-1} & \rightarrow \RR \\
\breve{\VEC{y}} & \mapsto g(\breve{\VEC{y}})\,
P_{x_n}\left(\breve{\VEC{x}} - \breve{\VEC{y}}\right)
\end{align*}
is in $\displaystyle L^1(\RR^{n-1})$.  For instance, if $1<p<\infty$ we have
\[
\int_{\RR^{n-1}} \left| g(\breve{\VEC{y}})\,
P_{x_n}\left(\breve{\VEC{x}} - \breve{\VEC{y}}\right) \right|
\dx{\breve{\VEC{y}}}
\leq
\left( \int_{\RR^{n-1}} \left|g(\breve{\VEC{y}}) \right|^p
\dx{\breve{\VEC{y}}} \right)^{1/p}
\left( \int_{\RR^{n-1}} \left|
P_{x_n}\left(\breve{\VEC{x}} - \breve{\VEC{y}}\right) \right|^q
\dx{\breve{\VEC{y}}} \right)^{1/q} < \infty
\]
for $\displaystyle \frac{1}{p} + \frac{1}{q} = 1$.
Similarly, for $p=1$,
\[
\int_{\RR^{n-1}} \left| g(\breve{\VEC{y}})\,
P_{x_n}\left(\breve{\VEC{x}} - \breve{\VEC{y}}\right) \right|
\dx{\breve{\VEC{y}}}
\leq \sup_{\breve{x} \in \RR^{n-1}} |P_{x_n}(\breve{\VEC{x}})|
\, \int_{\RR^{n-1}} \left|g(\breve{\VEC{y}}) \right|
\dx{\breve{\VEC{y}}}
\leq \frac{2}{\omega_n x_n^{n-1}}
\, \int_{\RR^{n-1}} \left|g(\breve{\VEC{y}}) \right| \dx{\breve{\VEC{y}}}
< \infty \ .
\]
Thus $\displaystyle u:\RR^n_+\rightarrow \RR$ is well defined.

\stage{ii} We show that $u$ is harmonic in $\displaystyle \RR^n_+$.
The function $\VEC{x} \mapsto P_{x_n}( \breve{\VEC{x}} - \breve{\VEC{y}} )$
is of class $\displaystyle C^\infty$ on $\displaystyle \RR^n_+$ for all
$\displaystyle \breve{\VEC{y}} \in \partial \RR^{n-1}$.
Choose $\delta>0$ and $b>a>0$.  Given $k\geq 0$ and a multi-index
$\displaystyle \VEC{\alpha} \in \NN^{n-1}$, there exists $C>0$ such that
\[
\left| \left( D^{\VEC{\alpha}}_{\breve{\VEC{x}}}
\pdfdxn{ P_{x_n}\left(\breve{\VEC{x}} - \breve{\VEC{y}}\right)}{x_n}{k} \right)
\right| 
\leq h(\breve{\VEC{y}}) =
\begin{cases}
C & \quad \text{if} \left\|\breve{\VEC{y}}\right\| \leq 2\delta \\
C\|\breve{\VEC{y}}\|^{-n} & \quad \text{if}
\left\|\breve{\VEC{y}}\right\| > 2\delta
\end{cases}
\]
for $\|\breve{\VEC{x}}\|\leq \delta$ and $a \leq x_n \leq b$.   The constant
$C$ depends only on $a$, $b$, $\delta$, $k$ and $\VEC{\alpha}$.  Thus
\[
\left|g(\breve{\VEC{y}})\, \left( D^{\VEC{\alpha}}_{\breve{\VEC{x}}}
\pdfdxn{ P_{x_n}\left(\breve{\VEC{x}} - \breve{\VEC{y}}\right)}{x_n}{k} \right)
\right| \leq \left|g(\breve{\VEC{y}})h(\breve{\VEC{y}})\right|
\]
for all $\displaystyle \breve{\VEC{y}} \in \RR^{n-1}$ and
$\displaystyle \VEC{x} \in \RR^n_+$ such that
$\|\breve{\VEC{x}}\|\leq \delta$ and $a \leq x_n \leq b$.  Proceeding
as in (i), we can show that $\displaystyle g h \in L^1(\RR^{n-1})$.
Hence, since $a$, $b$ and $\delta$ are arbitrary, we may interchange the
integral with respect to $\breve{\VEC{y}}$ and the partial
derivatives of any order with respect to the $x_i$ (see \cite{Flem}).

Since $\VEC{x} \mapsto G(\VEC{x}, \VEC{y})$ is harmonic in
$\displaystyle \RR^n_+$ for
$\displaystyle \VEC{y} \in \partial \RR^n_+$, we have that
\[
\VEC{x} \mapsto -\pdydx{G}{y_n}(\VEC{x},\VEC{y})
= P_{x_n}(\breve{\VEC{x}}-\breve{\VEC{y}})
\]
is harmonic in $\displaystyle \RR^n_+$ for
$\displaystyle \VEC{y} \in \partial \RR^n_+$.
Hence,
\[
\Delta u(\VEC{x}) = 
\int_{\RR^{n-1}} g(\breve{\VEC{y}})\,
\Delta_{\VEC{x}} P_{x_n}\left(\breve{\VEC{x}} - \breve{\VEC{y}}\right)
\dx{\breve{\VEC{y}}} = 0
\]
for all $\displaystyle \VEC{x} \in \RR^n_+$.

\stage{iii} We consider the boundary conditions.
If $\displaystyle g\in L^p(\RR^{n-1})$ for some integer $p \geq 1$, it
follows from Proposition~\ref{distr_limit_convol} and
Lemma~\ref{laplace_lemma_diric} that
$u_{x_n} = g \ast P_{x_n} \rightarrow g$ in $\displaystyle L^p(\RR^{n-1})$ as
$x_n \rightarrow 0$.

\stage{iv} If $g$ is continuous and bounded on $\displaystyle \RR^{n-1}$, in
particular $g$ is uniformly continuous on any compact subset of
$\displaystyle \RR^{n-1}$, it follows from
Proposition~\ref{distr_limit_convol} and
Lemma~\ref{laplace_lemma_diric} that
$g \ast P_{x_n} \rightarrow g$ uniformly on compact subsets of
$\displaystyle \RR^{n-1}$ as $x_n \rightarrow 0$.  In particular,
$u(\VEC{x}) = g(\VEC{x})$ for
$\displaystyle \VEC{x} \in \partial \RR^n_+$ defines a
continuous extension of $u$ on $R$.
\end{proof}

\begin{rmk}
The solution of the Dirichlet problem $\Delta u=0$ on
$\displaystyle \RR^n_+$ with
the condition $u=g$ on $\displaystyle \partial \RR^n_+$ is not unique.
If $u$ is a solution, then $\VEC{x} \rightarrow u(\VEC{x})+cx_n$ is also a
solution.  However, $\VEC{x} \rightarrow u(\VEC{x})+cx_n$ is not
bounded on $\displaystyle \RR^n_+$.  There is a unique bounded
solution and it is given by
$u(\VEC{x}) = (g \ast P_{x_n})(\breve{\VEC{x}})$ for
$\displaystyle \VEC{x}\in\RR^n_+$.
\end{rmk}

\begin{theorem}
Suppose that $\displaystyle g \in C(\partial \RR^n_+)$ and vanishes at infinity.
Then $u(\VEC{x}) = (g \ast P_{x_n})(\breve{\VEC{x}})$ for
$\displaystyle \VEC{x} \in \RR^n_+$ vanishes at infinity on
$\displaystyle R = \left\{ \VEC{x} \in \RR^n : x_n \geq 0 \right\}$.
Moreover, it is the unique solution that vanishes at infinity for the
Dirichlet problem $\Delta u=0$ on $\displaystyle \RR^n_+$ with the
condition $u=g$ on $\displaystyle \partial \RR^n_+$.
\end{theorem}

\begin{proof}
\stage{i} Suppose first that $g$ has a compact support inside
$\displaystyle B_a(\VEC{0}) \subset \partial(\RR^n_+) \cong \RR^{n-1}$.  Since
$\displaystyle g \in L^1(\RR^{n-1})$ and
$\displaystyle \left| P_{x_n}(\breve{\VEC{x}})\right| \leq 
\frac{2}{\omega_{n} x_n^{n-1}}$
for $\displaystyle \breve{\VEC{x}} \in \RR^{n-1}$ and $x_n >0$, we have
\begin{align*}
| u((\breve{\VEC{x}},x_n)) | &= \left| \int_{\RR^{n-1}} g(\breve{\VEC{y}})
P_{x_n}(\breve{\VEC{x}} - \breve{\VEC{y}}) \dx{\breve{\VEC{y}}} \right|
\leq \int_{\RR^{n-1}} | g(\breve{\VEC{y}})| \,
\left| P_{x_n}(\breve{\VEC{x}} - \breve{\VEC{y}}) \right|
\dx{\breve{\VEC{y}}} \\
& \leq \left( \int_{\RR^{n-1}} | g(\breve{\VEC{y}})|
\dx{\breve{\VEC{y}}} \right)\, \frac{2}{\omega_{n} x_n^{n-1}} \to 0 \quad
\text{as} \quad x_n \to \infty
\end{align*}
uniformly for $\displaystyle \breve{\VEC{x}} \in \RR^{n-1}$.  Moreover,
$\displaystyle \left| P_{x_n}(\breve{\VEC{x}})\right| \leq
\frac{2 x_n}{\omega_{n} \|\breve{\VEC{x}}\|^n}$ for
$\breve{\VEC{x}} \neq \VEC{0}$.
Hence, for $\|\breve{\VEC{x}}\| > 2a$ and $0< x_n \leq X$, where $X$
is arbitrary but fixed, we have
\begin{align*}
| u((\breve{\VEC{x}},x_n)) | &= \left| \int_{\RR^{n-1}} g(\breve{\VEC{y}})
P_{x_n}(\breve{\VEC{x}} - \breve{\VEC{y}}) \dx{\breve{\VEC{y}}} \right|
= \left| \int_{B_a(\VEC{0})} g(\breve{\VEC{y}})
P_{x_n}(\breve{\VEC{x}} - \breve{\VEC{y}}) \dx{\breve{\VEC{y}}}
\right| \\
& \leq \int_{B_a(\VEC{0})} | g(\breve{\VEC{y}})| \,
\left| P_{x_n}(\breve{\VEC{x}} - \breve{\VEC{y}}) \right|
\dx{\breve{\VEC{y}}}
\leq \left( \int_{B_a(\VEC{0})} | g(\breve{\VEC{y}})|\dx{\breve{\VEC{y}}}
\right)\,
\sup_{\breve{\VEC{y}} \in B_a(\VEC{0})}
\left| P_{x_n}(\breve{\VEC{x}} - \breve{\VEC{y}}) \right| \\
& \leq \left( \int_{B_a(\VEC{0})} | g(\breve{\VEC{y}})|\dx{\breve{\VEC{y}}}
\right)\,
\frac{2 X}{\omega_{n} (\|\breve{\VEC{x}}\|_2 - a)^n} \to 0 \quad \text{as}
\quad \|\breve{\VEC{x}}\| \to \infty
\end{align*}
uniformly for $0 < x_n \leq X$ because
$a \leq \|\breve{\VEC{x}}\|_2 - a
= \|\breve{\VEC{x}}\|_2 - \|\breve{\VEC{y}}\|_2
\leq \|\breve{\VEC{x}} - \breve{\VEC{y}}\|_2$ for all
$\breve{\VEC{y}} \in B_a(\VEC{0})$ and
$\|\breve{\VEC{x}}\| > 2a$.

Combining these two results proved that $u$ vanishes a infinity on
$\displaystyle \RR^n_+$ when $g$ has a compact support.

\stage{ii} If $g$ vanished at infinity but does not have a compact
support, we choose functions $\displaystyle g_k:\RR^{n-1}\to \RR$ with
compact supports such that $g_k \to g$ uniformly as $k \to \infty$.
For instance, just multiply $g$ by smooth functions
$\displaystyle \psi_k:\RR^{n-1}\to \RR$ with compact support such that
$\psi(\VEC{y}) \leq 1$ for all $\displaystyle \VEC{y} \in \RR^{n-1}$ and
$\psi(\VEC{y}) =1$ for $\VEC{y} \in B_k(\VEC{0}) \cap R$ with $k>0$.

Let $u_k(\VEC{x}) = (g_k \ast P_{x_n})(\breve{\VEC{x}})$ for
$\displaystyle \VEC{x} \in \RR^n_+$.  We have shown in (i) that $u_k$
vanished at infinity on $\displaystyle \RR^n_+$.  Moreover, $u_k$
converges uniformly on $\displaystyle \RR^n_+$ to $u$ because
\begin{align*}
&\| u - u_k \|_\infty = \sup_{\VEC{x}\in\RR^n_+} 
\left| \int_{\breve{y} \in \RR^{n-1}}
\big(g(\breve{\VEC{y}}) - g_k(\breve{\VEC{y}}) \big)
P_{x_n}(\breve{\VEC{y}}-\breve{\VEC{x}}) \dx{\breve{\VEC{y}}} \right| \\
&\quad \leq \sup_{\breve{\VEC{y}}\in \RR^{n-1}}
\big|g(\breve{\VEC{y}}) - g_k(\breve{\VEC{y}}) \big|
\, \sup_{\VEC{x}\in\RR^n_+} \left| \int_{\breve{y} \in \RR^{n-1}}
P_{x_n}(\breve{\VEC{y}}-\breve{\VEC{x}}) \dx{\breve{\VEC{y}}}\right| \\
&\quad = \sup_{\breve{\VEC{y}}\in \RR^{n-1}}
\big|g(\breve{\VEC{y}}) - g_k(\breve{\VEC{y}}) \big|
\, \sup_{\VEC{x}\in\RR^n_+} \left| \int_{\breve{y} \in \RR^{n-1}}
P_{x_n}(\breve{\VEC{y}}) \dx{\breve{\VEC{y}}}\right|
= \sup_{\breve{\VEC{y}}\in \RR^{n-1}}
\big|g(\breve{\VEC{y}}) - g_k(\breve{\VEC{y}}) \big| \to 0 \quad
\text{as} \quad k \to \infty \ ,
\end{align*}
where we have used Lemma~\ref{laplace_lemma_diric}.
One can now easily show that $u$ also vanishes at infinity on
$\displaystyle \RR^n_+$.

Since $u$ can be continuously expanded to
$R$ by $u=g$ on $\displaystyle \partial \RR^n_+$
according to Theorem~\ref{laplace_half_plane_proof}, we
have that $u$ also vanishes at infinity on $R$.

\stage{iii}  Suppose that $v_1$ and $v_2$ are two solutions of the
Dirichlet problem $\Delta u=0$ on $\displaystyle \RR^n_+$ with the
condition $u=g$ on $\displaystyle \partial \RR^n_+$.  Suppose moreover
that they are continuous on $R$ and vanishing at infinity on $R$.
Then $w = v_1-v_2$ is a solution of $\Delta u=0$ on
$\displaystyle \RR^n_+$ that vanishes at infinity on
$R$ and such that $w=0$ on $\displaystyle \partial \RR^n_+$.

Choose $\epsilon >0$.  Since $w$ vanished at infinity, there exists
$X_0 >0$ such that $|w| < \epsilon$ on
$R \setminus B_X(\VEC{0}) \times [0,X])$, where
$\displaystyle B_{X_0}(\VEC{0}) \subset \RR^{n-1}$. 
In particular, $|w| < \epsilon$ on $\partial (B_X(\VEC{0}) \times [0,X])$
for $X > X_0$.  It follows from the Corollary~\ref{laplace_cHMP} to
the Maximum Principle, that
$|w| \leq \epsilon$ on $B_X(\VEC{0}) \times [0,X]$.
Thus $|w| \leq \epsilon$ on $R$.
Since $\epsilon > 0$ is arbitrary, we get that $w=0$ on $R$.
\end{proof}

\subsection{Dirichlet Problem in a Ball}

\begin{lemma} \label{laplace_diric_ball}
If $\displaystyle \VEC{x}, \VEC{y} \in \RR^n$, $\VEC{x} \neq \VEC{0}$ and
$\|\VEC{y}\|=1$, then
$\displaystyle \|\VEC{x}-\VEC{y}\|
= \left\|\|\VEC{x}\|^{-1} \VEC{x} - \|\VEC{x}\| \VEC{y}\right\|$.
\end{lemma}

\begin{proof}
We have that
\begin{align*}
\|\VEC{x}-\VEC{y}\|^2 &= \ps{\VEC{x}-\VEC{y}}{\VEC{x}-\VEC{y}}
= \|\VEC{x}\|^2 - 2 \ps{\VEC{x}}{\VEC{y}} + 1
= \left\| \|\VEC{x}\|\VEC{y}\right\|^2  - 2
\ps{\|\VEC{x}\|^{-1}\VEC{x}}{\|\VEC{x}\|\VEC{y}} +
\left\|\|\VEC{x}\|^{-1}\VEC{x}\right\|^2 \\
&= \ps{\|\VEC{x}\|^{-1} \VEC{x} - \|\VEC{x}\|\VEC{y}}
{\|\VEC{x}\|^{-1} \VEC{x} - \|\VEC{x}\|\VEC{y}}
= \left\|\|\VEC{x}\|^{-1} \VEC{x} - \|\VEC{x}\|
  \VEC{y}\right\| \ .  \qedhere
\end{align*}
\end{proof}

Without loss of generality, we may limit our work to finding the Green
function in the ball $\Omega = B_1(\VEC{0})$.

\stage{$\mathbf{n>2}$}
The {\bfseries Green's function}\index{Green's Function} on $B_1(\VEC{0})$ is
defined by $G(\VEC{x},\VEC{y}) = N(\VEC{x},\VEC{y}) - U(\VEC{x},\VEC{y})$
for $\VEC{x} \in B_1(\VEC{0})$ and $\VEC{y} \in \overline{B_1(\VEC{0})}$ with
$\VEC{x} \neq \VEC{y}$, where
\begin{align*}
U(\VEC{x},\VEC{y}) &=
\begin{cases}
N\left(\|\VEC{x}\|^{-1} \VEC{x},\|\VEC{x}\|\,\VEC{y}\right) &
\quad \text{if} \ \VEC{x} \neq \VEC{0} \\[0.8em]
\displaystyle \frac{1}{(2-n)\omega_n} & \quad \text{if} \ \VEC{x} = \VEC{0}
\end{cases} \\
&= \begin{cases}
\displaystyle \frac{1}{(2-n)\omega_n}
\left\| \|\VEC{x}\|^{-1}\VEC{x} - \|\VEC{x}\|\,\VEC{y}\right\|^{2-n}
& \quad \text{if} \ \VEC{x} \neq \VEC{0} \\[0.8em]
\displaystyle \frac{1}{(2-n)\omega_n} & \quad \text{if} \ \VEC{x} = \VEC{0}
\end{cases}
\end{align*}
for $\VEC{x} \in B_1(\VEC{0})$ and $\VEC{y} \in \overline{B_1(\VEC{x})}$.
We note that
\[
\frac{1}{(2-n)\omega_n}
\left\| \|\VEC{x}\|^{-1}\VEC{x} -\|\VEC{x}\|\,\VEC{y}\right\|^{2-n}
\rightarrow  \frac{1}{(2-n)\omega_n}
\]
uniformly for $\VEC{y} \in \overline{B_1(\VEC{0})}$ as
$\VEC{x}\rightarrow \VEC{0}$ because
\begin{align*}
1-\|\VEC{x}\| &\leq 1 - \|\VEC{x}\|\,\|\VEC{y}\| =
\left|\, \left\|\, \|\VEC{x}\|^{-1}\VEC{x} \, \right\| -
\left\|\, \|\VEC{x}\|\,\VEC{y} \, \right\|\, \right|
\leq \left\|\, \|\VEC{x}\|^{-1}\VEC{x} -\|\VEC{x}\|\,\VEC{y} \,\right\| \\
&\leq \left\|\, \|\VEC{x}\|^{-1}\VEC{x} \,\right\|
+\left\|\, \|\VEC{x}\|\,\VEC{y} \right\| = 1 + \|\VEC{x}\|\,\|\VEC{y}\|
\leq 1 + \|\VEC{x}\|
\end{align*}
for $\VEC{y}\in \overline{B_1(\VEC{0})}$ and
$\VEC{x}\in B_1(\VEC{0})$.

The function $\VEC{y} \mapsto U(\VEC{x},\VEC{y})$ with
$\VEC{x} \neq \VEC{0}$ is harmonic in $B_1(\VEC{0})$ and continuous on
$\overline{B_1(\VEC{0})}$ because
$\displaystyle \|\VEC{x}\|^{-2}\VEC{x} \not\in \overline{B_1(\VEC{0})}$ for all
$\VEC{x} \in B_1(\VEC{0}) \setminus \{0\}$ (Figure~\ref{laplace_FIG2})
and so
$\displaystyle \|\VEC{x}\|^{-1}\VEC{x} -\|\VEC{x}\|\,\VEC{y} \neq \VEC{0}$
for all $\VEC{y} \in B_1(\VEC{0})$.  The previous statement about
$\VEC{y} \mapsto U(\VEC{x},\VEC{y})$ is obviously true
if $\VEC{x} = \VEC{0}$.

\pdfF{laplace/laplace_fig2}{Reflection through a sphere}
{$\displaystyle \VEC{y}= \|\VEC{x}\|^{-2}\VEC{x}$ is the reflection through the
sphere of radius $1$ of $\VEC{x}$ because $\ps{\VEC{x}}{\VEC{y}} =1$,
the radius of the sphere.  Since $\|\VEC{x}\|<1$, we have that
$\displaystyle \|\VEC{y}\| = \|\VEC{x}\|^{-1} >1$.}{laplace_FIG2}

We get from Lemma~\ref{laplace_diric_ball} that
\[
U(\VEC{x},\VEC{y}) = \frac{1}{(2-n)\omega_n}
\left\| \|\VEC{x}\|^{-1}\VEC{x} - \|\VEC{x}\|\,\VEC{y}\right\|^{2-n}
= \frac{1}{(2-n)\omega_n} \|\VEC{x}-\VEC{y}\|^{2-n}
= N(\VEC{x},\VEC{y})
\]
for $\VEC{y} \in \partial B_1(\VEC{0})$ and
$\VEC{x} \in B_1(\VEC{0})\setminus \{\VEC{0}\}$.  For
$\VEC{y} \in \partial B_1(\VEC{0})$ and $\VEC{x} = \VEC{0}$, we have
\[
U(\VEC{x},\VEC{y}) = \frac{1}{(2-n)\omega_n} 
= \frac{1}{(2-n)\omega_n} \|\VEC{y}\|^{2-n} = N(\VEC{x},\VEC{y}) \ .
\]

Explicitly, the Green's function for $B_1(\VEC{0})$ is
\begin{align*}
G(\VEC{x},\VEC{y}) &=
\begin{cases}
N(\VEC{x},\VEC{y}) -
N\left(\|\VEC{x}\|^{-1} \VEC{x},\|\VEC{x}\|\,\VEC{y}\right) & \quad
\text{if} \ \VEC{x} \neq \VEC{0} \\
\displaystyle N(\VEC{y}) - \frac{1}{(2-n)\omega_n} & \quad \text{if}
\ \VEC{x} = \VEC{0}
\end{cases} \\
&= \begin{cases}
\displaystyle \frac{1}{(2-n)\omega_n} \left( \|\VEC{x}-\VEC{y}\|^{2-n}
-\left\| \|\VEC{x}\|^{-1}\VEC{x} - \|\VEC{x}\|\VEC{y}\right\|^{2-n}
\right) & \quad \text{if} \ \VEC{x} \neq \VEC{0} \\[1em]
\displaystyle \frac{1}{(2-n)\omega_n}\,\|\VEC{y}\|^{2-n} -
\frac{1}{(2-n)\omega_n} & \quad \text{if} \ \VEC{x} = \VEC{0}
\end{cases}
\end{align*}
for $\VEC{x} \in B_1(\VEC{0})$ and $\VEC{y} \in \overline{B_1(\VEC{0})}$
with $\VEC{x} \neq \VEC{y}$.  

\stage{$\mathbf{n = 2}$}
The {\bfseries Green's function}\index{Green's Function} on $B_1(\VEC{0})$ is
defined by $G(\VEC{x},\VEC{y}) = N(\VEC{x},\VEC{y}) - U(\VEC{x},\VEC{y})$
for $\VEC{x} \in B_1(\VEC{0})$ and $\VEC{y} \in \overline{B_1(\VEC{0})}$ with
$\VEC{x} \neq \VEC{y}$, where
\begin{align*}
U(\VEC{x},\VEC{y}) &=
\begin{cases}
N\left(\|\VEC{x}\|^{-1} \VEC{x},\|\VEC{x}\|\,\VEC{y}\right) &
\quad \text{if} \ \VEC{x} \neq \VEC{0} \\[0.8em]
0 & \quad \text{if} \ \VEC{x} = \VEC{0}
\end{cases} \\
&= \begin{cases}
\displaystyle \frac{1}{(2-n)\omega_n}
\ln\left( \left\| \|\VEC{x}\|^{-1}\VEC{x} - \|\VEC{x}\|\,\VEC{y}\right\|\right)
& \quad \text{if} \ \VEC{x} \neq \VEC{0} \\[0.8em]
0 & \quad \text{if} \ \VEC{x} = \VEC{0}
\end{cases}
\end{align*}
for $\VEC{x} \in B_1(\VEC{0})$ and $\VEC{y} \in \overline{B_1(\VEC{x})}$.
For a reason similar to the one given in the case $n>2$,
$\displaystyle
\| \|\VEC{x}\|^{-1} \VEC{x}- \|\VEC{x}\|\,\VEC{y} \| \rightarrow 1$
uniformly for $\VEC{y} \in \overline{B_1(\VEC{x})}$ as
$\VEC{x} \rightarrow \VEC{0}$ and so $\displaystyle
\ln\left(\| \|\VEC{x}\|^{-1} \VEC{x}- \|\VEC{x}\|\, \VEC{y} \|\right)
\rightarrow 0$ uniformly for $\VEC{y} \in \overline{B_1(\VEC{x})}$
as $\VEC{x} \rightarrow \VEC{0}$.

The function $\VEC{y} \mapsto U\left(\VEC{x},\VEC{y}\right)$
is harmonic in $B_1(\VEC{0})$ and
continuous on $\overline{B_1(\VEC{0})}$ because
$\displaystyle \|\VEC{x}\|^{-1}\VEC{x} \not\in B_1(\VEC{0})$ for all
$\VEC{x} \in B_1(\VEC{0})\setminus \{\VEC{0}\}$
(Figure~\ref{laplace_FIG2}) and so
$\displaystyle \|\VEC{x}\|^{-1}\VEC{x} -\|\VEC{x}\|\,\VEC{y} \neq \VEC{0}$
for all $\VEC{y} \in \overline{B_1(\VEC{0})}$.
The previous statement about
$\VEC{y} \mapsto U(\VEC{x},\VEC{y})$ is obviously true
if $\VEC{x} = \VEC{0}$.

We get from Lemma~\ref{laplace_diric_ball} that
\[
U(\VEC{x},\VEC{y}) = \frac{1}{\omega_2}
\ln \left( \|\VEC{x}\|^{-1}\VEC{x} - \|\VEC{x}\|\VEC{y}\right)
= \frac{1}{\omega_2} \ln \left( \|\VEC{x} - \VEC{y}\| \right)
= N(\VEC{x},\VEC{y})
\]
for $\VEC{y} \in \partial B_1(\VEC{0})$ and
$\VEC{x} \in B_1(\VEC{0})\setminus \{\VEC{0}\}$.  For
$\VEC{y} \in \partial B_1(\VEC{0})$ and $\VEC{x} = \VEC{0}$, we have
\[
N(\VEC{x},\VEC{y}) = \frac{1}{\omega_2} \ln \left(\|\VEC{y}\|\right)
= 0 = U(\VEC{x},\VEC{y})
\]
because $\|\VEC{y}\|=1$.

Explicitly, the Green's function on $B_1(\VEC{0})$ is
\begin{align*}
G(\VEC{x},\VEC{y}) &=
\begin{cases}
N(\VEC{x},\VEC{y}) - N\left(\|\VEC{x}\|^{-1} \VEC{x},\|\VEC{x}\|\VEC{y}\right)
& \quad \text{if} \ \VEC{x} \neq \VEC{0} \\
\displaystyle N(\VEC{y}) & \quad \text{if} \ \VEC{x} = \VEC{0}
\end{cases} \\
&= \begin{cases}
\displaystyle \frac{1}{\omega_2} \left( \ln\left(\|\VEC{x}-\VEC{y}\|\right)
- \ln\left( \| \|\VEC{x}\|^{-1} \VEC{x}- \|\VEC{x}\| \VEC{y} \|\right) \right)
& \quad \text{if} \ \VEC{x} \neq \VEC{0} \\[1em]
\displaystyle \frac{1}{\omega_2} \ln\left(\|\VEC{y}\|\right)
& \quad \text{if} \ \VEC{x} = \VEC{0}
\end{cases}
\end{align*}
for $\VEC{x} \in B_1(\VEC{0})$ and $\VEC{y} \in \overline{B_1(\VEC{0})}$
with $\VEC{x} \neq \VEC{y}$.

\begin{rmk}
It can be directly proved that $G(\VEC{x},\VEC{y}) = G(\VEC{y},\VEC{x})$
for $\VEC{x}$ and $\VEC{y}$ in $B_1(\VEC{0})$ using an identity
similar to the one in Lemma~\ref{laplace_diric_ball}.
\end{rmk}

According to Theorem~\ref{laplace_dirichlet1}, the solution of
$\Delta u = f$ on $B_1(\VEC{0})$ with $u = 0$ on
$\partial B_1(\VEC{0})$ is given by
\[
u(\VEC{x}) = \int_{B_1(\VEC{0})} G(\VEC{x},\VEC{y})f(\VEC{y}) \dx{\VEC{y}}
\]
provide that $\displaystyle f\in L^1(B_1(\VEC{0}))$.

According to Theorem~\ref{laplace_dirichlet2} and provide that
$g\in C(\partial B_1(\VEC{0}))$, the solution of
$\Delta u = 0$ on $B_1(\VEC{0})$ with $u = g$ on $\partial B_1(\VEC{0})$
is given by
\[
u(\VEC{x}) =
\begin{cases}
\displaystyle
\int_{\partial B_1(\VEC{0})} g(\VEC{y}) P(\VEC{x},\VEC{y}) \dss{S}{y} &
\quad \text{if} \ \VEC{x} \in B_1(\VEC{0}) \\
g(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \partial B_1(\VEC{0})
\end{cases}
\]
where
$\displaystyle P(\VEC{x},\VEC{y}) =
\pdydx{G_{\VEC{x}}}{\nu}(\VEC{y})$ with
$G_{\VEC{x}}(\VEC{y}) = G(\VEC{x},\VEC{y})$ for all
$\VEC{y} \in \overline{B_1(\VEC{0})} \setminus \{\VEC{x}\}$.  Moreover,
$u \in C(\overline{B_1(\VEC{0})})$.

We now show that the {\bfseries Poisson kernel}\index{Poisson Kernel}
for $B_1(\VEC{0})$ is
\begin{equation} \label{laplace_green_ball}
P(\VEC{x},\VEC{y}) =
\frac{1-\|\VEC{x}\|^2}{\omega_n \|\VEC{x}-\VEC{y}\|^n}
\end{equation}
for $\VEC{x}\in B_1(\VEC{0})$ and $\VEC{y} \in \partial B_1(\VEC{0})$.

For $n>2$, we find using Lemma~\ref{laplace_diric_ball} that the
Poisson kernel is
\begin{align*}
& P(\VEC{x},\VEC{y}) = \pdydx{G_{\VEC{x}}}{\nu}(\VEC{y}) =
\nabla_{\VEC{y}} G_{\VEC{x}}(\VEC{y}) \cdot \VEC{y} \\
&\qquad
= - \frac{1}{\omega_n} \left( \frac{1}{\| \VEC{x} - \VEC{y}\|^{n}}
\, \left(\VEC{x}-\VEC{y}\right) \cdot \VEC{y} -
\frac{\|\VEC{x}\|}
{\left\| \, \|\VEC{x}\|^{-1}\VEC{x} - \|\VEC{x}\|\,\VEC{y}\, \right\|^{n}}
\, \left( \|\VEC{x}\|^{-1}\VEC{x} - \|\VEC{x}\|\VEC{y}
\right) \cdot \VEC{y} \right)
= \frac{1-\|\VEC{x}\|^2}{\omega_n \|\VEC{x}-\VEC{y}\|^n}
\end{align*}
for $\VEC{x} \in B_1(\VEC{0})\setminus \{\VEC{0}\}$ and
$\VEC{y} \in \partial B_1(\VEC{0})$.  Similarly, for
$\VEC{y} \in \partial B_1(\VEC{0})$, we have
\[
P(\VEC{0},\VEC{y}) = \nabla_{\VEC{y}} G_{\VEC{0}}(\VEC{y}) \cdot \VEC{y}
= \frac{1}{\omega_n} \, \frac{1}{\|\VEC{y}\|^{n}}
\, \VEC{y} \cdot \VEC{y} = \frac{1}{\omega_n}
\]
because $\|\VEC{y}\|=1$.
Thus (\ref{laplace_green_ball}) is true for $n>2$ and all
$\VEC{x} \in B_1(\VEC{0})$.  Proceeding as we have just done for
$n>2$, we can show that (\ref{laplace_green_ball}) is also true for
$n=2$ and all $\VEC{x} \in B_1(\VEC{0})$.

As we have done in the case of the half plane, since
Theorem~\ref{laplace_dirichlet2} has not been proved yet, we now prove
that this theorem is true in the present case.  More precisely, we
prove the following theorem.

\begin{theorem} \label{laplace_exist_ball}
Suppose that $\displaystyle g \in L^1(\partial B_1(\VEC{0}))$.  Then
\[
u(\VEC{x}) = \int_{\partial B_1(\VEC{0})} g(\VEC{y}) \,
P(\VEC{x},\VEC{y}) \dss{S}{y}
= \int_{\partial B_1(\VEC{0})} g(\VEC{y}) \,
\frac{1-\|\VEC{x}\|^2}{\omega_n \|\VEC{x}-\VEC{y}\|^n} \dss{S}{y}
\]
is well defined for $\VEC{x} \in B_1(\VEC{0})$.
Moreover, $u$ is harmonic in $B_1(\VEC{0})$.

If $g\in C(\partial B_1(\VEC{0}))$, then $u$ can be
continuously extended to $\overline{B_1(\VEC{0})}$ by
$u(\VEC{x}) = g(\VEC{x})$ for $\VEC{x} \in \partial B_1(\VEC{0})$.

If $\displaystyle g \in L^p(\partial B_1(\VEC{0}))$ for some integer
$p \geq 1$, then $u_r(\VEC{x}) \equiv u(r\,\VEC{x})$ for $0\leq r < 1$ and
$\VEC{x} \in \partial B_1(\VEC{0})$ satisfies $u_r \rightarrow g$ in
$\displaystyle L^p(\partial B_1(\VEC{0}))$ as $r \rightarrow 1^-$.
\end{theorem}

\begin{rmk}
To solve the Dirichlet problem    \label{laplace_exist_a_ball}
$\Delta u = 0$ on $B_\rho(\VEC{x}_0)$ with $u=g$ on
$\partial B_\rho(\VEC{x}_0)$, we need to consider
$\tilde{u}(\tilde{\VEC{x}}) = u(\rho \tilde{\VEC{x}} + \VEC{x}_0)$ for
$\tilde{\VEC{x}} \in B_1(\VEC{0})$ and
$\tilde{g}(\tilde{\VEC{x}}) = g(\rho \tilde{\VEC{x}} + \VEC{x}_0)$ for
$\tilde{\VEC{x}} \in \partial B_1(\VEC{0})$ to transform the previous
problem into  $\Delta \tilde{u} = 0$ on $B_1(\VEC{0})$ with
$\tilde{u}=\tilde{g}$ on $\partial B_1(\VEC{0})$.
The solution of this problem is
\[
\tilde{u}(\tilde{\VEC{x}}) = \int_{\partial B_1(\VEC{0})}
\tilde{g}(\tilde{\VEC{y}}) \,
P(\tilde{\VEC{x}},\tilde{\VEC{y}}) \dx{\VEC{S}_{\tilde{\VEC{y}}}}
= \int_{\partial B_1(\VEC{0})}
\tilde{g}(\tilde{\VEC{y}}) \, \frac{1-\|\tilde{\VEC{x}}\|^2}
{\omega_n \|\tilde{\VEC{x}}-\tilde{\VEC{y}}\|^n}
\dx{\VEC{S}_{\tilde{\VEC{y}}}}
\]
for $\tilde{\VEC{x}} \in B_1(\VEC{0})$.
If we restate this formula in terms of $u$ and $g$, we get
\[
u(\rho \tilde{\VEC{x}} +\VEC{x}_0) = \int_{\partial B_1(\VEC{0})}
g(\rho\tilde{\VEC{y}}+\VEC{x}_0) \, P(\tilde{\VEC{x}},\tilde{\VEC{y}})
\dx{\VEC{S}_{\tilde{\VEC{y}}}}
= \int_{\partial B_1(\VEC{0})}
g(\rho \tilde{\VEC{y}} + \VEC{x}_0) \,
\frac{1-\|\tilde{\VEC{x}}\|^2}{\omega_n \|\tilde{\VEC{x}}-\tilde{\VEC{y}}\|^n}
\dx{S_{\tilde{\VEC{y}}}}
\]
for $\tilde{\VEC{x}} \in B_1(\VEC{0})$.
Finally, the substitution $\tilde{\VEC{x}} = (\VEC{x}-\VEC{x}_0)/\rho$
and $\tilde{\VEC{y}} = (\VEC{y}-\VEC{x}_0)/\rho$ yields the solution
\begin{align}
u(\VEC{x}) &= \int_{\partial B_\rho(\VEC{x}_0)}
g(\VEC{y}) \, P\left(\frac{\VEC{x}-\VEC{x}_0}{\rho},
\frac{\VEC{y}-\VEC{x}_0}{\rho}\right) \,\rho^{1-n}
\dsss{S}{y} \nonumber \\
&= \int_{\partial B_\rho(\VEC{x}_0)} g(\VEC{y}) \,
\frac{1-\left\|(\VEC{x}-\VEC{x}_0)/\rho\right\|^2}
{\omega_n \left\|(\VEC{x}-\VEC{x}_0)/\rho -
(\VEC{y}-\VEC{x}_0)/\rho\right\|^n}
\, \rho^{1-n} \dss{S}{y} \nonumber \\
&=\int_{\partial B_\rho(\VEC{x}_0)} g(\VEC{y}) \,
\frac{\rho^2-\left\|\VEC{x}-\VEC{x}_0\right\|^2}
{\rho \, \omega_n \left\|\VEC{x}-\VEC{y}\right\|^n}
\dss{S}{y}  \label{laplace_ball_formula}
\end{align}
for $\VEC{x} \in B_\rho(\VEC{x}_0)$
for the original Dirichlet problem on $B_\rho(\VEC{x}_0)$.
\end{rmk}

Before giving the proof of the previous theorem, we need a lemma.

\begin{lemma} \label{laplace_l_exist_ball}
We have
\begin{equation}   \label{laplace_ident1}
\int_{\partial B_1(\VEC{0})} P(\VEC{x},\VEC{y}) \dss{S}{y} = 1 \quad ,
\quad \VEC{x} \in B_1(\VEC{0}) \ .
\end{equation}
Moreover, given $\epsilon >0$,
\[
\int_{\partial B_1(\VEC{0}) \,\setminus B_\epsilon(\VEC{x}_0)}
P(r\VEC{x}_0,\VEC{y}) \dss{S}{y} \rightarrow  0 \qquad \text{as} \quad 
r\rightarrow 0
\]
uniformly for $\VEC{x}_0 \in \partial B_1(\VEC{0})$.
\end{lemma}

\begin{proof}
Since $\VEC{x} \rightarrow P(\VEC{x},\VEC{y})$
is harmonic in $B_1(\VEC{0})$ for all $\VEC{y}\in \partial B_1(\VEC{0})$,
we get from the Main Value Theorem, Theorem~\ref{laplace_MVT}, that 
\[
P(\VEC{0},\VEC{y}) = \frac{1}{\omega_n} \int_{\partial B_1(\VEC{0})}
P(r\VEC{x},\VEC{y}) \dss{S}{x}
\]
for $\VEC{y} \in \partial B_1(\VEC{0})$ and $0<r<1$.
Since $\displaystyle P(\VEC{0},\VEC{y}) = 1/\omega_n$ for all
$\VEC{y} \in \partial B_1(\VEC{0})$, we get
\[
1 = \int_{\partial B_1(\VEC{0})}
P(r\VEC{x},\VEC{y}) \dss{S}{x}
\]
for $\VEC{y} \in \partial B_1(\VEC{0})$ and $0<r<1$.
From Lemma~\ref{laplace_diric_ball}, we have that
$\|r\VEC{x} - \VEC{y}\| = \|r^{-1}(r\VEC{x})- r \VEC{y}\|
= \|\VEC{x} - r \VEC{y}\|$ for $\VEC{y} \in \partial B_1(\VEC{0})$. 
Therefore, $\displaystyle P(r\VEC{x},\VEC{y}) = P(r\VEC{y},\VEC{x})$ for
$\VEC{x}$ and $\VEC{y}$ in $\partial B_1(\VEC{0})$.  It follows that
\[
1 = \int_{\partial B_1(\VEC{0})}
P(r\VEC{y},\VEC{x}) \dss{S}{x}
\]
for $\VEC{y} \in \partial B_1(\VEC{0})$ and $0<r<1$.
Since all elements of $B_1(\VEC{0})$ are of the form $r\VEC{y}$ for
$0\leq r <1$ and $\VEC{y} \in \partial B_1(\VEC{0})$, we get
(\ref{laplace_ident1}).

To prove the second part of the lemma, we note that
\[
P(r\VEC{x}_0,\VEC{y}) =
\frac{1-\|r\VEC{x}_0\|^2}{\omega_n\|r\VEC{x}_0 - \VEC{y}\|^n} \leq
\frac{1- |r|^2}{\omega_n q^n}
\]
for all $\displaystyle \VEC{x}_0 \in \partial B_1(\VEC{0})$ and
$\displaystyle \VEC{y} \in \partial B_1(\VEC{0})
\setminus B_\epsilon(\VEC{x}_0)$, where
\[
q = \min \left\{ \|r\VEC{x}_0 - \VEC{y} \| : r>0 \ , \ \VEC{y} \in
\partial B_1(\VEC{0}) \setminus B_\epsilon(\VEC{x}_0) \right\} > 0
\]
is the distance between the region
$\partial B_1(\VEC{0}) \setminus B_\epsilon(\VEC{x}_0)$ and the segment
$\{ r\VEC{x}_0 : r >0 \}$ as it can be seen in
Figure~\ref{laplace_FIG3}.  Let
$\displaystyle M =
\int_{\partial B_1(\VEC{0}) \setminus B_\epsilon(\VEC{x}_0)} \dx{S}$.
M is the surface area of
$\partial B_1(\VEC{0}) \setminus B_\epsilon(\VEC{x}_0)$.  By symmetry,
it is independent of the $\VEC{x}_0$ considered.

Given $\delta >0$, choose $r_0$ closed to $1$ such that
$\displaystyle 0 \leq P(r\VEC{x}_0,\VEC{y}) < \delta/M$
for all $\displaystyle \VEC{x}_0 \in \partial B_1(\VEC{0})$,
$\displaystyle \VEC{y} \in \partial B_1(\VEC{0}) \setminus
B_\epsilon(\VEC{x}_0)$, and $r_0 <r < 1$.  Then
\[
0 \leq \int_{\partial B_1(\VEC{0}) \setminus B_\epsilon(\VEC{x}_0)}
P(r\VEC{x}_0,\VEC{y}) \dss{S}{y} < \delta
\]
for all $\VEC{x}_0 \in \partial B_1(\VEC{0})$ and $r_0 <r < 1$.
\end{proof}

\pdfF{laplace/laplace_fig3}{Study of the Poisson kernel for the ball}
{$q$ is the distance between the region
$\partial B_1(\VEC{0}) \setminus B_\epsilon(\VEC{x}_0)$ and the segment
$\{ r\VEC{x}_0 : r >0 \}$ used in the proof of
Lemma~\ref{laplace_l_exist_ball}.}{laplace_FIG3}

\begin{proof}[Proof of Theorem~\ref{laplace_exist_ball}]
\stage{i} Since $\VEC{y} \rightarrow P(\VEC{x},\VEC{y})$ is continuous
on $\partial B_1(\VEC{0})$ for all $\VEC{x} \in B_1(\VEC{0})$ and
$\partial B_1(\VEC{0})$ is compact, then
$\VEC{y} \rightarrow P(\VEC{x},\VEC{y})$ is bounded on
$\partial B_1(\VEC{0})$ and
\[
\left| u(\VEC{x}) \right| \leq \sup_{\VEC{y} \in \partial B_1(\VEC{0})}
\left| P(\VEC{x},\VEC{y}) \right| \ 
\int_{\partial B_1(\VEC{0})} \left| g(\VEC{y}) \right| \dss{S}{y}
< \infty
\]
for all $\VEC{x} \in B_1(\VEC{0})$.
Thus $u$ is well defined on $B_1(\VEC{0})$.

\stage{ii} Proceeding as we did in (i), we can show that, for any
$0\leq a < b <1$, there exists a constant $C$ such that 
$\displaystyle \big|g(\VEC{y})\,
D^{\VEC{\alpha}}_{\VEC{x}} P(\VEC{x},\VEC{y})\big|
\leq |g(\VEC{y})|$ for $a \leq \|\VEC{x} \| \leq b$ and
$\VEC{y} \in \partial B_1(\VEC{0})$, and any multi-index
$\VEC{\alpha} \in \NN^n$ with $|\VEC{\alpha}|\leq 2$.  Thus,
$\displaystyle \VEC{y} \mapsto g(\VEC{y})\, D^{\VEC{\alpha}}_{\VEC{x}}
P(\VEC{x},\VEC{y})$
is bounded in absolute value by a function in
$\displaystyle L^1(\partial B_1(\VEC{0}))$ for
$a \leq \|\VEC{x} \| \leq b$ and
$\VEC{y} \in \partial B_1(\VEC{0})$, and any multi-index
$\displaystyle \VEC{\alpha} \in \NN^n$ with $|\VEC{\alpha}|<2$.  
We may therefore interchange the integral with respect to $\VEC{y}$
that defined $u$ and the differential operator $\Delta_{\VEC{x}}$
(see \cite{Flem}).  We get
\[
\Delta_{\VEC{x}} u(\VEC{x}) = \int_{\partial B_1(\VEC{0})}
\Delta_{\VEC{x}}P(\VEC{x},\VEC{y}) g(\VEC{y}) \dss{S}{y} = 0
\]
for $\VEC{x} \in B_1(\VEC{0})$
because $\VEC{x} \mapsto P(\VEC{x},\VEC{y})$ is harmonic in
$B_1(\VEC{0})$ for all $\VEC{y} \in \partial B_1(\VEC{0})$.

\stage{iii} Suppose that $g$ is continuous on the compact set
$\partial B_1(\VEC{0})$, then $g$ is uniformly continuous on
$\partial B_1(\VEC{0})$.  Given $\epsilon>0$, choose $\delta>0$ such
that
$\displaystyle |g(\VEC{y}) - g(\VEC{x})| < \epsilon/2$ for
$\|\VEC{x}-\VEC{y}\| < \delta$ and
$\VEC{x},\VEC{y} \in \partial B_1(\VEC{0})$.

Let
\[
V_{\VEC{x}} = \partial B_1(\VEC{0}) \cap B_\delta(\VEC{x})
= \left\{ \VEC{y} \in \partial B_1(\VEC{0})
: \|\VEC{x} - \VEC{y} \| < \delta \right\}
\]
for all $\VEC{x} \in \partial B_1(\VEC{0})$.  We have
$\displaystyle |g(\VEC{y}) - g(\VEC{x})| < \epsilon/2$ for all
$\VEC{y} \in V_{\VEC{x}}$.
According to Lemma~\ref{laplace_l_exist_ball}, there exists $r_0<1$
closed to $1$ such that
\[
\int_{\partial B_1(\VEC{0})\setminus V_{\VEC{x}}}
P(r\VEC{x},\VEC{y}) \dss{S}{y} < \frac{\epsilon}{4\|g\|_\infty}
\]
for all $\VEC{x} \in \partial B_1(\VEC{0})$ and $r_0 < r < 1$, where
$\displaystyle \|g\|_{\infty} = \max_{\VEC{y}\in\partial B_1(\VEC{0})}
|g(\VEC{y})|$.
We assume that $g \neq 0$ on $\partial B_1(\VEC{0})$ otherwise there
is nothing to prove.

Using (\ref{laplace_ident1}), we have
\[
g(\VEC{x}) - u(r\VEC{x})
=\int_{\partial B_1(\VEC{0})} \left( g(\VEC{x}) -g(\VEC{y})\right)
P(r\VEC{x},\VEC{y}) \dss{S}{y}
\]
for all $\VEC{x} \in \partial B_1(\VEC{0})$.  Thus,
\begin{align*}
\left| g(\VEC{x}) - u(r\VEC{x})\right|
&= \left| \int_{\partial B_1(\VEC{0})} \left( g(\VEC{x}) -g(\VEC{y})\right)
P(r\VEC{x},\VEC{y}) \dss{S}{y} \right| \\
&\leq \int_{V_{\VEC{x}}} \left| g(\VEC{x}) -g(\VEC{y})\right|
P(r\VEC{x},\VEC{y}) \dss{S}{y}
+\int_{\partial B_1(\VEC{0})\setminus V_{\VEC{x}}}
\left| g(\VEC{x}) -g(\VEC{y})\right| P(r\VEC{x},\VEC{y}) \dss{S}{y} \\
&< \frac{\epsilon}{2} \int_{V_{\VEC{x}}} P(r\VEC{x},\VEC{y})
\dss{S}{y} + 2 \|g\|_{\infty}
\int_{\partial B_1(\VEC{0})\setminus V_{\VEC{x}}} P(r\VEC{x},\VEC{y}) \dss{S}{y}
\leq \frac{\epsilon}{2} + 2 \|g\|_{\infty}
\frac{\epsilon}{4\|g\|_{\infty}} < \epsilon
\end{align*}
for all $\VEC{x} \in \partial B_1(\VEC{0})$ and $r_0<r<1$, where again
we have used (\ref{laplace_ident1}) to obtain
\[
\int_{V_{\VEC{x}}} P(r\VEC{x},\VEC{y}) \dss{S}{y}
\leq \int_{\partial B_1(\VEC{0})} P(r\VEC{x},\VEC{y}) \dss{S}{y} = 1 \ .
\]
Hence
\begin{align*}
u_r: \partial B_1(\VEC{0}) &\rightarrow \RR \\
\VEC{x} &\mapsto u(r\VEC{x})
\end{align*}
converges uniformly on $\partial B_1(\VEC{0})$ to $g$ as
$r\rightarrow 1$.  We may then extend $u$ continuously to
$\overline{B_1(\VEC{0})}$ with
$u(\VEC{x})=g(\VEC{x})$ for $\VEC{x}\in \partial B_1(\VEC{0})$.

\stage{iv}  Suppose that $\displaystyle g\in L^p(\partial B_1(\VEC{0}))$ with
$1\leq p < \infty$.  Given $\epsilon>0$, choose
$f\in C(\partial B_1(\VEC{0}))$ such that
\begin{equation} \label{laplace_ident2}
\|g-f\|_p < \epsilon/3 \ , 
\end{equation}
where $\|\cdot\|_p$ is the $\displaystyle L^p$-norm on
$\displaystyle L^p(\partial B_1(\VEC{0}))$.
This is possible because $C(\partial B_1(\VEC{0}))$ is dense in
$\displaystyle L^p(\partial B_1(\VEC{0}))$.

Let
\[
v(\VEC{x}) = \int_{\partial B_1(\VEC{0})} f(\VEC{y})
P(\VEC{x},\VEC{y}) \dss{S}{y}
\quad , \quad \VEC{x} \in B_1(\VEC{0}) \ .
\]
Then
\begin{equation} \label{laplace_ident5}
\|g-u_r\|_p \leq \| g - f \|_p + \| f - v_r \|_p + \| v_r - u_r\|_p \ ,
\end{equation}
where $v_r$ is defined by $v_r(\VEC{x}) = v(r\VEC{x})$ for all
$\VEC{x} \in \partial B_1(\VEC{0})$ and $0 \leq r < 1$.

As seen in (iii), for $r$ closed enough to $1$, we have
$\displaystyle \| f - v_r \|_\infty < \frac{\epsilon}{3 B}$, where
$\displaystyle B^p = \int_{\partial B_1(\VEC{0})} \dx{S}$.  Hence
\begin{equation} \label{laplace_ident3}
\| f - v_r \|_p < \frac{\epsilon}{3} \  . 
\end{equation}

The linear application
\begin{align*}
T_r: L^p(\partial B_1(\VEC{0})) &\rightarrow L^p(\partial B_1(\VEC{0})) \\
h &\mapsto \int_{\partial B_1(\VEC{0})} h(\VEC{y}) P(r\VEC{x},\VEC{y}) \dss{S}{y}
\end{align*}
has norm less than or equal to $1$ according to the Generalized
Young's Inequality, Theorem~\ref{distr_GyoungI}, because
\[
  \int_{\partial B_1(\VEC{0})} P(r\VEC{x},\VEC{y}) \dss{S}{y} = 1
\]
for $\VEC{x} \in \partial B_1(\VEC{0})$ and $0 \leq r <1$, and
\[
\int_{\partial B_1(\VEC{0})} P(r\VEC{x},\VEC{y}) \dss{S}{x} =
\int_{\partial B_1(\VEC{0})} P(r\VEC{y},\VEC{x}) \dss{S}{x} = 1
\]
for $\VEC{y} \in \partial B_1(\VEC{0})$ and $0 \leq r <1$.
Note that it follows from Lemma~\ref{laplace_diric_ball} that
$P(r\VEC{x}, \VEC{y}) = P(r\VEC{y},\VEC{x})$ for
$\VEC{x}$ and $\VEC{y}$ in $\partial B_1(\VEC{0})$.
Therefore, $\displaystyle \| u_r - v_r \|_p
= \|T_r(g) - T_r(f) \|_p \leq \|g - f \|_p$.
It follows from (\ref{laplace_ident2}) that
\begin{equation} \label{laplace_ident4}
\| u_r - v_r \|_p < \frac{\epsilon}{3} \ .
\end{equation}

Finally, (\ref{laplace_ident2}), (\ref{laplace_ident5}),
(\ref{laplace_ident3}) and (\ref{laplace_ident4}) implies that
$\|g-u_r\|_p < \epsilon$ for $r$ closed enough to $1$.
\end{proof}

Some results about harmonic functions, which are given in a course on
complex analysis, generalize to dimensions higher than two.

\begin{theorem}[Harnack's Inequality]
Suppose that $\Omega \subset \RR^n$ is an open set and that
$u \in C^2(\Omega)\cap C^1(\overline{\Omega})$ is an harmonic function
in $\Omega$ such that $u(\VEC{x}) \geq 0$ for all $\VEC{x} \in \Omega$.
Then, given $\VEC{x}_0 \in \Omega$ and $\rho>0$ such that
$B_{\rho}(\VEC{x}_0) \subset \Omega$, we have
\[
\frac{\rho^{n-2}(\rho-r)}{(\rho+r)^{n-1}}\, u(\VEC{x}_0) \leq u(\VEC{x}) \leq
\frac{\rho^{n-2}(\rho+r)}{(\rho-r)^{n-1}}\, u(\VEC{x}_0)
\]
for $\VEC{x} \in B_{\rho}(\VEC{x}_0)$ and $r=\|\VEC{x}-\VEC{x}_0\|$.
\end{theorem}

\begin{proof}
Since $\|\VEC{x} - \VEC{y}\| \leq \rho + r$ for
$\VEC{x} \in B_{\rho}(\VEC{x}_0)$ and
$\VEC{y} \in \partial B_{\rho}(\VEC{x}_0)$, we get
\[
\frac{\rho-r}{(\rho+r)^{n-1}} = \frac{\rho^2-r^2}{(\rho+r)^n}
\leq \frac{\rho^2-r^2}{\|\VEC{x} - \VEC{y}\|^n}
\]
for
$\VEC{x} \in B_{\rho}(\VEC{x}_0)$ and
$\VEC{y} \in \partial B_{\rho}(\VEC{x}_0)$, 
Similarly, since $\rho \leq \|\VEC{x} - \VEC{y}\| + r$ for
$\VEC{x} \in B_{\rho}(\VEC{x}_0)$ and
$\VEC{y} \in \partial B_{\rho}(\VEC{x}_0)$, 
we get
\[
\frac{\rho^2-r^2}{\|\VEC{x} - \VEC{y}\|^n} \leq
\frac{\rho^2-r^2}{(\rho-r)^n} = \frac{\rho+r}{(\rho-r)^{n-1}}
\]
for
$\VEC{x} \in B_{\rho}(\VEC{x}_0)$ and
$\VEC{y} \in \partial B_{\rho}(\VEC{x}_0)$.

We therefore have
\begin{equation}\label{Harnack1}
\begin{split}
\int_{\partial B_\rho(\VEC{x}_0)} u(\VEC{y})
\, \frac{\rho-r}{\rho\, \omega_n (\rho+r)^{n-1}} \dss{S}{y}
&\leq \int_{\partial B_\rho(\VEC{x}_0)} u(\VEC{y})\, 
\frac{\rho^2-r^2}{\rho \, \omega_n \left\|\VEC{x}-\VEC{y}\right\|^n}
\dss{S}{y} \\
&\leq \int_{\partial B_\rho(\VEC{x}_0)} u(\VEC{y}) \,
\frac{\rho+r}{\rho\, \omega_n (\rho-r)^{n-1}} \dss{S}{y}
\end{split}
\end{equation}
for $\VEC{x} \in B_{\rho}(\VEC{x}_0)$.

Moreover,
\begin{equation}\label{Harnack2}
\begin{split}
\int_{\partial B_\rho(\VEC{x}_0)} u(\VEC{y})
\, \frac{\rho-r}{\rho\, \omega_n (\rho+r)^{n-1}} \dss{S}{y}
&= \frac{\rho^{n-2}(\rho-r)}{(\rho+r)^{n-1}} \left( \frac{1}{\omega_n \rho^{n-1}}
\int_{\partial B_\rho(\VEC{x}_0)} u(\VEC{y}) \dss{S}{y} \right) \\
&= \frac{\rho^{n-2}(\rho-r)}{(\rho+r)^{n-1}}\, u(\VEC{x}_0)
\end{split}
\end{equation}
because $u$ is harmonic in $\Omega$.  Similarly,
\begin{equation}\label{Harnack3}
\int_{\partial B_\rho(\VEC{x}_0)} u(\VEC{y}) \,
\frac{\rho+r}{\rho\, \omega_n (\rho-r)^{n-1}} \dss{S}{y}
= \frac{\rho^{n-2}(\rho+r)}{(\rho-r)^{n-1}}\, u(\VEC{x}_0) \ .
\end{equation}
Finally, we have from (\ref{laplace_ball_formula}) that
\begin{equation}\label{Harnack4}
\int_{\partial B_\rho(\VEC{x}_0)} u(\VEC{y})\, 
\frac{\rho^2-r^2}{\rho \, \omega_n \left\|\VEC{x}-\VEC{y}\right\|^n}
\dss{S}{y} = u(\VEC{x})
\end{equation}
for $\VEC{x} \in B_{\rho}(\VEC{x}_0)$.

We obtain the conclusion of the theorem by substituting
(\ref{Harnack2}), (\ref{Harnack3}) and (\ref{Harnack4}) in
(\ref{Harnack1}).
\end{proof}

\section{Harmonic Polynomials} \label{SectHramPoly}

In this section, we study the harmonic polynomials on
$\RR^n$.  They will be quite useful later.  In particular, in the
study of potential problem in the next chapter..

Let $\displaystyle P_k
= \big\{ \sum_{\VEC{\alpha} \in \NN^n,\ |\VEC{\alpha}| = k} a_{\VEC{\alpha}}
\VEC{x}^{\VEC{\alpha}} : a_{\VEC{\alpha}} \in \RR  \big\}$
and $H_k = \{ p \in P_k : \Delta p = 0 \}$.

\begin{prop} \label{PkHkrPkm2}
$P_k = H_k \oplus \|\VEC{x}\|_2^2 P_{k-2}$ and thus
$\displaystyle P_k = \bigoplus_{j=0}^{\intpt{k/2}} \|\VEC{x}\|^{2j} H_{k-2j}$.
\end{prop}

\begin{proof}
The direct sum in the statement of the proposition is based on a new
scalar product on the space $P_k$.  Given $p,q \in P_k$, we define the
scalar product of $p$ and $q$ as $\psP{p}{q} = p(\diff) q$, where
for $\displaystyle p = \sum_{\VEC{\alpha} \in \NN^n,\ |\VEC{\alpha}| = k}
a_{\VEC{\alpha}} \VEC{x}^{\VEC{\alpha}} \in P_k$, we set
$\displaystyle p(\diff) = \sum_{\VEC{\alpha} \in \NN^n,\ |\VEC{\alpha}| = k}
a_{\VEC{\alpha}} \diff^{\VEC{\alpha}}$.
It is easy to verify that this defines a scalar product on $P_k$.
In particular, we have that
\[
\psP{\VEC{x}^{\VEC{\alpha}}}{\VEC{x}^{\VEC{\beta}}} =
\begin{cases}
0 & \quad \text{if} \ \VEC{\alpha} \neq \VEC{\beta} \\
\VEC{\alpha}! & \quad \text{if} \ \VEC{\alpha} = \VEC{\beta} \\
\end{cases}
\]
Hence, for
$\displaystyle p = \sum_{\VEC{\alpha} \in \NN^n,\ |\VEC{\alpha}| = k}
a_{\VEC{\alpha}} \VEC{x}^{\VEC{\alpha}}$ and
$\displaystyle q = \sum_{\VEC{\alpha} \in \NN^n,\ |\VEC{\alpha}| = k}
b_{\VEC{\alpha}} \VEC{x}^{\VEC{\alpha}}$, we have that
$\displaystyle \psP{p}{q} = \sum_{\VEC{\alpha} \in \NN^n,\ |\VEC{\alpha}| = k}
a_{\VEC{\alpha}} b_{\VEC{\alpha}} \, \VEC{\alpha}!$.

We now show that the orthogonal complement of
$\displaystyle \|\VEC{x}\|_2^2 P_{k-2}$
in $P_k$ is $H_k$.  Since $q \in P_k$ is in the orthogonal complement 
of $\displaystyle \|\VEC{x}\|_2^2 P_{k-2}$ if and only if
$\displaystyle 0 = \psP{\|\VEC{x}\|_2^2\, p}{q} =  p(\diff) \Delta q
= \psP{p}{\Delta q}$ for all $p \in P_{k-2}$, in particular for
$\displaystyle p(\VEC{x}) = x^{\VEC{\alpha}}$ with $|\VEC{\alpha}| = k-2$,
we get that $\Delta q = 0$.  Thus $q \in H_k$.
\end{proof}

Since $\|\VEC{x}\|_2 = 1$ on
$\displaystyle \partial B_1(\VEC{0}) \subset \RR^n$, we
get the following corollary.

\begin{cor}
If $\displaystyle S = \partial B_1(\VEC{0}) \subset \RR^n$, then
$\displaystyle P_k\big|_S = \bigoplus_{j=0}^{\intpt{k/2}} H_{k-2j}\big|_S$.
\end{cor}

\begin{theorem} \label{L2DecHk}
If $\displaystyle S = \partial B_1(\VEC{0}) \subset \RR^n$, then
$\displaystyle L^2(S) = \sum_{k=0}^\infty H_k\big|_S$, where the sum
is a direct sum with respect to the standard scalar product on
$\displaystyle L^2(S)$.
\end{theorem}

\begin{proof}
Consider $\displaystyle f \in L^2(S)$ and $\epsilon >0$.  Since $C(S)$
is dense in $\displaystyle L^2(S)$, there exists a continuous function
$\tilde{f}$ on $S$ such that
\begin{equation} \label{HarmL2eq1}
  \|f - \tilde{f}\|_2 < \epsilon/2 \ .
\end{equation}
Using Weierstrass approximation theorem, there exists a polynomial $p$
such that
\begin{equation} \label{HarmL2eq2}
\sup_{\VEC{x} \in S} \big|\tilde{f}(\VEC{x}) - p(\VEC{x})\big|
< \epsilon/(2\sqrt{\omega_n}) \ .
\end{equation}
It follows from (\ref{HarmL2eq1}) and (\ref{HarmL2eq1}) that
$\|f - p \|_2 < \epsilon$.
It follows from the previous corollary that
$\displaystyle p\big|_S = \sum_{k=0}^K p_k$ with
$p_k \in H_k$, where $K$ is the degree of $p$.

Since $f$ and $\epsilon$ were arbitrary, this proves that
$\displaystyle L^2(S)$ is a sum of the $H_k\big|_S$.  To prove that it
is a direct sum, we have to show that $H_i \perp H_j$ if $i \neq j$.  Before
proving this result, we need to make the following observation.

Given $\displaystyle p = \sum_{\VEC{\alpha} \in \NN^n,\ |\VEC{\alpha}| = k}
a_{\VEC{\alpha}} \VEC{x}^{\VEC{\alpha}} \in P_k$, we have that
\begin{align*}
\sum_{s=1}^n x_s \pdfdx{p}{x_s}(\VEC{x})
& = \sum_{\VEC{\alpha} \in \NN^n,\ |\VEC{\alpha}| = k} a_{\VEC{\alpha}}
\left( \sum_{s=1}^n x_s \pdydx{}{x_s} \VEC{x}^{\VEC{\alpha}} \right)
 =  \sum_{\VEC{\alpha} \in \NN^n,\ |\VEC{\alpha}| = k} a_{\VEC{\alpha}}
\left( \sum_{s=1}^n \alpha_s \VEC{x}^{\VEC{\alpha}} \right) \\
&=  \sum_{\VEC{\alpha} \in \NN^n,\ |\VEC{\alpha}| = k} a_{\VEC{\alpha}}
\underbrace{\left( \sum_{s=1}^n \alpha_s\right)}_{=k} \VEC{x}^{\VEC{\alpha}}
= k p(\VEC{x}) \ .
\end{align*}
The equation above is known as {\bfseries Euler's relation}\index{Euler's
Relation}.

Given $p\in H_i$ and $q \in H_j$ with $i \neq j$, we get from the Green's
identity (\ref{laplace_green2}) on $B_1(\VEC{0})$ that
\[
  0 = \int_{B_1(\VEC{0})} (p \Delta q - q \Delta p) \dx{\VEC{x}}
= \int_S \left( p\,\pdydx{q}{\nu} - q \pdydx{p}{\nu} \right)
\dss{S}{x} = (j - i) \int_S p\,q \dss{S}{x}
= (j-i)\ps{p}{q} \ ,
\]
where we have use the fact that
\[
 \pdydx{p}{\nu}(\VEC{x})
 = \graD p(\VEC{x}) \cdot \VEC{x}
 = \sum_{s=1}^n x_s \pdfdx{p}{x_s}(\VEC{x}) = 
 = i p(\VEC{x})
\]
and similarly $\displaystyle \pdydx{q}{\nu}(\VEC{x}) = j q(\VEC{x})$
for $\VEC{x} \in S$.  Thus $\ps{p}{q} = 0$.  Since $p$ and $q$ are
arbitrary, $H_i \perp H_j$.
\end{proof}

A basis of $P_k$ is formed of the monomials
$\displaystyle \VEC{x}^{\VEC{\alpha}}$ with
$\displaystyle \VEC{\alpha} \in \NN^n$ and $|\VEC{\alpha}| = k$.
Suppose that you have a line of $n+k-1$ balls.  The number of possible
monomials of degree $k$ is the number of way to remove $n-1$ balls among the
$n+k-1$ balls to create at most $n$ groups of balls.  The number of
balls in the first group is the exponent of $x_1$, the number of balls
in the second group is the exponent of $x_2$, and so on.  Thus
$\displaystyle \dim P_k = \frac{(n+k-1)!}{(n-1)!\,k!}$.  It follows
from Proposition~\ref{PkHkrPkm2} that
\begin{align*}
\dim H_k &= \dim P_k - \dim P_{k-2}
= \frac{(n+k-1)!}{(n-1)!\,k!} - \frac{(n+k-3)!}{(n-1)!\,(k-2)!} \\
&= \big((n+k-1)(n+k-2) - k(k-1)\big)
\frac{(n+k-3)!}{(n-1)!\,k!}
= (2k + n - 2)\, \frac{(n+k-3)!}{(n-2)!\,k!} \ .
\end{align*}
We get the following result.

\begin{prop} \label{HkOknm2}
$d_k \equiv \dim H_k = O(k^{n-2})$ as $k \to \infty$.
\end{prop}

\begin{proof}
For $k>3$, we have that
\begin{align*}
\frac{d_k}{k^{n-2}}
&= \frac{(2k + n - 2)}{(n-2)!\,k^{n-2}}\,
(n+k-3)(n+k-2)\ldots (k+1) \\
&= \left(2 + \frac{n - 2}{k}\right)\,
\frac{1}{(n-2)!}
\left(1 + \frac{n-3}{k}\right)\left(1 + \frac{n-2}{k}\right)\ldots
\left(1 + \frac{1}{k}\right) \to \frac{2}{(n-2)!} \neq 0
\end{align*}
as $k \to \infty$.
\end{proof}

Let $\displaystyle S = \partial B_1(\VEC{0}) \subset \RR^n$.
For each $\VEC{x} \in S$, the mapping
\begin{align*}
  \phi_{\VEC{x}}: H_k\big|_S &\to \RR \\
  p &\mapsto p(\VEC{x})
\end{align*}
is a linear functional on the finite dimensional vector subspace
$\displaystyle H_k\big|_S$ of $L^2(S)$.  From the finite dimensional
version of the Riesz Representation Theorem, there exists
$\displaystyle p_{\VEC{x}}^{[k]}\in H_k\big|_S$ such that 
\[
  p(\VEC{x}) = \phi_{\VEC{x}}(p) = \ps{p}{p_{\VEC{x}}^{[k]}}
  = \int_S p(\VEC{y})\,p_{\VEC{x}}^{[k]}(\VEC{y}) \dss{S}{y}
\]
for all $\displaystyle p \in H_k\big|_S$.

\begin{prop} \label{L2NormPx}
$\displaystyle \left\| p_{\VEC{x}}^{[k]} \right\|_2 = \sqrt{d_k/\omega_n}$ and
$\displaystyle \left\| p_{\VEC{x}}^{[k]} \right\|_\infty = d_k/\omega_n$.  
\end{prop}

\begin{proof}
\stage{i} Let $\displaystyle R:\RR^n \to \RR^n$ be a rotation.  Using
$R$ has a change of variable on $S$, we get
\begin{align*}
\ps{p}{p_{R(\VEC{x})}^{[k]}\circ R}
&= \int_S p(\VEC{y})\, p_{R(\VEC{x})}^{[k]}(R(\VEC{y})) \dss{S}{y}  
= \int_S p(R^{-1}(\VEC{y}), p_{R(\VEC{x})}^{[k]}(\VEC{y})
\underbrace{|\det R^{-1}(\VEC{y})|}_{=1} \dss{S}{y} \\
&= \ps{p\circ R^{-1}}{p_{R(\VEC{x})}^{[k]}}
= (p\circ R^{-1})(R(\VEC{x})) = p(\VEC{x})
\end{align*}
for all $\displaystyle p \in H_k\big|_S$.  Since
$\displaystyle p_{\VEC{x}}^{[k]}$ is the
unique element of $H_k\big|_S$ such that
$\displaystyle p(\VEC{x}) = \ps{p}{p_{\VEC{x}}^{[k]}}$ for all
$\displaystyle p \in H_k\big|_S$, we have that
$\displaystyle p_{\VEC{x}}^{[k]} = p_{R(\VEC{x})}^{[k]}\circ R$ for
all rotation $R$.

It follows that
$\displaystyle p_{\VEC{x}}^{[k]}(\VEC{x}) = p_{R(\VEC{x})}^{[k]}(R(\VEC{x}))$
for all $\VEC{x} \in S$.  Thus
$\displaystyle p_{\VEC{x}}^{[k]}(\VEC{x})$ is constant for
$\VEC{x} \in S$.

\stage{ii}
Let $\displaystyle \left\{ p_j\right\}_{j=1}^{d_k}$ be an orthonormal basis of
$\displaystyle H_k\big|_S \subset L^2(S)$.  We note that
\begin{equation} \label{pxSizeeq1}
p_{\VEC{x}}^{[k]}(\VEC{y})
= \sum_{j=1}^{d_k} \ps{p_{\VEC{x}}^{[k]}}{p_j}\, p_j(\VEC{y})
= \sum_{j=1}^{d_k} \ps{p_j}{p_{\VEC{x}}^{[k]}}\, p_j(\VEC{y})
= \sum_{j=1}^{d_k} p_j(\VEC{x}) \, p_j(\VEC{y})
\end{equation}
for all $\VEC{y} \in S$.  Thus,
\[
p_{\VEC{x}}^{[k]}(\VEC{x}) = \sum_{j=1}^{d_k} (p_j(\VEC{x}))^2
\]
for all $\VEC{x} \in S$.  Hence,
\[
d_k = \sum_{j=1}^{d_k} \|p_j\|_2^2
= \int_S \left( \sum_{j=1}^{d_k} (p_j(\VEC{x}))^2 \right) \dss{S}{x} 
= \int_S \left( p_{\VEC{x}}^{[k]}(\VEC{x}) \right) \dss{S}{x}
= p_{\VEC{x}}^{[k]}(\VEC{x}) \int_S \dss{S}{x} 
= \omega_n\, p_{\VEC{x}}^{[k]}(\VEC{x}) \ .
\]
We deduce that
$\displaystyle p_{\VEC{x}}^{[k]}(\VEC{x}) = d_k/\omega_n$.

\stage{iii} It follows from (\ref{pxSizeeq1}) that
\[
\left\|p_{\VEC{x}}^{[k]}\right\|_2^2 = \ps{p_{\VEC{x}}^{[k]}}{p_{\VEC{x}}^{[k]}}
= \sum_{i,j=1}^{d_k} p_j(\VEC{x}) p_i(\VEC{x}) \, \ps{p_j}{p_i}
= \sum_{j=1}^{d_k} \left(p_j(\VEC{x})\right)^2 = p_{\VEC{x}}^{[k]}(\VEC{x})
= \frac{d_k}{\omega_n} \ .
\]

\stage{iv}
Since $\displaystyle p_{\VEC{x}}^{[k]}(\VEC{y})
= \ps{p_{\VEC{x}}^{[k]}}{p_{\VEC{y}}^{[k]}}$ for all
$\VEC{x},\VEC{y} \in S$ by definition of
$\displaystyle p_{\VEC{y}}^{[k]}$, we have that
\[
  \left| p_{\VEC{x}}^{[k]}(\VEC{y}) \right|
= \left| \ps{p_{\VEC{x}}^{[k]}}{p_{\VEC{y}}^{[k]}} \right|
\leq \left\|p_{\VEC{x}}^{[k]}\right\|_2 \left\|p_{\VEC{y}}^{[k]}\right\|_2
\leq \frac{d_k}{\omega_n}
\]
for all $\VEC{y} \in S$.  Thus
$\displaystyle \left\|p_{\VEC{x}}^{[k]}\right\|_\infty
= \sup_{\VEC{y} \in S} \left| p_{\VEC{x}}^{[k]}(\VEC{y}) \right| \leq
\frac{d_k}{\omega_n}$.  However, we have that
$\displaystyle p_{\VEC{x}}^{[k]}(\VEC{x}) = \frac{d_k}{\omega_n}$.
Thus
$\displaystyle \left\|p_{\VEC{x}}^{[k]}\right\|_\infty
= \frac{d_k}{\omega_n}$.
\end{proof}

\begin{theorem} \label{L2AbsConvUrx}
Let $\displaystyle S = \partial B_1(\VEC{0}) \subset \RR^n$.
Given $\displaystyle g \in L^2(S)$.  The function
$u: \overline{B_1(\VEC{0})} \to \RR$
defined by
\begin{equation} \label{L2AbsConvUrxEq1}
u(\VEC{x}) = \sum_{k=0}^\infty \|\VEC{x}\|^k
\ps{g}{p_{\|\VEC{x}\|^{-1}\VEC{x}}^{[k]}}
\end{equation}
is an harmonic function on $B_1(\VEC{0})$ and satisfies $u = g$
in $\displaystyle L^2(S)$.  More specifically,
{\renewcommand{\labelenumi}{\roman{enumi})}
\begin{enumerate}
\item The series in (\ref{L2AbsConvUrxEq1}) is absolutely and
uniformly convergent on $\overline{B_r(\VEC{0})}$ for every $0 \leq r <1$.
\item The series $\displaystyle
\sum_{k=0}^\infty r^k \ps{f}{p_{\VEC{x}}^{[k]}}$ for $\VEC{x} \in S$ is
convergent in $\displaystyle L^2(S)$ for every $0 \leq r \leq 1$.
\item If we define
\[
u_r(\VEC{x}) \equiv u(r\VEC{x}) = \sum_{k=0}^\infty r^k \ps{g}{p_{\VEC{x}}^{[k]}}
\]
for all $\VEC{x} \in S$, then $u_r \to u_1 = g$ as $r\to 1^-$ in
$\displaystyle L^2(S)$.
\end{enumerate}
}
\end{theorem}

\begin{proof}
Let us first show that the orthogonal projection
$\displaystyle \pi_k:L^2(S) \to H_k\big|_S$ is
given by $\displaystyle \pi_k(g)(\VEC{x}) = \ps{g}{p_{\VEC{x}}^{[k]}}$
for $\VEC{x} \in S$.
According to Theorem~\ref{L2DecHk}, we have that $g = \pi_k(g) + h$
where $\displaystyle h \in \left(H_k\big|_S\right)^\perp$.  Thus, since
$\displaystyle p_{\VEC{x}}^{[k]} \in H_k\big|_S$, we have that
\[
\ps{g}{p_{\VEC{x}}^{[k]}} = \ps{\pi_k(g)}{p_{\VEC{x}}^{[k]}}
+ \ps{h}{p_{\VEC{x}}^{[k]}}
= \ps{\pi_k(g)}{p_{\VEC{x}}^{[k]}} = \pi_k(g)(\VEC{x})
\]
for all $\VEC{x} \in S$.  Therefore, there exists a unique
$\phi_k \in H_k$ such that
$\displaystyle \phi_k(\VEC{x}) = \ps{g}{p_{\VEC{x}}^{[k]}}$
for all $\VEC{x} \in S$.  Note that
$\displaystyle \phi_k(\VEC{x})
= \|\VEC{x}\|^k \phi_k\left(\left\|\VEC{x}\|^{-1} \, \VEC{x}\right\|\right)
= r^k \phi_k(\VEC{y})$ if $\VEC{x} = r \VEC{y}$ with $\VEC{y} \in S$
because $\phi_k$ is homogeneous of degree $k$.

\stage{i} Choose $0 < r < 1$.  It follows from Propositions~\ref{HkOknm2} and
\ref{L2NormPx} that
\[
\|p_{\VEC{x}}^{[k]}\|_2^2
= \int_S \left|p_{\VEC{x}}^{[k]}(\VEC{y})\right|^2 \dss{S}{y}
\leq C (1+k)^{n-2}
\]
for a constant $C$ \footnote{We have to use $(1+k)^{n-2}$ instead of
$k^{n-2}$ as predicted by (\ref{HkOknm2}) to handle the case $k=0$.}
and all $\VEC{x} \in S$.  Hence, for all
$\VEC{x} \in \overline{B_r(\VEC{0})} \setminus\{\VEC{0}\}$,
we have that
\begin{align*}
\sum_{k=0}^\infty \left| \phi_k(\VEC{x}) \right|
&= \sum_{k=0}^\infty \left| \|\VEC{x}\|^k
\phi_k\left( \|\VEC{x}\|^{-1}\VEC{x}\right) \right|
=\sum_{k=0}^\infty \left| \|\VEC{x}\|^k
\ps{g}{p_{\|\VEC{x}\|^{-1}\VEC{x}}^{[k]}} \right|
\leq \sum_{k=0}^\infty r^k \|g\|_2\,
\left\|p_{\|\VEC{x}\|^{-1}\VEC{x}}^{[k]}\right\|_2 \\
&\leq \sqrt{C} \, \|g\|_2 \sum_{k=0}^\infty r^k (1+k)^{(n-2)/2}  < \infty
\end{align*}
because the last series converges according to the ratio test.
We therefore have that the series 
$\displaystyle \sum_{k=0}^\infty \phi_k$ is absolutely and uniformly
convergent on $\overline{B_r(\VEC{0})}$.  It follows from
Corollary~\ref{UnifConvHarm} that
$\displaystyle u = \sum_{k=0}^\infty \phi_k$ is
harmonic on $B_r(\VEC{0})$.

\stage{ii} Since $\displaystyle \phi_k = \pi_k(g)$ on $S$, it follows
from Theorem~\ref{L2DecHk} that
$\displaystyle \sum_{k=0}^\infty \phi_k$ converges to $g$ in
$\displaystyle L^2(S)$.  Moreover,
$\displaystyle \|g\|_2^2 = \sum_{j=0}^\infty \left\|\phi_k\right\|_2^2 < \infty$
where $\displaystyle \|\phi_k\|_2
= \left( \int_S |\phi_k(\VEC{x})|^2 \dss{S}{x}\right)^{1/2}$.
Since $\displaystyle r^k\phi_k$ is in $\displaystyle H_k\big|_S$ and
$\displaystyle \sum_{j=0}^\infty \left\|r^k\phi_k\right\|_2^2
\leq \sum_{j=0}^\infty \left\|\phi_k\right\|_2^2 < \infty$ for
$0 \leq r \leq 1$, it follows again from Theorem~\ref{L2DecHk} that
$\displaystyle \sum_{j=0}^\infty r^k\phi_k$ converges in $\displaystyle L^2(S)$
for $0 \leq r \leq 1$.

\stage{iii} We have that $\displaystyle u_r = \sum_{j=0}^\infty r^k\phi_k$
on $S$.  It follows from (ii) that $\displaystyle u_r \in L^2(S)$ for
$0\leq r \leq 1$ because the series that defined $u_r$ converges in
$\displaystyle L^2(S)$.  Hence,
\begin{align*}
\left\| u_r- u_1 \right\|_2
\leq \left\| u_r - \sum_{k=0}^K r^k \phi_k \right\|_2
+ \left\| \sum_{k=0}^K r^k \phi_k - \sum_{k=0}^K \phi_k \right\|_2
+ \left\| \sum_{k=0}^K \phi_k - u_1 \right\|_2
\end{align*}
for $K>0$.
Given $\epsilon >0$, choose $K$ large enough to have the first and
third norms smaller than $\epsilon/3$.  This is possible because of (ii).
Since $S$ is a compact set, there exists $0<R<1$ such that
\[
  (1-r^k) \sup_{\VEC{x} \in S} \sum_{k=0}^K \left|\phi_k(\VEC{x}) \right|
< \frac{\epsilon}{3 \sqrt{\omega_n}}
\]
for $R <r \leq 1$.  Thus, for $R < r \leq 1$, the second norm is
smaller than $\epsilon/3$ and it follows that
$\| u_r - u_1\| \leq \epsilon$ for $R < r \leq 1$.
\end{proof}

\begin{cor} \label{L2AbsConvUrxCor}
Let $\displaystyle S = \partial B_1(\VEC{0}) \subset \RR^n$.
The Poisson kernel $P$ for the Dirichlet problem in the ball
$B_1(\VEC{0})$ given in (\ref{laplace_green_ball}) can be expressed as
\[
  P(\VEC{x},\VEC{y}) = \sum_{k=0}^\infty \|\VEC{x}\|^k
p_{\|\VEC{x}\|^{-1}\VEC{x}}^{[k]}(\VEC{y})
\]
for $\VEC{x} \in B_1(\VEC{0})$ and $\VEC{y} \in S$.  The series
is uniformly convergent on $\overline{B_r(\VEC{x})}$ for every
$0 \leq r<1$.

If $g\in C(S)$, then $u$ defined in (\ref{L2AbsConvUrxEq1}) is
the unique harmonic function on $B_1(\VEC{0})$ which is continuous on
$\overline{B_1(\VEC{0})}$ and satisfies $u = g$ on $S$.
\end{cor}

\begin{proof}
Given $0 < r < 1$, it follows from Propositions~\ref{HkOknm2} and
\ref{L2NormPx} that
$\displaystyle \|p_{\VEC{x}}^{[k]}\|_\infty \leq C (1+k)^{n-2}$
for a constant $C$ \footnote{We have to use $(1+k)^{n-2}$ instead of
$k^{n-2}$ as predicted by Proposition~\ref{HkOknm2} to handle the case $k=0$.}
and all $\VEC{x} \in S$.  Hence, for all
$\VEC{x} \in \overline{B_r(\VEC{0})} \setminus\{\VEC{0}\}$,
we have that
\begin{align*}
\sum_{k=0}^\infty \left| \|\VEC{x}\|^k
p_{\|\VEC{x}\|^{-1}\VEC{x}}^{[k]}(\VEC{y}) \right|
\leq \sum_{k=0}^\infty r^k \left\|p_{\|\VEC{x}\|^{-1}\VEC{x}}^{[k]}\right\|_\infty
\leq C \sum_{k=0}^\infty  r^k (1+k)^{n-2}  < \infty
\end{align*}
because the last series converges according to the ratio test.
We therefore have that the series 
$\displaystyle \sum_{k=0}^\infty \|\VEC{x}\|^k
p_{\|\VEC{x}\|^{-1}\VEC{x}}^{[k]}(\VEC{y})$
is absolutely and uniformly
convergent on $\overline{B_r(\VEC{0})}$, and the limit is a continuous
function on $\overline{B_r(\VEC{0})}$ which is harmonic on $B_r(\VEC{0})$.

Suppose that $\displaystyle g \in L^2(\Omega)$.
It follows from Theorems~\ref{laplace_exist_ball} and
\ref{L2AbsConvUrx} that the harmonic function $u$ in
$B_1(\VEC{0})$ with $u=g$ in $\displaystyle L^2(S)$ satisfies
\begin{equation} \label{PoissonKernHarmExp}
\begin{split}
\int_S g(\VEC{y}) \, P(s\VEC{x},\VEC{y}) \dss{S}{y}
&= u(s\VEC{x}) = \sum_{k=0}^\infty s^k \ps{g}{p_{\VEC{x}}^{[k]}}
= \sum_{k=0}^\infty s^k \int_S g(\VEC{y}) p_{\VEC{x}}^{[k]}(\VEC{y}) \dss{S}{y} \\
&= \int_S g(\VEC{y}) \left(\sum_{k=0}^\infty s^k
p_{\VEC{x}}^{[k]}(\VEC{y})\right) \dss{S}{y}
\end{split}
\end{equation}
for all $\VEC{x} \in S$ and $0 \leq s \leq r$.
We have used the uniform convergence of
$\displaystyle \sum_{k=0}^\infty \|\VEC{x}\|^k
p_{\|\VEC{x}\|^{-1}\VEC{x}}^{[k]}(\VEC{y})$ on
$\displaystyle \overline{B_r(\VEC{0})}$ to interchange the sum
and the integral in the equation above.  

Since (\ref{PoissonKernHarmExp}) is true for all functions
$\displaystyle g\in L^2(S)$,
we have that
$\displaystyle P(s\VEC{x},\VEC{y})
= \sum_{k=0}^\infty s^k p_{\VEC{x}}^{[k]}(\VEC{y})$ for almost all
$\VEC{y} \in S$.  Moreover, since
$\displaystyle \VEC{y} \mapsto P(s\VEC{x},\VEC{y})$ and
$\displaystyle \VEC{y} \mapsto
\sum_{k=0}^\infty s^k p_{\VEC{x}}^{[k]}(\VEC{y})$ are
continuous on $\VEC{y} \in S$, we get that
$\displaystyle P(s\VEC{x},\VEC{y})
= \sum_{k=0}^\infty s^k p_{\VEC{x}}^{[k]}(\VEC{y})$ for all
$\VEC{y} \in S$.  This is true for all $\VEC{x} \in S$ and all
$0 \leq s \leq r$.

If $g \in C(S)$, then it follows from Theorem~\ref{laplace_exist_ball} that
\[
u(\VEC{x}) = \int_{\partial B_1(\VEC{0})} g(\VEC{y}) \,
P(\VEC{x},\VEC{y}) \dss{S}{y}
= \sum_{k=0}^\infty \|\VEC{x}\|^k \ps{g}{p_{\|\VEC{x}\|^{-1} \VEC{x}}^{[k]}}
\]
$u$ can be continuously extended to $\overline{B_1(\VEC{0})}$ by
$u(\VEC{x}) = g(\VEC{x})$ for $\VEC{x} \in S$.
The uniqueness of $u$ then comes from Theorem~\ref{laplace_uniqu_th}.
\end{proof}

\section{Reflection Principle}

In complex analysis, we have a reflection principle to expand an
harmonic function defined for the complex numbers with non-negative
imaginary part and null on the real axis to an harmonic function on
the entire complex plan.  There is an equivalent result for harmonic
functions in $\displaystyle \RR^n$.

\begin{theorem}[Reflection Principle] \label{laplace_refl_pr}
Let $\displaystyle \Omega \subset \RR^n$ be an open subset, symmetric
with respect to the hyperplane $x_n=0$; namely,
$(\breve{\VEC{x}},x_n) \in \Omega$ if and only if 
$(\breve{\VEC{x}},-x_n) \in \Omega$.  Let
$\displaystyle \Omega_+
= \left\{ (\breve{\VEC{x}},x_n) \in \Omega : x_n>0 \right\}$,
$\displaystyle \Omega_-
= \left\{ (\breve{\VEC{x}},x_n) \in \Omega : x_n<0 \right\}$ and
$\displaystyle \Omega_0 = \left\{ (\breve{\VEC{x}},0) \in \Omega \right\}$.
Suppose that $u:\Omega_+\cup \Omega_0 \rightarrow \RR$ is continuous,
harmonic in $\Omega_+$ and $u(\VEC{x})=0$ for $\VEC{x} \in \Omega_0$.
Then $u$ can be extended to an harmonic function on $\Omega$ by
$u(\breve{\VEC{x}},x_n) = -u(\breve{\VEC{x}},-x_n)$ for
$(\VEC{x},x_n)\in \Omega_-$.
\end{theorem}

\pdfF{laplace/laplace_fig4}{Reflection Principle for harmonic functions}
{Figure used in the proof of the reflection principle,
Theorem~\ref{laplace_refl_pr}, for harmonic functions.}{laplace_FIG4}

\begin{proof}
In this proof, we refer to Figure~\ref{laplace_FIG4}.
The extension is obviously continuous on $\Omega$ because $u$ is
continuous on $\Omega_+\cup \Omega_0$ and null on $\Omega_0$.
Moreover, the extension of $u$ is harmonic on $\Omega \setminus \Omega_0$.
We need only prove that $u$ is harmonic in a neighbourhood of an
arbitrary point $\VEC{x}_0 = (\breve{\VEC{x}}_0,0) \in \Omega_0$.

Choose $\delta >0$ such that $\overline{B_\delta(\VEC{x}_0)} \subset \Omega$.
According to Remark~\ref{laplace_exist_a_ball}, the solution of the
Dirichlet problem
$\Delta v = 0$ on $B_\delta(\VEC{x}_0)$ with the boundary condition $v=u$ on
$\partial B_\delta(\VEC{x}_0)$ is
\[
v(\VEC{x}) = \int_{\partial B_\delta(\VEC{x}_0)} u(\VEC{y}) \,
\frac{\delta^2-\left\|\VEC{x}-\VEC{x}_0\right\|^2}
{\delta \, \omega_n \left\|\VEC{x}-\VEC{y}\right\|^n} \dss{S}{y}
\]
for $\VEC{x} \in B_\delta(\VEC{x}_0)$.
For $(\breve{\VEC{x}},x_n) \in B_\delta(\VEC{x}_0)$, we have
$\displaystyle \|(\breve{\VEC{x}},x_n)-\VEC{x}_0\| =
\|(\breve{\VEC{x}},-x_n)-\VEC{x}_0\|$
and
$\displaystyle \|(\breve{\VEC{x}},x_n)-(\breve{\VEC{y}},y_n)\| =
\|(\breve{\VEC{x}},-x_n)-(\breve{\VEC{y}}, -y_n)\|$.
Hence
\begin{align*}
v(\breve{\VEC{x}},x_n) &=
\int_{\partial B_\delta(\VEC{x}_0)} u(\breve{\VEC{y}},y_n) \,
\frac{\delta^2-\left\| (\breve{\VEC{x}},x_n) - \VEC{x}_0\right\|^2}
{\delta \, \omega_n \left\|(\breve{\VEC{x}},x_n)
-(\breve{\VEC{y}},y_n) \right\|^n} \dss{S}{y} \\
&= \int_{\partial B_\delta(\VEC{x}_0)} u(\breve{\VEC{y}},y_n) \,
\frac{\delta^2-\left\| (\breve{\VEC{x}},-x_n) - \VEC{x}_0\right\|^2}
{\delta \, \omega_n \left\|(\breve{\VEC{x}},-x_n) -
(\breve{\VEC{y}},-y_n) \right\|^n} \dss{S}{y} \\
&= \int_{\partial B_\delta(\VEC{x}_0)}
u(\breve{\VEC{y}},-y_n) \,
\frac{\delta^2-\left\| (\breve{\VEC{x}},-x_n) - \VEC{x}_0\right\|^2}
{\delta \, \omega_n \left\|(\breve{\VEC{x}},-x_n) -
(\breve{\VEC{y}},y_n) \right\|^n} \dss{S}{y} \\
&= -\int_{\partial B_\delta(\VEC{x}_0)}
u(\breve{\VEC{y}},y_n) \,
\frac{\delta^2-\left\| (\breve{\VEC{x}},-x_n) - \VEC{x}_0\right\|^2}
{\delta \, \omega_n \left\|(\breve{\VEC{x}},-x_n) -
(\breve{\VEC{y}},y_n) \right\|^n} \dss{S}{y} =
-v(\breve{\VEC{x}},-x_n)
\end{align*}
for all $(\breve{\VEC{x}},x_n) \in B_\delta(\VEC{x}_0)$.  We have
used the symmetry of $\partial B_\delta(\VEC{x}_0)$ with respect to
the hyperplane $y_n=0$ for the third equality and
$u(\breve{\VEC{y}},-y_n) = -u(\breve{\VEC{y}},y_n)$ for the last
equality.  It follows from this identity that
$v(\breve{\VEC{x}},0) = - v(\breve{\VEC{x}},0)$ for
all $(\breve{\VEC{x}},0) \in \Omega_0 \cap B_\delta(\VEC{x}_0)$.  Thus
$v(\breve{\VEC{x}},0) = u(\breve{\VEC{x}},0)= 0$ for all
$(\breve{\VEC{x}},0) \in \Omega_0 \cap B_\delta(\VEC{x}_0)$. 

Let $B_+ = B_\delta(\VEC{x}_0) \cap \Omega_+$.  Since $u=v$ on
$\partial B_+$ and both $u$ and $v$ are harmonic in $B_+$, we have by
uniqueness of solutions that $u=v$ in $B_+$.  For similar reasons,
$u = v$ on $B_- = B_\delta(\VEC{x}_0) \cap \Omega_-$.  Thus, 
since $u=v$ on $B_\delta(\VEC{x}_0) \cap \Omega_0$, we get that
$u=v$ on $B_\delta(\VEC{x}_0)$.  In particular, $u$ is harmonic in
$B_\delta(\VEC{x}_0)$.
\end{proof}

\section{Perron's Method}

In Section~\ref{potential_sect}, we ``give'' the solution of the
Dirichlet problem using potential theory.  In this section, we prove
the existence of the solution of the Dirichlet problem on a bounded
open subset of $\displaystyle \RR^n$ using subharmonic functions.
This method is known as Perron's method.  It is valid for a more
general type of boundaries than the method used in
Section~\ref{potential_sect}.  However, both methods relies upon the
knowledge of the existence of the solution for the Dirichlet problem
on $B_1(\VEC{0})$ given before.  Perron's method only proves the
existence of the solution but does not provide a formula for the
solution as it is done in Section~\ref{potential_sect}.

In this section, we follow the presentation in \cite{J}.

\begin{defn}
Suppose that $\Omega$ is an open subset of $\displaystyle \RR^n$ and that
$u \in C(\Omega)$.  Given $\VEC{z} \in \Omega$ and $\rho >0$ such that
$\overline{B_{\rho}(\VEC{z})} \subset \Omega$, we define a new
continuous function $u_{\VEC{z},\rho}:\Omega \to \RR$ by
\[
u_{\VEC{z},\rho} =
\begin{cases}
u(\VEC{x}) & \quad \text{if} \ \VEC{x} \in \Omega \setminus B_{\rho}(\VEC{z}) \\
v(\VEC{x}) & \quad \text{if} \ \VEC{x} \in B_{\rho}(\VEC{z})
\end{cases}
\]
where $v: B_{\rho}(\VEC{z}) \to \RR$ is the solution of the Dirichlet
problem $\Delta v = 0$ on $B_{\rho}(\VEC{z})$ with $v(\VEC{x}) = u(\VEC{x})$
for $\VEC{x} \in \partial B_{\rho}(\VEC{z})$.
\end{defn}

\begin{lemma} \label{PerronLem1}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$ and $u \in \Omega$ be a
subharmonic function.   Suppose that $\VEC{z} \in \Omega$
and $\overline{B_{\rho}(\VEC{z})} \subset \Omega$ for some $\rho >0$.  Then
$u(\VEC{x}) \leq u_{\VEC{z},\rho}(\VEC{x})$ for all $\VEC{x} \in \Omega$,
and $u_{\VEC{z},\rho}:\Omega \to \RR$ is subharmonic.
\end{lemma}

\begin{proof}
\stage{i} We have that $u(\VEC{x}) \leq u_{\VEC{z},\rho}(\VEC{x})$ for
all $\VEC{x} \in \Omega \setminus B_{\rho}(\VEC{z})$ by definition of
$u_{\VEC{z},\rho}$.
Since $u - u_{\VEC{z},\rho}$ is a subharmonic function on $B_{\rho}(\VEC{z})$,
is continuous on $\overline{B_{\rho}(\VEC{z})}$, and satisfies
$(u-u_{\VEC{z},\rho})(\VEC{x}) = 0$ for all
$\VEC{x} \in \partial B_{\rho}(\VEC{z})$,
it follows from the Maximum Principle Theorem,
Theorem~\ref{laplace_HMP}, that $(u-u_{\VEC{z},\rho})(\VEC{x}) \leq 0$
for all $\VEC{x} \in \overline{B_r(\VEC{z})}$; namely,
$u(\VEC{x}) \leq u_{\VEC{z},\rho}(\VEC{x})$
for all $\VEC{x} \in \overline{B_r(\VEC{z})}$.

\stage{ii}  Since $u_{\VEC{z},\rho} = u$ on the open set
$\Omega \setminus \overline{B_{\rho}(\VEC{z})}$, we have that
$u_{\VEC{z},\rho}$ is subharmonic on
$\Omega \setminus \overline{B_{\rho}(\VEC{z})}$.
Since $u_{\VEC{z},\rho}$ is harmonic on $B_\rho(\VEC{z})$, then
$u_{\VEC{z},\rho}$ is subharmonic on $B_\rho(\VEC{z})$.

To prove that $u_{\VEC{z},\rho}$ is subharmonic on $\Omega$, we need
to show that for every $\VEC{x} \in \partial B_{\rho}(\VEC{z})$, we
can find $R>0$ such that $B_r(\VEC{x}) \subset \Omega$ and
$u_{\VEC{z},\rho}(\VEC{x}) \leq M_{u_{\VEC{z},\rho}}(\VEC{x},r)$
for all $0 < r < R$.

Consider $\VEC{x} \in \partial B_{\rho}(\VEC{z})$.  Since $u$ is
subharmonic on $\Omega$, there exists $R>0$ such that
$B_r(\VEC{x}) \subset \Omega$ and $u(\VEC{x}) \leq M_u(\VEC{x},r)$
for all $0 < r < R$.  But $u(\VEC{x}) = u_{\VEC{z},\rho}(\VEC{x})$ because
$\VEC{x} \in \partial B_{\rho}(\VEC{z})$, and
$u(\VEC{x}) \leq u_{\VEC{z},\rho}(\VEC{x})$ for all $\VEC{x} \in \Omega$.
Thus,
$u_{\VEC{z},\rho}(\VEC{x}) = u(\VEC{x}) \leq M_u(\VEC{x},r)
\leq M_{u_{\VEC{z},\rho}}(\VEC{x},r)$
for all $0 < r < R$.
\end{proof}

\begin{lemma} \label{PerromLem2}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$ and $u \in \Omega$ is a
subharmonic function.   Suppose that $\VEC{z} \in \Omega$
and $\overline{B_{\rho}(\VEC{z})} \subset \Omega$ for some $\rho >0$.  Then
$u(\VEC{z}) \leq M_u(\VEC{z},\rho)$
\end{lemma}

\begin{proof}
We have that
$\displaystyle
u(\VEC{z}) \leq u_{\VEC{z},\rho}(\VEC{z}) = M_{u_{\VEC{z},\rho}}(\VEC{z},\rho)
= M_u(\VEC{z},\rho)$,
where the first inequality is a consequence of the previous lemma, the
first equality is true because $u_{\VEC{z},\rho}$ is harmonic on
$B_{\rho}(\VEC{z})$, and the last equality is true because
$u_{\VEC{z},\rho}(\VEC{x}) = u(\VEC{x})$ for all
$\VEC{x} \in \partial B_{\rho}(\VEC{z})$.
\end{proof}

\begin{lemma}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$ and $u \in C(\Omega)$.
$u$ is harmonic on $\Omega$ if and only if $u$ and $-u$ are
subharmonic on $\Omega$.
\end{lemma}

\begin{proof}
\stage{$\mathbf{\Rightarrow}$}
If $u$ is harmonic on $\Omega$ then $u$ and $-u$ are harmonic functions
and so also subharmonic on $\Omega$.

\stage{$\mathbf{\Leftarrow}$}
Suppose that $u$ and $-u$ are subharmonic functions on $\Omega$.
Given $\VEC{z} \in \Omega$ and $\rho >0$ such that
$\overline{B_{\rho}(\VEC{z})} \subset \Omega$, we have from
Lemma~\ref{PerronLem1} that
$u(\VEC{x}) \leq u_{\VEC{z},\rho}(\VEC{x})$ and
$-u(\VEC{x}) \leq -u_{\VEC{z},\rho}(\VEC{x})$ for all
$\VEC{x} \in B_{\rho}(\VEC{z})$.  Thus,
$u = u_{\VEC{z},\rho}$ on $B_{\rho}(\VEC{z})$.  Since 
$u_{\VEC{z},\rho}$ is harmonic on $B_{\rho}(\VEC{z})$, we have that
$u$ is harmonic on $B_{\rho}(\VEC{z})$.  Since this is true for all
$\VEC{z} \in \Omega$ and $\rho>0$ such that
$\overline{B_{\rho}(\VEC{z})} \subset \Omega$, then $u$ is harmonic on
$\Omega$.
\end{proof}

\begin{lemma}
Let $\Omega$ be an open subset of $\displaystyle \RR^n$ and $u \in C(\Omega)$.
If, for each $\VEC{x} \in \Omega$, there exists $R>0$ (that may depends
on $\VEC{x}$) such that $B_R(\VEC{x}) \subset \Omega$ and
$u(\VEC{x}) = M_u(\VEC{x},r)$ for $0 < r < R$, then
$u$ is harmonic on $\Omega$.
\end{lemma}

\begin{proof}
The assumption of the lemma implies that $u$ and $-u$ are subharmonic
on $\Omega$.  The conclusion of the lemma follows from the previous
lemma.
\end{proof}

Suppose that $\Omega$ is an bounded open subset of $\displaystyle \RR^n$
and that $\displaystyle f: \partial \Omega \to \RR$ is a continuous
function.  We define the set
\[
\Sigma_f = \left\{ u \in C(\overline{\Omega}) :
u \ \text{is subharmonic on} \ \Omega \ \text{and} \ u(\VEC{x}) \leq f(\VEC{x})
\ \text{for all} \ \VEC{x} \in \partial \Omega \right \}
\]
and the function
\begin{align*}
u_f : \overline{\Omega} &\to \RR \\
\VEC{x} &\mapsto \sup_{u \in \Sigma_f} u(\VEC{x})
\end{align*}
We obviously need to justify why $u_f$ is well defined.
Since $f$ is continuous on the compact set $\partial \Omega$, we have
that
$\displaystyle m = \min_{\VEC{x} \in \partial \Omega} f(\VEC{x})
> -\infty$ and
$\displaystyle M = \max_{\VEC{x} \in \partial \Omega} f(\VEC{x})
< \infty$.  The function $u_m:\overline{\Omega} \to \RR$ defined by
$u_m(\VEC{x}) = m$ for all $\VEC{x} \in \overline{\Omega}$ belongs to
$\Sigma_f$.  So, $\Sigma_f \neq \emptyset$.  It also follows from the
Maximum Principle Theorem that
$\displaystyle \sup_{\VEC{x} \in \overline{\Omega}} u(\VEC{x}) \leq M$
for all $u \in \Sigma_f$.
Thus, $u_f(\VEC{x}) \leq M$ for all $\VEC{x} \in \overline{\Omega}$.

\begin{lemma} \label{PerronLem5}
If $\displaystyle \{u_j\}_{j=1}^k \subset \Sigma_f$, then
$u = \max \{u_1, u_2, \ldots, u_j\} \in \Sigma_f$.
\end{lemma}

\begin{proof}
Note that $u = \max \{u_1, u_2, \ldots, u_j\}$ is defined by
$u(\VEC{x}) = \max \{u_1(\VEC{x}), u_2(\VEC{x}), \ldots, u_j(\VEC{x})\}$
for all $\VEC{x} \in \overline{\Omega}$.

We leave it to the reader to verify that
$u \in C(\overline{\Omega})$.  We have that
$u(\VEC{x}) \leq f(x)$ for $\VEC{x} \in \partial \Omega$ because
$u_j(\VEC{x}) \leq f(x)$ for $\VEC{x} \in \partial \Omega$ and all $j$.
It follows from Lemma~\ref{PerromLem2} that
\begin{align*}
u(\VEC{x}) &= \max \{u_1(\VEC{x}), u_2(\VEC{x}), \ldots, u_j(\VEC{x})\}
\leq \max \left\{ M_{u_1}(\VEC{x},r), M_{u_2}(\VEC{x},r), \ldots,
M_{u_j}(\VEC{x},r) \right\} \\
&\leq  M_u(\VEC{x},r)
\end{align*}
for all $\VEC{x} \in \Omega$ with $r$ such that
$\overline{B_r(\VEC{x})} \subset \Omega$.  Thus, $u$ is subharmonic on
$\Omega$.
\end{proof}

\begin{lemma} \label{PerronLem6}
Suppose that $\displaystyle u \in C(\overline{B_r(\VEC{x})})$
and $u$ is harmonic in $B_r(\VEC{x})$, then
\[
\left|\pdydx{u}{x_j}(\VEC{x})\right|
\leq \frac{n}{r}\, \sup_{\VEC{w} \in \partial B_r(\VEC{x})} |u(\VEC{w})|
\]
for $1 \leq j \leq n$.
\end{lemma}

\begin{proof}
It follows from Remark~\ref{laplace_exist_a_ball} that
\[
u(\VEC{z}) = \int_{\partial B_r(\VEC{x})} u(\VEC{y}) \,
\frac{r^2-\|\VEC{z}-\VEC{x}\|^2}{r\, \omega_n \|\VEC{z}-\VEC{y}\|^n} \dss{S}{y}
\]
for $\VEC{z} \in B_r(\VEC{x})$.  Since
\[
(\VEC{z},\VEC{y}) \to
\pdfdx{\left(\frac{r^2-\|\VEC{z}-\VEC{x}\|^2}
{\|\VEC{z}-\VEC{y}\|^n}\right)}{z_j}
= \frac{-2(z_j-x_j) \|\VEC{z}-\VEC{y}\|^n
- n (z_j-y_j)(r^2 - \|\VEC{z}-\VEC{x}\|^2)
\|\VEC{z}-\VEC{y}\|^{n-2}}{\|\VEC{z}-\VEC{y}\|^{2n}}
\]
is uniformly continuous on
$\overline{B_s(\VEC{x})} \times \partial B_r(\VEC{x})$ for any $0<s<r$,
we get
\[
\pdydx{u}{z_j}(\VEC{z}) = \frac{1}{r\,\omega_n}
\int_{\partial B_r(\VEC{x})} u(\VEC{y}) \,
\left( \frac{-2(z_j-x_j) \|\VEC{z}-\VEC{y}\|^n
- n(z_j-y_j) (r^2 - \|\VEC{z}-\VEC{x}\|^2)
\|\VEC{z}-\VEC{y}\|^{n-2}}{\|\VEC{z}-\VEC{y}\|^{2n}} \right) \dss{S}{y}
\]
for $\VEC{z} \in B_r(\VEC{x})$.  Since
$\|\VEC{x}-\VEC{y}\| = r$ for $\VEC{y}\in \partial B_r(\VEC{x})$, we obtain
\[
\pdydx{u}{z_j}(\VEC{x}) = -\frac{n}{r^{n+1}\,\omega_n}
\int_{\partial B_r(\VEC{x})} (x_j-y_j) u(\VEC{y}) \dss{S}{y}
= \frac{n}{r\,\omega_n}
\int_{\partial B_1(\VEC{0})} y_j u(\VEC{x} + r\VEC{y}) \dss{S}{y} \ .
\]
Finally, since
$\displaystyle
| y_j u(\VEC{x} + r\VEC{y}) | \leq
|u(\VEC{x} + r\VEC{y}) | \leq \sup_{\VEC{w}\in \partial B_r(\VEC{x})} |u(\VEC{w})|$
for all $\VEC{y} \in \partial B_1(\VEC{0})$, we get
\begin{align*}
\left|\pdydx{u}{z_j}(\VEC{x})\right|
& \leq \frac{n}{r\,\omega_n}
\int_{\partial B_1(\VEC{0})} |y_j u(\VEC{x} + r\VEC{y})| \dss{S}{y}
\leq \frac{n}{r\,\omega_n}\,\sup_{\VEC{w}\in \partial B_r(\VEC{x})} |u(\VEC{w})|
\int_{\partial B_1(\VEC{0})} \dss{S}{y} \\
&= \frac{n}{r}\,\sup_{\VEC{w}\in \partial B_r(\VEC{x})} |u(\VEC{w})| \ . \qedhere 
\end{align*}
\end{proof}

\begin{lemma} \label{PerronLem7}
$u_f$ is harmonic on $\Omega$.
\end{lemma}

\begin{proof}
Choose $\VEC{z} \in \Omega$ and $\rho>0$ such that
$\displaystyle \overline{B_{\rho}(\VEC{z})} \subset \Omega$,
and $0 < \eta < \rho$.

\stage{i} Given a sequence
$\displaystyle \{\VEC{x}_j\}_{j=1}^\infty \subset B_\eta(\VEC{z})$.
By definition of $u_f$, we can find for each $j$ a sequence
$\displaystyle \{v_{i,j}\}_{i=1}^\infty \subset \Sigma_f$ such that
$\displaystyle \lim_{i \to \infty} v_{i,j}(\VEC{x}_j) = u_f(\VEC{x}_j)$
for $j \geq 1$.

Let $\displaystyle v_i = \max_{1\leq j \leq i} v_{i,j}$.  It follows
from Lemma~\ref{PerronLem5} that $v_i \in \Sigma_f$.  Since
$\displaystyle v_{i,j}(\VEC{x}_j) \leq v_i(\VEC{x}_j) \leq u_f(\VEC{x}_j)$
for all $i \geq j$ and
$\displaystyle \lim_{i \to \infty} v_{i,j}(\VEC{x}_j) = u_f(\VEC{x}_j)$,
we get that
$\displaystyle \lim_{i \to \infty} v_i(\VEC{x}_j) = u_f(\VEC{x}_j)$
for all $j$.

Substituting $v_i$ by $\max \{u_m,v_i\}$, we get that
$m \leq v_i(\VEC{x}) \leq M$ for all $\VEC{x} \in \Omega$.  We still
preserve $v_i \in \Sigma_f$ according to Lemma~\ref{PerronLem5},
and
$\displaystyle \lim_{i \to \infty} v_i(\VEC{x}_j) = u_f(\VEC{x}_j)$
for all $j$.

Let $v_{i,\VEC{z},\rho} = (v_i)_{\VEC{z},\rho}$.  We have that
$v_{i,\VEC{z},\rho}$ is harmonic on $B_\rho(\VEC{z})$ for all $i$.
We still have that $v_{i,\VEC{z},\rho} \in \Sigma_f$
due to Lemma~\ref{PerronLem1} and
$v_{i,\VEC{z},\rho} = v_i$ on $\partial \Omega$.  Moreover,
from Lemma~\ref{PerronLem1}, we also get that
$\displaystyle v_i(\VEC{x}_j) \leq v_{i,\VEC{z},\rho}(\VEC{x}_j)
\leq u_f(\VEC{x}_j)$ for all $i$ and $j$.  Thus
$\displaystyle \lim_{i \to \infty} v_{i,\VEC{z},\rho}(\VEC{x}_j) = u_f(\VEC{x}_j)$
for all $j$.

\stage{ii} Given $\VEC{x} \in \overline{B_\eta(\VEC{z})}$, let 
$r = \rho - \|\VEC{x}-\VEC{z}\|$.  We have that
$\displaystyle \overline{B_r(\VEC{x})} \subset \overline{B_\rho(\VEC{z})}$ and
$r\geq \rho-\eta>0$.  Since $v_{i,\VEC{z},\rho}$ is continuous on
$\overline{B_\rho(\VEC{z})}$ and harmonic on $B_\rho(\VEC{z})$, it
follows from Lemma~\ref{PerronLem6} that
\[
\left|\pdydx{v_{i,\VEC{z},\rho}}{x_j}(\VEC{x})\right|
\leq \frac{n}{r}\, \sup_{\VEC{y} \in \partial B_r(\VEC{x})}
|v_{i,\VEC{z},\rho}(\VEC{y})|
\leq \frac{n}{\rho-\eta}\, \sup_{\VEC{y} \in \partial \Omega}
|v_{i,\VEC{z},\rho}(\VEC{y})| = \frac{nM}{\rho-\eta}
\]
for $1 \leq j \leq n$, where we have use the Maximum Principle Theorem
for subharmonic functions on $\Omega$ to obtain the second inequality.
Since $\VEC{x} \in \overline{B_\eta(\VEC{z})}$ is arbitrary,
we have that
\[
\left|\pdydx{v_{i,\VEC{z},\rho}}{x_j}(\VEC{x})\right|
\leq \frac{nM}{\rho-\eta}
\]
for all $\VEC{x} \in \overline{B_\eta(\VEC{z})}$ and
$1 \leq j \leq n$.  Thus
$\|\diff v_{i,\VEC{z},\rho} (\VEC{x})\| \leq n\sqrt{n}\,M/(\rho-\eta)$ for all
$\VEC{x} \in \overline{B_\eta(\VEC{z})}$ and all $i$.  Combining this
relation with the Mean Value Theorem for functions of several
variables, it is easy to show that
$\displaystyle \left\{ v_{i,\VEC{z},\rho} \right\}_{j=1}^\infty$ is
equicontinuous on $\overline{B_\eta(\VEC{z})}$.  Since
$m \leq v_{i,\VEC{z},\rho} (\VEC{x}) \leq M$ for all
$\VEC{x} \in \overline{B_\eta(\VEC{z})}$, we may use Arzela-Ascoli
Theorem\footnote{In some textbook, it is referred as
Arzela Theorem only and in others as Ascoli Theorem only.  Why?}
to conclude that there exists a subsequence 
$\displaystyle \left\{ v_{i_k,\VEC{z},\rho} \right\}_{k=1}^\infty$
that converge uniformly on 
$\overline{B_\eta(\VEC{z})}$.

\stage{iii}
Let $v(\VEC{x}) \equiv \lim_{k\to \infty} v_{i_k,\VEC{z},\rho}(\VEC{x})$
for all $\VEC{x} \in \Omega$.  Since
$\displaystyle \left\{v_{i_k,\VEC{z},\rho}\right\}_{k=1}^\infty$ is a
sequence of harmonic functions on $B_\eta(\VEC{z})$ and converges
uniformly to $v$ on $\overline{B_\eta(\VEC{z})}$, we get from
Corollary~\ref{UnifConvHarm} that $v$ is harmonic on $B_\eta(\VEC{z})$
and continuous on $\overline{B_\eta(\VEC{z})}$.

We also have that $v(\VEC{x}_j) = u_f(\VEC{x}_j)$ for all $j$ because
$\displaystyle \lim_{i \to \infty} v_{i,\VEC{z},\rho}(\VEC{x}_j)
= u_f(\VEC{x}_j)$ for all $j$.

\stage{iv} Let us show that $u_f$ is continuous on $B_\eta(\VEC{z})$.
Given $\VEC{w} \in B_\eta(\VEC{z})$, choose a sequence
$\displaystyle \{\VEC{x}_j\}_{j=1}^\infty \subset B_\eta(\VEC{z})$
such that $\VEC{x}_1 = \VEC{w}$ and $\displaystyle \{\VEC{x}_j\}_{j=2}^\infty$
converges to $\VEC{w}$.  Since $v$ is continuous \footnote{Note that
the sequence $\displaystyle \{v_{i,j}\}_{i=1}^\infty$ will change if
we change the sequence
$\displaystyle \{\VEC{x}_j\}_{j=1}^\infty \subset B_\eta(\VEC{z})$ and
so may $v$.} on $\overline{B_\eta(\VEC{z})}$, we then have that
$\displaystyle \lim_{j\to \infty} u_f(\VEC{x}_j)
= \lim_{j\to \infty} v(\VEC{x}_j) = v(\VEC{w}) = v(\VEC{x}_1) = 
u_f(\VEC{x}_1) = u_f(\VEC{w})$.
Since this is true for all sequences converging to $\VEC{w}$, we have
that $u_f$ is continuous at $\VEC{w}$.  Since $\VEC{w} \in B_\eta(\VEC{z})$
is arbitrary, $u_f$ is continuous on $B_\eta(\VEC{z})$.

\stage{v}
Let $\displaystyle \{\VEC{x}_j\}_{j=1}^\infty$ be a dense sequence in 
$B_\eta(\VEC{z})$.  Since $u_f$ and the function $v$ associated to
this sequence are continuous functions that agree on the dense set
$\displaystyle \{\VEC{x}_j\}_{j=1}^\infty$, we have that
$u_f = v$ on $B_\eta(\VEC{z})$.  Thus $u_f$ is harmonic on
$B_\eta(\VEC{z})$.  Since this is true for all $\VEC{z} \in \Omega$
and all $\eta < \rho$ such that $\overline{B_\rho(\VEC{z})} \subset
\Omega$, we finally get that $u_f$ is harmonic on $\Omega$.
\end{proof}

Since the beginning, we have assumed that the boundary of $\Omega$ was
a manifold of class $C^2$.  Using Perron's method to solve the Dirichlet
problem, we may impose less restrictive conditions on the boundary of
$\Omega$.

\begin{defn}[Barrier Condition]
The boundary $\partial \Omega$ of an open subset $\Omega \subset \RR^n$
satisfies the {\bfseries barrier condition}\index{Barrier Condition}
if, for every $\VEC{z} \in \partial \Omega$, there exists a function
$g_{\VEC{z}} \in C(\overline{\Omega})$ such that
$g_{\VEC{z}}$ is subharmonic on $\Omega$, $g_{\VEC{z}}(\VEC{z}) = 0$
and $g_{\VEC{z}}(\VEC{x}) < 0$ for all
$\VEC{x} \in \partial \Omega \setminus \{\VEC{z}\}$.
\end{defn}

We now show that a bounded open set $\Omega$ with a boundary of class
$C^2$ satisfies the barrier condition.   For each
$\VEC{z} \in \partial \Omega$, there exist $\VEC{w}$ on the line
$\displaystyle \{ \VEC{z} + t\nu(\VEC{z})) : t > 0 \}$
and $s>0$ small enough such that
$\displaystyle \overline{B_s(\VEC{w})} \cap \overline{\Omega} = \{\VEC{z}\}$
because $\partial \Omega$ is a $C^2$-manifold \footnote{This can be
proved using Lemma~\ref{pot_inequ} in the next chapter.}
(Figure~\ref{Barrier1}).  As usual, $\nu(\VEC{z})$ is the
outward unit normal to $\partial \Omega$ at
$\VEC{z} \in \partial \Omega$.  Let
\[
g_{\VEC{z}}(\VEC{x})
= \begin{cases}
\displaystyle \left\| \frac{1}{s}\,(\VEC{x}-\VEC{w}) \right\|^{2-n} - 1
& \quad \text{if} \ n > 2 \\[0.8em]
\displaystyle
-\ln\left(\left\| \frac{1}{s}\, (\VEC{x} - \VEC{w}) \right\|\right)
& \quad \text{if} \ n = 2
\end{cases}
\]
We have from Corollary~\ref{laplace_sharm} that
$g_{\VEC{z}}$ is harmonic on $\RR^n\setminus \{\VEC{w}\}$.
We have also by construction that
$\displaystyle |g_{\VEC{z}}(\VEC{x})| < 0$ for
$\VEC{x} \not\in \overline{B_s(\VEC{w})}$ because
$\|\VEC{x} - \VEC{w}\| > s$ in that case, and
$\displaystyle g_{\VEC{z}}(\VEC{x}) = 0$ for
$\VEC{x} \in \partial B_s(\VEC{w})$ because
$\|\VEC{x} - \VEC{w}\| = s$ in that case.
Hence, $g_{\VEC{z}} \in C(\overline{\Omega})$ is harmonic on
$\Omega$, and satisfies $g_{\VEC{z}}(\VEC{z}) = 0$ because
$\VEC{z} \in \partial B_s(\VEC{w})$ and $g_{\VEC{z}}(\VEC{x}) < 0$ for 
$\VEC{x} \in \partial \Omega \setminus \{\VEC{z}\}$ because
$\VEC{x} \not\in \overline{B_s(\VEC{w})}$.

\pdfF{laplace/barrier1}{$C^2$ boundaries satisfy the barrier condition}
{Figure associated to the construction of the function $g_{\VEC{z}}$
used to demonstrate that $\partial \Omega$ of class $C^2$ satisfies the
barrier condition.}{Barrier1}

There are sets $\Omega \subset \RR^n$ that do not have a boundary of
class $C^2$ but satisfy the barrier condition.  The simplest examples
that come to mind are the sets $\Omega$ which are strictly convex.
Therefore, for each point $\VEC{z} \in \partial \Omega$, there exists an
hyperplane
$P_{\VEC{z}} = \left\{ \VEC{y} \in \RR^n : \ps{\VEC{y}}{\VEC{w}} = 0 \right\}$
for some $\VEC{w}$ such that
$(\VEC{z} + P_{\VEC{z}}) \cap \overline{\Omega} = \{\VEC{z}\}$.
We may assume that $\VEC{w}$ is a unit vector pointing outside of $\Omega$.
Then $g_{\VEC{z}}:\RR^n \to \RR$ defined by
$g_{\VEC{z}}(\VEC{x}) = \ps{\VEC{x} - \VEC{z}}{\VEC{w}}$ is an
harmonic function, since it is linear, such that
$g_{\VEC{z}}(\VEC{z}) = 0$ and
$g_{\VEC{z}}(\VEC{x}) < 0$ for $\VEC{x} \in \Omega \setminus \{\VEC{z}\}$
because $\VEC{x}-\VEC{z}$ is on the opposite site of $P_{\VEC{z}}$ than
$\VEC{w}$ (Figure~\ref{Barrier2}).
Note that $g_{\VEC{z}}(\VEC{x})$ is the orthogonal projection of the vector 
$\VEC{x} - \VEC{z}$ along $\VEC{w}$.

\pdfF{laplace/barrier2}{Non differentiable boundaries that do not
satisfy the barrier condition}{Figure associated to the construction
of the function $g_{\VEC{z}}$ used to demonstrate that
$\partial \Omega$ satisfies the barrier condition if $\Omega$ is
strictly convex.  $\partial \Omega$ may not be differentiable
everywhere.  For a clearer visualization, the vectors $\VEC{w}$ and
$\VEC{x} - \VEC{z}$ have be translated by $\VEC{z}$ in the figure
above to have then start at the point $\VEC{z}$.}{Barrier2}

For the rest of this section, we assume that $\Omega$ is a bounded
open subset of $\displaystyle \RR^n$ and satisfies the barrier condition.  

\begin{lemma}
$\displaystyle \liminf_{\VEC{x}\to \VEC{z}} u_f(\VEC{x}) \geq f(\VEC{z})$
for all $\VEC{z} \in \partial \Omega$.
\end{lemma}

\begin{proof}
Given $\VEC{z} \in \partial \Omega$ and $\epsilon >0$, we show that
there exists $v_\epsilon \in \Sigma_f$ such that
$\displaystyle \lim_{\VEC{x} \to \VEC{z}} v_\epsilon(\VEC{x}) \geq
f(\VEC{z}) - \epsilon$.
We will then get from $u_f(\VEC{x}) \geq v_\epsilon(\VEC{x})$
for all $\VEC{x} \in \overline{\Omega}$ that
$\displaystyle \liminf_{\VEC{x}\to \VEC{z}} u_f(\VEC{x}) 
\geq \lim_{\VEC{x} \to \VEC{z}} v_\epsilon(\VEC{x}) \geq f(\VEC{z}) -
\epsilon$.
Thus, $\displaystyle \liminf_{\VEC{x}\to \VEC{z}} u_f(\VEC{x}) \geq f(\VEC{z})$
because $\epsilon >0$ is arbitrary.

Since $f:\partial \Omega \to \RR$ is continuous, there exists $\delta >0$
such that $|f(\VEC{x}) - f(\VEC{z})|<\epsilon$ for
$\VEC{x} \in \partial \Omega \cap B_\delta(\VEC{z})$.  Thus
$f(\VEC{z}) - \epsilon < f(\VEC{x})$ for
$\VEC{x} \in \partial \Omega \cap B_\delta(\VEC{z})$.

Moreover, since $g_{\VEC{z}}$ given in the definition of the barrier
condition is continuous on the compact set
$\partial \Omega \setminus B_\delta(\VEC{z})$, we have that
$\displaystyle b_g = \max_{\VEC{x} \in \partial \Omega \setminus B_\delta(\VEC{z})}
  g_{\VEC{z}}(\VEC{x}) = g_{\VEC{z}}(\VEC{y})$
for some $\VEC{y} \in \partial \Omega \setminus B_\delta(\VEC{z})$.
Thus, $b_g<0$.  Similarly, since $f$ is continuous on the compact set
$\partial \Omega \setminus B_\delta(\VEC{z})$, we have that
$\displaystyle b_f = \min_{\VEC{x} \in \partial \Omega \setminus B_\delta(\VEC{z})}
f(\VEC{x}) > -\infty$.
Choose $C$ such that $f(\VEC{z}) - \epsilon + Cb_g \leq b_f$ and
consider
\begin{align*}
  u_\epsilon : \overline{\Omega} & \to \RR \\
  \VEC{x} &\mapsto f(\VEC{z}) -\epsilon + C g_{\VEC{z}}(\VEC{x})
\end{align*}
Since $\displaystyle g_{\VEC{z}} \in C(\overline{\Omega})$
is subharmonic on $\Omega$, so is $u_\epsilon$.  Moreover,
$\displaystyle u_\epsilon(\VEC{x}) \leq f(\VEC{z}) - \epsilon \leq f(\VEC{x})$
for all $\VEC{x} \in \partial \Omega \cap B_\delta(\VEC{z})$, and
$\displaystyle u_\epsilon(\VEC{x})
= f(\VEC{z}) -\epsilon + C g_{\VEC{z}}(\VEC{x})
\leq f(\VEC{z}) -\epsilon + C b_g
\leq b_f \leq f(\VEC{x})$
for all $\VEC{x} \in \partial \Omega \setminus B_\delta(\VEC{z})$.
We therefore have that $u_\epsilon \in \Sigma_f$.
\end{proof}

\begin{lemma} \label{PerronLem9}
$\displaystyle \lim_{\VEC{x}\to \VEC{z}} u_f(\VEC{x}) = f(\VEC{z})$
for all $\VEC{z} \in \partial \Omega$.
\end{lemma}

\begin{proof}
It follows from the previous lemma that we only have to prove that
$\displaystyle \limsup_{\VEC{x}\to \VEC{z}} u_f(\VEC{x}) \leq f(\VEC{z})$
for all $\VEC{z} \in \partial \Omega$.

We have that
$\displaystyle u_{-f}(\VEC{x}) = \sup_{u \in \Sigma_{-f}} u(\VEC{x})
= -\inf_{u \in \Sigma_{-f}} -u(\VEC{x})$.
Note that $u_{-f}(\VEC{x}) \leq -f(\VEC{x})$ for all
$\VEC{x} \in \partial \Omega$ by definition of $\Sigma_{-f}$.

If $v \in \Sigma_{-f}$, then $v(\VEC{x}) \leq -f(\VEC{x})$ for all
$\VEC{x} \in \partial \Omega$.
If $u \in \Sigma_f$, then $u(\VEC{x}) \leq f(\VEC{x})$ for all
$\VEC{x} \in \partial \Omega$.  Hence, $u(\VEC{x}) + v(\VEC{x}) \leq 0$
for all $\VEC{x} \in \partial \Omega$ whatever
$v \in \Sigma_{-f}$ and $u \in \Sigma_f$.  Since
$\displaystyle u+v \in C(\overline{\Omega})$ is subharmonic
on $\Omega$, we get from the Maximum Principle Theorem,
Theorem~\ref{laplace_HMP}, that
$u(\VEC{x}) \leq -v(\VEC{x})$ for all $\VEC{x} \in \overline{\Omega}$
whatever $v \in \Sigma_{-f}$ and $u \in \Sigma_f$.
Thus,
$\displaystyle u_f(\VEC{x}) = \sup_{u \in \Sigma_f} u(\VEC{x}) \leq -v(\VEC{x})$
for all $\VEC{x} \in \overline{\Omega}$ and all $v \in \Sigma_{-f}$.
It follows that
$\displaystyle u_f(\VEC{x}) = \sup_{u \in \Sigma_f} u(\VEC{x})
\leq \inf_{v \in \Sigma_{-f}} -v(\VEC{x}) = -u_{-f}(\VEC{x})$
for all $\VEC{x} \in \overline{\Omega}$.

Hence, for $\VEC{z} \in \partial \Omega$,
$\displaystyle \limsup_{\VEC{x} \to \VEC{z}} u_f(\VEC{x})
\leq \limsup_{\VEC{x} \to \VEC{z}} -u_{-f}(\VEC{x})
= -\liminf_{\VEC{x} \to \VEC{z}} u_{-f}(\VEC{x})
\leq f(\VEC{z})$
because $\displaystyle \liminf_{\VEC{x} \to \VEC{z}} u_{-f}(\VEC{x})
\geq -f(\VEC{z})$ according to the previous lemma applied to $-f$.
\end{proof}

We have finally proved the following result.

\begin{theorem} \label{PerronExistTh}
If $\Omega \subset \RR^n$ is a bounded open set such that
$\partial \Omega$ satisfies the barrier condition, and if
$f:\partial \Omega \to \RR$ is a continuous function, then there
exists a unique function
$\displaystyle u \in C(\overline{\Omega})$ which is
harmonic on $\Omega$ and satisfies $u(\VEC{x}) = f(\VEC{x})$ for all
$\VEC{x} \in \partial \Omega$.
\end{theorem}

\begin{proof}
According to Lemmas~\ref{PerronLem7} and \ref{PerronLem9}, the function
$u_f: \overline{\Omega} \to \RR$ is a continuous function on
$\overline{\Omega}$, harmonic on $\Omega$, and satisfying
$u_f(\VEC{x}) = f(\VEC{x})$ for all
$\VEC{x} \in \partial \Omega$.  According to
Theorem~\ref{laplace_uniqu_th}, $u_f$ is the unique function with such
properties.
\end{proof}

\input{potential}

\section{Separation of Variables} \label{SectLaplaceSepVar}

The method of separation of variables is a simple method to solve the
Laplace equation however it applies only to nice domains like a
rectangle or a sphere.  As for the wave equation, our presentation of
the method of separation of variables for the Laplace equation is going
to be formal.

\subsection{Cartesian Coordinates}

\begin{egg}
Find the solution of the Laplace equation
\begin{equation} \label{laplace_spv_A}
\Delta u = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0 \quad ,
\quad 0 < x < a \ \text{and} \ 0 < y < b \ ,
\end{equation}
with the boundary conditions $u(0,y) = 0$, $u(a,y)=0$, $u(x,0)=0$
and $u(x,b) = f(x)$ for $0<x<a$

\subI{Separation of Variables}
If we substitute $u(x,y) = F(x)G(y)$ in (\ref{laplace_spv_A}), we get
\[
F''(x)G(y) + F(x)G''(y) = 0 \quad , \quad  0 < x < a \ \text{and}
\ 0 < y < b \ ,
\]
After dividing both sides by $F(x)G(y)$, we get
\[
\frac{F''(x)}{F(x)} + \frac{G''(y)}{G(y)} = 0 \quad , \quad
 0 < x < a \ \text{and} \ 0 < y < b \ ,
\]
Thus,
\[
\frac{F''(x)}{F(x)} = - \frac{G''(y)}{G(y)} \quad , \quad
 0 < x < a \ \text{and} \ 0 < y < b \ .
\]
Since the right hand side is independent of $x$ and the left hand side
is independent of $y$, we get
\[
\frac{F''(x)}{F(x)} = - \frac{G''(y)}{G(y)} = -k \quad , \quad
 0 < x < a \ \text{and} \ 0 < y < b \ ,
\]
for some constant $k$.  We end up with two ordinary differential equations.
\begin{equation} \label{laplace_spv_B}
F''(x) + k F(x) = 0 \quad \text{and}
\quad G''(y) - k\,G(y) = 0 \ .
\end{equation}

The first ordinary differential equation in (\ref{laplace_spv_B})
satisfies two boundary conditions.   From $u(0,y) = 0$, we get
$F(0)G(y)=0$.  Since we assume that $G$ is non-null, we get
$F(0)=0$.  Similarly, from $u(a,y) = 0$, we get $F(a)G(y)=0$.  Again,
since we assume that $G$ is non-null, we get $F(a)=0$.  The
boundary conditions for the first ordinary differential equation in
(\ref{laplace_spv_B}) are $F(0)=F(a)=0$. 

\subI{Simple Functions}
We consider the boundary value problem
\begin{equation} \label{laplace_spv_C}
F''(x) + k F(x) = 0 \quad \text{with} \quad F(0)=F(a)=0  \ .
\end{equation}
The form of the general solution of the ordinary differential equation
above is determined by the roots of the characteristic equation
$\lambda^2+k=0$.

If $k<0$, the roots of the characteristic equation are $\pm \sqrt{-k}$.
Since the roots are real, the solution of the ordinary differential
equation is of the form
$\displaystyle F(x) = A e^{\sqrt{-k}\,x} + B e^{-\sqrt{-k}\, x}$.
Moreover, $A+B=0$ from $F(0)=0$ and 
$\displaystyle A e^{a\sqrt{-k}} + B e^{-a\sqrt{-k}} = 0$ from $F(a)=0$.
The only solution of the system
\[
\begin{pmatrix}
1 & 1 \\ e^{a\sqrt{-k}} & e^{-a\sqrt{-k}}
\end{pmatrix}
\begin{pmatrix}
A \\ B
\end{pmatrix}
=
\begin{pmatrix}
0 \\ 0 
\end{pmatrix}
\]
is $A=B=0$ because
\[
\det
\begin{pmatrix}
1 & 1 \\ e^{a\sqrt{-k}} & e^{-a\sqrt{-k}}
\end{pmatrix}
= e^{a\sqrt{-k}} - e^{-a\sqrt{-k}} =
e^{-a\sqrt{-k}}\left(e^{2a\sqrt{-k}} - 1 \right)  
\neq 0
\]
for $k\neq 0$.  Therefore, the null solution is the only solution
of the boundary value problem (\ref{laplace_spv_C}) for $k<0$.

If $k=0$, the solution of the ordinary differential equation is $F(x)=Ax+B$.
Moreover, $F(0)=0$ implies that $B=0$ and thus $F(a)=0$ implies
that $Aa + B = 0$.  Hence, $A=B=0$ and again the null solution is the
only solution of the boundary value problem (\ref{laplace_spv_C}) for
$k=0$.

If $k>0$, the roots of the characteristic equation are $\pm i \sqrt{k}$.
Since the roots are complex, the solution of the ordinary differential
equation is of the form
\[
F(x) = A \cos\left(\sqrt{k}\,x\right) + B \sin\left(\sqrt{k}\,x\right) \ .
\]
Moreover, $F(0)=0$ implies that $A=0$ and thus $F(a)=0$ implies that
$B \sin\left(a\sqrt{k}\right) = 0$.  If we take $B=0$, we get the
null solution.  We must therefore have
$\sin\left(a\sqrt{k}\right) = 0$.  This implies that
$\displaystyle k = k_n \equiv \left(n\pi/a\right)^2$ for any integer $n>0$.
The boundary value problem
(\ref{laplace_spv_C}) has non-null solutions only for
$\displaystyle k = k_n = \left(n\pi/a\right)^2$ with
any integer $n>0$, and the solutions associated to $k_n$ are of the
form
\[
F(x)=F_n(x) \equiv B_n \sin\left(\frac{n\pi x}{a}\right) \ .
\]

With $\displaystyle k = k_n = \left(n\pi/a\right)^2$, the second
ordinary differential equation in (\ref{laplace_spv_C}) is therefore
\[
G''(y) - \left(\frac{n\pi}{a}\right)^2\,G(y) = 0
\]
for any integer $n>0$.  For each $n$, the general solution
of this second order ordinary differential equation is
\[
G(t) = G_n(t) \equiv C_n e^{n\pi y/a} + D_n e^{-n\pi y/a} \ .
\]

We have found the simple functions
\[
u_n(x,t) \equiv F_n(x)G_n(t) =
\left( a_n e^{n\pi y/a} + b_n e^{-n\pi y/a} \right) 
 \sin\left(\frac{n\pi x}{a}\right)
\]
for $n>0$.
The constants $a_n$ and $b_n$ come from the product of the constants
$B_n$ and $C_n$, and $B_n$ and $D_n$ respectively.

We seek a solution of the form
\[
u(x,y) = \sum_{n=1}^\infty u_n(x,y)
= \sum_{n=1}^\infty \left( a_n e^{n\pi y/a} + b_n e^{-n\pi y/a} \right) 
 \sin\left(\frac{n\pi x}{a}\right) \ .
\]

From $u(x,0) = 0$, we get
\[
0 = \sum_{n=1}^\infty (a_n+b_n) \sin\left(\frac{n\pi x}{a}\right) \ .
\]
Thus, $a_n = -b_n$ for all $n$.  The solution can be written
\begin{equation}\label{laplace_spv_D}
u(x,t) = \sum_{n=1}^\infty c_n \sinh\left(\frac{n\pi y}{a}\right) 
 \sin\left(\frac{n\pi x}{a}\right) \ ,
\end{equation}
where $c_n = 2 a_n$.  From $u(x,b) = f(x)$, we get
\[
f(x) = \sum_{n=1}^\infty c_n \sinh\left(\frac{n\pi b}{a}\right) 
 \sin\left(\frac{n\pi x}{a}\right)
\]
for $0<x<a$.  This is the Fourier sine series of $f$ on $[0,a]$.  Thus,
\[
c_n \sinh\left(\frac{n\pi b}{a}\right) = \frac{2}{a} \int_0^a f(x)
\sin\left(\frac{n\pi x}{a}\right) \dx{x}
\]
for $n > 0$.
The solution of the Laplace equation is given by (\ref{laplace_spv_D})
with the coefficient
\[
c_n  = \frac{2}{a \sinh\left(n\pi b/a\right)} \int_0^a f(x)
\sin\left(\frac{n\pi x}{a}\right) \dx{x}
\]
for $n > 0$.
\end{egg}

In general, the solutions of the Laplace equation $\Delta u = 0$ on a
rectangular domain are linear combinations of simple functions of the
following form.  If $u=0$ on the vertical sides ($x$ is constant),
\[
u(x,y) = (A \cos (k\,x) + B \sin (k\,x))(C \,e^{(k\,y)} + D\,e^{(-k\,y)}) \ .
\]
If $u=0$ on the horizontal sides ($y$ is constant),
\[
u(x,y) = (A\,e^{(k\,x)} + B\,e^{(-k\,x)})(C \cos(k\,y) + D \sin(k\,y)) \ .
\]

\begin{egg}
Solve the potential equation
\[
\Delta u = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0 \quad ,
\quad 0<x<3 \ \text{and} \ 0<y<7 \ ,
\]
with the boundary conditions
$u(x,0) = u(x,7) = 0$ for $0<x<3$, $u(0,y) = 3\sin\left(4\pi y/7\right)$
for $0<y<7$, and $u(3,y) = y(7-y)$ for $0<y<7$.

The simple solutions are of the form
\[
u(x,y) = (A\,e^{(k\,x)} + B\,e^{(-k\,x)})(C \cos(k\,y) + D \sin(k\,y)) \ .
\]
The boundary condition $u(x,0) =0$ gives
$C\,(A\,e^{(k\,x)} + B\,e^{(-k\,x)})=0$ for $0<x<3$.  Thus $C=0$ because the
expression between parentheses cannot be null for all $x$ if we want
to get a non-null solution.  The boundary condition $u(x,7) = 0$ then
gives $D (A\,e^{(k\,x)} + B\,e^{(-k\,x)})\sin(7k) = 0$.  Since $D$ and
the expression between parentheses cannot be null for all $x$ if we
want to get a non-null solution, we get $\sin(7k) = 0$ and therefore
$k=k_n \equiv n\pi/7$ for $n >0$.

We end up with simple functions of the form
\[
u_n(x,y) \equiv \left(a_n\,e^{n\pi x/7} + b_n\,e^{-n\pi x/7}\right)\sin(n\pi y/7)
\]
for $n > 0$, where $a_n$ and $b_n$ come from the product of $D$ and
$A$, and $D$ and $B$ respectively for each value of $n$.

We seek a solution of the form
\[
u(x,t) = \sum_{n=1}^\infty u_n(x,t)
= \sum_{n=1}^\infty \left(a_n\,e^{n\pi x/7}
+ b_n\,e^{-n\pi x/7}\right)\sin\left(\frac{n\pi y}{7}\right) \ .
\]

From $\displaystyle u(0,y) = 3\sin\left(4\pi y/7\right)$, we
get
\[
\sum_{n=1}^\infty \left(a_n+ b_n\right)\sin\left(\frac{n\pi y}{7}\right) =
3\sin\left(\frac{4\pi y}{7}\right) \ .
\]
Thus
\[
a_n + b_n =
\begin{cases}
3 & \quad \text{for} \quad n=4 \\  
0 & \quad \text{otherwise}
\end{cases}
\]
From $u(3,y) = y(7-y)$, we get
\[
\sum_{n=1}^\infty \left(a_n\,e^{3n\pi /7}
+ b_n\,e^{-3n\pi /7}\right)\sin\left(\frac{n\pi y}{7}\right) = y(7-y) \ .
\]
This is the Fourier sine series of $y(7-y)$ on the interval $[0,7]$.
Thus,
\[
a_n\,e^{3n\pi /7} + b_n\,e^{-3n\pi /7} =
\frac{2}{7}\int_0^7 y(7-y) \sin\left(\frac{n\pi y}{7}\right) \dx{y} \ .
\]
To evaluate the integral, we use the method of integration by
parts.  The integrant is $f(y)g'(y)$, where $f(y)=y(7-y)$ and
$\displaystyle g'(y) = \sin\left(n\pi y/7\right)$.  Hence,
$f'(y) = 7-2y$ and
$\displaystyle g(y) = -7/(n\pi)\,\cos\left(n\pi y/7\right)$.
We get
\begin{align*}
a_n\,e^{3n\pi /7} + b_n\,e^{-3n\pi /7}
&= \frac{-7}{n\pi}\,y(7-y)\,\cos\left(\frac{n\pi y}{7}\right)\bigg|_0^7 +
\frac{7}{n\pi}\,\int_0^7 (7-2y)\,\cos\left(\frac{n\pi y}{7}\right)\dx{y} \\
&= \frac{7}{n\pi}\,\int_0^7 (7-2y)\,\cos\left(\frac{n\pi y}{7}\right)\dx{y}
\end{align*}
Again, we can compute this integral by the method of integration by
parts.  The integrant is $f(y)g'(y)$, where $f(y)=7-2y$ and
$\displaystyle g'(y) = \cos\left(n\pi y/7\right)$.  Hence,
$f'(y) = -2$ and $\displaystyle g(y) =
7/(n\pi) \,\sin\left(n\pi y/7\right)$.  We get
\begin{align*}
a_n\,e^{3n\pi /7} + b_n\,e^{-3n\pi /7}
&= \frac{7^2}{n^2\pi^2}\,(7-2y)\,\sin\left(\frac{n\pi y}{7}\right)\bigg|_0^7 +
\frac{2\cdot 7^2}{n^2\pi^2}\,\int_0^7
\sin\left(\frac{n\pi y}{7}\right)\dx{y} \\
&= \frac{-2\cdot 7^3}{n^3\pi^3}\,\cos\left(\frac{n\pi y}{7}\right)\bigg|_0^7
= \frac{-2\cdot 7^3}{n^3\pi^3}\, \left((-1)^n - 1\right)
\end{align*}
for $n > 0$.

For $n=4$, we have the linear system
\begin{align*}
a_4 + b_4 &= 3 \\
a_4 e^{12\pi/7} + b_4 e^{-12\pi/7} &= 0
\end{align*}
The solution of this system is
$\displaystyle a_4 = \frac{-3 e^{-12\pi/7} }{e^{12\pi/7}-e^{-12\pi/7}}
= \frac{-3 e^{-12\pi/7} }{2\sinh(12\pi/7)}$
and
$\displaystyle b_4 = \frac{3\,e^{12\pi/7}}{e^{12\pi/7}-e^{-12\pi/7}}
= \frac{3\,e^{12\pi/7}}{2\sinh(12\pi/7)}$.

For $n\neq 4$, we get the linear system
\begin{align*}
a_n + b_n &= 0 \\
a_n e^{3n\pi/7} + b_n e^{-3n \pi/7} &=
\frac{-2\cdot 7^3}{n^3\pi^3}\, \left((-1)^n - 1\right)
\end{align*}
The solution of this system is
\[
a_n = -b_n = \frac{-2\cdot 7^3}{n^3\pi^3}\,\left((-1)^n - 1\right)\,
\frac{1}{e^{3n\pi/7} - e^{-3n\pi/7}}
= \frac{2\cdot 7^3 (1 - (-1)^n)}{n^3\pi^3 \sinh(3 n\pi/7)} \ .
\]

The solution of the potential problem is
\begin{align*}
&u(x,y) = \frac{-3}{2\sinh(12\pi/7)}
  \left(e^{-12\pi/7 +4\pi x/7} - e^{12\pi/7 - 4\pi x /7}\right)
  \sin\left(\frac{4\pi y}{7}\right) \\
&\qquad\qquad + \sum_{\substack{n=1\\n\neq 4}}^\infty
\frac{2\cdot 7^3 (1 - (-1)^n)}{n^3\pi^3\sinh(3 n\pi/7)}
\left(e^{n\pi x/7} - e^{-n\pi x/7}\right)\sin\left(\frac{n\pi y}{7}\right) \\
&= \frac{-3}{\sinh(12\pi/7)}\sinh\left(\frac{4\pi(x-3)}{7}\right)
\sin\left(\frac{4\pi y}{7}\right)
+ \sum_{\substack{n=1\\n\neq 4}}^\infty
\frac{7^3 (1 - (-1)^n)}{n^3\pi^3\sinh(3 n\pi/7)}
  \sinh\left(\frac{n\pi x}{7}\right)\sin\left(\frac{n\pi y}{7}\right) \ .
\end{align*}
\end{egg}

\begin{egg}
Find the solution of the following Dirichlet problem.
\[
\Delta u = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0 \quad ,
\quad 0 < y < L \ \text{and} \ -L < x < L \ ,
\]
with the boundary conditions
$u(x,0) = u(x,L) = 0$ for $-L<x<L$,
$u(-L,y) = 50 \sin\left(\pi y/(2L)\right)$ and
$u(L,y) = 50 \sin\left(\pi y/(2L)\right)$ for $0<y<L$.

The simple functions obtained by separation of variables are of the
form
\[
u(x,y) = \left( A e^{kx} + B e^{-kx} \right)
\left(C \cos(ky) + D \sin(ky)\right) \ .
\]
From $u(x,0) = 0$, we get $C\,\left(A e^{kx} + B e^{-kx}\right)=0$ for
$-L<x<L$.  Since we are looking for non-null solutions, we must have
$C=0$ because $A e^{kx} + B e^{-kx}$ cannot be equal to $0$ for all
$x$.  From $u(x,L) = 0$, we then get 
$D\sin(kL)\left(A e^{kx} + B e^{-kx}\right)=0$ for $-L<x<L$.  Hence,
$D\neq 0$ and $\sin(kL)=0$ since we are looking for non-null
solutions.  This implies that $k = k_n \equiv n\pi/L$ for any integer $n>0$.

We have found that the simple functions are of the form
\[
u_n(x,y) \equiv \sin\left(\frac{n\pi y}{L}\right)
\left(a_n e^{n\pi x/L} + b_n e^{-n\pi x/L}\right)
\]
for $n > 0$, where $a_n$ and $b_n$ come from the product of $D$ and
$A$, and $D$ and $B$ respectively for each value of $n$.  The solution
is of the form
\[
u(x,y) = \sum_{n=1}^\infty u_n(x,y) = 
\sum_{n=1}^\infty \sin\left(\frac{n\pi y}{L}\right)
\left(a_n e^{n\pi x/L} + b_n e^{-n\pi x/L}\right) \ .
\]

From $\displaystyle u(-L,y) = 50 \sin\left(\pi y/(2L)\right)$, we get
\[
\sum_{n=1}^\infty \sin\left(\frac{n\pi y}{L}\right)
\left(a_n e^{-n\pi} + b_n e^{n\pi} \right) =
50 \sin\left(\frac{\pi y}{2L}\right) \ .
\]
This is the Fourier sine series of the odd function 50
$\sin\left(\pi y/(2L)\right)$.  Therefore,
\[
a_n e^{-n\pi} + b_n e^{n\pi} =
\frac{100}{L} \int_0^L \sin\left(\frac{n\pi y}{L}\right)
\sin\left(\frac{\pi y}{2L}\right) \dx{y} \ .
\]
If we use the trigonometric identity
$\displaystyle \sin(\theta_1)\sin(\theta_2) = 
\left(\cos(\theta_1-\theta_2) -\cos(\theta_1+\theta_2)\right)/2$,
we get
\begin{align}
a_n e^{-n\pi} + b_n e^{n\pi} &=
\frac{50}{L} \int_0^L \left( \cos\left(\frac{n\pi y}{L}-\frac{\pi y}{2L}\right)
- \cos\left(\frac{n\pi y}{L}+\frac{\pi y}{2L}\right)\right) \dx{y}
\nonumber \\
&= \frac{50}{L} \int_0^L \left( \cos\left(\frac{(2n-1)\pi y}{2L}\right)
- \cos\left(\frac{(2n+1)\pi y}{2L}\right)\right) \dx{y} \nonumber \\
&= \frac{100}{(2n-1)\pi} \sin\left(\frac{(2n-1)\pi y}{2L}\right)\bigg|_0^L
- \frac{100}{(2n+1)\pi} \sin\left(\frac{(2n+1)\pi y}{2L}\right)\bigg|_0^L
\nonumber \\
&= \frac{100}{(2n-1)\pi} \sin\left(\frac{(2n-1)\pi}{2}\right)
- \frac{100}{(2n+1)\pi} \sin\left(\frac{(2n+1)\pi}{2}\right) \nonumber \\
&= \left( \frac{100}{(2n-1)\pi} + \frac{100}{(2n+1)\pi}\right)
\sin\left(\frac{(2n-1)\pi}{2}\right)  \label{laplace_spv_egg2a}
\end{align}
since
\[
\sin\left(\frac{(2n+1)\pi}{2}\right) =
\sin\left(\frac{(2n-1)\pi}{2} + \pi\right)
= -\sin\left(\frac{(2n-1)\pi}{2}\right) \ ,
\]

From $\displaystyle u(L,y) = 50 \sin\left(\pi y/(2L)\right)$,
we get
\[
\sum_{n=1}^\infty \sin\left(\frac{n\pi y}{L}\right)
\left(a_n e^{n\pi} + b_n e^{-n\pi} \right) =
50 \sin\left(\frac{\pi y}{2L}\right) \ .
\]
As for the boundary condition at $x=-L$, this is the Fourier sine series of
this odd function $50 \sin\left(\pi y/(2L)\right)$.  Therefore,
\begin{align}
a_n e^{n\pi} + b_n e^{-n\pi} &=
\frac{100}{L} \int_0^L \sin\left(\frac{n\pi y}{L}\right)
\sin\left(\frac{\pi y}{2L}\right) \dx{y} \nonumber \\
&= \left( \frac{100}{(2n-1)\pi} + \frac{100}{(2n+1)\pi}\right)
\sin\left(\frac{(2n-1)\pi}{2}\right) \label{laplace_spv_egg2b}
\end{align}

From (\ref{laplace_spv_egg2a}) and (\ref{laplace_spv_egg2b}), we get
the linear system
\[
\begin{pmatrix}
e^{n\pi} & e^{-n\pi} \\
e^{-n\pi} & e^{n\pi}
\end{pmatrix}
\begin{pmatrix}
a_n \\ b_n
\end{pmatrix}
=\
\begin{pmatrix}
 \alpha_n \\ \alpha_n
\end{pmatrix} \ ,
\]
where
$\displaystyle
\alpha_n = \left( \frac{100}{(2n-1)\pi} + \frac{100}{(2n+1)\pi}\right)
\sin\left(\frac{(2n-1)\pi}{2}\right)$.
The solution of this linear system is
\begin{align*}
a_n &= b_n = \frac{e^{n\pi} - e^{-n\pi}}{e^{2n\pi}- e^{-2n\pi}}\,\alpha_n
=\frac{e^{n\pi} - e^{-n\pi}}{e^{2n\pi}- e^{-2n\pi}}\,
\left( \frac{100}{(2n-1)\pi} + \frac{100}{(2n+1)\pi}\right)
\sin\left(\frac{(2n-1)\pi}{2}\right) \\
&= (-1)^{n+1}\frac{\sinh(n\pi)}{\sinh(2n\pi)}
\left( \frac{100}{(2n-1)\pi} + \frac{100}{(2n+1)\pi}\right) \ ,
\end{align*}
where we have used $\displaystyle \sin\left(\frac{(2n-1)\pi}{2}\right)
=\sin\left(n\pi - \frac{\pi}{2}\right) = (-1)^{n+1}$.

Finally, the solution of the Dirichlet problem above is 
\begin{align*}
u(x,y) &= \sum_{n=1}^\infty u_n(x,y) \\
& = \sum_{n=1}^\infty
(-1)^{n+1}\frac{\sinh(n\pi)}{\sinh(2n\pi)}
\left( \frac{100}{(2n-1)\pi} + \frac{100}{(2n+1)\pi}\right)
\sin\left(\frac{n\pi y}{L}\right)
\left(e^{n\pi x/L} + e^{-n\pi x/L}\right) \\
& = 2\sum_{n=1}^\infty
(-1)^{n+1}\frac{\sinh(n\pi)}{\sinh(2n\pi)}
\left( \frac{200}{(2n-1)\pi} + \frac{200}{(2n+1)\pi}\right)
\sin\left(\frac{n\pi y}{L}\right)\cosh\left(\frac{n\pi x}{L}\right) \ .
\end{align*}
\end{egg}

\begin{egg}
Find the solution of the following Dirichlet problem.
\label{laplace_split_egg}
\[
\Delta u = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0
\quad , \quad 0 < x < a \ \text{and} \ 0 < y < b \ ,
\]
with the boundary conditions
$u(x,0) = 0$ and $u(x,b) = 0.5\sin\left(7\pi x/a\right)$ for
$0<x<a$, and $u(0,y) = 0.7 \sin\left(2\pi y/b\right)$ and
$u(a,y) = y(b-y)$ for $0<y<b$.

We split the problem into two smaller problems
(Remark~\ref{laplace_split_td} below).

\subI{Problem 1}
Solve the Laplace equation
\[
\Delta u = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0
\quad , \quad 0 < x < a \ \text{and} \ 0 < y < b \ ,
\]
with the boundary conditions $u(x,0) = 0$ and
$u(x,b) = 0.5\sin\left(7\pi x/a\right)$ for $0<x<a$, and
$u(0,y) = u(a,y) = 0$ for $0<y<b$.

\subI{Problem 2}
Solve the Laplace equation
\[
\Delta u = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0
\quad , \quad 0 < x < a \ \text{and} \ 0 < y < b \ ,
\]
with the boundary conditions $u(x,0) = u(x,b) = 0$ for  $0<x<a$, and
$u(0,y) = 0.7 \sin\left(2\pi y/b\right)$ and
$u(a,y) = y(b-y)$ for $0<y<b$.

\subI{Problem 1}
The simple functions obtained by separation of variables are of the
form
\[
u(x,y) = \left( A \cos(kx) + B\sin(kx) \right)
\left(C e^{ky} + D e^{-ky}\right) \ .
\]
From $u(0,y) = 0$, we get $A\left(C e^{ky} + D e^{-ky}\right)=0$ for
$0<y<b$.  Thus $A=0$ because we are looking for non-null solutions.
From $u(a,y) = 0$, we then get
$B\sin(ka)\left(C e^{ky} + D e^{-ky}\right)=0$ for $0<y<b$.  Hence,
$B \neq 0$ and $\sin(ka)=0$ because we are looking for non-null
solutions.  therefore, $k = k_n \equiv n\pi/a$ for any integer $n>0$.

We have found that the simple functions are of the form
\[
u_n(x,y) \equiv \sin\left(\frac{n\pi x}{a}\right)
\left(a_n e^{n\pi y/a} + b_n e^{-n\pi y/a}\right)
\]
for $n > 0$.  The solution is of the form
\[
u(x,y) = \sum_{n=1}^\infty u_n(x,y) = 
\sum_{n=1}^\infty \sin\left(\frac{n\pi x}{a}\right)
\left(a_n e^{n\pi y/a} + b_n e^{-n\pi y/a}\right) \ .
\]

From $u(x,0) = 0$, we get
\[
\sum_{n=1}^\infty \sin\left(\frac{n\pi x}{a}\right)
\left(a_n + b_n \right) = 0 \ .
\]
Thus
\begin{equation} \label{laplace_spv_egg1a}
a_n + b_n = 0 
\end{equation}
for $n > 0$.
From $\displaystyle u(x,b) = 0.5\sin\left(7\pi x/a\right)$, we
get
\[
\sum_{n=1}^\infty \sin\left(\frac{n\pi x}{a}\right)
\left(a_n e^{n\pi b/a} + b_n e^{-n\pi b/a} \right) =
0.5\sin\left(\frac{7\pi x}{a}\right) \  .
\]
Thus
\begin{equation} \label{laplace_spv_egg1b}
a_n e^{n\pi b/a} + b_n e^{-n\pi b/a} = \begin{cases}
0.5 & \text{ if } n = 7 \\
0  & \text{ if } n\neq 7
\end{cases}
\end{equation}

For $n=7$, we get from (\ref{laplace_spv_egg1a}) and
(\ref{laplace_spv_egg1b}) the linear system
\begin{align*}
a_7 + b_7 &= 0 \\
a_7 e^{7\pi b/a} + b_7 e^{-7\pi b/a} &= 0.5
\end{align*}
The solution of this system is
$\displaystyle
a_7 = -b_7 =\frac{1}{\displaystyle 2\left( e^{7\pi b/a} - e^{-7\pi b/a}\right)}
= \frac{1}{4 \sinh(7\pi b/a)}$.

For $n\neq 7$, we get from (\ref{laplace_spv_egg1a}) and
(\ref{laplace_spv_egg1b}) the linear system
\begin{align*}
a_n + b_n &= 0 \\
a_n e^{n\pi b/a} + b_n e^{-n\pi b/a} &= 0
\end{align*}
The solution of this system is $a_n = b_n = 0$ because
\[
\det
\begin{pmatrix}
1 & 1 \\
e^{n\pi b/a} & e^{-n\pi b/a}
\end{pmatrix}
= e^{-n\pi b/a}-e^{n\pi b/a} =
e^{-n\pi b/a} \left( 1 - e^{2n\pi b/a}\right) \neq 0
\]
for $n\neq 0$.  The solution of the first problem is
\begin{equation} \label{laplace_spv_egg1c}
u(x,y) = \sin\left(\frac{7\pi x}{a}\right)
\left(\frac{e^{7\pi y/a} - e^{-7\pi y/a}}{4 \sinh(7\pi b/a)} \right)
= \frac{1}{2 \sinh(7\pi b/a)}\, \sin\left(\frac{7\pi x}{a}\right)
\sinh\left(\frac{7\pi y}{a}\right) \ .
\end{equation}

\subI{Problem 2}
The simple functions obtained by separation of variables are of the
form
\[
u(x,y) = \left( A e^{kx} + B e^{-kx} \right)
\left(C \cos(ky) + D \sin(ky)\right) \  .
\]
From $u(x,0) = 0$, we get $C \left(A e^{kx} + B e^{-kx}\right)=0$ for
$0<x<a$.  Thus $C=0$ because we are looking for non-null solutions.
From $u(x,b) = 0$, we then get
$D\sin(kb)\left(A e^{kx} + B e^{-kx}\right)=0$ for $0<x<a$.  Hence,
$D \neq 0$ and $\sin(kb)=0$ because we are looking for non-null
solutions.  Therefore, $k = k_n \equiv n\pi/b$ for any integer $n>0$.

We have found that the simple functions are of the form
\[
u_n(x,y) \equiv \sin\left(\frac{n\pi y}{b}\right)
\left(a_n e^{n\pi x/b} + b_n e^{-n\pi x/b}\right)
\]
for $n > 0$.  The solution is of the form
\[
u(x,y) = \sum_{n=1}^\infty u_n(x,y) = 
\sum_{n=1}^\infty \sin\left(\frac{n\pi y}{b}\right)
\left(A_n e^{n\pi x/b} + B_n e^{-n\pi x/b}\right) \ .
\]

From $\displaystyle u(0,y) = 0.7 \sin\left(2\pi y/b\right)$,
we get
\[
\sum_{n=1}^\infty \sin\left(\frac{n\pi y}{b}\right)
\left(a_n + b_n \right) = 0.7 \sin\left(\frac{2\pi y}{b}\right) \  .
\]
Thus
\begin{equation} \label{laplace_spv_egg1d}
a_n+b_n = \begin{cases} 0.7 & \text{ if } n = 2 \\
0 & \text{ if } n\neq 2
\end{cases}
\end{equation}
From $\displaystyle u(a,y) = y(b-y)$, we get
\[
\sum_{n=1}^\infty \sin\left(\frac{n\pi y}{b}\right)
\left(A_n e^{n\pi a/b} + B_n e^{-n\pi a/b} \right) = y(b-y) \ .
\]
This is the Fourier sine series of $y(b-y)$, therefore
\[
a_n e^{n\pi a/b} + b_n e^{-n\pi a/b} =
\frac{2}{b} \int_0^b y(b-y) \sin\left(\frac{n\pi y}{b}\right) \dx{y} \ .
\]
We can compute this integral by the method of integration by parts.
The integrant is $f(y)g'(y)$, where $f(y)=y(b-y)$ and
$\displaystyle g'(y) = \sin\left(n\pi y/b\right)$.  Thus,
$f'(y) = b-2y$ and
$\displaystyle g(y) = -b/(n\pi)\,\cos\left(n\pi y/b\right)$.
We get
\begin{align*}
a_n e^{n\pi a/b} + b_n e^{-n\pi a/b}
&= -\frac{2}{b}\left(\frac{b}{n\pi}\,y(b-y)\,
\cos\left(\frac{n\pi y}{b}\right)\right)\bigg|_0^b +
\frac{2}{n\pi}\,\int_0^b (b-2y)\,\cos\left(\frac{n\pi y}{b}\right)\dx{y} \\
&=
\frac{2}{n\pi}\,\int_0^b (b-2y)\,\cos\left(\frac{n\pi y}{b}\right)\dx{y} \ .
\end{align*}
Again, we can compute this integral by the method of integration by
parts.  The integrant is $f(y)g'(y)$, where $f(y)=b-2y$ and
$\displaystyle g'(y) = \cos\left(n\pi y/b\right)$.  Thus,
$f'(y) = -2$ and $\displaystyle g(y) =
b/(n\pi)\,\sin\left(n\pi y/b\right)$.  We get
\begin{align}
&a_n e^{n\pi a/b} + b_n e^{-n\pi a/b}
= \frac{2}{n\pi}\,\left(\frac{b}{n\pi}\,(b-2y)\,
\sin\left(\frac{n\pi y}{b}\right) \right)\bigg|_0^b +
\frac{4b}{n^2\pi^2}\,\int_0^b \sin\left(\frac{n\pi y}{b}\right)\dx{y}
\nonumber \\
&\qquad = \frac{4b}{n^2\pi^2}\,\int_0^b \sin\left(\frac{n\pi y}{b}\right)\dx{y}
=- \frac{4b^2}{n^3\pi^3}\,\cos\left(\frac{n\pi y}{b}\right)\bigg|_0^b
= \frac{4b^2}{n^3\pi^3}\,\left( 1 - (-1)^n\right)  \label{laplace_spv_egg1e}
\end{align}
for $n > 0$. 

For $n=2$, we get from (\ref{laplace_spv_egg1d}) and
(\ref{laplace_spv_egg1e}) the linear system
\begin{align*}
a_2 + b_2 &= 0.7 \\
a_2 e^{2\pi a/b} + b_2 e^{-2\pi a/b} &= 0
\end{align*}
The solution of this system is
$\displaystyle a_2 = \frac{-0.7\,e^{-2\pi a/b}}{2\sinh(2\pi a/b)}$
and $\displaystyle b_2 = \frac{0.7\,e^{2\pi a/b}}{2\sinh(2\pi a/b)}$.

For $n\neq 2$, we get from (\ref{laplace_spv_egg1a}) and
(\ref{laplace_spv_egg1b}) the linear system
\begin{align*}
a_n + b_n &= 0 \\
a_n e^{n\pi a/b} + b_n e^{-n\pi a/b} &=
\frac{4b^2}{n^3\pi^3}\,\left( 1 - (-1)^n\right)
\end{align*}
The solution of this system is
\[
a_n = -b_n = \left(\frac{1}{e^{n\pi a/b} - e^{-n\pi a/b}}\right)\,
\frac{4b^2}{n^3\pi^3}\,\left(1- (-1)^n\right)
= \frac{2b^2 \left(1- (-1)^n\right)}{n^3\pi^3\,\sinh(n\pi a/b)} \ .
\]
The solution of the second problem is
\begin{align*}
  u(x,y) &=
\left( \frac{-0.7\,e^{-2\pi a/b}}{2\sinh(2\pi a/b)} e^{2\pi x/b}
+ \frac{0.7\,e^{2\pi a/b}}{2\sinh(2\pi a/b)} e^{-2\pi x/b} \right)
\sin\left(\frac{2 \pi y }{b}\right) \\
&\qquad + \sum_{\substack{n=1\\n\neq 2}}^\infty
\frac{2b^2 \left(1- (-1)^n\right)}{n^3\pi^3\,\sinh(n\pi a/b)}
\left(e^{n\pi x/b} - e^{-n\pi x/b}\right)\sin\left(\frac{n\pi y}{b}\right) \\
&= \frac{-0.7}{\sinh(2\pi a/b)}\sinh\left(\frac{2\pi(x-a)}{b}\right)
\sin\left(\frac{2 \pi y }{b}\right) \\
&\qquad + \sum_{\substack{n=1\\n\neq 2}}^\infty
\frac{4b^2 \left(1- (-1)^n\right)}{n^3\pi^3\,\sinh(n\pi a/b)}
\sinh\left(\frac{n\pi x}{b}\right)\sin\left(\frac{n\pi y}{b}\right) \ .
\end{align*}
Since
\[
1-(-1)^n =
\begin{cases}
2 & \quad \text{for $n$ odd} \\
0 & \quad \text{for $n$ even}
\end{cases}
\]
we get the solution
\begin{align}
&u(x,y)
= \frac{-0.7}{\sinh(2\pi a/b)}\,\sin\left(\frac{2\pi y}{b}\right)
\sinh\left(\frac{2\pi (x-a)}{b}\right) \nonumber \\
&+ \sum_{k=0}^\infty \frac{8b^2}{(2k+1)^3\pi^3\,
\sinh((2k+1)\pi a/b)}
\sin\left(\frac{(2k+1)\pi y}{b}\right)\sinh\left(\frac{(2k+1)\pi x}{b}\right)
\ .  \label{laplace_spv_egg1f}
\end{align}

\subI{Complete Solution}
The sum of (\ref{laplace_spv_egg1c}) and (\ref{laplace_spv_egg1f}) gives the
solution of the full Dirichlet problem.
\end{egg}

\begin{rmk}
Consider the Dirichlet problem
\begin{equation} \label{laplace_split_td_one}
\Delta u = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0
\quad , \quad 0 < x < a \ \text{and} \ 0 < y < b \ ,
\end{equation}
with the boundary conditions $u(x,0) = f_1(x)$ and $u(x,b) = f_2(x)$
for $0<x<a$, and $u(0,y) = g_1(y)$ and $u(a,y) = g_2(y)$ for $0<y<b$.

Suppose that the compatibility conditions $f_1(0) = g_1(0)$, $f_1(a) =
g_2(0)$, $f_2(0) = g_1(b)$ and $f_2(a) = g_2(b)$ are satisfied.
Namely, the boundary conditions match at the corners.  These
compatibility conditions are necessary to get a classical solution.

If we split the problem in two as we did in
Example~\ref{laplace_split_egg}, we get:

\subI{Problem 1}
Solve
\[
\Delta u = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0
\quad , \quad 0 < x < a \ \text{and} \ 0 < y < b \ ,
\]
with the boundary conditions $u(x,0) = f_1(x)$ and
$u(x,b) = f_2(x)$ for $0<x<a$, and 
$u(0,y) = 0$ and $u(a,y) = 0$ for $0<y<b$.

\subI{Problem 2}
Solve
\[
\Delta u = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0
\quad , \quad 0 < x < a \ \text{and} \ 0 < y < b \ ,
\]
with the boundary conditions
$u(x,0) = 0$ and $u(x,b) = 0$ for $0<x<a$, and
$u(0,y) = g_1(y)$ and $u(a,y) = g_2(y)$ for $0<y<b$.

However, the boundary conditions may not match at the corners for the
two reduced problems above.  If $f_1(0) = g_1(0) \neq 0$, then the
compatibility condition is broken at the $(0,0)$ corner of the domain
for both reduced problems.  In Example~\ref{laplace_split_egg},
there was no such problem because $f_1(0) = f_1(a) = f_2(0) = f_2(a) = 0$
and $g_1(0) = g_1(b) = g_2(0) = g_2(b) = 0$.

To be able to split the problem and expect a classical solution, we
must make sure that $f_1(0) = f_1(a) = f_2(0) = f_2(a) = 0$ and
$g_1(0) = g_1(b) = g_2(0) = g_2(b) = 0$.  To do so, we first choose a
polynomial $p:\RR^2\to \RR$ of degree two such that
$\Delta p = 0$ with
$p(0,0) = f_1(0) = g_1(0)$, $p(a,0) = f_1(a) = g_2(0)$,
$p(0,b) = f_2(0) = g_1(b)$ and $p(a,b) = f_2(a) = g_2(b)$.
We consider instead of (\ref{laplace_split_td_one}) the Dirichlet
problem
\[
\Delta w = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0 \quad ,
\quad 0 < x < a \ \text{and} \ 0 < y < b \ ,
\]
with the boundary conditions
$w(x,0) = f_1(x) - p(x,0)$ and $w(x,b) = f_2(x) - p(x,b)$
for $0<x<a$, and $w(0,y) = g_1(y) - p(0,y)$ and
$w(a,y) = g_2(y) - p(a,y)$ for $0<y<b$.

For this problem, the boundary conditions match and are null at the
corners .  We may split this Dirichlet problem to find its solution
$w$.  The final solution of (\ref{laplace_split_td_one}) is $u = w + p$.

Because $\Delta p = 0$, the polynomial $p$ has to be of the form
$p(x,y) = a_{2,2}(x^2-y^2) + a_{1,1}xy + a_{1,0}x + a_{0,1}y + a_{0,0}$.
To satisfy the conditions
$p(0,0) = f_1(0) = g_1(0)$, $p(a,0) = f_1(a) = g_2(0)$,
$p(0,b) = f_2(0) = g_1(b)$ and $p(a,b) = f_2(a) = g_2(b)$, we find
that we may take $a_{2,2} = 0$ to get
$a_{0,0} = f_1(0)$, $a_{1,0} = (f_1(a) - f_1(0))/a$,
$a_{0,1} = (f_2(0) - f_1(0))/b$ and
$a_{1,1} = (f_2(a) - f_1(a) -f_2(0) + f_1(0))/(ab)$.
\label{laplace_split_td}
\end{rmk}

\begin{egg}
Find the solution of the following Neumann problem.
\[
\Delta u = \pdydxn{u}{x}{2} + \pdydxn{u}{y}{2} = 0 \quad ,
\quad 0 < y < \pi \ \text{and} \ 0 < x < \pi \ ,
\]
with the boundary conditions
$\displaystyle \pdydx{u}{x}(0,y) = \pdydx{u}{x}(\pi,y) = 0$
for $0<y<\pi$, and
$\displaystyle \pdydx{u}{y}(x,0) =0$ and
$\displaystyle \pdydx{u}{y}(x,\pi) = x - \frac{\pi}{2}$
for $0<x<\pi$.

Note that the consistency condition for the Neumann problem,
Proposition~\ref{pot_nec_Nprobl}, is satisfied; namely,
\begin{equation} \label{laplace_spv_npc}
\int_{\partial R} \pdydx{u}{\nu} \dx{s} = \int_0^\pi \pdydx{u}{y}(x,\pi) \dx{x}
= \int_0^\pi \left(x-\frac{\pi}{2}\right)\dx{x}
= \frac{1}{2}\,\left( x - \frac{\pi}{2}\right)^2\bigg|_0^\pi = 0 \ ,
\end{equation}
where
$\displaystyle R = \{ (x,y) : 0 \leq y \leq \pi \ \text{and}
\ 0 \leq x \leq \pi\}$
and $\nu(x,y)$ is the outward unit normal to the surface $\partial R$
at the point $(x,y) \in \partial R$ (except at the corners of the domain).

\subI{Separation of Variables}
If we substitute $u(x,y) = F(x)G(y)$ in $\Delta u = 0$, we get
\[
\dydxn{F}{x}{2}(x)\,G(y) + F(x)\,\dydxn{G}{y}{2}(y) = 0 \quad ,
\quad 0 < y < \pi \ \text{and} \ 0 < x < \pi \ .
\]
Thus, after dividing both sides by $F(x)G(y)$, we get
\[
\frac{1}{F(x)}\,\dydxn{F}{x}{2}(x) = -\frac{1}{G(y)}\,\dydxn{G}{y}{2}(y)
\quad , \quad 0 < y < \pi \ \text{and} \ 0 < x < \pi \ .
\]
Since the right hand side is independent of $x$ and the left hand side
is independent of $y$, we get
\[
\frac{1}{F(x)}\,\dydxn{F}{x}{2}(x) = -\frac{1}{G(y)}\,\dydxn{G}{y}{2}(y)
= k  \quad , \quad 0 < y < \pi \ \text{and} \ 0 < x < \pi \ .
\]
for some constant $k$.  We end up with two ordinary differential equation.
\begin{equation} \label{laplace_spv_egg1_ode}
\dydxn{F}{x}{2}(x) -k F(x) = 0 \quad \text{and}
\quad \dydxn{G}{y}{2}(y) + k\,G(y) = 0 \ .
\end{equation}

\subI{Simple Functions}
The first ordinary differential equation in
(\ref{laplace_spv_egg1_ode}) satisfies two boundary
conditions.   From $\displaystyle \pdydx{u}{x}(0,y) = 0$, we get
$\displaystyle \dydx{F}{x}(0)G(y)=0$.  Since we are looking for
non-null solutions, $G$ must be non-null and we get
$\displaystyle \dydx{F}{x}(0)=0$.  Similarly,
from $\displaystyle \pdydx{u}{x}(\pi,y) = 0$, we
get $\displaystyle \dydx{F}{x}(\pi)G(y)=0$.  Again, since we are
looking for non-null solutions, $G$ must be non-null and we get
$\displaystyle \dydx{F}{x}(\pi)=0$.
The boundary conditions for the first ordinary differential equation in
(\ref{laplace_spv_egg1_ode}) are
$\displaystyle \dydx{F}{x}(0)=\dydx{F}{x}(\pi)=0$.

We consider the boundary value problem
\begin{equation}\label{laplace_spv_egg1_bvpX}
\dydxn{F}{x}{2}(x) -k F(x) = 0  \quad , \quad 0 < x < \pi \ ,
\end{equation}
with the boundary conditions
$\displaystyle \dydx{F}{x}(0) = \dydx{F}{x}(\pi) = 0$.

If $k>0$, the roots of the characteristic equation are $\pm \sqrt{k}$.
Since the roots are real, the general solution of the ordinary
differential equation in
(\ref{laplace_spv_egg1_bvpX}) is of the form
\[
F(x) = A e^{\sqrt{k}\,x} + B e^{-\sqrt{k}\, x} \ .
\]
However, $\displaystyle \dydx{F}{x}(0)=0$ implies that $A - B=0$ and
$\displaystyle \dydx{F}{x}(\pi)=0$ implies
$\displaystyle A e^{\pi\sqrt{k}} - B e^{-\pi\sqrt{k}} = 0$.
The only solution of the system
\[
\begin{pmatrix}
1 & -1 \\ e^{\pi\sqrt{k}} & -e^{-\pi\sqrt{k}}
\end{pmatrix}
\begin{pmatrix}
A \\ B
\end{pmatrix}
=
\begin{pmatrix}
0 \\ 0
\end{pmatrix}
\]
is $A=B=0$ because
\[
\det
\begin{pmatrix}
1 & -1 \\  e^{\pi\sqrt{k}} &  -e^{-\pi\sqrt{k}}
\end{pmatrix}
= -e^{-\pi\sqrt{k}} + e^{\pi\sqrt{k}} =
-e^{-\pi\sqrt{k}}\left(1-e^{2\pi\sqrt{k}}\right) \neq 0
\]
for $k\neq 0$.  Therefore, the null solution is the only solution
of the boundary value problem for $k>0$.

If $k=0$, the general solution of the ordinary differential equation in
(\ref{laplace_spv_egg1_bvpX}) is $F(x)=B_0 x+ A_0$.
However, both $\displaystyle \dydx{F}{x}(0)=0$ and
$\displaystyle \dydx{F}{x}(\pi)=0$ imply that $B_0=0$.  Hence, $A_0$
is free.  We get the solution $F_0(x) \equiv A_0$ for
the boundary value problem.

If $k<0$, the roots of the characteristic equation are $\pm i \sqrt{-k}$.
Since the roots are complex, the general solution of the ordinary
differential equation in (\ref{laplace_spv_egg1_bvpX}) is of the form
\[
F(x) = A \cos\left(\sqrt{-k}\,x\right)
+ B \sin\left(\sqrt{-k}\,x\right) \ .
\]
However, we get $B =0$ from $\displaystyle \dydx{F}{x}(0)=0$.  It then
follows from $\displaystyle \dydx{F}{x}(\pi)=0$ that\\
$-A \sqrt{-k} \sin\left(\pi\sqrt{-k}\right) = 0$.  If we take $A=0$,
we get the null solution.  We must therefore have
$\sin\left(\pi\sqrt{-k}\right) = 0$ with $k>0$.  This implies
that $k = k_n \equiv -n^2$ for $n>0$.  The boundary value
problem (\ref{laplace_spv_egg1_bvpX}) has non-null 
solutions only for $k=k_n = -n^2<0$ with any integer $n>0$, and the
solutions associated are of the form
$\displaystyle F(x)=F_n(x) \equiv A_n \cos(nx)$ for $n > 0$.

We consider the differential equation
\[
\dydxn{G}{y}{2}(y) + k\,G(y) = 0 \ .
\]
For $k=0$, we get the general solution
$G_0(y) \equiv C_0 y + D_0$ and, for $k= -n^2$ with $n>0$, we get the
general solution $\displaystyle G_n(y) \equiv C_n e^{ny} + D_n e^{-ny}$.

The simple functions obtained by separation of variables are
$\displaystyle u_0(x,y) \equiv a_0 y + b_0$ and
$\displaystyle u_n(x,y) \equiv \cos(n x)\left(a_n e^{n y} + b_n e^{-n y}\right)$
for all integers $n>0$, where $a_n = C_n A_n$ and $b_n = D_n A_n$.

The solution is of the form
\[
u(x,y) = \sum_{n=0}^\infty u_n(x,y) =  a_0 y + b_0
+ \sum_{n=1}^\infty \cos(n x)\left(a_n e^{n y} + b_n e^{-n y}\right) \ .
\]

Since
\[
\pdydx{u}{y}(x,y) =  a_0
+ \sum_{n=1}^\infty \cos(n x)\left(n a_n e^{n y} -n b_n e^{-n y}\right) \ ,
\]
we get from $\displaystyle \pdydx{u}{y}(x,0) = 0$ that
\[
a_0 + \sum_{n=1}^\infty \cos(n x)\left(n a_n -n b_n\right) = 0 \  .
\]
Thus
\begin{equation} \label{laplace_spv_egg3a}
a_0 = 0 \quad \text{and} \quad n a_n - n b_n = 0
\end{equation}
for all integers $n>0$.
We also get from $\displaystyle \pdydx{u}{y}(x,\pi) = x - \frac{\pi}{2}$ that
\[
a_0 +
\sum_{n=1}^\infty \cos(n x)\left(n a_n e^{n \pi} -n b_n e^{-n \pi}\right)
= x - \frac{\pi}{2} \ .
\]
This is the Fourier cosine series of $\displaystyle x -\pi/2$.
Since
\[
a_0 = \frac{1}{\pi} \int_0^\pi \left( x - \frac{\pi}{2} \right) \dx{x} = 0 \  ,
\]
the constant term of the Fourier cosine series of
$\displaystyle x - \pi/2$ is null.  This is exactly what we
have in (\ref{laplace_spv_egg3a}).  This is a concrete justification
for the consistency condition (\ref{laplace_spv_npc}).
The other terms of the Fourier cosine series are given by
\[
n a_n e^{n \pi} -n b_n e^{-n \pi}
= \frac{2}{\pi} \int_0^\pi \left( x -\frac{\pi}{2} \right) \cos(n x)
\dx{x}
\]
for $n> 0$.
We use integration by parts to compute this last integral.
The integrant is of the form $f(x)g'(x)$ where
$\displaystyle f(x) = x - \pi/2$ and
$g'(x) = \cos(n x)$.  Thus $f'(x) = 1$ and
$\displaystyle g(x) = (1/n) \sin(nx)$.  We end up with
\begin{align}
n a_n e^{n \pi} -n b_n e^{-n \pi}
&= \frac{2}{\pi} \left(\frac{1}{n}\left(x -\frac{\pi}{2}\right)
  \sin(nx)\bigg|_0^\pi - \frac{1}{n}\int_0^\pi \sin(nx) \dx{x} \right)
\nonumber \\
&= \frac{2}{n^2\pi} \cos(nx)\bigg|_0^\pi
= \frac{2}{n^2\pi} \left( (-1)^n-1\right) \label{laplace_spv_egg3c}
\end{align}
for $n>0$.

For $n>0$, we get the following system of linear equations from
(\ref{laplace_spv_egg3a}) and (\ref{laplace_spv_egg3c}).
\[
\begin{pmatrix}
n & -n \\ n e^{n \pi} & -n e^{-n \pi}
\end{pmatrix}
\begin{pmatrix}
a_n \\ b_n
\end{pmatrix}
=
\begin{pmatrix}
0 \\ 2\left( (-1)^n-1\right)/(n^2\pi)
\end{pmatrix}
\ .
\]
The solution of this system is
\[
a_n = b_n = \frac{2\left( (-1)^n-1\right)}{n^3\,\pi(e^{n\pi} - e^{n\pi})}
= \frac{ (-1)^n-1}{n^3\,\pi \sinh(n\pi)}
=
\begin{cases}
\displaystyle \frac{-2}{n^3\,\pi \sinh(n\pi)} & \quad \text{for $n$ odd} \\
0 & \quad \text{for $n$ even}
\end{cases}
\]

The solution of the Neumann problem is
\[
u(x,y) = b_0
- \sum_{k=1}^\infty \frac{4}{(2k-1)^3\,\pi \sinh\left((2k-1)\pi\right)}
\cos\left( (2k-1) x\right) \cosh\left((2k-1) y\right) \ .
\]
Since the boundary conditions involve only derivatives, it is not
surprising that there are no constrains on $b_0$.  Namely, $b_0$
is a free parameter.
\end{egg}

\subsection{Cylindrical and Spherical Coordinates}

We have seen the polar, cylindrical and spherical changes of
coordinates in Section~\ref{wave_cyl_sph_coord}.  In particular, we
have seen that the Laplacian in spherical coordinates is
\[
\Delta u = \pdydxn{u}{r}{2} + \frac{2}{r} \pdydx{u}{r}
+ \frac{1}{r^2} \pdydxn{u}{\phi}{2} + \frac{\cot(\phi)}{r^2}
\pdydx{u}{\phi} + \frac{1}{r^2\sin^2(\phi)}
\pdydxn{u}{\theta}{2} \ .
\]

\begin{egg}
Solve the potential equation
\[
\Delta u = 0 \quad , \quad \|(x,y,z)\|_2 < R
\]
with the condition that $u$ is bounded at the origin and $u$ satsifies
the boundary condition $u(R,\theta, \phi) = f(\phi)$ for
$0 \leq \phi \leq \pi$.   \label{laplace_spv_pe_sphc_egg1}

Since the boundary condition is independent of $\theta$, we may
assume that the solution $u$ is also independent of $\theta$.  Thus,
the potential equation becomes
\begin{equation} \label{laplace_spv_pe_sphc}
\Delta u = \pdydxn{u}{r}{2} + \frac{2}{r} \pdydx{u}{r}
+ \frac{1}{r^2} \pdydxn{u}{\phi}{2} + \frac{\cot(\phi)}{r^2}
\pdydx{u}{\phi} = 0
\quad , \quad \|(x,y,z)\|_2 < R \ .
\end{equation}

\subI{Separation of Variables}
If we substitute $u(r,\phi) = F(r)G(\phi)$ in (\ref{laplace_spv_pe_sphc}) and
multiply by $r^2$, we get
\[
r^2 \dydxn{F}{r}{2}(r)G(\phi) + 2r \dydx{F}{r}(r)G(\phi) +
F(r)\dydxn{G}{\phi}{2}(\phi) + \cot(\phi) F(r)\dydx{G}{\phi}(\phi) =0 \ .
\]
After dividing by $F(r)G(\phi)$, we get
\[
\frac{1}{F(r)} \dfdx{\left(r^2 \dydx{F}{r}(r)\right)}{r}
= - \frac{1}{\sin(\phi)G(\phi)}
\dfdx{\left(\sin(\phi) \dydx{G}{\phi}(\phi)\right)}{\phi} \ .
\]
Since the left hand side is independent of $\phi$ and the right hand
side is independent of $r$, we get
\[
\frac{1}{F(r)} \dfdx{\left(r^2 \dydx{F}{r}(r)\right)}{r}
= - \frac{1}{\sin(\phi)G(\phi)}
\dfdx{\left(\sin(\phi) \dydx{G}{\phi}(\phi)\right)}{\phi} = k \ ,
\]
where $k$ is constant.  This yields two ordinary differential equations.
\begin{align}
r^2 \dydxn{F}{r}{2}(r) + 2r \dydx{F}{r}(r) - k F(r) &= 0
\label{laplace_spv_pe_sphc1}
\intertext{and}
\frac{1}{\sin(\phi)}
\dfdx{\left(\sin(\phi) \dydx{G}{\phi}(\phi)\right)}{\phi} + kG(\phi)
&= 0 \ . \label{laplace_spv_pe_sphc2}
\end{align}

\subI{Simple Functions}
We first solve (\ref{laplace_spv_pe_sphc2}).  Let $w = \cos(\phi)$.
We have \\
$\displaystyle \dydx{H}{\phi}(\phi) = \dydx{H}{w}(w)\, \dydx{w}{\phi}(\phi)
= -\sin(\phi) \dydx{H}{w}(w)$
and so
$\displaystyle \frac{1}{\sin(\phi)} \dydx{H}{\phi}(\phi) = -\dydx{H}{w}(w)$
for any differentiable function $H$.  As usual, to simplify the notation, we
keep the same name $H$ as a function of $\phi$ and $H$ as a function of
$w$.  We then have $H(\phi) = H(w)$ for $w=\cos(\phi)$.
Hence, for $H=G$, we get
\[
\sin(\phi) \dydx{G}{\phi}(\phi) = - \sin^2(\phi) \dydx{G}{w}(w)
= \left( \cos^2(\phi) - 1 \right) \dydx{G}{w}(w)
= (w^2-1)  \dydx{G}{w}(w) \ .
\]
With the change of variable $w = \cos(\phi)$, the equation
(\ref{laplace_spv_pe_sphc2}) becomes
\[
- \dfdx{ \left( (w^2-1) \dydx{G}{w}(w) \right) }{w} + k G(w) = 0 \ .
\]
If we expand this equation, we get the Legendre equation
\[
(1-w^2) \dydxn{G}{w}{2}(w) -2 w \dydx{G}{w}(w) + k G(w) = 0
\]
for $-1 \leq w \leq 1$ because $0 \leq \phi \leq \pi$.  As we saw in
Section~\ref{SectLegendrePoly}
the Legendre equation has bounded solutions on $]-1,1[$ only when
$k=n(n+1)$.  These solutions are scalar
multiple of the Legendre polynomial $P_n(w)$. Thus, we take
$G(\phi) = G_n(\phi) \equiv P_n(\cos(\phi))$ for integers $n \geq 0$.

We now turn our attention to (\ref{laplace_spv_pe_sphc1}) with $k=n(n+1)$.
This is an Euler-Cauchy ordinary differential equation.  The method to
solve this ordinary differential equation is well known.  If we
substitute $F(r) = r^\alpha$ in
(\ref{laplace_spv_pe_sphc1}), we get the characteristic equation
$\alpha(\alpha-1) + 2 \alpha + k=0$.  If $\alpha_1$ and $\alpha_2$ are
distinct roots of this equation, then the general solution of
(\ref{laplace_spv_pe_sphc1}) is given by
$F(r) = A r^{\alpha_1} + B r^{\alpha_2}$.  If there is only one root
$\alpha$ of algebraic multiplicity two, then the general solution of
(\ref{laplace_spv_pe_sphc1}) is given by
$F(r) = A r^{\alpha} + B r^{\alpha}\ln(r)$.

If we substitute $k=n(n+1)$ in (\ref{laplace_spv_pe_sphc1}), we get
the characteristic equation
\[
\alpha(\alpha+1) - n(n+1) = (\alpha-n)(\alpha+n+1) = 0 \ .
\]
Its roots are $\alpha_1 = n$ and $\alpha_2 = -n-1$.  The general
solution of (\ref{laplace_spv_pe_sphc1}) with $k=n(n+1)$ is therefore
\begin{equation} \label{laplace_spv_pe_sphc3}
F(r) = F_n(r) \equiv A_n r^n + B_n r^{-n-1}
\end{equation}
for $n \geq 0$.  Since we are looking for bounded solutions at the
origin, we must have $B_n = 0$ for all $n$.

The simple functions are
\[
u_n(r,\phi) \equiv F_n(r)G_n(\phi) = A_n r^n P_n(\cos(\phi))
\]
for $n \geq 0$.

\subI{Boundary Condition}
We seek a solution of the form
\[
u(r,\phi) = \sum_{n=0}^\infty u_n(r,\phi)
= \sum_{n=0}^\infty A_n r^n P_n(\cos(\phi))
\quad , \quad 0 < r < R \ \text{and} \ 0 \leq \phi \leq \pi \ .
\]

From the Boundary condition $u(R,\phi) = f(\phi)$, we get
\[
f(\phi) = \sum_{n=0}^\infty A_n R^n P_n(\cos(\phi)) \ .
\]
The change of variable $w=\cos(\phi)$ (or $\phi= \arccos(w)$) shows
that this is the Fourier-Legendre series of $f(\arccos(w))$ with
respect to the polynomials $P_n(w)$ for $n \geq 0$.
Hence
\[
A_n R^n = \frac{2n+1}{2} \int_{-1}^1 f(\arccos(w)) P_n(w) \dx{w}
= \frac{2n+1}{2} \int_0^\pi f(\phi) P_n(\cos(\phi)) \sin(\phi) \dx{\phi} \ ,
\]
\end{egg}

\begin{egg}
Solve the potential equation
\[
\Delta u = 0 \quad , \quad \|(x,y,z)\|_2 > R
\]
with the condition that $u$ vanished at infinity and $u$ satisfies the
boundary condition\\
$u(R,\theta, \phi) = f(\phi)$ for $0 \leq \phi \leq \pi$.

The solution of this problem starts exactly like in Example
\ref{laplace_spv_pe_sphc_egg1}.  The solution 
takes a different direction at (\ref{laplace_spv_pe_sphc3}).  Since we
are now looking for a solution that goes to $0$ as $r$ converges to
infinity, we must take $A_n =0$ for $n \geq 0$.

The simple functions are
\[
u_n(r,\phi) \equiv F_n(r)G_n(\phi) = B_n r^{-n-1} P_n(\phi)
\]
for $n \geq 0$.

\subI{Boundary Condition}
We seek a solution of the form
\[
u(r,\phi) = \sum_{n=0}^\infty u_n(r,\phi)
= \sum_{n=0}^\infty B_n r^{-n-1} P_n(\phi)
\quad , \quad r > R \ \text{and} \ 0 \leq \phi \leq \pi \ .
\]

From the Boundary condition $u(R,\phi) = f(\phi)$, we get
\[
f(\phi) = \sum_{n=0}^\infty B_n R^{-n-1} P_n(\cos(\phi)) \ .
\]
This is the Fourier-Legendre series of $f(\arccos(w))$ with respect to
the polynomials $P_n(w)$ for $n \geq 0$.
Therefore
\[
B_n R^{-n-1} = \frac{2n+1}{2} \int_{-1}^1 f(\arccos(w)) P_n(w) \dx{w}
= \frac{2n+1}{2} \int_0^\pi f(\phi) P_n(\cos(\phi)) \sin(\phi) \dx{\phi} \ ,
\]
where we have used the change of variable $w=\cos(\phi)$ for
$0\leq \phi \leq \pi$.
\end{egg}

\begin{egg}
Solve the potential equation
\[
\Delta u = 0 \quad , \quad 0< R_1 < \|(x,y,z)\|_2 < R_2
\]
with the condition that $u$ is bounded and the boundary
conditions $u(R_1,\theta, \phi) = f(\phi)$ and
$u(R_2,\theta, \phi) = g(\phi)$ for $0 \leq \phi \leq \pi$.

The solution of this problem starts exactly like in Example
\ref{laplace_spv_pe_sphc_egg1}.  The solution takes a different direction at
(\ref{laplace_spv_pe_sphc3}).  Since the domain is the bounded annulus
$\{ (x,y,z) : R_1 < \|(x,y,z)\|_2 < R_2 \}$, there is no reason for the
$A_n$ and $B_n$ to be zero.

The simple functions are
\[
u_n(r,\phi) \equiv F_n(r)G_n(\phi) = \left(A_n r^n + B_n r^{-n-1}\right)
P_n(\phi)
\]
for $n \geq 0$.

\subI{Boundary Condition}
We seek a solution of the form
\[
u(r,\phi) = \sum_{n=0}^\infty u_n(r,\phi)
= \sum_{n=0}^\infty \left(A_n r^n + B_n r^{-n-1}\right) P_n(\phi)
\quad , \quad R_1 < r < R_2 \ \text{and} \ 0 \leq \phi \leq \pi \ .
\]

From the Boundary condition $u(R_1,\phi) = f(\phi)$, we get
\[
f(\phi) = \sum_{n=0}^\infty \left(A_n R_1^n + B_n R_1^{-n-1}\right)
P_n(\cos(\phi)) \ .
\]
This is the Fourier-Legendre series of $f(\arccos(w))$ with respect to
the polynomials $P_n(w)$ for $n\leq 0$.
Therefore,
\[
A_n R_1^n + B_n R_1^{-n-1} =
\frac{2n+1}{2} \int_0^\pi f(\phi) P_n(\cos(\phi)) \sin(\phi) \dx{\phi} \ .
\]
From the Boundary condition $u(R_2,\phi) = g(\phi)$, we get
\[
g(\phi) = \sum_{n=0}^\infty \left(A_n R_2^n + B_n R_2^{-n-1}\right)
P_n(\cos(\phi)) \ .
\]
This is the Fourier-Legendre series of $g(\arccos(w))$ with respect to
the polynomials $P_n(w)$ for $n \geq 0$.
Therefore,
\[
A_n R_2^n + B_n R_2^{-n-1} =
\frac{2n+1}{2} \int_0^\pi g(\phi) P_n(\cos(\phi)) \sin(\phi) \dx{\phi} \ .
\]

We have an infinite numbers of linear system of equations
\[
\begin{pmatrix}
R_1^n & R_1^{-n-1} \\
R_2^n & R_2^{-n-1}
\end{pmatrix}
\begin{pmatrix}
A_n \\ B_n
\end{pmatrix}
=
\begin{pmatrix}
\displaystyle
\frac{2n+1}{2} \int_0^\pi f(\phi) P_n(\cos(\phi)) \sin(\phi) \dx{\phi}
\\[0.6em]
\displaystyle
\frac{2n+1}{2} \int_0^\pi g(\phi) P_n(\cos(\phi)) \sin(\phi) \dx{\phi}
\end{pmatrix}
\]
for $n\geq 0$ to solve.
\end{egg}

By separation of variables, we find that the solutions of the
potential equation on a spherical domain are linear combinations of
simple functions of the following form.  If the problem is independent
of $\theta$,
\begin{equation}\label{laplace_sf_rphi}
u_n(r,\phi) = \left(A_n r^n + \frac{B_n}{r^{n+1}} \right)
P_n(\cos(\phi))
\end{equation}
for $n \geq 0$.  If the problem is independent of $\theta$ and $\phi$,
$\displaystyle u(r) = C/r + D$.

\begin{egg}
Consider two concentric spheres $S_1$ and $S_2$ of radius $R_1=3$ and
$R_2=4$ respectively.  The potential on the first sphere is given by
$u(R_1,\phi) = \cos(\phi)$ and on the second sphere by
$u(R_2,\phi)= 3 \cos^2(\phi) + \cos(\phi) -1$.  Find the potential
$u(r,\phi)$:

\subQ{a} inside the sphere $S_1$.\\
\subQ{b} outside the sphere $S_2$\\
\subQ{c} between both spheres.

For (a), since the simple functions (\ref{laplace_sf_rphi}) must be
bounded at the origine, we must have $B_n=0$ for all $n$.  The
solution is therefore of the form
\[
u(r,\phi) = \sum_{n=0}^\infty A_n r^n P_n(\cos(\phi))
\quad , \quad 0 < r < 3 \ \text{and} \ 0 \leq \phi \leq \pi \ .
\]
Since $P_1(\cos(\phi)) = \cos(\phi)$, we get
\[
P_1(\cos(\phi)) = u(3,\phi) = \sum_{n=0}^\infty A_n 3^n P_n(\cos(\phi)) \ .
\]
Thus
\[
A_n = \begin{cases}
1/3 & \quad \text{if}\ n=1\\
0 & \quad \text{if} \ n\neq 1
\end{cases}
\]
The potential inside the sphere $S_1$ is given by
\[
u(r,\phi) = \frac{1}{3} \, r P_1(\cos(\phi)) = \frac{r\cos(\phi)}{3}
\quad , \quad 0 < r < 3 \ \text{and} \ 0 \leq \phi \leq \pi \ .
\]

For (b), since the simple functions (\ref{laplace_sf_rphi}) must converge to
$0$ as $r$ goes to infinity, we must have $A_n=0$ for all $n$.  The solution is
therefore of the form
\[
u(r,\phi) = \sum_{n=0}^\infty \frac{B_n}{r^{n+1}}
P_n(\cos(\phi))
\quad , \quad r > 4 \ \text{and} \ 0 \leq \phi \leq \pi \ .
\]
Since
\[
u(4,\phi) = 3 \cos^2(\phi) + \cos(\phi) -1 = 2 P_2(\cos(\phi)) +
P_1(\cos(\phi)) \ ,
\]
we get
\[
2 P_2(\cos(\phi)) + P_1(\cos(\phi)) = u(4,\phi)
= \sum_{n=0}^\infty \frac{B_n}{4^{n+1}} P_n(\cos(\phi)) \ .
\]
Thus
\[
B_n = \begin{cases}
16 & \quad \text{if $n=1$}\\
128 & \quad \text{if $n=2$} \\
0 &  \quad \text{if $n\neq 1,2$}
\end{cases}
\]
The potential outside the sphere $S_2$ is given by
\[
u(r,\phi) = \frac{16}{r^2} P_1(\cos(\phi)) + \frac{128}{r^3} P_2(\cos(\phi))
\quad , \quad r > 4 \ \text{and} \ 0 \leq \phi \leq \pi \ .
\]

Finally, for (c), there is no restriction on the simple functions
(\ref{laplace_sf_rphi}),  The solution is therefore of the form
\[
u(r,\phi) = \sum_{n=0}^\infty \left(A_n r^n + \frac{B_n}{r^{n+1}} \right)
P_n(\cos(\phi))
\quad , \quad 3 < r < 4 \ \text{and} \ 0 \leq \phi \leq \pi \ .
\]
From 
\[
P_1(\cos(\phi)) = u(3,\phi)
= \sum_{n=0}^\infty \left(A_n 3^n + \frac{B_n}{3^{n+1}} \right)
P_n(\cos(\phi)) \ ,
\]
we get
\[
A_n 3^n + \frac{B_n}{3^{n+1}} = \begin{cases}
1 & \quad \text{if $n=1$}\\
0 &  \quad \text{if $n\neq 1$}
\end{cases}
\]
From
\[
2 P_2(\cos(\phi)) + P_1(\cos(\phi)) = u(4,\phi)
= \sum_{n=0}^\infty \left(A_n 4^n + \frac{B_n}{4^{n+1}} \right)
P_n(\cos(\phi)) \ ,
\]
we get
\[
A_n 4^n + \frac{B_n}{4^{n+1}} = \begin{cases}
1 & \quad \text{if $n=1$}\\
2 & \quad \text{if $n=2$} \\
0 &  \quad \text{if $n\neq 1,2$}
\end{cases}
\]
For $n=1$, the coefficients $A_1$ and $B_1$ are the solutions of
\[
\begin{pmatrix}
3 & 1/9 \\ 4 & 1/16
\end{pmatrix}
\begin{pmatrix}
A_1 \\ B_1
\end{pmatrix}
=
\begin{pmatrix}
1 \\ 1
\end{pmatrix}
\ .
\]
We find $A_1 = 7/37$ and $B_1 = 144/37$.  For $n=2$, the coefficients
$A_2$ and $B_2$ are the solutions of 
\[
\begin{pmatrix}
9 & 1/27 \\ 16 & 1/64
\end{pmatrix}
\begin{pmatrix}
A_2 \\ B_2
\end{pmatrix}
=
\begin{pmatrix}
0 \\ 2
\end{pmatrix}
\ .
\]
We find $A_2 = -2 (27(9/64-16/27))^{-1}= 128/781$ and\\
$B_2 = 18 (9/64 - 16/27)^{-1}=-31104/781$.   For all the other values of $n$,
$A_n = B_n = 0$.  The potential between the spheres $S_1$ and $S_2$ is
given by
\[
u(r,\phi) = \left(\frac{7r}{37} + \frac{144}{37r^2} \right)
P_1(\cos(\phi)) +
\left( \frac{128 r^2}{781} + \frac{ -31104}{781 r^3} \right)
P_2(\cos(\phi))
\]
for $3 < r < 4$ and $0 \leq \phi \leq \pi$.
\end{egg}

We have see in Section~\ref{wave_cyl_sph_coord} that the Laplacian in
cylindrical coordinates is
\[
\Delta u = \pdydxn{u}{r}{2} + \frac{1}{r} \pdydx{u}{r}
+ \frac{1}{r^2} \pdydxn{u}{\theta}{2} + \pdydxn{u}{z}{2} \ .
\]
By separation of variables, we find that the solutions of the
potential equation in a cylindrical domain (this includes the planar
circular domain if the solution is independent of the $z$-coordinate)
are linear combinations of simple functions of the following form.
If the problem is independent of $z$ only
$\displaystyle u_0(r,\theta) = A_0 + B_0 \ln(r)$
and
$\displaystyle u_n(r,\theta)
= \left(A_n r^n + B_n r^{-n}\right) \cos(n \theta)
+ \left(C_n r^n + D_n r^{-n}\right) \sin(n \theta)$
for $n > 0$.  If the problem is independent of $\theta$ and $z$,
$u(r) = C \ln r + D$.

\section{Eigenvalue Problems for the Laplacian Operator}
\label{sectEigLaplace}

The concept of eigenvalues and eigenvectors is first introduced in
Linear Algebra.  Namely, if $A$ is an \nn matrix, then 
$\lambda$ is an eigenvalue of $A$ if there exists a non-null vector
$\VEC{v}\in \RR^n$ such that $A\VEC{v} = \lambda \VEC{v}$.  The vector
$\VEC{v}$ is called an eigenvector associated to $\lambda$.

The same concept may be applied to the linear differential operator
$\Delta$.  Suppose that $\Omega$ is a open set in $\RR^n$ with a
sufficiently smooth boundary.  Let
\[
  {\cal X} = \left\{ u \in C^2(\Omega) \cap C^1(\overline{\Omega}) :
    u = 0 \ \text{on} \ \partial \Omega\right\} \ .
\]
We say that $\lambda \in \RR$ is an
{\bfseries eigenvalue}\index{Laplacian!Eigenvalue} for the Laplacian 
operator $-\Delta$ on $\cal X$ if there exists a non-null function
$u \in \cal X$ solving the Laplace equation
$- \Delta u = \lambda u$ on $\Omega$.
We then say that $u$ is en
{\bfseries eigenvector}\index{Laplacian!Eigenvector} or
{\bfseries eigenfunction}\index{Laplacian!Eigenfunction} associated to
$\lambda$.

We provide a rigorous treatment of this subject in
Section~\ref{subsectEigLaplace}.  We consider the operator $-\Delta$
instead of $\Delta$ to obtain a nice ``variational formulation'' of
the Laplace equation as we will see in Section~\ref{subsectEigLaplace}.

For the rest of this section about the method of
separation of variables, we will continue with a more formal presentation.

\subsection{Eigenvalue Problem in a Rectangle}

In this section, we consider the eigenvalue problem for the mapping
$-\Delta$ on $\cal X$, where
\[
  \Omega =\left\{ (x,y) : 0 < x < a\ ,\ 0 < y < b \right\} \ .
\]
Namely, we seek $\lambda$ and
$u \in C^2(\Omega)\cap C(\overline{\Omega})$ such that
\begin{equation} \label{laplace_e_eigenC}
-\Delta u = -\pdydxn{u}{x}{2} - \pdydxn{u}{y}{2} = \lambda u
\quad , \quad (x,y) \in \Omega \ ,
\end{equation}
with the boundary conditions $u(x,0) = u(x,b) = 0$ for $0<x<a$ and
$u(0,y) = u(a,y) = 0$ for $0<y<b$.

\subI{Separation of Variables}
If we substitute $u(x,y) = F(x)G(y)$ in (\ref{laplace_e_eigenC}), we get
\[
-\dydxn{F}{x}{2}(x)\, G(y) - F(x)\,\dydxn{G}{y}{2}(y) = \lambda
F(x)G(y) \quad , \quad (x,y) \in \Omega \ .
\]
After dividing both sides by $F(x)G(y)$, we get
\[
-\frac{1}{G(y)} \, \dydxn{G}{y}{2}(y) =
\lambda + \frac{1}{F(x)}\,\dydxn{F}{x}{2}(x)
\quad , \quad (x,y) \in \Omega \ .
\]
Since the right hand side is independent of $y$ and the left hand side
is independent of $x$, we get
\[
-\frac{1}{G(y)} \, \dydxn{G}{y}{2}(y) = \lambda + \frac{1}{F(x)}\,
\dydxn{F}{x}{2}(x) = k \quad , \quad (x,y) \in \Omega \ ,
\]
for some constant $k$.  We end up with two ordinary differential equation.
\begin{equation} \label{laplace_e_eigenC1}
\dydxn{F}{x}{2}(x) + (\lambda-k) F(x) = 0 \quad \text{and}
\quad \dydxn{G}{y}{2}(y) + k\,G(y) = 0 \  .
\end{equation}

The first ordinary differential equation in
(\ref{laplace_e_eigenC1}) satisfies two boundary
conditions.   From $u(0,y) = 0$, we get $F(0)G(y)=0$.  Since we are
looking for non-null solutions, we must have that $G$ is
non-null and $F(0)=0$.  Similarly, from
$u(a,y) = 0$, we get $F(a)G(y)=0$.  Again, since we are
looking for non-null solutions, we must have that $G$ is
non-null and we get $F(a)=0$.  The boundary conditions for
the first ordinary differential equation in (\ref{laplace_e_eigenC1})
are $F(0)=F(a)=0$.

Similarly, the second ordinary differential equation in
(\ref{laplace_e_eigenC1}) satisfies the boundary conditions $G(0)=G(b)=0$.

\subI{Eigenfunctions}
We first consider the boundary value problem
\begin{equation} \label{laplace_e_eigenC2}
\dydxn{G}{y}{2}(y) + k G(y) = 0 \quad \text{with} \quad G(0)=G(b)=0 \ .
\end{equation}
The form of the general solution of the second order ordinary differential equation above is
determined by the roots of the characteristic equation $\rho^2 + k=0$.

For $k>0$, we get
$\displaystyle G(y) = C \cos(\sqrt{k}\,y) + D \sin(\sqrt{k} \,y)$.
The boundary condition $G(0)=0$ forces $C$ to be $0$.  The boundary
condition $G(b) = 0$ implies that
$\displaystyle k = k_n \equiv \left(n\pi/b\right)^2$ for all integers $n>0$
if we want to get a non-null solution.
We obtain
\[
G(y) = G_n(y) \equiv D_n \sin\left( \frac{n\pi\, y}{b}\right)
\]
for any integer $n>0$.  The usual analysis based on the sign of
$k$ yields no other non-null solution.

We now consider the boundary value problems
\begin{equation} \label{laplace_e_eigenC3}
\dydxn{F}{x}{2}(x) + (\lambda-k_n) F(x) = 0 \quad \text{with}
\quad F(0)=F(\pi)=0
\end{equation}
for $n>0$.  The form of the general solution
of the second order ordinary differential equation above is determined by the roots of the
characteristic equation $\rho^2 +(\lambda-k_n)=0$.

For $\lambda-k_n>0$, we get
$\displaystyle F(x) = A_n \cos(\sqrt{\lambda-k_n}\, x) + B_n
\sin(\sqrt{\lambda-k_n}\,x)$.
The boundary condition $F(0)=0$ forces $A$ to be $0$.  The boundary
condition $F(a) = 0$ implies that
$\displaystyle \lambda - k_n = \left(m\pi/a\right)^2$ for
all integers $m>0$ if we want to get a non-null solution.  We obtain
\[
F(x) = F_m(x) \equiv B_m \sin\left(\frac{m\pi\,x}{a}\right)
\]
for $m>0$.  The usual analysis based on the sign of
$\lambda - k_n$ yields no other non-null solution.

For each $m$ and $n$, we have found the non-null solution
$u_{n,m}(x,y) \equiv F_m(x)G_n(y)$ associated to
$\displaystyle \lambda = \lambda_{m,n} \equiv \left(m\pi/a\right)^2 +
\left(n\pi/b\right)^2$ with $m,n > 0$.  The $\lambda_{m,n}$
are the eigenvalues and, for each $m$ and $n$, an eigenfunction
associated to $\lambda_{m,n}$ is
\[
u_{m,n}(x,y) = F_m(x)G_n(y) = \sin\left(\frac{m\pi\,x}{a}\right)
\sin\left( \frac{n\pi\, y}{b}\right) \ .
\]

\begin{rmk}
The eigenspace associated to an eigenvalue $\lambda_{m,n}$ can
sometime be of dimension greater than $1$.  For instance, if $a=b$
then $\lambda_{1.2} = \lambda_{2.1}$ and the eigenfunctions
$u_{1,2}$ and $u_{2,1}$ are two linearly independent functions in the
eigenspace associated to $\lambda_{1.2} = \lambda_{2.1}$.
\end{rmk}

\subsection{Eigenvalue Problem in a Disk}

In this section, we consider the eigenvalue problem for the mapping
$-\Delta$ on $\cal X$, where
\[
  \Omega = \left\{ (x,y) :  \|(x,y)\| < R \right\} \ .
\]
We seek $\lambda$ and
$u \in C^2(\Omega)\cap C(\overline{\Omega})$ such that
\begin{equation} \label{laplace_e_eigenP}
-\Delta u = -\pdydxn{u}{r}{2} - \frac{1}{r} \pdydx{u}{r}
- \frac{1}{r^2} \dydxn{u}{\theta}{2} = \lambda u
\end{equation}
on $\Omega$ with the boundary conditions $u(R,\theta) =0$ for
$0\leq \theta < 2\pi$.

\subI{Separation of Variables}
If we substitute $u(r,\theta) = F(r)G(\theta)$ in
(\ref{laplace_e_eigenP}), we get
\[
-\dydxn{F}{r}{2}(r)\, G(\theta) - \frac{1}{r} \pdydx{F}{r}(r) G(\theta)
- \frac{1}{r^2} F(r)\dydxn{G}{\theta}{2}(\theta) = \lambda F(r)G(\theta) \ .
\]
After multiplying both sides by
$\displaystyle \frac{r^2}{F(r)G(\theta)}$, we get
\[
-\frac{1}{G(\theta)} \dydxn{G}{\theta}{2}(\theta) =
\frac{r^2}{F(r)} \dydxn{F}{r}{2}(r) + \frac{r}{F(r)} \pdydx{F}{r}(r)
+ \lambda \, r^2 \ .
\]
Since the right hand side is independent of $\theta$ and the left hand side
is independent of $r$, we get
\[
-\frac{1}{G(\theta)} \dydxn{G}{\theta}{2}(\theta) =
\frac{r^2}{F(r)} \dydxn{F}{r}{2}(r) + \frac{r}{F(r)} \pdydx{F}{r}(r)
+ \lambda \, r^2 = k
\]
for some constant $k$.  We end up with two ordinary differential equation.
\begin{equation} \label{laplace_e_eigenP1}
r^2\,\dydxn{F}{r}{2}(r) + r\, \pdydx{F}{r}(r)
+ \left(\lambda \, r^2 -k\right) F(r) = 0 \quad \text{and} \quad
\dydxn{G}{\theta}{2}(\theta) + k\,G(\theta) = 0 \  .
\end{equation}

The first ordinary differential equation in
(\ref{laplace_e_eigenP1}) satisfies two boundary
conditions.   From $u(R,\theta) = 0$, we get $F(R)G(\theta)=0$.  Since
we are looking for non-null solutions, we must have that $G$ is
non-null and $F(R)=0$.  There is another condition which is
implicit.  The function $u$, and thus $F$, must be bounded.  As we
will see, this condition is that $F$ must be bounded at the origin.

The second ordinary differential equation has also an implicit
boundary condition.  The solution
$u$ must be periodic of period $2\pi$ in $\theta$; namely,
$u(r,\theta) = u(r,\theta + 2\pi)$ for all $\theta$.  This gives
$F(r)G(\theta) = F(r)G(\theta + 2\pi)$ for all $r$ and $\theta$.
Since we are looking for non-null solutions, we must have that
$F$ is non-null and $G(\theta) = G(\theta + 2\pi)$ for all
$\theta$.

\subI{Eigenfunctions}
We first consider the boundary value problem
\begin{equation} \label{laplace_e_eigenP2}
\dydxn{G}{\theta}{2}(\theta) + k\,G(\theta) = 0 \quad \text{with} \quad
G(\theta) = G(\theta + 2\pi) \ .
\end{equation}

If $k<0$, the general solution of (\ref{laplace_e_eigenP2}) is of the form
$\displaystyle G(\theta) = A e^{\sqrt{-k}\theta} + B e^{-\sqrt{-k}\theta}$.
This cannot satisfy the condition $G(\theta) = G(\theta + 2\pi)$ for
all $\theta$ unless $A=B=0$

If $k=0$, the general solution of (\ref{laplace_e_eigenP2}) is of the form
$G(\theta) = B_0 \theta + A_0$.  We need $B_0 = 0$ to satisfy the
condition $G(\theta) = G(\theta + 2\pi)$.  Associated to $k = k_0 \equiv 0$,
we get the solution $G(\theta) = G_0(\theta) \equiv A_0$
for all $\theta$, where $A_0$ is a constant,

If $k>0$, the general solution of (\ref{laplace_e_eigenP2}) is of the form
$\displaystyle G(\theta) = A \cos\left(\sqrt{k}\theta\right)
+ B\sin\left(\sqrt{k}\theta\right)$.
To obtain non-null solutions satisfying the condition
$G(\theta) = G(\theta + 2\pi)$ for all $\theta$, we must have that
$\displaystyle k = k_n = n^2$ for all integers $n > 0$.  We get the
non-null solution
\[
G(\theta) = G_n(\theta) \equiv A_n \cos\left(n\theta\right)
+ B_n\sin\left(n\theta\right)
\]
for any integer $n > 0$.  Note that $n=0$ in the formula above yields the
constant solution $G = A_0$ found for $k=k_0=0$.

We now consider the boundary value problems
\begin{equation} \label{laplace_e_eigenP3}
r^2\,\dydxn{F}{r}{2}(r) + r\, \pdydx{F}{r}(r)
+ \left(\lambda \, r^2 -n^2\right) F(r) = 0 \\
\end{equation}
with $F(R)=0$ and $F$ bounded for any integer $n\geq 0$.

As we will see in Section~\ref{subsectEigLaplace}, the eigenvalues of
$-\Delta$ are positive.  We can therefore define the change of
variable $s=\sqrt{\lambda}\,r$.  Since
\[
\dydx{H}{r} = \dydx{H}{s} \dydx{s}{r} = \sqrt{\lambda} \dydx{H}{s}
\quad \text{and} \quad
\dydxn{H}{r}{2} = \dfdx{\left(\dydx{H}{r}\right)}{r}
= \sqrt{\lambda}\dfdx{\left(\sqrt{\lambda}\dydx{H}{s}\right)}{s}
= \lambda \dydxn{H}{s}{2}
\]
for any twice differentiable function $H$, the differential equation
in (\ref{laplace_e_eigenP3}) becomes
\[
s^2\,\dydxn{F}{s}{2}(s) + s\, \pdydx{F}{s}(s)
+ \left(s^2 -n^2\right) F(s) = 0
\]
for any integer $n \geq 0$, where, as usual, we are using the same name
for $F$ as a function of $s$ and $F$ as a function of $r$.  For each
$n$, this is the Bessel equation of order $n$ whose general solution
is of the form $F(s) = C_n J_n(s) + D_n Y_n(s)$.  Thus,
$\displaystyle F(r) = C_n J_n\left(\sqrt{\lambda}\, r\right) + D_n
Y_n\left(\sqrt{\lambda} \, r\right)$.
The condition that $u$ be bounded (at the origin) implies that $D_n=0$.
To get a non-null solution, we must have that $C_m \neq 0$.
Hence, the condition $F(R) = 0$ implies that
$\displaystyle J_n\left(\sqrt{\lambda}\, R\right)= 0$.  Thus,
$\displaystyle \lambda = \lambda_{m.n} \equiv \left(\alpha_{m,n}/R\right)^2$,
where $\alpha_{m,n}$ is the $m^{th}$ zero of the Bessel function $J_n$.
We get the non-null solutions
\[
  F(r) = F_{m,n}(r) \equiv C_{m,n} J_n\left(\frac{\alpha_{m,n}\,r}{R}\right)
\]
for any integers $n,m \geq 0$.
For $n\geq 1$, we have $\alpha_{0,n} =0$ so we may ignore $m=0$ for
$n>0$ because $\displaystyle J_n\left(\alpha_{0,n}\,r/R\right) = J_n(0) = 0$
for all $r$.

We have found non-null solutions only for
$\displaystyle \lambda = \lambda_{m.n} = \left(\alpha_{m,n}/R\right)^2$
with $m>0$ for $n>0$ and $m\geq 0$ for $n=0$.
The solution associated to $\lambda_{m.n}$ is
\[
u_{m,n}(x,y) \equiv F_{m,n}(r) G_n(\theta) =
\left( A_{m,n} \cos\left(n\theta\right)
+ B_{m,n} \sin\left(n\theta\right) \right)
J_n\left(\frac{\alpha_{m,n}\,r}{R}\right) \  ,
\]
where $A_{m,n} = A_n C_{m,n}$ and $B_{m,n} = B_n C_{m,n}$ are constants.

Hence, the eigenvalues are
$\lambda_{m.n} = \left(\alpha_{m,n}/R\right)^2$ 
with $m>0$ for $n>0$ and $m\geq 0$ for $n=0$.
The eigenspace associated to the eigenvalue $\lambda_{m,n}$ is
generated by
\[
\cos\left(n\theta\right)J_n\left(\frac{\alpha_{m,n}\,r}{R}\right)
\quad \text{and} \quad
\sin\left(n\theta\right)J_n\left(\frac{\alpha_{m,n}\,r}{R}\right) \ .
\]

Note that for the smallest eigenvalue $\lambda_{0,0} = (\alpha_{0,0}/R)^2$,
the eigenfunctions are multiple of
$\displaystyle J_0\left(\alpha_{0,0}\,r/R\right)$.  Thus, the
eigenspace associated to $\lambda_{0,0}$ is of dimension one as
predicted by the theory.

\subsection{Eigenvalue Problem on a Sphere}

In this section, we consider the eigenvalue problem for the mapping
$-\Delta$ on $\cal X$, where the region
\[
  \Omega = \left\{ (x,y,z) :  \|(x,y,z)\| = 1 \right\} \ .
\]
We seek $\lambda$ and $u \in C^2(\Omega)$ such that
\begin{equation} \label{laplace_e_eigenS}
-\Delta u = -\pdydxn{u}{\phi}{2} - \cot(\phi)\pdydx{u}{\phi}
- \frac{1}{\sin^2(\phi)}\pdydxn{u}{\theta}{2} 
= \lambda u
\end{equation}
on $\Omega$.  There is no boundary conditions but $u$ is periodic of period
$2\pi$ in $\theta$ and $u$ is bounded on the sphere, in particular at
the poles.

\subI{Separation of Variables}
If we substitute $u(\theta, \phi) = G(\theta)H(\phi)$ in
(\ref{laplace_e_eigenS}), we get 
\begin{equation} \label{laplace_e_eigenSB}
-G(\theta)\,\dydxn{H}{\phi}{2}(\phi) -\cot(\phi) G(\theta)\dydx{H}{\phi}(\phi)
- \frac{1}{\sin^2(\phi)} \dydxn{G}{\theta}{2}\,H(\phi)
= \lambda G(\theta)H(\phi) \ .
\end{equation}
After multiplying both sides by
$\displaystyle \frac{\sin^2(\phi)}{G(\theta)H(\phi)}$, we get
\[
\frac{1}{H(\phi)} \left(\sin^2(\phi) \dydxn{H}{\phi}{2}(\phi)
+ \cos(\phi) \sin(\phi) \dydx{H}{\phi}(\phi)\right) +
\lambda\,\sin^2(\phi) = - \frac{1}{G(\theta)} \dydxn{G}{\theta}{2}(\theta) \ .
\]
Since the right hand side is independent of $\phi$ and the left hand
side is independent of $\theta$, we get
\[
\frac{1}{H(\phi)} \left(\sin^2(\phi) \dydxn{H}{\phi}{2}(\phi)
+ \cos(\phi) \sin(\phi) \dydx{H}{\phi}(\phi)\right) +
\lambda\,\sin^2(\phi) = - \frac{1}{G(\theta)} \dydxn{G}{\theta}{2}(\theta)
= k
\]
for some constant $k$.  We get two ordinary differential equation.
\begin{equation} \label{laplace_e_eigenS1}
\dydxn{G}{\theta}{2}(\theta) + k G(\theta) = 0
\end{equation}
and
\begin{equation} \label{laplace_e_eigenS2}
\sin^2(\phi) \dydxn{H}{\phi}{2}(\phi)
+ \cos(\phi) \sin(\phi) \dydx{H}{\phi}(\phi) +
\left( \lambda\,\sin^2(\phi) - k\right) H(\phi) = 0
\end{equation}

\subI{Eigenfunctions}
We first solve (\ref{laplace_e_eigenS1}).  Since $u$ is periodic of period
$2\pi$ in $\theta$, the function $G$ must also be periodic of period
$2\pi$.  As for the eigenvalue problem on a disk, we find that
$k = k_m \equiv m^2$ and
\[
G(\theta) = G_m(\theta) \equiv A_m\cos(m\theta) + B_m\sin(m\theta)
\]
for all integers $m \geq 0$.  Since $G_0(\theta) = A_0$ for all
$\theta$, the term $B_m\sin(m\theta)$ can be ignored when $m=0$.

We now solve (\ref{laplace_e_eigenS2}) with $k=m^2$ for $m\geq 0$.
Namely, we consider
\begin{equation} \label{laplace_e_eigenS3}
\sin(\phi)\,\dfdx{\left(\sin(\phi)\dydx{H}{\phi}(\phi)\right)}{\phi}
+\left(\lambda\,\sin^2(\phi) - m^2\right)H(\phi) = 0
\end{equation}
for $m\geq 0$.

As we did for the potential equation in spherical
coordinates, we use the change of variable $w = \cos(\phi)$ for
$0<\phi<\pi$.
We have that
$\displaystyle \dydx{V}{\phi}(\phi) = \dydx{V}{w}(w)\, \dydx{w}{\phi}(\phi)
= -\sin(\phi) \dydx{V}{w}(w)$ and
$\displaystyle \sin(\phi) \dydx{V}{\phi}(\phi) = - \sin^2(\phi) \dydx{V}{w}(w)
= \left( \cos^2(\phi) - 1 \right) \dydx{V}{w}(w)
= (w^2-1)  \dydx{V}{w}(w)$
for any differentiable functions $V$.  As usual, to simplify the
notation, we use the same name to designate $V$ as a function of
$\phi$ and $V$ as a function of $w$.  We then have that $V(\phi) =
V(w)$ for $w=\cos(\phi)$.

Hence, with the change of variable $w = \cos(\phi)$ for $0<\phi<\pi$,
the equation (\ref{laplace_e_eigenS3}) becomes
\begin{equation} \label{laplace_e_eigenS4}
(w^2-1) \dfdx{\left( (w^2-1) \dydx{H}{w}(w)\right)}{w} 
+ \left( \lambda\,(w^2-1) -m^2\right) H(w) = 0 
\end{equation}
for $m\geq 0$.
This is the associated Legendre equation of order $m$
and has regular singular points at $w=-1$ and $w=1$.  For each
integer $m>0$, (\ref{laplace_e_eigenS4}) possesses non-null
bounded solutions when $\lambda = \lambda_n \equiv n(n+1)$ for
any integer $n \geq m$.  For fixed values of $m$ and
$n$, the non-null bounded solutions are multiple of the associated
Legendre polynomial
\[
P_n^m(w) = \left( 1-w^2 \right)^{m/2} \dydxn{P_n}{w}{m}(w) \ .
\]
We note that $\displaystyle \dydxn{P_n}{w}{m}(w) =0$ for all $w$ when
$m>n$ because $P_n$ is the Legendre polynomial of degree $n$,

Hence, for each integer $m\geq 0$, (\ref{laplace_e_eigenS2}) has
non-null bounded solutions when
$\lambda = \lambda_n = n(n+1)$ with $n$ an integer such that
$n\geq m$.  For fixed values of $m$ and $n$, the non-null bounded
solutions are multiple of
$\displaystyle H(\phi) = H_{m,n}(\phi) \equiv P_n^m(\cos(\phi))$.

We have found non-null solutions only for
$\displaystyle \lambda = \lambda_n = n(n+1)$.  The solutions
associated to $\lambda_n$ are of the form
\[
u_{m,n}(x,y) \equiv \sum_{m=0}^n G_m(\theta)H_{m,n}(\phi)
= \sum_{m=0}^n A_m\cos(m\theta) P_n^m(\cos(\phi))
+ \sum_{m=1}^n B_m\sin(m\theta) P_n^m(\cos(\phi))  ,
\]
where the $A_n$ and $B_n$ are constants.

Hence, the eigenvalues are
$\lambda = \lambda_n = n(n+1)$ for any integer $n\geq 0$.
The eigenspace associated to the eigenvalue $\lambda_n$ is
generated by the eigenfunctions
$\displaystyle \cos(m\theta)P_n^m(\cos(\phi))$ for $0 \leq m \leq n$
and
$\displaystyle \sin(m\theta)P_n^m(\cos(\phi))$ for $1 \leq m \leq n$.
These eigenfunctions are knows as
{\bfseries Surface Harmonics}\index{Laplacian!Surface Harmonics} of
order $n$.  The dimension of the eigenspace associated to $\lambda_n$
is of dimension $2n+1$.

\subsection{Eigenvalue Problem in a Ball}

In this section, we consider the eigenvalue problem for the mapping
$-\Delta$ on $\cal X$, where
\[
  \Omega = \left\{ (x,y,z) :  \|(x,y,z)\| < R \right\} \ .
\]
We seek $\lambda$ and
$u \in C^2(\Omega)\cap C(\overline{\Omega})$ such that
\begin{equation} \label{laplace_e_eigenB}
-\Delta u = -\pdydxn{u}{r}{2} - \frac{2}{r} \pdydx{u}{r}
- \frac{1}{r^2} \pdydxn{u}{\phi}{2} - \frac{\cot(\phi)}{r^2}
\pdydx{u}{\phi} - \frac{1}{r^2\sin^2(\phi)}\pdydxn{u}{\theta}{2} 
= \lambda u
\end{equation}
on $\Omega$ with the boundary conditions $u(R,\theta, \phi) =0$ for
$0\leq \theta < 2\pi$ and $0<\phi<\pi$.

\subI{Separation of Variables}
If we substitute $u(r,\theta, \phi) = F(r)G(\theta)H(\phi)$ in
(\ref{laplace_e_eigenB}), we get 
\begin{align*}
&-\dydxn{F}{r}{2}(r)\,G(\theta)H(\phi) - \frac{2}{r} \dydx{F}{r}(r) \,
G(\theta)H(\phi) - \frac{1}{r^2}F(r)G(\theta)\,\dydxn{H}{\phi}{2}(\phi) \\
&\qquad - \frac{\cot(\phi)}{r^2} F(r)G(\theta)\dydx{H}{\phi}(\phi)
- \frac{1}{r^2\sin^2(\phi)} F(r)\dydxn{G}{\theta}{2}\,H(\phi)
= \lambda F(r)G(\theta)H(\phi) \ .
\end{align*}
After multiplying both sides by
$\displaystyle \frac{r^2}{F(r)G(\theta)H(\phi)}$, we get
\begin{align*}
&-\frac{1}{F(r)} \left(r^2\,\dydxn{F}{r}{2}(r) +
2r \dydx{F}{r}(r)\right) - \lambda\,r^2 \\
&\qquad = \frac{1}{H(\phi)}\left( \dydxn{H}{\phi}{2}(\phi) + \cot(\phi)
\dydx{H}{\phi}(\phi)\right) +
\frac{1}{\sin^2(\phi) G(\theta)} \dydxn{G}{\theta}{2}(\theta) \ .
\end{align*}
Since the right hand side is independent of $r$ and the left hand side
is independent of $\theta$ and $\phi$, we get
\begin{align*}
&-\frac{1}{F(r)} \left(r^2\,\dydxn{F}{r}{2}(r) +
2r \dydx{F}{r}(r)\right) - \lambda\,r^2\\
&\qquad =\frac{1}{H(\phi)}\left( \dydxn{H}{\phi}{2}(\phi) +
\cot(\phi) \dydx{H}{\phi}(\phi)\right)
+ \frac{1}{\sin^2(\phi)G(\theta)} \dydxn{G}{\theta}{2}(\theta) = p
\end{align*}
for some constant $p$.  We get the ordinary differential equation
\begin{equation} \label{laplace_e_eigenB1}
r^2\,\dydxn{F}{r}{2}(r)+ 2r \dydx{F}{r}(r) + (p+ \lambda\,r^2)F(r) = 0
\end{equation}
and the equation
\[
\frac{1}{H(\phi)}\left( \dydxn{H}{\phi}{2}(\phi) +
\cot(\phi) \dydx{H}{\phi}(\phi) \right)
+ \frac{1}{\sin^2(\phi)G(\theta)} \dydxn{G}{\theta}{2}(\theta) = p
\]
This equation is (\ref{laplace_e_eigenSB}) with $\lambda$ replaced by $-p$.
In the previous section, we have found the conditions that must be
satisfied by $p$ to get non-null and bounded solutions.  More
precisely, we have found that non-null bounded solutions exist only
for $p = p_n \equiv -n(n+1)$ for $n\geq 0$.
For each $n$, the bounded solutions are linear combinations of terms of
the form
$\displaystyle G(\theta) H(\phi) = \cos(m\theta) P_n^m(\cos(\phi))$ for
$0 \leq m \leq n$ and
$\displaystyle G(\theta) H(\phi) = \sin(m\theta) P_n^m(\cos(\phi))$
for $0 \leq m \leq n$.

\subI{Eigenfunctions}
We only have to solve (\ref{laplace_e_eigenB1}) with $p=p_n=-n(n+1)$ for
$n \geq 0$.  We get from $u(R,\theta,\phi) = 0$ that
$F(R)G(\theta)H(\phi) = 0$ for all $\theta$ and $\phi$.
Since $G$ and $H$ are non-null functions, we must have that $F(R)=0$.
Moreover, $F$ must be bounded at the origin since it is required for $u$.

Let $\displaystyle F(r) = r^{-1/2}\,\rho(r)$.  We have that
$\displaystyle \dydx{F}{r} = -\frac{1}{2}\,r^{-3/2} \, \rho(r) +
r^{-1/2}\,\dydx{\rho}{r}(r)$ and\\
$\displaystyle \dydxn{F}{r}{2} = \frac{3}{4}\,r^{-5/2} \, \rho(r) -
r^{-3/2}\,\dydx{\rho}{r}(r) + r^{-1/2}\,\dydxn{\rho}{r}{2}$.
So, If we substitute $\displaystyle F(r) = r^{-1/2}\,\rho(r)$
in (\ref{laplace_e_eigenB1}) and simplify, we get
\[
r^2 \dydxn{\rho}{r}{2} + r \dydx{\rho}{r} + \left(\lambda r^2 -
  \left( n + \frac{1}{2}\right)^2\right)\rho = 0 \  .
\]
With $z = \lambda^{1/2} r$, we have
$\displaystyle
\dydx{V}{r} = \dydx{V}{z} \, \dydx{z}{r} = \lambda^{1/2} \dydx{V}{z}$
and
$\displaystyle \dydxn{V}{r}{2} = \dfdx{ \left( \dydx{V}{r}\right) }{r} =
\lambda^{1/2} \dfdx{ \left(\lambda^{1/2} \dydx{V}{z} \right) }{z}
= \lambda \dydxn{V}{z}{2}$
for any twice differentiable function $V$.  Hence, with the
substitution $z=\lambda^{1/2} r$, the previous ordinary differential equation becomes
\[
z^2 \dydxn{\rho}{z}{2} + z \dydx{\rho}{z} + \left( z^2 - 
\left( n + \frac{1}{2}\right)^2\right)\rho = 0 \  .
\]
This is a Bessel Equation of order $\displaystyle n + 1/2$.  Its
general solution is
$\displaystyle \rho(z) = A J_{n+1/2}(z) + B J_{-n-1/2}(z)$.
The general solution of (\ref{laplace_e_eigenB1}) with $p=p_n=-n(n+1)$ is
therefore
\[
F(r) = A r^{-1/2} J_{n+1/2}\left(\sqrt{\lambda}\, r\right)
+ B r^{-1/2} J_{-n-1/2}\left(\sqrt{\lambda}\, r\right) \  .
\]
Since $F$ must be bounded at the origin, we have $B=0$.  It
follows from the condition $F(R)=0$ that
$\displaystyle 0 = F(R) = A R^{-1/2} J_{n+1/2}\left(\sqrt{\lambda}\, R\right)$.
Thus, $\displaystyle \lambda = \lambda_{j,n} \equiv
\left(\alpha_{j,n+1/2}/R\right)^2$ for $j \geq 1$, where
$\alpha_{j,n+1/2}$ is the $j^{th}$ root of the Bessel function $J_{n+1/2}$.

We have shown that (\ref{laplace_e_eigenB}) has bounded solutions only when
$\displaystyle \lambda = \lambda_{j,n} =
\left(\alpha_{j,n+1/2}/R\right)^2$ and the non-null bounded
solutions associated to $\lambda_{j,n}$ are linear combinations of\\
$\displaystyle
r^{-1/2} J_{n+1/2}\left(\alpha_{j,n+1/2} r/R\right)
\cos(m\theta)P_n^m(\cos(\phi))$ for $0 \leq m \leq n$, and\\
$\displaystyle r^{-1/2} J_{n+1/2}\left(\alpha_{j,n+1/2} r/R\right)
\sin(m\theta)P_n^m(\cos(\phi))$ for $1 \leq m \leq n$.

Hence, the eigenvalues of (\ref{laplace_e_eigenB}) are
$\displaystyle \lambda_{j,n} =
\left(\alpha_{j,n+1/2}/R\right)^2$ for any integers 
$n \geq 0$ and $j > 0$.   The eigenspace associated to the eigenvalue
$\lambda_{j,n}$ is generated by the eigenfunctions
$\displaystyle r^{-1/2} J_{n+1/2}\left(\alpha_{j,n+1/2} r/R\right)
\cos(m\theta)P_n^m(\cos(\phi))$
for $0 \leq m \leq n$, and\\
$\displaystyle r^{-1/2} J_{n+1/2}\left(\alpha_{j,n+1/2} r/R\right)
\sin(m\theta)P_n^m(\cos(\phi))$
for $1 \leq m \leq n$.  These eigenfunctions are knows as
{\bfseries Spherical Harmonics}\index{Laplacian!Spherical Harmonics} of
order $n$.  The dimension of the eigenspace associated to
$\lambda_{j,n}$ is of dimension $2n+1$.

\section{Exercises}

Suggested exercises:

\begin{itemize}
\item In \cite{J}: all the numbers in Section 4.2.
\item In \cite{McO}: all the numbers in Sections 4.1; numbers 1 to 9
  in Section 4.2;  numbers 2, 5 to 7 in Section 4.4.
\item In \cite{PinRub}: numbers 7.2 to 7.5, 7.8, 7.10 to 7.12, 7.19,
  7.20 and 7.22 in Section 7.9; numbers 9.8 to 9.10 in Section 9.13. 
\item In \cite{Str}: numbers 2 to 12 in Section 6.1; all the
numbers in Section 6.2; numbers 1 to 3 in Section 6.3; numbers 1, 2, 5
to 11, and 13 in Section 6.4; numbers 5 to 9, 12 to 18 in Section 7.4;
numbers 14 to 19 in Section 10.5; numbers 6 to 8 in Sections 10.6.
\end{itemize}


%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "notes"
%%% End: 
